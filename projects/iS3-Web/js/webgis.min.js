function get_bit(t,e){return t/Math.pow(2,e)&1}function iS3(t){}!function(){function t(t){var e=t.__resizeTriggers__,n=e.firstElementChild,i=e.lastElementChild,o=n.firstElementChild;i.scrollLeft=i.scrollWidth,i.scrollTop=i.scrollHeight,o.style.width=n.offsetWidth+1+"px",o.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight}function e(t){return t.offsetWidth!=t.__resizeLast__.width||t.offsetHeight!=t.__resizeLast__.height}function n(n){var i=this;t(this),this.__resizeRAF__&&a(this.__resizeRAF__),this.__resizeRAF__=s(function(){e(i)&&(i.__resizeLast__.width=i.offsetWidth,i.__resizeLast__.height=i.offsetHeight,i.__resizeListeners__.forEach(function(t){t.call(i,n)}))})}function i(){if(!r){var t=(v?v:"")+".resize-triggers { "+(j?j:"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t)),e.appendChild(n),r=!0}}var o=document.attachEvent,r=!1;if(!o){var s=function(){var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)};return function(e){return t(e)}}(),a=function(){var t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(e){return t(e)}}(),l=!1,d="animation",c="",h="animationstart",u="Webkit Moz O ms".split(" "),p="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),g="",m=document.createElement("fakeelement");if(void 0!==m.style.animationName&&(l=!0),l===!1)for(var f=0;f<u.length;f++)if(void 0!==m.style[u[f]+"AnimationName"]){g=u[f],d=g+"Animation",c="-"+g.toLowerCase()+"-",h=p[f],l=!0;break}var y="resizeanim",v="@"+c+"keyframes "+y+" { from { opacity: 0; } to { opacity: 0; } } ",j=c+"animation: 1ms "+y+"; "}window.addResizeListener=function(e,r){o?e.attachEvent("onresize",r):(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),i(),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=document.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),t(e),e.addEventListener("scroll",n,!0),h&&e.__resizeTriggers__.addEventListener(h,function(n){n.animationName==y&&t(e)})),e.__resizeListeners__.push(r))},window.removeResizeListener=function(t,e){o?t.detachEvent("onresize",e):(t.__resizeListeners__.splice(t.__resizeListeners__.indexOf(e),1),t.__resizeListeners__.length||(t.removeEventListener("scroll",n),t.__resizeTriggers__=!t.removeChild(t.__resizeTriggers__)))}}(),iS3.saveAs=iS3.saveAs||function(t){"use strict";if(!("undefined"==typeof t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},i=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in i,r=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},s=/constructor/i.test(t.HTMLElement)||t.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},d="application/octet-stream",c=4e4,h=function(t){var e=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};setTimeout(e,c)},u=function(t,e,n){e=[].concat(e);for(var i=e.length;i--;){var o=t["on"+e[i]];if("function"==typeof o)try{o.call(t,n||t)}catch(t){l(t)}}},p=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},g=function(e,l,c){c||(e=p(e));var g,m=this,f=e.type,y=f===d,v=function(){u(m,"writestart progress write writeend".split(" "))},j=function(){if((a||y&&s)&&t.FileReader){var i=new FileReader;return i.onloadend=function(){var e=a?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;"),n=t.open(e,"_blank");n||(t.location.href=e),e=void 0,m.readyState=m.DONE,v()},i.readAsDataURL(e),void(m.readyState=m.INIT)}if(g||(g=n().createObjectURL(e)),y)t.location.href=g;else{var o=t.open(g,"_blank");o||(t.location.href=g)}m.readyState=m.DONE,v(),h(g)};return m.readyState=m.INIT,console.log(e.type),o?(g=n().createObjectURL(e),void setTimeout(function(){i.href=g,i.download=l,r(i),v(),h(g),m.readyState=m.DONE})):void j()},m=g.prototype,f=function(t,e,n){return new g(t,e||t.name||"download",n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=p(t)),navigator.msSaveOrOpenBlob(t,e)}:(m.abort=function(){},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,f)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content),"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs}),iS3.geohash=function(){};for(var BASE32_CODES="0123456789bcdefghjkmnpqrstuvwxyz",BASE32_CODES_DICT={},i=0;i<BASE32_CODES.length;i++)BASE32_CODES_DICT[BASE32_CODES.charAt(i)]=i;var ENCODE_AUTO="auto",SIGFIG_HASH_LENGTH=[0,5,7,8,11,12,13,15,16,17,18];iS3.geohash.encode=function(t,e,n){if(n===ENCODE_AUTO){if("number"==typeof t||"number"==typeof e)throw new Error("string notation required for auto precision.");var i=t.split(".")[1].length,o=e.split(".")[1].length,r=Math.max(i,o);n=SIGFIG_HASH_LENGTH[r]}else void 0===n&&(n=9);for(var s,a=[],l=0,d=0,c=0,h=90,u=-90,p=180,g=-180;a.length<n;)if(d%2===0?(s=(p+g)/2,e>s?(c=(c<<1)+1,g=s):(c=(c<<1)+0,p=s)):(s=(h+u)/2,t>s?(c=(c<<1)+1,u=s):(c=(c<<1)+0,h=s)),l++,d++,5===l){var m=BASE32_CODES[c];a.push(m),l=0,c=0}return a.join("")},iS3.geohash.encode_int=function(t,e,n){n=n||52;for(var i,o=0,r=90,s=-90,a=180,l=-180,d=0;o<n;)d*=2,o%2===0?(i=(a+l)/2,e>i?(d+=1,l=i):a=i):(i=(r+s)/2,t>i?(d+=1,s=i):r=i),o++;return d},iS3.geohash.decode_bbox=function(t){for(var e,n=!0,i=90,o=-90,r=180,s=-180,a=0,l=0,d=t.length;l<d;l++){var c=t[l].toLowerCase();a=BASE32_CODES_DICT[c];for(var h=4;h>=0;h--){var u=a>>h&1;n?(e=(r+s)/2,1===u?s=e:r=e):(e=(i+o)/2,1===u?o=e:i=e),n=!n}}return[o,s,i,r]},iS3.geohash.decode_bbox_int=function(t,e){e=e||52;for(var n=90,i=-90,o=180,r=-180,s=0,a=0,l=e/2,d=0;d<l;d++)a=get_bit(t,2*(l-d)-1),s=get_bit(t,2*(l-d)-2),0===s?n=(n+i)/2:i=(n+i)/2,0===a?o=(o+r)/2:r=(o+r)/2;return[i,r,n,o]},iS3.geohash.decode=function(t){var e=iS3.geohash.decode_bbox(t),n=(e[0]+e[2])/2,i=(e[1]+e[3])/2,o=e[2]-n,r=e[3]-i;return{latitude:n,longitude:i,error:{latitude:o,longitude:r}}},iS3.geohash.decode_int=function(t,e){var n=iS3.geohash.decode_bbox_int(t,e),i=(n[0]+n[2])/2,o=(n[1]+n[3])/2,r=n[2]-i,s=n[3]-o;return{latitude:i,longitude:o,error:{latitude:r,longitude:s}}},iS3.geohash.neighbor=function(t,e){var n=iS3.geohash.decode(t),i=n.latitude+e[0]*n.error.latitude*2,o=n.longitude+e[1]*n.error.longitude*2;return iS3.geohash.encode(i,o,t.length)},iS3.geohash.neighbor_int=function(t,e,n){n=n||52;var i=iS3.geohash.decode_int(t,n),o=i.latitude+e[0]*i.error.latitude*2,r=i.longitude+e[1]*i.error.longitude*2;return iS3.geohash.encode_int(o,r,n)},iS3.geohash.neighbors=function(t){function e(t,e){return n=s+t*l,i=a+e*d,iS3.geohash.encode(n,i,o)}var n,i,o=t.length,r=iS3.geohash.decode(t),s=r.latitude,a=r.longitude,l=2*r.error.latitude,d=2*r.error.longitude,c=[e(1,0),e(1,1),e(0,1),e(-1,1),e(-1,0),e(-1,-1),e(0,-1),e(1,-1)];return c},iS3.geohash.neighbors_int=function(t,e){function n(t,n){return i=s+t*l,o=a+n*d,iS3.geohash.encode_int(i,o,e)}e=e||52;var i,o,r=iS3.geohash.decode_int(t,e),s=r.latitude,a=r.longitude,l=2*r.error.latitude,d=2*r.error.longitude,c=[n(1,0),n(1,1),n(0,1),n(-1,1),n(-1,0),n(-1,-1),n(0,-1),n(1,-1)];return c},iS3.geohash.bboxes=function(t,e,n,i,o){o=o||9;for(var r=iS3.geohash.encode(t,e,o),s=iS3.geohash.encode(n,i,o),a=iS3.geohash.decode(r),l=2*a.error.latitude,d=2*a.error.longitude,c=iS3.geohash.decode_bbox(r),h=iS3.geohash.decode_bbox(s),u=Math.round((h[0]-c[0])/l),p=Math.round((h[1]-c[1])/d),g=[],m=0;m<=u;m++)for(var f=0;f<=p;f++)g.push(iS3.geohash.neighbor(r,[m,f]));return g},iS3.geohash.bboxes_int=function(t,e,n,i,o){o=o||52;for(var r=iS3.geohash.encode_int(t,e,o),s=iS3.geohash.encode_int(n,i,o),a=iS3.geohash.decode_int(r,o),l=2*a.error.latitude,d=2*a.error.longitude,c=iS3.geohash.decode_bbox_int(r,o),h=iS3.geohash.decode_bbox_int(s,o),u=Math.round((h[0]-c[0])/l),p=Math.round((h[1]-c[1])/d),g=[],m=0;m<=u;m++)for(var f=0;f<=p;f++)g.push(iS3.geohash.neighbor_int(r,[m,f],o));return g},!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.hull=t()}}(function(){return function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return o(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){function i(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function o(t){for(var e=[],n=0;n<t.length;n++){for(;e.length>=2&&i(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}return e.pop(),e}function r(t){for(var e=t.reverse(),n=[],o=0;o<e.length;o++){for(;n.length>=2&&i(n[n.length-2],n[n.length-1],e[o])<=0;)n.pop();n.push(e[o])}return n.pop(),n}function s(t){var e,n=o(t),i=r(t);return e=i.concat(n),e.push(t[0]),e}e.exports=s},{}],2:[function(t,e,n){e.exports={toXy:function(t,e){return void 0===e?t.slice():t.map(function(t){var n=new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];");return n(t)})},fromXy:function(t,e){return void 0===e?t.slice():t.map(function(t){var n=new Function("pt","var o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;");return n(t)})}}},{}],3:[function(t,e,n){function i(t,e){this._cells=[],this._cellSize=e,t.forEach(function(t){var e=this.point2CellXY(t),n=e[0],i=e[1];void 0===this._cells[n]&&(this._cells[n]=[]),void 0===this._cells[n][i]&&(this._cells[n][i]=[]),this._cells[n][i].push(t)},this)}function o(t,e){return new i(t,e)}i.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){for(var e=this.point2CellXY([t[0],t[1]]),n=this.point2CellXY([t[2],t[3]]),i=[],o=e[0];o<=n[0];o++)for(var r=e[1];r<=n[1];r++)i=i.concat(this.cellPoints(o,r));return i},removePoint:function(t){for(var e,n=this.point2CellXY(t),i=this._cells[n[0]][n[1]],o=0;o<i.length;o++)if(i[o][0]===t[0]&&i[o][1]===t[1]){e=o;break}return i.splice(e,1),i},point2CellXY:function(t){var e=parseInt(t[0]/this._cellSize),n=parseInt(t[1]/this._cellSize);return[e,n]},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},e.exports=o},{}],4:[function(t,e,n){"use strict";function i(t){return t.filter(function(t,e,n){var i=n[e-1];return 0===e||!(i[0]===t[0]&&i[1]===t[1])})}function o(t){return t.sort(function(t,e){return t[0]==e[0]?t[1]-e[1]:t[0]-e[0]})}function r(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function s(t,e,n){var i=[e[0]-t[0],e[1]-t[1]],o=[n[0]-t[0],n[1]-t[1]],s=r(t,e),a=r(t,n),l=i[0]*o[0]+i[1]*o[1];return l/Math.sqrt(s*a)}function a(t,e){for(var n=0;n<e.length-1;n++){var i=[e[n],e[n+1]];if(!(t[0][0]===i[0][0]&&t[0][1]===i[0][1]||t[0][0]===i[1][0]&&t[0][1]===i[1][1])&&p(t,i))return!0}return!1}function l(t){for(var e=1/0,n=1/0,i=-(1/0),o=-(1/0),r=t.length-1;r>=0;r--)t[r][0]<e&&(e=t[r][0]),t[r][1]<n&&(n=t[r][1]),t[r][0]>i&&(i=t[r][0]),t[r][1]>o&&(o=t[r][1]);return[i-e,o-n]}function d(t){return[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]}function c(t,e,n){for(var i,o,r=null,l=y,d=y,c=0;c<e.length;c++)i=s(t[0],t[1],e[c]),o=s(t[1],t[0],e[c]),i>l&&o>d&&!a([t[0],e[c]],n)&&!a([t[1],e[c]],n)&&(l=i,d=o,r=e[c]);return r}function h(t,e,n,i,o){for(var s,a,l,u,p,g,m,f=!1,y=0;y<t.length-1;y++)if(s=[t[y],t[y+1]],a=s[0].join()+","+s[1].join(),!(r(s[0],s[1])<e||o[a]===!0)){l=0,p=d(s);do p=i.extendBbox(p,l),g=p[2]-p[0],m=p[3]-p[1],u=c(s,i.rangePoints(p),t),l++;while(null===u&&(n[0]>g||n[1]>m));g>=n[0]&&m>=n[1]&&(o[a]=!0),null!==u&&(t.splice(y+1,0,u),i.removePoint(u),f=!0)}return f?h(t,e,n,i,o):t}function u(t,e,n){var r,s,a,d,c,u,p,y=e||20;return t.length<4?t.slice():(p=i(o(m.toXy(t,n))),d=l(p),c=[d[0]*v,d[1]*v],r=f(p),a=p.filter(function(t){return r.indexOf(t)<0}),u=Math.ceil(1/(p.length/(d[0]*d[1]))),s=h(r,Math.pow(y,2),c,g(a,u),{}),m.fromXy(s,n))}var p=t("./intersect.js"),g=t("./grid.js"),m=t("./format.js"),f=t("./convex.js"),y=Math.cos(90/(180/Math.PI)),v=.6;e.exports=u},{"./convex.js":1,"./format.js":2,"./grid.js":3,"./intersect.js":5}],5:[function(t,e,n){function i(t,e,n,i,o,r){var s=(r-e)*(n-t)-(i-e)*(o-t);return s>0||!(s<0)}function o(t,e){var n=t[0][0],o=t[0][1],r=t[1][0],s=t[1][1],a=e[0][0],l=e[0][1],d=e[1][0],c=e[1][1];return i(n,o,a,l,d,c)!==i(r,s,a,l,d,c)&&i(n,o,r,s,a,l)!==i(n,o,r,s,d,c)}e.exports=o},{}]},{},[4])(4)}),function(t,e,n){function i(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function o(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return h[t.which]?h[t.which]:u[t.which]?u[t.which]:String.fromCharCode(t.which).toLowerCase()}function r(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}function s(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function a(t,e){var n,i,o,r=[];for(n=t,"+"===n?n=["+"]:(n=n.replace(/\+{2}/g,"+plus"),n=n.split("+")),o=0;o<n.length;++o)i=n[o],g[i]&&(i=g[i]),e&&"keypress"!=e&&p[i]&&(i=p[i],r.push("shift")),s(i)&&r.push(i);if(n=i,o=e,!o){if(!c){c={};for(var a in h)95<a&&112>a||h.hasOwnProperty(a)&&(c[h[a]]=a)}o=c[n]?"keydown":"keypress"}return"keypress"==o&&r.length&&(o="keydown"),{key:i,modifiers:r,action:o}}function l(t,n){return null!==t&&t!==e&&(t===n||l(t.parentNode,n))}function d(t){function n(t){t=t||{};var e,n=!1;for(e in f)t[e]?n=!0:f[e]=0;n||(j=!1)}function l(t,e,n,i,o,r){var a,l,d=[],c=n.type;if(!g._callbacks[t])return[];for("keyup"==c&&s(t)&&(e=[t]),a=0;a<g._callbacks[t].length;++a)if(l=g._callbacks[t][a],(i||!l.seq||f[l.seq]==l.level)&&c==l.action){var h;(h="keypress"==c&&!n.metaKey&&!n.ctrlKey)||(h=l.modifiers,h=e.sort().join(",")===h.sort().join(",")),h&&(h=i&&l.seq==i&&l.level==r,(!i&&l.combo==o||h)&&g._callbacks[t].splice(a,1),d.push(l))}return d}function c(t,e,n,i){g.stopCallback(e,e.target||e.srcElement,n,i)||!1!==t(e,n)||(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0)}function h(t){"number"!=typeof t.which&&(t.which=t.keyCode);var e=o(t);e&&("keyup"==t.type&&y===e?y=!1:g.handleKey(e,r(t),t))}function u(t,e,i,r){function s(e){return function(){j=e,++f[t],clearTimeout(m),m=setTimeout(n,1e3)}}function l(e){c(i,e,t),"keyup"!==r&&(y=o(e)),setTimeout(n,10)}for(var d=f[t]=0;d<e.length;++d){var h=d+1===e.length?l:s(r||a(e[d+1]).action);p(e[d],h,r,t,d)}}function p(t,e,n,i,o){g._directMap[t+":"+n]=e,t=t.replace(/\s+/g," ");var r=t.split(" ");1<r.length?u(t,r,e,n):(n=a(t,n),g._callbacks[n.key]=g._callbacks[n.key]||[],l(n.key,n.modifiers,{type:n.action},i,t,o),g._callbacks[n.key][i?"unshift":"push"]({callback:e,modifiers:n.modifiers,action:n.action,seq:i,level:o,combo:t}))}var g=this;if(t=t||e,!(g instanceof d))return new d(t);g.target=t,g._callbacks={},g._directMap={};var m,f={},y=!1,v=!1,j=!1;g._handleKey=function(t,e,i){var o,r=l(t,e,i);e={};var a=0,d=!1;for(o=0;o<r.length;++o)r[o].seq&&(a=Math.max(a,r[o].level));for(o=0;o<r.length;++o)r[o].seq?r[o].level==a&&(d=!0,e[r[o].seq]=1,c(r[o].callback,i,r[o].combo,r[o].seq)):d||c(r[o].callback,i,r[o].combo);r="keypress"==i.type&&v,i.type!=j||s(t)||r||n(e),v=d&&"keydown"==i.type},g._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)p(t[i],e,n)},i(t,"keypress",h),i(t,"keydown",h),i(t,"keyup",h)}if(t){var c,h={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},u={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},p={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},g={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"};for(n=1;20>n;++n)h[111+n]="f"+n;for(n=0;9>=n;++n)h[n+96]=n;d.prototype.bind=function(t,e,n){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,n),this},d.prototype.unbind=function(t,e){return this.bind.call(this,t,function(){},e)},d.prototype.trigger=function(t,e){return this._directMap[t+":"+e]&&this._directMap[t+":"+e]({},t),this},d.prototype.reset=function(){return this._callbacks={},this._directMap={},this},d.prototype.stopCallback=function(t,e){return!(-1<(" "+e.className+" ").indexOf(" mousetrap ")||l(e,this.target))&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable)},d.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},d.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(h[e]=t[e]);c=null},d.init=function(){var t,n=d(e);for(t in n)"_"!==t.charAt(0)&&(d[t]=function(t){return function(){return n[t].apply(n,arguments)}}(t))},d.init(),t.Mousetrap=d,"undefined"!=typeof module&&module.exports&&(module.exports=d),"function"==typeof define&&define.amd&&define(function(){return d})}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null),function(t){"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e,window,document)}):"object"==typeof exports?module.exports=function(e,n){return e||(e=window),n||(n="undefined"!=typeof window?require("jquery"):require("jquery")(e)),t(n,e,e.document)}:t(jQuery,window,document)}(function(t,e,n,i){function o(e){var n,i,r={};t.each(e,function(t){(n=t.match(/^([^A-Z]+?)([A-Z])/))&&-1!=="a aa ai ao as b fn i m o s ".indexOf(n[1]+" ")&&(i=t.replace(n[0],n[2].toLowerCase()),r[i]=t,"o"===n[1]&&o(e[t]))}),e._hungarianMap=r}function r(e,n,s){e._hungarianMap||o(e);var a;t.each(n,function(o){a=e._hungarianMap[o],a===i||!s&&n[a]!==i||("o"===a.charAt(0)?(n[a]||(n[a]={}),t.extend(!0,n[a],n[o]),r(e[a],n[a],s)):n[a]=n[o])})}function s(t){var e=zt.defaults.oLanguage,n=t.sZeroRecords;!t.sEmptyTable&&n&&"No data available in table"===e.sEmptyTable&&Nt(t,t,"sZeroRecords","sEmptyTable"),!t.sLoadingRecords&&n&&"Loading..."===e.sLoadingRecords&&Nt(t,t,"sZeroRecords","sLoadingRecords"),t.sInfoThousands&&(t.sThousands=t.sInfoThousands),(t=t.sDecimal)&&Bt(t)}function a(t){if(de(t,"ordering","bSort"),de(t,"orderMulti","bSortMulti"),de(t,"orderClasses","bSortClasses"),de(t,"orderCellsTop","bSortCellsTop"),de(t,"order","aaSorting"),de(t,"orderFixed","aaSortingFixed"),de(t,"paging","bPaginate"),de(t,"pagingType","sPaginationType"),de(t,"pageLength","iDisplayLength"),de(t,"searching","bFilter"),"boolean"==typeof t.sScrollX&&(t.sScrollX=t.sScrollX?"100%":""),"boolean"==typeof t.scrollX&&(t.scrollX=t.scrollX?"100%":""),t=t.aoSearchCols)for(var e=0,n=t.length;e<n;e++)t[e]&&r(zt.models.oSearch,t[e])}function l(e){de(e,"orderable","bSortable"),de(e,"orderData","aDataSort"),de(e,"orderSequence","asSorting"),de(e,"orderDataType","sortDataType");var n=e.aDataSort;"number"==typeof n&&!t.isArray(n)&&(e.aDataSort=[n])}function d(n){if(!zt.__browser){var i={};zt.__browser=i;var o=t("<div/>").css({position:"fixed",top:0,left:-1*t(e).scrollLeft(),height:1,width:1,overflow:"hidden"}).append(t("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(t("<div/>").css({width:"100%",height:10}))).appendTo("body"),r=o.children(),s=r.children();i.barWidth=r[0].offsetWidth-r[0].clientWidth,i.bScrollOversize=100===s[0].offsetWidth&&100!==r[0].clientWidth,i.bScrollbarLeft=1!==Math.round(s.offset().left),i.bBounding=!!o[0].getBoundingClientRect().width,o.remove()}t.extend(n.oBrowser,zt.__browser),n.oScroll.iBarWidth=zt.__browser.barWidth}function c(t,e,n,o,r,s){var a,l=!1;for(n!==i&&(a=n,l=!0);o!==r;)t.hasOwnProperty(o)&&(a=l?e(a,t[o],o,t):t[o],l=!0,o+=s);return a}function h(e,i){var o=zt.defaults.column,r=e.aoColumns.length,o=t.extend({},zt.models.oColumn,o,{nTh:i?i:n.createElement("th"),sTitle:o.sTitle?o.sTitle:i?i.innerHTML:"",aDataSort:o.aDataSort?o.aDataSort:[r],mData:o.mData?o.mData:r,idx:r});e.aoColumns.push(o),o=e.aoPreSearchCols,o[r]=t.extend({},zt.models.oSearch,o[r]),u(e,r,t(i).data())}function u(e,n,o){var n=e.aoColumns[n],s=e.oClasses,a=t(n.nTh);if(!n.sWidthOrig){n.sWidthOrig=a.attr("width")||null;var d=(a.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);d&&(n.sWidthOrig=d[1])}o!==i&&null!==o&&(l(o),r(zt.defaults.column,o),o.mDataProp!==i&&!o.mData&&(o.mData=o.mDataProp),o.sType&&(n._sManualType=o.sType),o.className&&!o.sClass&&(o.sClass=o.className),o.sClass&&a.addClass(o.sClass),t.extend(n,o),Nt(n,o,"sWidth","sWidthOrig"),o.iDataSort!==i&&(n.aDataSort=[o.iDataSort]),Nt(n,o,"aDataSort"));var c=n.mData,h=C(c),u=n.mRender?C(n.mRender):null,o=function(t){return"string"==typeof t&&-1!==t.indexOf("@")};n._bAttrSrc=t.isPlainObject(c)&&(o(c.sort)||o(c.type)||o(c.filter)),n._setter=null,n.fnGetData=function(t,e,n){var o=h(t,e,i,n);return u&&e?u(o,e,t,n):o},n.fnSetData=function(t,e,n){return I(c)(t,e,n)},"number"!=typeof c&&(e._rowReadObject=!0),e.oFeatures.bSort||(n.bSortable=!1,a.addClass(s.sSortableNone)),e=-1!==t.inArray("asc",n.asSorting),o=-1!==t.inArray("desc",n.asSorting),n.bSortable&&(e||o)?e&&!o?(n.sSortingClass=s.sSortableAsc,n.sSortingClassJUI=s.sSortJUIAscAllowed):!e&&o?(n.sSortingClass=s.sSortableDesc,n.sSortingClassJUI=s.sSortJUIDescAllowed):(n.sSortingClass=s.sSortable,n.sSortingClassJUI=s.sSortJUI):(n.sSortingClass=s.sSortableNone,n.sSortingClassJUI="")}function p(t){if(!1!==t.oFeatures.bAutoWidth){var e=t.aoColumns;mt(t);for(var n=0,i=e.length;n<i;n++)e[n].nTh.style.width=e[n].sWidth}e=t.oScroll,(""!==e.sY||""!==e.sX)&&pt(t),Rt(t,null,"column-sizing",[t])}function g(t,e){var n=y(t,"bVisible");return"number"==typeof n[e]?n[e]:null}function m(e,n){var i=y(e,"bVisible"),i=t.inArray(n,i);return-1!==i?i:null}function f(e){var n=0;return t.each(e.aoColumns,function(e,i){i.bVisible&&"none"!==t(i.nTh).css("display")&&n++}),n}function y(e,n){var i=[];return t.map(e.aoColumns,function(t,e){t[n]&&i.push(e)}),i}function v(t){var e,n,o,r,s,a,l,d,c,h=t.aoColumns,u=t.aoData,p=zt.ext.type.detect;for(e=0,n=h.length;e<n;e++)if(l=h[e],c=[],!l.sType&&l._sManualType)l.sType=l._sManualType;else if(!l.sType){for(o=0,r=p.length;o<r;o++){for(s=0,a=u.length;s<a&&(c[s]===i&&(c[s]=S(t,s,e,"type")),d=p[o](c[s],t),d||o===p.length-1)&&"html"!==d;s++);if(d){l.sType=d;break}}l.sType||(l.sType="string")}}function j(e,n,o,r){var s,a,l,d,c,u,p=e.aoColumns;if(n)for(s=n.length-1;0<=s;s--){u=n[s];var g=u.targets!==i?u.targets:u.aTargets;for(t.isArray(g)||(g=[g]),a=0,l=g.length;a<l;a++)if("number"==typeof g[a]&&0<=g[a]){for(;p.length<=g[a];)h(e);r(g[a],u)}else if("number"==typeof g[a]&&0>g[a])r(p.length+g[a],u);else if("string"==typeof g[a])for(d=0,c=p.length;d<c;d++)("_all"==g[a]||t(p[d].nTh).hasClass(g[a]))&&r(d,u)}if(o)for(s=0,e=o.length;s<e;s++)r(s,o[s])}function x(e,n,o,r){var s=e.aoData.length,a=t.extend(!0,{},zt.models.oRow,{src:o?"dom":"data",idx:s});a._aData=n,e.aoData.push(a);for(var l=e.aoColumns,d=0,c=l.length;d<c;d++)l[d].sType=null;return e.aiDisplayMaster.push(s),n=e.rowIdFn(n),n!==i&&(e.aIds[n]=a),(o||!e.oFeatures.bDeferRender)&&D(e,s,o,r),s}function _(e,n){var i;return n instanceof t||(n=t(n)),n.map(function(t,n){return i=N(e,n),x(e,i.data,n,i.cells)})}function S(t,e,n,o){var r=t.iDraw,s=t.aoColumns[n],a=t.aoData[e]._aData,l=s.sDefaultContent,d=s.fnGetData(a,o,{settings:t,row:e,col:n});if(d===i)return t.iDrawError!=r&&null===l&&(Tt(t,0,"Requested unknown parameter "+("function"==typeof s.mData?"{function}":"'"+s.mData+"'")+" for row "+e+", column "+n,4),t.iDrawError=r),l;if(d!==a&&null!==d||null===l||o===i){if("function"==typeof d)return d.call(a)}else d=l;return null===d&&"display"==o?"":d}function b(t,e,n,i){t.aoColumns[n].fnSetData(t.aoData[e]._aData,i,{settings:t,row:e,col:n})}function E(e){return t.map(e.match(/(\\.|[^\.])+/g)||[""],function(t){return t.replace(/\\\./g,".")})}function C(e){if(t.isPlainObject(e)){var n={};return t.each(e,function(t,e){e&&(n[t]=C(e))}),function(t,e,o,r){var s=n[e]||n._;return s!==i?s(t,e,o,r):t}}if(null===e)return function(t){return t};if("function"==typeof e)return function(t,n,i,o){return e(t,n,i,o)};if("string"==typeof e&&(-1!==e.indexOf(".")||-1!==e.indexOf("[")||-1!==e.indexOf("("))){var o=function(e,n,r){var s,a;if(""!==r){a=E(r);for(var l=0,d=a.length;l<d;l++){if(r=a[l].match(ce),s=a[l].match(he),r){if(a[l]=a[l].replace(ce,""),""!==a[l]&&(e=e[a[l]]),s=[],a.splice(0,l+1),a=a.join("."),t.isArray(e))for(l=0,d=e.length;l<d;l++)s.push(o(e[l],n,a));e=r[0].substring(1,r[0].length-1),e=""===e?s:s.join(e);break}if(s)a[l]=a[l].replace(he,""),e=e[a[l]]();else{if(null===e||e[a[l]]===i)return i;e=e[a[l]]}}}return e};return function(t,n){return o(t,n,e)}}return function(t){return t[e]}}function I(e){if(t.isPlainObject(e))return I(e._);if(null===e)return function(){};if("function"==typeof e)return function(t,n,i){e(t,"set",n,i)};if("string"==typeof e&&(-1!==e.indexOf(".")||-1!==e.indexOf("[")||-1!==e.indexOf("("))){var n=function(e,o,r){var s,r=E(r);s=r[r.length-1];for(var a,l,d=0,c=r.length-1;d<c;d++){if(a=r[d].match(ce),l=r[d].match(he),a){if(r[d]=r[d].replace(ce,""),e[r[d]]=[],s=r.slice(),s.splice(0,d+1),a=s.join("."),t.isArray(o))for(l=0,c=o.length;l<c;l++)s={},n(s,o[l],a),e[r[d]].push(s);else e[r[d]]=o;return}l&&(r[d]=r[d].replace(he,""),e=e[r[d]](o)),null!==e[r[d]]&&e[r[d]]!==i||(e[r[d]]={}),e=e[r[d]]}s.match(he)?e[s.replace(he,"")](o):e[s.replace(ce,"")]=o};return function(t,i){return n(t,i,e)}}return function(t,n){t[e]=n}}function w(t){return oe(t.aoData,"_aData")}function L(t){t.aoData.length=0,t.aiDisplayMaster.length=0,t.aiDisplay.length=0,t.aIds={}}function P(t,e,n){for(var o=-1,r=0,s=t.length;r<s;r++)t[r]==e?o=r:t[r]>e&&t[r]--;-1!=o&&n===i&&t.splice(o,1)}function T(t,e,n,o){var r,s=t.aoData[e],a=function(n,i){for(;n.childNodes.length;)n.removeChild(n.firstChild);n.innerHTML=S(t,e,i,"display")};if("dom"!==n&&(n&&"auto"!==n||"dom"!==s.src)){var l=s.anCells;if(l)if(o!==i)a(l[o],o);else for(n=0,r=l.length;n<r;n++)a(l[n],n)}else s._aData=N(t,s,o,o===i?i:s._aData).data;if(s._aSortData=null,s._aFilterData=null,a=t.aoColumns,o!==i)a[o].sType=null;else{for(n=0,r=a.length;n<r;n++)a[n].sType=null;O(t,s)}}function N(e,n,o,r){var s,a,l,d=[],c=n.firstChild,h=0,u=e.aoColumns,p=e._rowReadObject,r=r!==i?r:p?{}:[],g=function(t,e){if("string"==typeof t){var n=t.indexOf("@");-1!==n&&(n=t.substring(n+1),I(t)(r,e.getAttribute(n)))}},m=function(e){o!==i&&o!==h||(a=u[h],l=t.trim(e.innerHTML),a&&a._bAttrSrc?(I(a.mData._)(r,l),g(a.mData.sort,e),g(a.mData.type,e),g(a.mData.filter,e)):p?(a._setter||(a._setter=I(a.mData)),a._setter(r,l)):r[h]=l),h++};if(c)for(;c;)s=c.nodeName.toUpperCase(),"TD"!=s&&"TH"!=s||(m(c),d.push(c)),c=c.nextSibling;else for(d=n.anCells,c=0,s=d.length;c<s;c++)m(d[c]);return(n=n.firstChild?n:n.nTr)&&(n=n.getAttribute("id"))&&I(e.rowId)(r,n),{data:r,cells:d}}function D(e,i,o,r){var s,a,l,d,c,h=e.aoData[i],u=h._aData,p=[];if(null===h.nTr){for(s=o||n.createElement("tr"),h.nTr=s,h.anCells=p,s._DT_RowIndex=i,O(e,h),d=0,c=e.aoColumns.length;d<c;d++)l=e.aoColumns[d],a=o?r[d]:n.createElement(l.sCellType),a._DT_CellIndex={row:i,column:d},p.push(a),o&&!l.mRender&&l.mData===d||t.isPlainObject(l.mData)&&l.mData._===d+".display"||(a.innerHTML=S(e,i,d,"display")),l.sClass&&(a.className+=" "+l.sClass),l.bVisible&&!o?s.appendChild(a):!l.bVisible&&o&&a.parentNode.removeChild(a),l.fnCreatedCell&&l.fnCreatedCell.call(e.oInstance,a,S(e,i,d),u,i,d);Rt(e,"aoRowCreatedCallback",null,[s,u,i])}h.nTr.setAttribute("role","row")}function O(e,n){var i=n.nTr,o=n._aData;if(i){var r=e.rowIdFn(o);r&&(i.id=r),o.DT_RowClass&&(r=o.DT_RowClass.split(" "),n.__rowc=n.__rowc?le(n.__rowc.concat(r)):r,t(i).removeClass(n.__rowc.join(" ")).addClass(o.DT_RowClass)),o.DT_RowAttr&&t(i).attr(o.DT_RowAttr),o.DT_RowData&&t(i).data(o.DT_RowData)}}function A(e){var n,i,o,r,s,a=e.nTHead,l=e.nTFoot,d=0===t("th, td",a).length,c=e.oClasses,h=e.aoColumns;for(d&&(r=t("<tr/>").appendTo(a)),n=0,i=h.length;n<i;n++)s=h[n],o=t(s.nTh).addClass(s.sClass),d&&o.appendTo(r),e.oFeatures.bSort&&(o.addClass(s.sSortingClass),!1!==s.bSortable&&(o.attr("tabindex",e.iTabIndex).attr("aria-controls",e.sTableId),Et(e,s.nTh,n))),s.sTitle!=o[0].innerHTML&&o.html(s.sTitle),Ft(e,"header")(e,o,s,c);if(d&&G(e.aoHeader,a),t(a).find(">tr").attr("role","row"),t(a).find(">tr>th, >tr>td").addClass(c.sHeaderTH),t(l).find(">tr>th, >tr>td").addClass(c.sFooterTH),null!==l)for(e=e.aoFooter[0],n=0,i=e.length;n<i;n++)s=h[n],s.nTf=e[n].cell,s.sClass&&t(s.nTf).addClass(s.sClass)}function R(e,n,o){var r,s,a,l,d=[],c=[],h=e.aoColumns.length;if(n){for(o===i&&(o=!1),r=0,s=n.length;r<s;r++){for(d[r]=n[r].slice(),d[r].nTr=n[r].nTr,a=h-1;0<=a;a--)!e.aoColumns[a].bVisible&&!o&&d[r].splice(a,1);c.push([])}for(r=0,s=d.length;r<s;r++){if(e=d[r].nTr)for(;a=e.firstChild;)e.removeChild(a);for(a=0,n=d[r].length;a<n;a++)if(l=h=1,c[r][a]===i){for(e.appendChild(d[r][a].cell),c[r][a]=1;d[r+h]!==i&&d[r][a].cell==d[r+h][a].cell;)c[r+h][a]=1,h++;for(;d[r][a+l]!==i&&d[r][a].cell==d[r][a+l].cell;){for(o=0;o<h;o++)c[r+o][a+l]=1;l++}t(d[r][a].cell).attr("rowspan",h).attr("colspan",l)}}}}function M(e){var n=Rt(e,"aoPreDrawCallback","preDraw",[e]);if(-1!==t.inArray(!1,n))ht(e,!1);else{var n=[],o=0,r=e.asStripeClasses,s=r.length,a=e.oLanguage,l=e.iInitDisplayStart,d="ssp"==kt(e),c=e.aiDisplay;e.bDrawing=!0,l!==i&&-1!==l&&(e._iDisplayStart=d?l:l>=e.fnRecordsDisplay()?0:l,e.iInitDisplayStart=-1);var l=e._iDisplayStart,h=e.fnDisplayEnd();if(e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++,ht(e,!1);else if(d){if(!e.bDestroying&&!V(e))return}else e.iDraw++;if(0!==c.length)for(a=d?e.aoData.length:h,d=d?0:l;d<a;d++){var u=c[d],p=e.aoData[u];if(null===p.nTr&&D(e,u),u=p.nTr,0!==s){var g=r[o%s];p._sRowStripe!=g&&(t(u).removeClass(p._sRowStripe).addClass(g),p._sRowStripe=g)}Rt(e,"aoRowCallback",null,[u,p._aData,o,d]),n.push(u),o++}else o=a.sZeroRecords,1==e.iDraw&&"ajax"==kt(e)?o=a.sLoadingRecords:a.sEmptyTable&&0===e.fnRecordsTotal()&&(o=a.sEmptyTable),n[0]=t("<tr/>",{class:s?r[0]:""}).append(t("<td />",{valign:"top",colSpan:f(e),class:e.oClasses.sRowEmpty}).html(o))[0];Rt(e,"aoHeaderCallback","header",[t(e.nTHead).children("tr")[0],w(e),l,h,c]),Rt(e,"aoFooterCallback","footer",[t(e.nTFoot).children("tr")[0],w(e),l,h,c]),r=t(e.nTBody),r.children().detach(),r.append(t(n)),Rt(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1}}function F(t,e){var n=t.oFeatures,i=n.bFilter;n.bSort&&_t(t),i?X(t,t.oPreviousSearch):t.aiDisplay=t.aiDisplayMaster.slice(),!0!==e&&(t._iDisplayStart=0),t._drawHold=e,M(t),t._drawHold=!1}function k(e){var n=e.oClasses,i=t(e.nTable),i=t("<div/>").insertBefore(i),o=e.oFeatures,r=t("<div/>",{
id:e.sTableId+"_wrapper",class:n.sWrapper+(e.nTFoot?"":" "+n.sNoFooter)});e.nHolding=i[0],e.nTableWrapper=r[0],e.nTableReinsertBefore=e.nTable.nextSibling;for(var s,a,l,d,c,h,u=e.sDom.split(""),p=0;p<u.length;p++){if(s=null,a=u[p],"<"==a){if(l=t("<div/>")[0],d=u[p+1],"'"==d||'"'==d){for(c="",h=2;u[p+h]!=d;)c+=u[p+h],h++;"H"==c?c=n.sJUIHeader:"F"==c&&(c=n.sJUIFooter),-1!=c.indexOf(".")?(d=c.split("."),l.id=d[0].substr(1,d[0].length-1),l.className=d[1]):"#"==c.charAt(0)?l.id=c.substr(1,c.length-1):l.className=c,p+=h}r.append(l),r=t(l)}else if(">"==a)r=r.parent();else if("l"==a&&o.bPaginate&&o.bLengthChange)s=at(e);else if("f"==a&&o.bFilter)s=z(e);else if("r"==a&&o.bProcessing)s=ct(e);else if("t"==a)s=ut(e);else if("i"==a&&o.bInfo)s=et(e);else if("p"==a&&o.bPaginate)s=lt(e);else if(0!==zt.ext.feature.length)for(l=zt.ext.feature,h=0,d=l.length;h<d;h++)if(a==l[h].cFeature){s=l[h].fnInit(e);break}s&&(l=e.aanFeatures,l[a]||(l[a]=[]),l[a].push(s),r.append(s))}i.replaceWith(r),e.nHolding=null}function G(e,n){var i,o,r,s,a,l,d,c,h,u,p=t(n).children("tr");for(e.splice(0,e.length),r=0,l=p.length;r<l;r++)e.push([]);for(r=0,l=p.length;r<l;r++)for(i=p[r],o=i.firstChild;o;){if("TD"==o.nodeName.toUpperCase()||"TH"==o.nodeName.toUpperCase()){for(c=1*o.getAttribute("colspan"),h=1*o.getAttribute("rowspan"),c=c&&0!==c&&1!==c?c:1,h=h&&0!==h&&1!==h?h:1,s=0,a=e[r];a[s];)s++;for(d=s,u=1===c,a=0;a<c;a++)for(s=0;s<h;s++)e[r+s][d+a]={cell:o,unique:u},e[r+s].nTr=i}o=o.nextSibling}}function B(t,e,n){var i=[];n||(n=t.aoHeader,e&&(n=[],G(n,e)));for(var e=0,o=n.length;e<o;e++)for(var r=0,s=n[e].length;r<s;r++)!n[e][r].unique||i[r]&&t.bSortCellsTop||(i[r]=n[e][r].cell);return i}function q(e,n,i){if(Rt(e,"aoServerParams","serverParams",[n]),n&&t.isArray(n)){var o={},r=/(.*?)\[\]$/;t.each(n,function(t,e){var n=e.name.match(r);n?(n=n[0],o[n]||(o[n]=[]),o[n].push(e.value)):o[e.name]=e.value}),n=o}var s,a=e.ajax,l=e.oInstance,d=function(t){Rt(e,null,"xhr",[e,t,e.jqXHR]),i(t)};if(t.isPlainObject(a)&&a.data){s=a.data;var c=t.isFunction(s)?s(n,e):s,n=t.isFunction(s)&&c?c:t.extend(!0,n,c);delete a.data}c={data:n,success:function(t){var n=t.error||t.sError;n&&Tt(e,0,n),e.json=t,d(t)},dataType:"json",cache:!1,type:e.sServerMethod,error:function(n,i){var o=Rt(e,null,"xhr",[e,null,e.jqXHR]);-1===t.inArray(!0,o)&&("parsererror"==i?Tt(e,0,"Invalid JSON response",1):4===n.readyState&&Tt(e,0,"Ajax error",7)),ht(e,!1)}},e.oAjaxData=n,Rt(e,null,"preXhr",[e,n]),e.fnServerData?e.fnServerData.call(l,e.sAjaxSource,t.map(n,function(t,e){return{name:e,value:t}}),d,e):e.sAjaxSource||"string"==typeof a?e.jqXHR=t.ajax(t.extend(c,{url:a||e.sAjaxSource})):t.isFunction(a)?e.jqXHR=a.call(l,n,d,e):(e.jqXHR=t.ajax(t.extend(c,a)),a.data=s)}function V(t){return!t.bAjaxDataGet||(t.iDraw++,ht(t,!0),q(t,H(t),function(e){U(t,e)}),!1)}function H(e){var n,i,o,r,s=e.aoColumns,a=s.length,l=e.oFeatures,d=e.oPreviousSearch,c=e.aoPreSearchCols,h=[],u=xt(e);n=e._iDisplayStart,i=!1!==l.bPaginate?e._iDisplayLength:-1;var p=function(t,e){h.push({name:t,value:e})};p("sEcho",e.iDraw),p("iColumns",a),p("sColumns",oe(s,"sName").join(",")),p("iDisplayStart",n),p("iDisplayLength",i);var g={draw:e.iDraw,columns:[],order:[],start:n,length:i,search:{value:d.sSearch,regex:d.bRegex}};for(n=0;n<a;n++)o=s[n],r=c[n],i="function"==typeof o.mData?"function":o.mData,g.columns.push({data:i,name:o.sName,searchable:o.bSearchable,orderable:o.bSortable,search:{value:r.sSearch,regex:r.bRegex}}),p("mDataProp_"+n,i),l.bFilter&&(p("sSearch_"+n,r.sSearch),p("bRegex_"+n,r.bRegex),p("bSearchable_"+n,o.bSearchable)),l.bSort&&p("bSortable_"+n,o.bSortable);return l.bFilter&&(p("sSearch",d.sSearch),p("bRegex",d.bRegex)),l.bSort&&(t.each(u,function(t,e){g.order.push({column:e.col,dir:e.dir}),p("iSortCol_"+t,e.col),p("sSortDir_"+t,e.dir)}),p("iSortingCols",u.length)),s=zt.ext.legacy.ajax,null===s?e.sAjaxSource?h:g:s?h:g}function U(t,e){var n=W(t,e),o=e.sEcho!==i?e.sEcho:e.draw,r=e.iTotalRecords!==i?e.iTotalRecords:e.recordsTotal,s=e.iTotalDisplayRecords!==i?e.iTotalDisplayRecords:e.recordsFiltered;if(o){if(1*o<t.iDraw)return;t.iDraw=1*o}for(L(t),t._iRecordsTotal=parseInt(r,10),t._iRecordsDisplay=parseInt(s,10),o=0,r=n.length;o<r;o++)x(t,n[o]);t.aiDisplay=t.aiDisplayMaster.slice(),t.bAjaxDataGet=!1,M(t),t._bInitComplete||rt(t,e),t.bAjaxDataGet=!0,ht(t,!1)}function W(e,n){var o=t.isPlainObject(e.ajax)&&e.ajax.dataSrc!==i?e.ajax.dataSrc:e.sAjaxDataProp;return"data"===o?n.aaData||n[o]:""!==o?C(o)(n):n}function z(e){var i=e.oClasses,o=e.sTableId,r=e.oLanguage,s=e.oPreviousSearch,a=e.aanFeatures,l='<input type="search" class="'+i.sFilterInput+'"/>',d=r.sSearch,d=d.match(/_INPUT_/)?d.replace("_INPUT_",l):d+l,i=t("<div/>",{id:a.f?null:o+"_filter",class:i.sFilter}).append(t("<label/>").append(d)),a=function(){var t=this.value?this.value:"";t!=s.sSearch&&(X(e,{sSearch:t,bRegex:s.bRegex,bSmart:s.bSmart,bCaseInsensitive:s.bCaseInsensitive}),e._iDisplayStart=0,M(e))},l=null!==e.searchDelay?e.searchDelay:"ssp"===kt(e)?400:0,c=t("input",i).val(s.sSearch).attr("placeholder",r.sSearchPlaceholder).on("keyup.DT search.DT input.DT paste.DT cut.DT",l?fe(a,l):a).on("keypress.DT",function(t){if(13==t.keyCode)return!1}).attr("aria-controls",o);return t(e.nTable).on("search.dt.DT",function(t,i){if(e===i)try{c[0]!==n.activeElement&&c.val(s.sSearch)}catch(t){}}),i[0]}function X(t,e,n){var o=t.oPreviousSearch,r=t.aoPreSearchCols,s=function(t){o.sSearch=t.sSearch,o.bRegex=t.bRegex,o.bSmart=t.bSmart,o.bCaseInsensitive=t.bCaseInsensitive};if(v(t),"ssp"!=kt(t)){for($(t,e.sSearch,n,e.bEscapeRegex!==i?!e.bEscapeRegex:e.bRegex,e.bSmart,e.bCaseInsensitive),s(e),e=0;e<r.length;e++)Q(t,r[e].sSearch,e,r[e].bEscapeRegex!==i?!r[e].bEscapeRegex:r[e].bRegex,r[e].bSmart,r[e].bCaseInsensitive);Y(t)}else s(e);t.bFiltered=!0,Rt(t,null,"search",[t])}function Y(e){for(var n,i,o=zt.ext.search,r=e.aiDisplay,s=0,a=o.length;s<a;s++){for(var l=[],d=0,c=r.length;d<c;d++)i=r[d],n=e.aoData[i],o[s](e,n._aFilterData,i,n._aData,d)&&l.push(i);r.length=0,t.merge(r,l)}}function Q(t,e,n,i,o,r){if(""!==e){for(var s=[],a=t.aiDisplay,i=K(e,i,o,r),o=0;o<a.length;o++)e=t.aoData[a[o]]._aFilterData[n],i.test(e)&&s.push(a[o]);t.aiDisplay=s}}function $(t,e,n,i,o,r){var s,i=K(e,i,o,r),r=t.oPreviousSearch.sSearch,a=t.aiDisplayMaster,o=[];if(0!==zt.ext.search.length&&(n=!0),s=J(t),0>=e.length)t.aiDisplay=a.slice();else{for((s||n||r.length>e.length||0!==e.indexOf(r)||t.bSorted)&&(t.aiDisplay=a.slice()),e=t.aiDisplay,n=0;n<e.length;n++)i.test(t.aoData[e[n]]._sFilterRow)&&o.push(e[n]);t.aiDisplay=o}}function K(e,n,i,o){return e=n?e:ue(e),i&&(e="^(?=.*?"+t.map(e.match(/"[^"]+"|[^ ]+/g)||[""],function(t){if('"'===t.charAt(0))var e=t.match(/^"(.*)"$/),t=e?e[1]:t;return t.replace('"',"")}).join(")(?=.*?")+").*$"),RegExp(e,o?"i":"")}function J(t){var e,n,i,o,r,s,a,l,d=t.aoColumns,c=zt.ext.type.search;for(e=!1,n=0,o=t.aoData.length;n<o;n++)if(l=t.aoData[n],!l._aFilterData){for(s=[],i=0,r=d.length;i<r;i++)e=d[i],e.bSearchable?(a=S(t,n,i,"filter"),c[e.sType]&&(a=c[e.sType](a)),null===a&&(a=""),"string"!=typeof a&&a.toString&&(a=a.toString())):a="",a.indexOf&&-1!==a.indexOf("&")&&(pe.innerHTML=a,a=ge?pe.textContent:pe.innerText),a.replace&&(a=a.replace(/[\r\n]/g,"")),s.push(a);l._aFilterData=s,l._sFilterRow=s.join("  "),e=!0}return e}function Z(t){return{search:t.sSearch,smart:t.bSmart,regex:t.bRegex,caseInsensitive:t.bCaseInsensitive}}function tt(t){return{sSearch:t.search,bSmart:t.smart,bRegex:t.regex,bCaseInsensitive:t.caseInsensitive}}function et(e){var n=e.sTableId,i=e.aanFeatures.i,o=t("<div/>",{class:e.oClasses.sInfo,id:i?null:n+"_info"});return i||(e.aoDrawCallback.push({fn:nt,sName:"information"}),o.attr("role","status").attr("aria-live","polite"),t(e.nTable).attr("aria-describedby",n+"_info")),o[0]}function nt(e){var n=e.aanFeatures.i;if(0!==n.length){var i=e.oLanguage,o=e._iDisplayStart+1,r=e.fnDisplayEnd(),s=e.fnRecordsTotal(),a=e.fnRecordsDisplay(),l=a?i.sInfo:i.sInfoEmpty;a!==s&&(l+=" "+i.sInfoFiltered),l+=i.sInfoPostFix,l=it(e,l),i=i.fnInfoCallback,null!==i&&(l=i.call(e.oInstance,e,o,r,s,a,l)),t(n).html(l)}}function it(t,e){var n=t.fnFormatNumber,i=t._iDisplayStart+1,o=t._iDisplayLength,r=t.fnRecordsDisplay(),s=-1===o;return e.replace(/_START_/g,n.call(t,i)).replace(/_END_/g,n.call(t,t.fnDisplayEnd())).replace(/_MAX_/g,n.call(t,t.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(t,r)).replace(/_PAGE_/g,n.call(t,s?1:Math.ceil(i/o))).replace(/_PAGES_/g,n.call(t,s?1:Math.ceil(r/o)))}function ot(t){var e,n,i,o=t.iInitDisplayStart,r=t.aoColumns;n=t.oFeatures;var s=t.bDeferLoading;if(t.bInitialised){for(k(t),A(t),R(t,t.aoHeader),R(t,t.aoFooter),ht(t,!0),n.bAutoWidth&&mt(t),e=0,n=r.length;e<n;e++)i=r[e],i.sWidth&&(i.nTh.style.width=jt(i.sWidth));Rt(t,null,"preInit",[t]),F(t),r=kt(t),("ssp"!=r||s)&&("ajax"==r?q(t,[],function(n){var i=W(t,n);for(e=0;e<i.length;e++)x(t,i[e]);t.iInitDisplayStart=o,F(t),ht(t,!1),rt(t,n)},t):(ht(t,!1),rt(t)))}else setTimeout(function(){ot(t)},200)}function rt(t,e){t._bInitComplete=!0,(e||t.oInit.aaData)&&p(t),Rt(t,null,"plugin-init",[t,e]),Rt(t,"aoInitComplete","init",[t,e])}function st(t,e){var n=parseInt(e,10);t._iDisplayLength=n,Mt(t),Rt(t,null,"length",[t,n])}function at(e){for(var n=e.oClasses,i=e.sTableId,o=e.aLengthMenu,r=t.isArray(o[0]),s=r?o[0]:o,o=r?o[1]:o,r=t("<select/>",{name:i+"_length","aria-controls":i,class:n.sLengthSelect}),a=0,l=s.length;a<l;a++)r[0][a]=new Option("number"==typeof o[a]?e.fnFormatNumber(o[a]):o[a],s[a]);var d=t("<div><label/></div>").addClass(n.sLength);return e.aanFeatures.l||(d[0].id=i+"_length"),d.children().append(e.oLanguage.sLengthMenu.replace("_MENU_",r[0].outerHTML)),t("select",d).val(e._iDisplayLength).on("change.DT",function(){st(e,t(this).val()),M(e)}),t(e.nTable).on("length.dt.DT",function(n,i,o){e===i&&t("select",d).val(o)}),d[0]}function lt(e){var n=e.sPaginationType,i=zt.ext.pager[n],o="function"==typeof i,r=function(t){M(t)},n=t("<div/>").addClass(e.oClasses.sPaging+n)[0],s=e.aanFeatures;return o||i.fnInit(e,n,r),s.p||(n.id=e.sTableId+"_paginate",e.aoDrawCallback.push({fn:function(t){if(o){var e,n=t._iDisplayStart,a=t._iDisplayLength,l=t.fnRecordsDisplay(),d=-1===a,n=d?0:Math.ceil(n/a),a=d?1:Math.ceil(l/a),l=i(n,a),d=0;for(e=s.p.length;d<e;d++)Ft(t,"pageButton")(t,s.p[d],d,l,n,a)}else i.fnUpdate(t,r)},sName:"pagination"})),n}function dt(t,e,n){var i=t._iDisplayStart,o=t._iDisplayLength,r=t.fnRecordsDisplay();return 0===r||-1===o?i=0:"number"==typeof e?(i=e*o,i>r&&(i=0)):"first"==e?i=0:"previous"==e?(i=0<=o?i-o:0,0>i&&(i=0)):"next"==e?i+o<r&&(i+=o):"last"==e?i=Math.floor((r-1)/o)*o:Tt(t,0,"Unknown paging action: "+e,5),e=t._iDisplayStart!==i,t._iDisplayStart=i,e&&(Rt(t,null,"page",[t]),n&&M(t)),e}function ct(e){return t("<div/>",{id:e.aanFeatures.r?null:e.sTableId+"_processing",class:e.oClasses.sProcessing}).html(e.oLanguage.sProcessing).insertBefore(e.nTable)[0]}function ht(e,n){e.oFeatures.bProcessing&&t(e.aanFeatures.r).css("display",n?"block":"none"),Rt(e,null,"processing",[e,n])}function ut(e){var n=t(e.nTable);n.attr("role","grid");var i=e.oScroll;if(""===i.sX&&""===i.sY)return e.nTable;var o=i.sX,r=i.sY,s=e.oClasses,a=n.children("caption"),l=a.length?a[0]._captionSide:null,d=t(n[0].cloneNode(!1)),c=t(n[0].cloneNode(!1)),h=n.children("tfoot");h.length||(h=null),d=t("<div/>",{class:s.sScrollWrapper}).append(t("<div/>",{class:s.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:o?o?jt(o):null:"100%"}).append(t("<div/>",{class:s.sScrollHeadInner}).css({"box-sizing":"content-box",width:i.sXInner||"100%"}).append(d.removeAttr("id").css("margin-left",0).append("top"===l?a:null).append(n.children("thead"))))).append(t("<div/>",{class:s.sScrollBody}).css({position:"relative",overflow:"auto",width:o?jt(o):null}).append(n)),h&&d.append(t("<div/>",{class:s.sScrollFoot}).css({overflow:"hidden",border:0,width:o?o?jt(o):null:"100%"}).append(t("<div/>",{class:s.sScrollFootInner}).append(c.removeAttr("id").css("margin-left",0).append("bottom"===l?a:null).append(n.children("tfoot")))));var n=d.children(),u=n[0],s=n[1],p=h?n[2]:null;return o&&t(s).on("scroll.DT",function(){var t=this.scrollLeft;u.scrollLeft=t,h&&(p.scrollLeft=t)}),t(s).css(r&&i.bCollapse?"max-height":"height",r),e.nScrollHead=u,e.nScrollBody=s,e.nScrollFoot=p,e.aoDrawCallback.push({fn:pt,sName:"scrolling"}),d[0]}function pt(e){var n,o,r,s,a,l=e.oScroll,d=l.sX,c=l.sXInner,h=l.sY,l=l.iBarWidth,u=t(e.nScrollHead),m=u[0].style,f=u.children("div"),y=f[0].style,v=f.children("table"),f=e.nScrollBody,j=t(f),x=f.style,_=t(e.nScrollFoot).children("div"),S=_.children("table"),b=t(e.nTHead),E=t(e.nTable),C=E[0],I=C.style,w=e.nTFoot?t(e.nTFoot):null,L=e.oBrowser,P=L.bScrollOversize,T=oe(e.aoColumns,"nTh"),N=[],D=[],O=[],A=[],R=function(t){t=t.style,t.paddingTop="0",t.paddingBottom="0",t.borderTopWidth="0",t.borderBottomWidth="0",t.height=0};o=f.scrollHeight>f.clientHeight,e.scrollBarVis!==o&&e.scrollBarVis!==i?(e.scrollBarVis=o,p(e)):(e.scrollBarVis=o,E.children("thead, tfoot").remove(),w&&(r=w.clone().prependTo(E),n=w.find("tr"),r=r.find("tr")),s=b.clone().prependTo(E),b=b.find("tr"),o=s.find("tr"),s.find("th, td").removeAttr("tabindex"),d||(x.width="100%",u[0].style.width="100%"),t.each(B(e,s),function(t,n){a=g(e,t),n.style.width=e.aoColumns[a].sWidth}),w&&gt(function(t){t.style.width=""},r),u=E.outerWidth(),""===d?(I.width="100%",P&&(E.find("tbody").height()>f.offsetHeight||"scroll"==j.css("overflow-y"))&&(I.width=jt(E.outerWidth()-l)),u=E.outerWidth()):""!==c&&(I.width=jt(c),u=E.outerWidth()),gt(R,o),gt(function(e){O.push(e.innerHTML),N.push(jt(t(e).css("width")))},o),gt(function(e,n){t.inArray(e,T)!==-1&&(e.style.width=N[n])},b),t(o).height(0),w&&(gt(R,r),gt(function(e){A.push(e.innerHTML),D.push(jt(t(e).css("width")))},r),gt(function(t,e){t.style.width=D[e]},n),t(r).height(0)),gt(function(t,e){t.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+O[e]+"</div>",t.style.width=N[e]},o),w&&gt(function(t,e){t.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+A[e]+"</div>",t.style.width=D[e]},r),E.outerWidth()<u?(n=f.scrollHeight>f.offsetHeight||"scroll"==j.css("overflow-y")?u+l:u,P&&(f.scrollHeight>f.offsetHeight||"scroll"==j.css("overflow-y"))&&(I.width=jt(n-l)),(""===d||""!==c)&&Tt(e,1,"Possible column misalignment",6)):n="100%",x.width=jt(n),m.width=jt(n),w&&(e.nScrollFoot.style.width=jt(n)),!h&&P&&(x.height=jt(C.offsetHeight+l)),d=E.outerWidth(),v[0].style.width=jt(d),y.width=jt(d),c=E.height()>f.clientHeight||"scroll"==j.css("overflow-y"),h="padding"+(L.bScrollbarLeft?"Left":"Right"),y[h]=c?l+"px":"0px",w&&(S[0].style.width=jt(d),_[0].style.width=jt(d),_[0].style[h]=c?l+"px":"0px"),E.children("colgroup").insertBefore(E.children("thead")),j.scroll(),!e.bSorted&&!e.bFiltered||e._drawHold||(f.scrollTop=0))}function gt(t,e,n){for(var i,o,r=0,s=0,a=e.length;s<a;){for(i=e[s].firstChild,o=n?n[s].firstChild:null;i;)1===i.nodeType&&(n?t(i,o,r):t(i,r),r++),i=i.nextSibling,o=n?o.nextSibling:null;s++}}function mt(n){var i,o,r=n.nTable,s=n.aoColumns,a=n.oScroll,l=a.sY,d=a.sX,c=a.sXInner,h=s.length,u=y(n,"bVisible"),m=t("th",n.nTHead),v=r.getAttribute("width"),j=r.parentNode,x=!1,_=n.oBrowser,a=_.bScrollOversize;for((i=r.style.width)&&-1!==i.indexOf("%")&&(v=i),i=0;i<u.length;i++)o=s[u[i]],null!==o.sWidth&&(o.sWidth=ft(o.sWidthOrig,j),x=!0);if(a||!x&&!d&&!l&&h==f(n)&&h==m.length)for(i=0;i<h;i++)u=g(n,i),null!==u&&(s[u].sWidth=jt(m.eq(i).width()));else{h=t(r).clone().css("visibility","hidden").removeAttr("id"),h.find("tbody tr").remove();var S=t("<tr/>").appendTo(h.find("tbody"));for(h.find("thead, tfoot").remove(),h.append(t(n.nTHead).clone()).append(t(n.nTFoot).clone()),h.find("tfoot th, tfoot td").css("width",""),m=B(n,h.find("thead")[0]),i=0;i<u.length;i++)o=s[u[i]],m[i].style.width=null!==o.sWidthOrig&&""!==o.sWidthOrig?jt(o.sWidthOrig):"",o.sWidthOrig&&d&&t(m[i]).append(t("<div/>").css({width:o.sWidthOrig,margin:0,padding:0,border:0,height:1}));if(n.aoData.length)for(i=0;i<u.length;i++)x=u[i],o=s[x],t(yt(n,x)).clone(!1).append(o.sContentPadding).appendTo(S);for(t("[name]",h).removeAttr("name"),o=t("<div/>").css(d||l?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(h).appendTo(j),d&&c?h.width(c):d?(h.css("width","auto"),h.removeAttr("width"),h.width()<j.clientWidth&&v&&h.width(j.clientWidth)):l?h.width(j.clientWidth):v&&h.width(v),i=l=0;i<u.length;i++)j=t(m[i]),c=j.outerWidth()-j.width(),j=_.bBounding?Math.ceil(m[i].getBoundingClientRect().width):j.outerWidth(),l+=j,s[u[i]].sWidth=jt(j-c);r.style.width=jt(l),o.remove()}v&&(r.style.width=jt(v)),!v&&!d||n._reszEvt||(r=function(){t(e).on("resize.DT-"+n.sInstance,fe(function(){p(n)}))},a?setTimeout(r,1e3):r(),n._reszEvt=!0)}function ft(e,i){if(!e)return 0;var o=t("<div/>").css("width",jt(e)).appendTo(i||n.body),r=o[0].offsetWidth;return o.remove(),r}function yt(e,n){var i=vt(e,n);if(0>i)return null;var o=e.aoData[i];return o.nTr?o.anCells[n]:t("<td/>").html(S(e,i,n,"display"))[0]}function vt(t,e){for(var n,i=-1,o=-1,r=0,s=t.aoData.length;r<s;r++)n=S(t,r,e,"display")+"",n=n.replace(me,""),n=n.replace(/&nbsp;/g," "),n.length>i&&(i=n.length,o=r);return o}function jt(t){return null===t?"0px":"number"==typeof t?0>t?"0px":t+"px":t.match(/\d$/)?t+"px":t}function xt(e){var n,o,r,s,a,l,d=[],c=e.aoColumns;n=e.aaSortingFixed,o=t.isPlainObject(n);var h=[];for(r=function(e){e.length&&!t.isArray(e[0])?h.push(e):t.merge(h,e)},t.isArray(n)&&r(n),o&&n.pre&&r(n.pre),r(e.aaSorting),o&&n.post&&r(n.post),e=0;e<h.length;e++)for(l=h[e][0],r=c[l].aDataSort,n=0,o=r.length;n<o;n++)s=r[n],a=c[s].sType||"string",h[e]._idx===i&&(h[e]._idx=t.inArray(h[e][1],c[s].asSorting)),d.push({src:l,col:s,dir:h[e][1],index:h[e]._idx,type:a,formatter:zt.ext.type.order[a+"-pre"]});return d}function _t(t){var e,n,i,o,r=[],s=zt.ext.type.order,a=t.aoData,l=0,d=t.aiDisplayMaster;for(v(t),o=xt(t),e=0,n=o.length;e<n;e++)i=o[e],i.formatter&&l++,It(t,i.col);if("ssp"!=kt(t)&&0!==o.length){for(e=0,n=d.length;e<n;e++)r[d[e]]=e;l===o.length?d.sort(function(t,e){var n,i,s,l,d=o.length,c=a[t]._aSortData,h=a[e]._aSortData;for(s=0;s<d;s++)if(l=o[s],n=c[l.col],i=h[l.col],n=n<i?-1:n>i?1:0,0!==n)return"asc"===l.dir?n:-n;return n=r[t],i=r[e],n<i?-1:n>i?1:0}):d.sort(function(t,e){var n,i,l,d,c=o.length,h=a[t]._aSortData,u=a[e]._aSortData;for(l=0;l<c;l++)if(d=o[l],n=h[d.col],i=u[d.col],d=s[d.type+"-"+d.dir]||s["string-"+d.dir],n=d(n,i),0!==n)return n;return n=r[t],i=r[e],n<i?-1:n>i?1:0})}t.bSorted=!0}function St(t){for(var e,n,i=t.aoColumns,o=xt(t),t=t.oLanguage.oAria,r=0,s=i.length;r<s;r++){n=i[r];var a=n.asSorting;e=n.sTitle.replace(/<.*?>/g,"");var l=n.nTh;l.removeAttribute("aria-sort"),n.bSortable&&(0<o.length&&o[0].col==r?(l.setAttribute("aria-sort","asc"==o[0].dir?"ascending":"descending"),n=a[o[0].index+1]||a[0]):n=a[0],e+="asc"===n?t.sSortAscending:t.sSortDescending),l.setAttribute("aria-label",e)}}function bt(e,n,o,r){var s=e.aaSorting,a=e.aoColumns[n].asSorting,l=function(e,n){var o=e._idx;return o===i&&(o=t.inArray(e[1],a)),o+1<a.length?o+1:n?null:0};"number"==typeof s[0]&&(s=e.aaSorting=[s]),o&&e.oFeatures.bSortMulti?(o=t.inArray(n,oe(s,"0")),-1!==o?(n=l(s[o],!0),null===n&&1===s.length&&(n=0),null===n?s.splice(o,1):(s[o][1]=a[n],s[o]._idx=n)):(s.push([n,a[0],0]),s[s.length-1]._idx=0)):s.length&&s[0][0]==n?(n=l(s[0]),s.length=1,s[0][1]=a[n],s[0]._idx=n):(s.length=0,s.push([n,a[0]]),s[0]._idx=0),F(e),"function"==typeof r&&r(e)}function Et(t,e,n,i){var o=t.aoColumns[n];Ot(e,{},function(e){!1!==o.bSortable&&(t.oFeatures.bProcessing?(ht(t,!0),setTimeout(function(){bt(t,n,e.shiftKey,i),"ssp"!==kt(t)&&ht(t,!1)},0)):bt(t,n,e.shiftKey,i))})}function Ct(e){var n,i,o=e.aLastSort,r=e.oClasses.sSortColumn,s=xt(e),a=e.oFeatures;if(a.bSort&&a.bSortClasses){for(a=0,n=o.length;a<n;a++)i=o[a].src,t(oe(e.aoData,"anCells",i)).removeClass(r+(2>a?a+1:3));for(a=0,n=s.length;a<n;a++)i=s[a].src,t(oe(e.aoData,"anCells",i)).addClass(r+(2>a?a+1:3))}e.aLastSort=s}function It(t,e){var n,i=t.aoColumns[e],o=zt.ext.order[i.sSortDataType];o&&(n=o.call(t.oInstance,t,e,m(t,e)));for(var r,s=zt.ext.type.order[i.sType+"-pre"],a=0,l=t.aoData.length;a<l;a++)i=t.aoData[a],i._aSortData||(i._aSortData=[]),(!i._aSortData[e]||o)&&(r=o?n[a]:S(t,a,e,"sort"),i._aSortData[e]=s?s(r):r)}function wt(e){if(e.oFeatures.bStateSave&&!e.bDestroying){var n={time:+new Date,start:e._iDisplayStart,length:e._iDisplayLength,order:t.extend(!0,[],e.aaSorting),search:Z(e.oPreviousSearch),columns:t.map(e.aoColumns,function(t,n){return{visible:t.bVisible,search:Z(e.aoPreSearchCols[n])}})};Rt(e,"aoStateSaveParams","stateSaveParams",[e,n]),e.oSavedState=n,e.fnStateSaveCallback.call(e.oInstance,e,n)}}function Lt(e,n,o){var r,s,a=e.aoColumns,n=function(n){if(n&&n.time){var l=Rt(e,"aoStateLoadParams","stateLoadParams",[e,n]);if(-1===t.inArray(!1,l)&&(l=e.iStateDuration,!(0<l&&n.time<+new Date-1e3*l||n.columns&&a.length!==n.columns.length))){if(e.oLoadedState=t.extend(!0,{},n),n.start!==i&&(e._iDisplayStart=n.start,e.iInitDisplayStart=n.start),n.length!==i&&(e._iDisplayLength=n.length),n.order!==i&&(e.aaSorting=[],t.each(n.order,function(t,n){e.aaSorting.push(n[0]>=a.length?[0,n[1]]:n)})),n.search!==i&&t.extend(e.oPreviousSearch,tt(n.search)),n.columns)for(r=0,s=n.columns.length;r<s;r++)l=n.columns[r],l.visible!==i&&(a[r].bVisible=l.visible),l.search!==i&&t.extend(e.aoPreSearchCols[r],tt(l.search));Rt(e,"aoStateLoaded","stateLoaded",[e,n])}}o()};if(e.oFeatures.bStateSave){var l=e.fnStateLoadCallback.call(e.oInstance,e,n);l!==i&&n(l)}else o()}function Pt(e){var n=zt.settings,e=t.inArray(e,oe(n,"nTable"));return-1!==e?n[e]:null}function Tt(t,n,i,o){if(i="DataTables warning: "+(t?"table id="+t.sTableId+" - ":"")+i,o&&(i+=". For more information about this error, please see http://datatables.net/tn/"+o),n)e.console&&console.log&&console.log(i);else if(n=zt.ext,n=n.sErrMode||n.errMode,t&&Rt(t,null,"error",[t,o,i]),"alert"==n)alert(i);else{if("throw"==n)throw Error(i);"function"==typeof n&&n(t,o,i)}}function Nt(e,n,o,r){t.isArray(o)?t.each(o,function(i,o){t.isArray(o)?Nt(e,n,o[0],o[1]):Nt(e,n,o)}):(r===i&&(r=o),n[o]!==i&&(e[r]=n[o]))}function Dt(e,n,i){var o,r;for(r in n)n.hasOwnProperty(r)&&(o=n[r],t.isPlainObject(o)?(t.isPlainObject(e[r])||(e[r]={}),t.extend(!0,e[r],o)):e[r]=i&&"data"!==r&&"aaData"!==r&&t.isArray(o)?o.slice():o);return e}function Ot(e,n,i){t(e).on("click.DT",n,function(t){e.blur(),i(t)}).on("keypress.DT",n,function(t){13===t.which&&(t.preventDefault(),i(t))}).on("selectstart.DT",function(){return!1})}function At(t,e,n,i){n&&t[e].push({fn:n,sName:i})}function Rt(e,n,i,o){var r=[];return n&&(r=t.map(e[n].slice().reverse(),function(t){return t.fn.apply(e.oInstance,o)})),null!==i&&(n=t.Event(i+".dt"),t(e.nTable).trigger(n,o),r.push(n.result)),r}function Mt(t){var e=t._iDisplayStart,n=t.fnDisplayEnd(),i=t._iDisplayLength;e>=n&&(e=n-i),e-=e%i,(-1===i||0>e)&&(e=0),t._iDisplayStart=e}function Ft(e,n){var i=e.renderer,o=zt.ext.renderer[n];return t.isPlainObject(i)&&i[n]?o[i[n]]||o._:"string"==typeof i?o[i]||o._:o._}function kt(t){return t.oFeatures.bServerSide?"ssp":t.ajax||t.sAjaxSource?"ajax":"dom"}function Gt(t,e){var n=[],n=Pe.numbers_length,i=Math.floor(n/2);return e<=n?n=se(0,e):t<=i?(n=se(0,n-2),n.push("ellipsis"),n.push(e-1)):(t>=e-1-i?n=se(e-(n-2),e):(n=se(t-i+2,t+i-1),n.push("ellipsis"),n.push(e-1)),n.splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}function Bt(e){t.each({num:function(t){return Te(t,e)},"num-fmt":function(t){return Te(t,e,Jt)},"html-num":function(t){return Te(t,e,Qt)},"html-num-fmt":function(t){return Te(t,e,Qt,Jt)}},function(t,n){Vt.type.order[t+e+"-pre"]=n,t.match(/^html\-/)&&(Vt.type.search[t+e]=Vt.type.search.html)})}function qt(t){return function(){var e=[Pt(this[zt.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return zt.ext.internal[t].apply(this,e)}}var Vt,Ht,Ut,Wt,zt=function(e){this.$=function(t,e){return this.api(!0).$(t,e)},this._=function(t,e){return this.api(!0).rows(t,e).data()},this.api=function(t){return new Ht(t?Pt(this[Vt.iApiIndex]):this)},this.fnAddData=function(e,n){var o=this.api(!0),r=t.isArray(e)&&(t.isArray(e[0])||t.isPlainObject(e[0]))?o.rows.add(e):o.row.add(e);return(n===i||n)&&o.draw(),r.flatten().toArray()},this.fnAdjustColumnSizing=function(t){var e=this.api(!0).columns.adjust(),n=e.settings()[0],o=n.oScroll;t===i||t?e.draw(!1):(""!==o.sX||""!==o.sY)&&pt(n)},this.fnClearTable=function(t){var e=this.api(!0).clear();(t===i||t)&&e.draw()},this.fnClose=function(t){this.api(!0).row(t).child.hide()},this.fnDeleteRow=function(t,e,n){var o=this.api(!0),t=o.rows(t),r=t.settings()[0],s=r.aoData[t[0][0]];return t.remove(),e&&e.call(this,r,s),(n===i||n)&&o.draw(),s},this.fnDestroy=function(t){this.api(!0).destroy(t)},this.fnDraw=function(t){this.api(!0).draw(t)},this.fnFilter=function(t,e,n,o,r,s){r=this.api(!0),null===e||e===i?r.search(t,n,o,s):r.column(e).search(t,n,o,s),r.draw()},this.fnGetData=function(t,e){var n=this.api(!0);if(t!==i){var o=t.nodeName?t.nodeName.toLowerCase():"";return e!==i||"td"==o||"th"==o?n.cell(t,e).data():n.row(t).data()||null}return n.data().toArray()},this.fnGetNodes=function(t){var e=this.api(!0);return t!==i?e.row(t).node():e.rows().nodes().flatten().toArray()},this.fnGetPosition=function(t){var e=this.api(!0),n=t.nodeName.toUpperCase();return"TR"==n?e.row(t).index():"TD"==n||"TH"==n?(t=e.cell(t).index(),[t.row,t.columnVisible,t.column]):null},this.fnIsOpen=function(t){return this.api(!0).row(t).child.isShown()},this.fnOpen=function(t,e,n){return this.api(!0).row(t).child(e,n).show().child()[0]},this.fnPageChange=function(t,e){var n=this.api(!0).page(t);(e===i||e)&&n.draw(!1)},this.fnSetColumnVis=function(t,e,n){t=this.api(!0).column(t).visible(e),(n===i||n)&&t.columns.adjust().draw()},this.fnSettings=function(){return Pt(this[Vt.iApiIndex])},this.fnSort=function(t){this.api(!0).order(t).draw()},this.fnSortListener=function(t,e,n){this.api(!0).order.listener(t,e,n)},this.fnUpdate=function(t,e,n,o,r){var s=this.api(!0);return n===i||null===n?s.row(e).data(t):s.cell(e,n).data(t),(r===i||r)&&s.columns.adjust(),(o===i||o)&&s.draw(),0},this.fnVersionCheck=Vt.fnVersionCheck;var n=this,o=e===i,c=this.length;o&&(e={}),this.oApi=this.internal=Vt.internal;for(var p in zt.ext.internal)p&&(this[p]=qt(p));return this.each(function(){var p,g={},m=1<c?Dt(g,e,!0):e,f=0,g=this.getAttribute("id"),y=!1,v=zt.defaults,S=t(this);if("table"!=this.nodeName.toLowerCase())Tt(null,0,"Non-table node initialisation ("+this.nodeName+")",2);else{a(v),l(v.column),r(v,v,!0),r(v.column,v.column,!0),r(v,t.extend(m,S.data()));var b=zt.settings,f=0;for(p=b.length;f<p;f++){var E=b[f];if(E.nTable==this||E.nTHead.parentNode==this||E.nTFoot&&E.nTFoot.parentNode==this){var I=m.bRetrieve!==i?m.bRetrieve:v.bRetrieve;if(o||I)return E.oInstance;if(m.bDestroy!==i?m.bDestroy:v.bDestroy){E.oInstance.fnDestroy();break}return void Tt(E,0,"Cannot reinitialise DataTable",3)}if(E.sTableId==this.id){b.splice(f,1);break}}null!==g&&""!==g||(this.id=g="DataTables_Table_"+zt.ext._unique++);var w=t.extend(!0,{},zt.models.oSettings,{sDestroyWidth:S[0].style.width,sInstance:g,sTableId:g});w.nTable=this,w.oApi=n.internal,w.oInit=m,b.push(w),w.oInstance=1===n.length?n:S.dataTable(),a(m),m.oLanguage&&s(m.oLanguage),m.aLengthMenu&&!m.iDisplayLength&&(m.iDisplayLength=t.isArray(m.aLengthMenu[0])?m.aLengthMenu[0][0]:m.aLengthMenu[0]),m=Dt(t.extend(!0,{},v),m),Nt(w.oFeatures,m,"bPaginate bLengthChange bFilter bSort bSortMulti bInfo bProcessing bAutoWidth bSortClasses bServerSide bDeferRender".split(" ")),Nt(w,m,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"]]),Nt(w.oScroll,m,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Nt(w.oLanguage,m,"fnInfoCallback"),At(w,"aoDrawCallback",m.fnDrawCallback,"user"),At(w,"aoServerParams",m.fnServerParams,"user"),At(w,"aoStateSaveParams",m.fnStateSaveParams,"user"),At(w,"aoStateLoadParams",m.fnStateLoadParams,"user"),At(w,"aoStateLoaded",m.fnStateLoaded,"user"),At(w,"aoRowCallback",m.fnRowCallback,"user"),At(w,"aoRowCreatedCallback",m.fnCreatedRow,"user"),At(w,"aoHeaderCallback",m.fnHeaderCallback,"user"),At(w,"aoFooterCallback",m.fnFooterCallback,"user"),At(w,"aoInitComplete",m.fnInitComplete,"user"),At(w,"aoPreDrawCallback",m.fnPreDrawCallback,"user"),w.rowIdFn=C(m.rowId),d(w);var L=w.oClasses;t.extend(L,zt.ext.classes,m.oClasses),S.addClass(L.sTable),w.iInitDisplayStart===i&&(w.iInitDisplayStart=m.iDisplayStart,w._iDisplayStart=m.iDisplayStart),null!==m.iDeferLoading&&(w.bDeferLoading=!0,g=t.isArray(m.iDeferLoading),w._iRecordsDisplay=g?m.iDeferLoading[0]:m.iDeferLoading,w._iRecordsTotal=g?m.iDeferLoading[1]:m.iDeferLoading);var P=w.oLanguage;t.extend(!0,P,m.oLanguage),P.sUrl&&(t.ajax({dataType:"json",url:P.sUrl,success:function(e){s(e),r(v.oLanguage,e),t.extend(!0,P,e),ot(w)},error:function(){ot(w)}}),y=!0),null===m.asStripeClasses&&(w.asStripeClasses=[L.sStripeOdd,L.sStripeEven]);var g=w.asStripeClasses,T=S.children("tbody").find("tr").eq(0);if(-1!==t.inArray(!0,t.map(g,function(t){return T.hasClass(t)}))&&(t("tbody tr",this).removeClass(g.join(" ")),w.asDestroyStripes=g.slice()),g=[],b=this.getElementsByTagName("thead"),0!==b.length&&(G(w.aoHeader,b[0]),g=B(w)),null===m.aoColumns)for(b=[],f=0,p=g.length;f<p;f++)b.push(null);else b=m.aoColumns;for(f=0,p=b.length;f<p;f++)h(w,g?g[f]:null);if(j(w,m.aoColumnDefs,b,function(t,e){u(w,t,e)}),T.length){var N=function(t,e){return null!==t.getAttribute("data-"+e)?e:null};t(T[0]).children("th, td").each(function(t,e){var n=w.aoColumns[t];if(n.mData===t){var o=N(e,"sort")||N(e,"order"),r=N(e,"filter")||N(e,"search");null===o&&null===r||(n.mData={_:t+".display",sort:null!==o?t+".@data-"+o:i,type:null!==o?t+".@data-"+o:i,filter:null!==r?t+".@data-"+r:i},u(w,t))}})}var D=w.oFeatures,g=function(){if(m.aaSorting===i){var e=w.aaSorting;for(f=0,p=e.length;f<p;f++)e[f][1]=w.aoColumns[f].asSorting[0]}Ct(w),D.bSort&&At(w,"aoDrawCallback",function(){if(w.bSorted){var e=xt(w),n={};t.each(e,function(t,e){n[e.src]=e.dir}),Rt(w,null,"order",[w,e,n]),St(w)}}),At(w,"aoDrawCallback",function(){(w.bSorted||"ssp"===kt(w)||D.bDeferRender)&&Ct(w)},"sc");var e=S.children("caption").each(function(){this._captionSide=t(this).css("caption-side")}),n=S.children("thead");if(0===n.length&&(n=t("<thead/>").appendTo(S)),w.nTHead=n[0],n=S.children("tbody"),0===n.length&&(n=t("<tbody/>").appendTo(S)),w.nTBody=n[0],n=S.children("tfoot"),0===n.length&&e.length>0&&(""!==w.oScroll.sX||""!==w.oScroll.sY)&&(n=t("<tfoot/>").appendTo(S)),0===n.length||0===n.children().length?S.addClass(L.sNoFooter):n.length>0&&(w.nTFoot=n[0],G(w.aoFooter,w.nTFoot)),m.aaData)for(f=0;f<m.aaData.length;f++)x(w,m.aaData[f]);else(w.bDeferLoading||"dom"==kt(w))&&_(w,t(w.nTBody).children("tr"));w.aiDisplay=w.aiDisplayMaster.slice(),w.bInitialised=!0,y===!1&&ot(w)};m.bStateSave?(D.bStateSave=!0,At(w,"aoDrawCallback",wt,"state_save"),Lt(w,m,g)):g()}}),n=null,this},Xt={},Yt=/[\r\n]/g,Qt=/<.*?>/g,$t=/^\d{2,4}[\.\/\-]\d{1,2}[\.\/\-]\d{1,2}([T ]{1}\d{1,2}[:\.]\d{2}([\.:]\d{2})?)?$/,Kt=RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^|\\-)","g"),Jt=/[',$%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,Zt=function(t){return!t||!0===t||"-"===t},te=function(t){var e=parseInt(t,10);return!isNaN(e)&&isFinite(t)?e:null},ee=function(t,e){return Xt[e]||(Xt[e]=RegExp(ue(e),"g")),"string"==typeof t&&"."!==e?t.replace(/\./g,"").replace(Xt[e],"."):t},ne=function(t,e,n){var i="string"==typeof t;return!!Zt(t)||(e&&i&&(t=ee(t,e)),n&&i&&(t=t.replace(Jt,"")),!isNaN(parseFloat(t))&&isFinite(t))},ie=function(t,e,n){return!!Zt(t)||(Zt(t)||"string"==typeof t?!!ne(t.replace(Qt,""),e,n)||null:null);
},oe=function(t,e,n){var o=[],r=0,s=t.length;if(n!==i)for(;r<s;r++)t[r]&&t[r][e]&&o.push(t[r][e][n]);else for(;r<s;r++)t[r]&&o.push(t[r][e]);return o},re=function(t,e,n,o){var r=[],s=0,a=e.length;if(o!==i)for(;s<a;s++)t[e[s]][n]&&r.push(t[e[s]][n][o]);else for(;s<a;s++)r.push(t[e[s]][n]);return r},se=function(t,e){var n,o=[];e===i?(e=0,n=t):(n=e,e=t);for(var r=e;r<n;r++)o.push(r);return o},ae=function(t){for(var e=[],n=0,i=t.length;n<i;n++)t[n]&&e.push(t[n]);return e},le=function(t){var e;t:{if(!(2>t.length)){e=t.slice().sort();for(var n=e[0],i=1,o=e.length;i<o;i++){if(e[i]===n){e=!1;break t}n=e[i]}}e=!0}if(e)return t.slice();e=[];var r,o=t.length,s=0,i=0;t:for(;i<o;i++){for(n=t[i],r=0;r<s;r++)if(e[r]===n)continue t;e.push(n),s++}return e};zt.util={throttle:function(t,e){var n,o,r=e!==i?e:200;return function(){var e=this,s=+new Date,a=arguments;n&&s<n+r?(clearTimeout(o),o=setTimeout(function(){n=i,t.apply(e,a)},r)):(n=s,t.apply(e,a))}},escapeRegex:function(t){return t.replace(Kt,"\\$1")}};var de=function(t,e,n){t[e]!==i&&(t[n]=t[e])},ce=/\[.*?\]$/,he=/\(\)$/,ue=zt.util.escapeRegex,pe=t("<div>")[0],ge=pe.textContent!==i,me=/<.*?>/g,fe=zt.util.throttle,ye=[],ve=Array.prototype,je=function(e){var n,i,o=zt.settings,r=t.map(o,function(t){return t.nTable});return e?e.nTable&&e.oApi?[e]:e.nodeName&&"table"===e.nodeName.toLowerCase()?(n=t.inArray(e,r),-1!==n?[o[n]]:null):e&&"function"==typeof e.settings?e.settings().toArray():("string"==typeof e?i=t(e):e instanceof t&&(i=e),i?i.map(function(){return n=t.inArray(this,r),-1!==n?o[n]:null}).toArray():void 0):[]};Ht=function(e,n){if(!(this instanceof Ht))return new Ht(e,n);var i=[],o=function(t){(t=je(t))&&(i=i.concat(t))};if(t.isArray(e))for(var r=0,s=e.length;r<s;r++)o(e[r]);else o(e);this.context=le(i),n&&t.merge(this,n),this.selector={rows:null,cols:null,opts:null},Ht.extend(this,this,ye)},zt.Api=Ht,t.extend(Ht.prototype,{any:function(){return 0!==this.count()},concat:ve.concat,context:[],count:function(){return this.flatten().length},each:function(t){for(var e=0,n=this.length;e<n;e++)t.call(this,this[e],e,this);return this},eq:function(t){var e=this.context;return e.length>t?new Ht(e[t],this[t]):null},filter:function(t){var e=[];if(ve.filter)e=ve.filter.call(this,t,this);else for(var n=0,i=this.length;n<i;n++)t.call(this,this[n],n,this)&&e.push(this[n]);return new Ht(this.context,e)},flatten:function(){var t=[];return new Ht(this.context,t.concat.apply(t,this.toArray()))},join:ve.join,indexOf:ve.indexOf||function(t,e){for(var n=e||0,i=this.length;n<i;n++)if(this[n]===t)return n;return-1},iterator:function(t,e,n,o){var r,s,a,l,d,c,h,u=[],p=this.context,g=this.selector;for("string"==typeof t&&(o=n,n=e,e=t,t=!1),s=0,a=p.length;s<a;s++){var m=new Ht(p[s]);if("table"===e)r=n.call(m,p[s],s),r!==i&&u.push(r);else if("columns"===e||"rows"===e)r=n.call(m,p[s],this[s],s),r!==i&&u.push(r);else if("column"===e||"column-rows"===e||"row"===e||"cell"===e)for(h=this[s],"column-rows"===e&&(c=Ee(p[s],g.opts)),l=0,d=h.length;l<d;l++)r=h[l],r="cell"===e?n.call(m,p[s],r.row,r.column,s,l):n.call(m,p[s],r,s,l,c),r!==i&&u.push(r)}return u.length||o?(t=new Ht(p,t?u.concat.apply([],u):u),e=t.selector,e.rows=g.rows,e.cols=g.cols,e.opts=g.opts,t):this},lastIndexOf:ve.lastIndexOf||function(t,e){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(t){var e=[];if(ve.map)e=ve.map.call(this,t,this);else for(var n=0,i=this.length;n<i;n++)e.push(t.call(this,this[n],n));return new Ht(this.context,e)},pluck:function(t){return this.map(function(e){return e[t]})},pop:ve.pop,push:ve.push,reduce:ve.reduce||function(t,e){return c(this,t,e,0,this.length,1)},reduceRight:ve.reduceRight||function(t,e){return c(this,t,e,this.length-1,-1,-1)},reverse:ve.reverse,selector:null,shift:ve.shift,slice:function(){return new Ht(this.context,this)},sort:ve.sort,splice:ve.splice,toArray:function(){return ve.slice.call(this)},to$:function(){return t(this)},toJQuery:function(){return t(this)},unique:function(){return new Ht(this.context,le(this))},unshift:ve.unshift}),Ht.extend=function(e,n,i){if(i.length&&n&&(n instanceof Ht||n.__dt_wrapper)){var o,r,s,a=function(t,e,n){return function(){var i=e.apply(t,arguments);return Ht.extend(i,i,n.methodExt),i}};for(o=0,r=i.length;o<r;o++)s=i[o],n[s.name]="function"==typeof s.val?a(e,s.val,s):t.isPlainObject(s.val)?{}:s.val,n[s.name].__dt_wrapper=!0,Ht.extend(e,n[s.name],s.propExt)}},Ht.register=Ut=function(e,n){if(t.isArray(e))for(var i=0,o=e.length;i<o;i++)Ht.register(e[i],n);else for(var r,s,a=e.split("."),l=ye,i=0,o=a.length;i<o;i++){r=(s=-1!==a[i].indexOf("()"))?a[i].replace("()",""):a[i];var d;t:{d=0;for(var c=l.length;d<c;d++)if(l[d].name===r){d=l[d];break t}d=null}d||(d={name:r,val:{},methodExt:[],propExt:[]},l.push(d)),i===o-1?d.val=n:l=s?d.methodExt:d.propExt}},Ht.registerPlural=Wt=function(e,n,o){Ht.register(e,o),Ht.register(n,function(){var e=o.apply(this,arguments);return e===this?this:e instanceof Ht?e.length?t.isArray(e[0])?new Ht(e.context,e[0]):e[0]:i:e})},Ut("tables()",function(e){var n;if(e){n=Ht;var i=this.context;if("number"==typeof e)e=[i[e]];else var o=t.map(i,function(t){return t.nTable}),e=t(o).filter(e).map(function(){var e=t.inArray(this,o);return i[e]}).toArray();n=new n(e)}else n=this;return n}),Ut("table()",function(t){var t=this.tables(t),e=t.context;return e.length?new Ht(e[0]):t}),Wt("tables().nodes()","table().node()",function(){return this.iterator("table",function(t){return t.nTable},1)}),Wt("tables().body()","table().body()",function(){return this.iterator("table",function(t){return t.nTBody},1)}),Wt("tables().header()","table().header()",function(){return this.iterator("table",function(t){return t.nTHead},1)}),Wt("tables().footer()","table().footer()",function(){return this.iterator("table",function(t){return t.nTFoot},1)}),Wt("tables().containers()","table().container()",function(){return this.iterator("table",function(t){return t.nTableWrapper},1)}),Ut("draw()",function(t){return this.iterator("table",function(e){"page"===t?M(e):("string"==typeof t&&(t="full-hold"!==t),F(e,!1===t))})}),Ut("page()",function(t){return t===i?this.page.info().page:this.iterator("table",function(e){dt(e,t)})}),Ut("page.info()",function(){if(0===this.context.length)return i;var t=this.context[0],e=t._iDisplayStart,n=t.oFeatures.bPaginate?t._iDisplayLength:-1,o=t.fnRecordsDisplay(),r=-1===n;return{page:r?0:Math.floor(e/n),pages:r?1:Math.ceil(o/n),start:e,end:t.fnDisplayEnd(),length:n,recordsTotal:t.fnRecordsTotal(),recordsDisplay:o,serverSide:"ssp"===kt(t)}}),Ut("page.len()",function(t){return t===i?0!==this.context.length?this.context[0]._iDisplayLength:i:this.iterator("table",function(e){st(e,t)})});var xe=function(t,e,n){if(n){var i=new Ht(t);i.one("draw",function(){n(i.ajax.json())})}if("ssp"==kt(t))F(t,e);else{ht(t,!0);var o=t.jqXHR;o&&4!==o.readyState&&o.abort(),q(t,[],function(n){L(t);for(var n=W(t,n),i=0,o=n.length;i<o;i++)x(t,n[i]);F(t,e),ht(t,!1)})}};Ut("ajax.json()",function(){var t=this.context;if(0<t.length)return t[0].json}),Ut("ajax.params()",function(){var t=this.context;if(0<t.length)return t[0].oAjaxData}),Ut("ajax.reload()",function(t,e){return this.iterator("table",function(n){xe(n,!1===e,t)})}),Ut("ajax.url()",function(e){var n=this.context;return e===i?0===n.length?i:(n=n[0],n.ajax?t.isPlainObject(n.ajax)?n.ajax.url:n.ajax:n.sAjaxSource):this.iterator("table",function(n){t.isPlainObject(n.ajax)?n.ajax.url=e:n.ajax=e})}),Ut("ajax.url().load()",function(t,e){return this.iterator("table",function(n){xe(n,!1===e,t)})});var _e=function(e,n,o,r,s){var a,l,d,c,h,u,p=[];for(d=typeof n,n&&"string"!==d&&"function"!==d&&n.length!==i||(n=[n]),d=0,c=n.length;d<c;d++)for(l=n[d]&&n[d].split&&!n[d].match(/[\[\(:]/)?n[d].split(","):[n[d]],h=0,u=l.length;h<u;h++)(a=o("string"==typeof l[h]?t.trim(l[h]):l[h]))&&a.length&&(p=p.concat(a));if(e=Vt.selector[e],e.length)for(d=0,c=e.length;d<c;d++)p=e[d](r,s,p);return le(p)},Se=function(e){return e||(e={}),e.filter&&e.search===i&&(e.search=e.filter),t.extend({search:"none",order:"current",page:"all"},e)},be=function(t){for(var e=0,n=t.length;e<n;e++)if(0<t[e].length)return t[0]=t[e],t[0].length=1,t.length=1,t.context=[t.context[e]],t;return t.length=0,t},Ee=function(e,n){var i,o,r,s=[],a=e.aiDisplay;i=e.aiDisplayMaster;var l=n.search;if(o=n.order,r=n.page,"ssp"==kt(e))return"removed"===l?[]:se(0,i.length);if("current"==r)for(i=e._iDisplayStart,o=e.fnDisplayEnd();i<o;i++)s.push(a[i]);else if("current"==o||"applied"==o)s="none"==l?i.slice():"applied"==l?a.slice():t.map(i,function(e){return-1===t.inArray(e,a)?e:null});else if("index"==o||"original"==o)for(i=0,o=e.aoData.length;i<o;i++)"none"==l?s.push(i):(r=t.inArray(i,a),(-1===r&&"removed"==l||0<=r&&"applied"==l)&&s.push(i));return s};Ut("rows()",function(e,n){e===i?e="":t.isPlainObject(e)&&(n=e,e="");var n=Se(n),o=this.iterator("table",function(o){var r,s=n;return _e("row",e,function(e){var n=te(e);if(null!==n&&!s)return[n];if(r||(r=Ee(o,s)),null!==n&&t.inArray(n,r)!==-1)return[n];if(null===e||e===i||""===e)return r;if("function"==typeof e)return t.map(r,function(t){var n=o.aoData[t];return e(t,n._aData,n.nTr)?t:null});if(n=ae(re(o.aoData,r,"nTr")),e.nodeName)return e._DT_RowIndex!==i?[e._DT_RowIndex]:e._DT_CellIndex?[e._DT_CellIndex.row]:(n=t(e).closest("*[data-dt-row]"),n.length?[n.data("dt-row")]:[]);if("string"==typeof e&&"#"===e.charAt(0)){var a=o.aIds[e.replace(/^#/,"")];if(a!==i)return[a.idx]}return t(n).filter(e).map(function(){return this._DT_RowIndex}).toArray()},o,s)},1);return o.selector.rows=e,o.selector.opts=n,o}),Ut("rows().nodes()",function(){return this.iterator("row",function(t,e){return t.aoData[e].nTr||i},1)}),Ut("rows().data()",function(){return this.iterator(!0,"rows",function(t,e){return re(t.aoData,e,"_aData")},1)}),Wt("rows().cache()","row().cache()",function(t){return this.iterator("row",function(e,n){var i=e.aoData[n];return"search"===t?i._aFilterData:i._aSortData},1)}),Wt("rows().invalidate()","row().invalidate()",function(t){return this.iterator("row",function(e,n){T(e,n,t)})}),Wt("rows().indexes()","row().index()",function(){return this.iterator("row",function(t,e){return e},1)}),Wt("rows().ids()","row().id()",function(t){for(var e=[],n=this.context,i=0,o=n.length;i<o;i++)for(var r=0,s=this[i].length;r<s;r++){var a=n[i].rowIdFn(n[i].aoData[this[i][r]]._aData);e.push((!0===t?"#":"")+a)}return new Ht(n,e)}),Wt("rows().remove()","row().remove()",function(){var t=this;return this.iterator("row",function(e,n,o){var r,s,a,l,d,c=e.aoData,h=c[n];for(c.splice(n,1),r=0,s=c.length;r<s;r++)if(a=c[r],d=a.anCells,null!==a.nTr&&(a.nTr._DT_RowIndex=r),null!==d)for(a=0,l=d.length;a<l;a++)d[a]._DT_CellIndex.row=r;P(e.aiDisplayMaster,n),P(e.aiDisplay,n),P(t[o],n,!1),0<e._iRecordsDisplay&&e._iRecordsDisplay--,Mt(e),n=e.rowIdFn(h._aData),n!==i&&delete e.aIds[n]}),this.iterator("table",function(t){for(var e=0,n=t.aoData.length;e<n;e++)t.aoData[e].idx=e}),this}),Ut("rows.add()",function(e){var n=this.iterator("table",function(t){var n,i,o,r=[];for(i=0,o=e.length;i<o;i++)n=e[i],n.nodeName&&"TR"===n.nodeName.toUpperCase()?r.push(_(t,n)[0]):r.push(x(t,n));return r},1),i=this.rows(-1);return i.pop(),t.merge(i,n),i}),Ut("row()",function(t,e){return be(this.rows(t,e))}),Ut("row().data()",function(t){var e=this.context;return t===i?e.length&&this.length?e[0].aoData[this[0]]._aData:i:(e[0].aoData[this[0]]._aData=t,T(e[0],this[0],"data"),this)}),Ut("row().node()",function(){var t=this.context;return t.length&&this.length?t[0].aoData[this[0]].nTr||null:null}),Ut("row.add()",function(e){e instanceof t&&e.length&&(e=e[0]);var n=this.iterator("table",function(t){return e.nodeName&&"TR"===e.nodeName.toUpperCase()?_(t,e)[0]:x(t,e)});return this.row(n[0])});var Ce=function(t,e){var n=t.context;n.length&&(n=n[0].aoData[e!==i?e:t[0]])&&n._details&&(n._details.remove(),n._detailsShow=i,n._details=i)},Ie=function(t,e){var n=t.context;if(n.length&&t.length){var i=n[0].aoData[t[0]];if(i._details){(i._detailsShow=e)?i._details.insertAfter(i.nTr):i._details.detach();var o=n[0],r=new Ht(o),s=o.aoData;r.off("draw.dt.DT_details column-visibility.dt.DT_details destroy.dt.DT_details"),0<oe(s,"_details").length&&(r.on("draw.dt.DT_details",function(t,e){o===e&&r.rows({page:"current"}).eq(0).each(function(t){t=s[t],t._detailsShow&&t._details.insertAfter(t.nTr)})}),r.on("column-visibility.dt.DT_details",function(t,e){if(o===e)for(var n,i=f(e),r=0,a=s.length;r<a;r++)n=s[r],n._details&&n._details.children("td[colspan]").attr("colspan",i)}),r.on("destroy.dt.DT_details",function(t,e){if(o===e)for(var n=0,i=s.length;n<i;n++)s[n]._details&&Ce(r,n)}))}}};Ut("row().child()",function(e,n){var o=this.context;if(e===i)return o.length&&this.length?o[0].aoData[this[0]]._details:i;if(!0===e)this.child.show();else if(!1===e)Ce(this);else if(o.length&&this.length){var r=o[0],o=o[0].aoData[this[0]],s=[],a=function(e,n){if(t.isArray(e)||e instanceof t)for(var i=0,o=e.length;i<o;i++)a(e[i],n);else e.nodeName&&"tr"===e.nodeName.toLowerCase()?s.push(e):(i=t("<tr><td/></tr>").addClass(n),t("td",i).addClass(n).html(e)[0].colSpan=f(r),s.push(i[0]))};a(e,n),o._details&&o._details.detach(),o._details=t(s),o._detailsShow&&o._details.insertAfter(o.nTr)}return this}),Ut(["row().child.show()","row().child().show()"],function(){return Ie(this,!0),this}),Ut(["row().child.hide()","row().child().hide()"],function(){return Ie(this,!1),this}),Ut(["row().child.remove()","row().child().remove()"],function(){return Ce(this),this}),Ut("row().child.isShown()",function(){var t=this.context;return!(!t.length||!this.length)&&(t[0].aoData[this[0]]._detailsShow||!1)});var we=/^([^:]+):(name|visIdx|visible)$/,Le=function(t,e,n,i,o){for(var n=[],i=0,r=o.length;i<r;i++)n.push(S(t,o[i],e));return n};Ut("columns()",function(e,n){e===i?e="":t.isPlainObject(e)&&(n=e,e="");var n=Se(n),o=this.iterator("table",function(i){var o=e,r=n,s=i.aoColumns,a=oe(s,"sName"),l=oe(s,"nTh");return _e("column",o,function(e){var n=te(e);if(""===e)return se(s.length);if(null!==n)return[n>=0?n:s.length+n];if("function"==typeof e){var o=Ee(i,r);return t.map(s,function(t,n){return e(n,Le(i,n,0,0,o),l[n])?n:null})}var d="string"==typeof e?e.match(we):"";if(d)switch(d[2]){case"visIdx":case"visible":if(n=parseInt(d[1],10),n<0){var c=t.map(s,function(t,e){return t.bVisible?e:null});return[c[c.length+n]]}return[g(i,n)];case"name":return t.map(a,function(t,e){return t===d[1]?e:null});default:return[]}return e.nodeName&&e._DT_CellIndex?[e._DT_CellIndex.column]:(n=t(l).filter(e).map(function(){return t.inArray(this,l)}).toArray(),n.length||!e.nodeName?n:(n=t(e).closest("*[data-dt-column]"),n.length?[n.data("dt-column")]:[]))},i,r)},1);return o.selector.cols=e,o.selector.opts=n,o}),Wt("columns().header()","column().header()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].nTh},1)}),Wt("columns().footer()","column().footer()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].nTf},1)}),Wt("columns().data()","column().data()",function(){return this.iterator("column-rows",Le,1)}),Wt("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(t,e){return t.aoColumns[e].mData},1)}),Wt("columns().cache()","column().cache()",function(t){return this.iterator("column-rows",function(e,n,i,o,r){return re(e.aoData,r,"search"===t?"_aFilterData":"_aSortData",n)},1)}),Wt("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(t,e,n,i,o){return re(t.aoData,o,"anCells",e)},1)}),Wt("columns().visible()","column().visible()",function(e,n){var o=this.iterator("column",function(n,o){if(e===i)return n.aoColumns[o].bVisible;var r,s,a,l=n.aoColumns,d=l[o],c=n.aoData;if(e!==i&&d.bVisible!==e){if(e){var h=t.inArray(!0,oe(l,"bVisible"),o+1);for(r=0,s=c.length;r<s;r++)a=c[r].nTr,l=c[r].anCells,a&&a.insertBefore(l[o],l[h]||null)}else t(oe(n.aoData,"anCells",o)).detach();d.bVisible=e,R(n,n.aoHeader),R(n,n.aoFooter),wt(n)}});return e!==i&&(this.iterator("column",function(t,i){Rt(t,null,"column-visibility",[t,i,e,n])}),(n===i||n)&&this.columns.adjust()),o}),Wt("columns().indexes()","column().index()",function(t){return this.iterator("column",function(e,n){return"visible"===t?m(e,n):n},1)}),Ut("columns.adjust()",function(){return this.iterator("table",function(t){p(t)},1)}),Ut("column.index()",function(t,e){if(0!==this.context.length){var n=this.context[0];if("fromVisible"===t||"toData"===t)return g(n,e);if("fromData"===t||"toVisible"===t)return m(n,e)}}),Ut("column()",function(t,e){return be(this.columns(t,e))}),Ut("cells()",function(e,n,o){if(t.isPlainObject(e)&&(e.row===i?(o=e,e=null):(o=n,n=null)),t.isPlainObject(n)&&(o=n,n=null),null===n||n===i)return this.iterator("table",function(n){var r,s,a,l,d,c,h,u=e,p=Se(o),g=n.aoData,m=Ee(n,p),f=ae(re(g,m,"anCells")),y=t([].concat.apply([],f)),v=n.aoColumns.length;return _e("cell",u,function(e){var o="function"==typeof e;if(null===e||e===i||o){for(s=[],a=0,l=m.length;a<l;a++)for(r=m[a],d=0;d<v;d++)c={row:r,column:d},o?(h=g[r],e(c,S(n,r,d),h.anCells?h.anCells[d]:null)&&s.push(c)):s.push(c);return s}return t.isPlainObject(e)?[e]:(o=y.filter(e).map(function(t,e){return{row:e._DT_CellIndex.row,column:e._DT_CellIndex.column}}).toArray(),o.length||!e.nodeName?o:(h=t(e).closest("*[data-dt-row]"),h.length?[{row:h.data("dt-row"),column:h.data("dt-column")}]:[]))},n,p)});var r,s,a,l,d,c=this.columns(n,o),h=this.rows(e,o),u=this.iterator("table",function(t,e){for(r=[],s=0,a=h[e].length;s<a;s++)for(l=0,d=c[e].length;l<d;l++)r.push({row:h[e][s],column:c[e][l]});return r},1);return t.extend(u.selector,{cols:n,rows:e,opts:o}),u}),Wt("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(t,e,n){return(t=t.aoData[e])&&t.anCells?t.anCells[n]:i},1)}),Ut("cells().data()",function(){return this.iterator("cell",function(t,e,n){return S(t,e,n)},1)}),Wt("cells().cache()","cell().cache()",function(t){return t="search"===t?"_aFilterData":"_aSortData",this.iterator("cell",function(e,n,i){return e.aoData[n][t][i]},1)}),Wt("cells().render()","cell().render()",function(t){return this.iterator("cell",function(e,n,i){return S(e,n,i,t)},1)}),Wt("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(t,e,n){return{row:e,column:n,columnVisible:m(t,n)}},1)}),Wt("cells().invalidate()","cell().invalidate()",function(t){return this.iterator("cell",function(e,n,i){T(e,n,t,i)})}),Ut("cell()",function(t,e,n){return be(this.cells(t,e,n))}),Ut("cell().data()",function(t){var e=this.context,n=this[0];return t===i?e.length&&n.length?S(e[0],n[0].row,n[0].column):i:(b(e[0],n[0].row,n[0].column,t),T(e[0],n[0].row,"data",n[0].column),this)}),Ut("order()",function(e,n){var o=this.context;return e===i?0!==o.length?o[0].aaSorting:i:("number"==typeof e?e=[[e,n]]:e.length&&!t.isArray(e[0])&&(e=Array.prototype.slice.call(arguments)),this.iterator("table",function(t){t.aaSorting=e.slice()}))}),Ut("order.listener()",function(t,e,n){return this.iterator("table",function(i){Et(i,t,e,n)})}),Ut("order.fixed()",function(e){if(!e){var n=this.context,n=n.length?n[0].aaSortingFixed:i;return t.isArray(n)?{pre:n}:n}return this.iterator("table",function(n){n.aaSortingFixed=t.extend(!0,{},e)})}),Ut(["columns().order()","column().order()"],function(e){var n=this;return this.iterator("table",function(i,o){var r=[];t.each(n[o],function(t,n){r.push([n,e])}),i.aaSorting=r})}),Ut("search()",function(e,n,o,r){var s=this.context;return e===i?0!==s.length?s[0].oPreviousSearch.sSearch:i:this.iterator("table",function(i){i.oFeatures.bFilter&&X(i,t.extend({},i.oPreviousSearch,{sSearch:e+"",bRegex:null!==n&&n,bSmart:null===o||o,bCaseInsensitive:null===r||r}),1)})}),Wt("columns().search()","column().search()",function(e,n,o,r){return this.iterator("column",function(s,a){var l=s.aoPreSearchCols;return e===i?l[a].sSearch:void(s.oFeatures.bFilter&&(t.extend(l[a],{sSearch:e+"",bRegex:null!==n&&n,bSmart:null===o||o,bCaseInsensitive:null===r||r}),X(s,s.oPreviousSearch,1)))})}),Ut("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Ut("state.clear()",function(){return this.iterator("table",function(t){t.fnStateSaveCallback.call(t.oInstance,t,{})})}),Ut("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Ut("state.save()",function(){return this.iterator("table",function(t){wt(t)})}),zt.versionCheck=zt.fnVersionCheck=function(t){for(var e,n,i=zt.version.split("."),t=t.split("."),o=0,r=t.length;o<r;o++)if(e=parseInt(i[o],10)||0,n=parseInt(t[o],10)||0,e!==n)return e>n;return!0},zt.isDataTable=zt.fnIsDataTable=function(e){var n=t(e).get(0),i=!1;return e instanceof zt.Api||(t.each(zt.settings,function(e,o){var r=o.nScrollHead?t("table",o.nScrollHead)[0]:null,s=o.nScrollFoot?t("table",o.nScrollFoot)[0]:null;o.nTable!==n&&r!==n&&s!==n||(i=!0)}),i)},zt.tables=zt.fnTables=function(e){var n=!1;t.isPlainObject(e)&&(n=e.api,e=e.visible);var i=t.map(zt.settings,function(n){if(!e||e&&t(n.nTable).is(":visible"))return n.nTable});return n?new Ht(i):i},zt.camelToHungarian=r,Ut("$()",function(e,n){var i=this.rows(n).nodes(),i=t(i);return t([].concat(i.filter(e).toArray(),i.find(e).toArray()))}),t.each(["on","one","off"],function(e,n){Ut(n+"()",function(){var e=Array.prototype.slice.call(arguments);e[0]=t.map(e[0].split(/\s/),function(t){return t.match(/\.dt\b/)?t:t+".dt"}).join(" ");var i=t(this.tables().nodes());return i[n].apply(i,e),this})}),Ut("clear()",function(){return this.iterator("table",function(t){L(t)})}),Ut("settings()",function(){return new Ht(this.context,this.context)}),Ut("init()",function(){var t=this.context;return t.length?t[0].oInit:null}),Ut("data()",function(){return this.iterator("table",function(t){return oe(t.aoData,"_aData")}).flatten()}),Ut("destroy()",function(n){return n=n||!1,this.iterator("table",function(i){var o,r=i.nTableWrapper.parentNode,s=i.oClasses,a=i.nTable,l=i.nTBody,d=i.nTHead,c=i.nTFoot,h=t(a),l=t(l),u=t(i.nTableWrapper),p=t.map(i.aoData,function(t){return t.nTr});i.bDestroying=!0,Rt(i,"aoDestroyCallback","destroy",[i]),n||new Ht(i).columns().visible(!0),u.off(".DT").find(":not(tbody *)").off(".DT"),t(e).off(".DT-"+i.sInstance),a!=d.parentNode&&(h.children("thead").detach(),h.append(d)),c&&a!=c.parentNode&&(h.children("tfoot").detach(),h.append(c)),i.aaSorting=[],i.aaSortingFixed=[],Ct(i),t(p).removeClass(i.asStripeClasses.join(" ")),t("th, td",d).removeClass(s.sSortable+" "+s.sSortableAsc+" "+s.sSortableDesc+" "+s.sSortableNone),l.children().detach(),l.append(p),d=n?"remove":"detach",h[d](),u[d](),!n&&r&&(r.insertBefore(a,i.nTableReinsertBefore),h.css("width",i.sDestroyWidth).removeClass(s.sTable),(o=i.asDestroyStripes.length)&&l.children().each(function(e){t(this).addClass(i.asDestroyStripes[e%o])})),r=t.inArray(i,zt.settings),-1!==r&&zt.settings.splice(r,1)})}),t.each(["column","row","cell"],function(t,e){Ut(e+"s().every()",function(t){var n=this.selector.opts,o=this;return this.iterator(e,function(r,s,a,l,d){t.call(o[e](s,"cell"===e?a:n,"cell"===e?n:i),s,a,l,d)})})}),Ut("i18n()",function(e,n,o){var r=this.context[0],e=C(e)(r.oLanguage);return e===i&&(e=n),o!==i&&t.isPlainObject(e)&&(e=e[o]!==i?e[o]:e._),e.replace("%d",o)}),zt.version="1.10.16",zt.settings=[],zt.models={},zt.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},zt.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},zt.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},zt.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(t){try{return JSON.parse((-1===t.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+t.sInstance+"_"+location.pathname))}catch(t){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(t,e){try{(-1===t.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+t.sInstance+"_"+location.pathname,JSON.stringify(e))}catch(t){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:t.extend({},zt.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},o(zt.defaults),zt.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},o(zt.defaults.column),zt.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1,barWidth:0},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:i,oAjaxData:i,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==kt(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==kt(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var t=this._iDisplayLength,e=this._iDisplayStart,n=e+t,i=this.aiDisplay.length,o=this.oFeatures,r=o.bPaginate;return o.bServerSide?!1===r||-1===t?e+i:Math.min(e+t,this._iRecordsDisplay):!r||n>i||-1===t?i:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},zt.ext=Vt={buttons:{},classes:{},build:"se/dt-1.10.16",errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:zt.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:zt.version},t.extend(Vt,{afnFiltering:Vt.search,aTypes:Vt.type.detect,ofnSearch:Vt.type.search,oSort:Vt.type.order,afnSortData:Vt.order,aoFeatures:Vt.feature,oApi:Vt.internal,oStdClasses:Vt.classes,oPagination:Vt.pager}),t.extend(zt.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""});var Pe=zt.ext.pager;t.extend(Pe,{simple:function(){return["previous","next"]},full:function(){return["first","previous","next","last"]},numbers:function(t,e){return[Gt(t,e)]},simple_numbers:function(t,e){return["previous",Gt(t,e),"next"]},full_numbers:function(t,e){return["first","previous",Gt(t,e),"next","last"]},first_last_numbers:function(t,e){return["first",Gt(t,e),"last"]},_numbers:Gt,numbers_length:7}),t.extend(!0,zt.ext.renderer,{pageButton:{_:function(e,o,r,s,a,l){var d,c,h,u=e.oClasses,p=e.oLanguage.oPaginate,g=e.oLanguage.oAria.paginate||{},m=0,f=function(n,i){var o,s,h,y,v=function(t){dt(e,t.data.action,!0)};for(o=0,s=i.length;o<s;o++)if(y=i[o],t.isArray(y))h=t("<"+(y.DT_el||"div")+"/>").appendTo(n),f(h,y);else{switch(d=null,c="",y){case"ellipsis":n.append('<span class="ellipsis">&#x2026;</span>');break;case"first":d=p.sFirst,c=y+(a>0?"":" "+u.sPageButtonDisabled);break;case"previous":d=p.sPrevious,c=y+(a>0?"":" "+u.sPageButtonDisabled);break;case"next":d=p.sNext,c=y+(a<l-1?"":" "+u.sPageButtonDisabled);break;case"last":d=p.sLast,c=y+(a<l-1?"":" "+u.sPageButtonDisabled);break;default:d=y+1,c=a===y?u.sPageButtonActive:""}null!==d&&(h=t("<a>",{class:u.sPageButton+" "+c,"aria-controls":e.sTableId,"aria-label":g[y],"data-dt-idx":m,tabindex:e.iTabIndex,id:0===r&&"string"==typeof y?e.sTableId+"_"+y:null}).html(d).appendTo(n),Ot(h,{action:y},v),m++)}};try{h=t(o).find(n.activeElement).data("dt-idx")}catch(t){}f(t(o).empty(),s),h!==i&&t(o).find("[data-dt-idx="+h+"]").focus()}}}),t.extend(zt.ext.type.detect,[function(t,e){var n=e.oLanguage.sDecimal;return ne(t,n)?"num"+n:null},function(t){if(t&&!(t instanceof Date)&&!$t.test(t))return null;var e=Date.parse(t);return null!==e&&!isNaN(e)||Zt(t)?"date":null},function(t,e){var n=e.oLanguage.sDecimal;return ne(t,n,!0)?"num-fmt"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return ie(t,n)?"html-num"+n:null},function(t,e){var n=e.oLanguage.sDecimal;return ie(t,n,!0)?"html-num-fmt"+n:null},function(t){return Zt(t)||"string"==typeof t&&-1!==t.indexOf("<")?"html":null}]),t.extend(zt.ext.type.search,{html:function(t){return Zt(t)?t:"string"==typeof t?t.replace(Yt," ").replace(Qt,""):"";
},string:function(t){return Zt(t)?t:"string"==typeof t?t.replace(Yt," "):t}});var Te=function(t,e,n,i){return 0===t||t&&"-"!==t?(e&&(t=ee(t,e)),t.replace&&(n&&(t=t.replace(n,"")),i&&(t=t.replace(i,""))),1*t):-(1/0)};t.extend(Vt.type.order,{"date-pre":function(t){return Date.parse(t)||-(1/0)},"html-pre":function(t){return Zt(t)?"":t.replace?t.replace(/<.*?>/g,"").toLowerCase():t+""},"string-pre":function(t){return Zt(t)?"":"string"==typeof t?t.toLowerCase():t.toString?t.toString():""},"string-asc":function(t,e){return t<e?-1:t>e?1:0},"string-desc":function(t,e){return t<e?1:t>e?-1:0}}),Bt(""),t.extend(!0,zt.ext.renderer,{header:{_:function(e,n,i,o){t(e.nTable).on("order.dt.DT",function(t,r,s,a){e===r&&(t=i.idx,n.removeClass(i.sSortingClass+" "+o.sSortAsc+" "+o.sSortDesc).addClass("asc"==a[t]?o.sSortAsc:"desc"==a[t]?o.sSortDesc:i.sSortingClass))})},jqueryui:function(e,n,i,o){t("<div/>").addClass(o.sSortJUIWrapper).append(n.contents()).append(t("<span/>").addClass(o.sSortIcon+" "+i.sSortingClassJUI)).appendTo(n),t(e.nTable).on("order.dt.DT",function(t,r,s,a){e===r&&(t=i.idx,n.removeClass(o.sSortAsc+" "+o.sSortDesc).addClass("asc"==a[t]?o.sSortAsc:"desc"==a[t]?o.sSortDesc:i.sSortingClass),n.find("span."+o.sSortIcon).removeClass(o.sSortJUIAsc+" "+o.sSortJUIDesc+" "+o.sSortJUI+" "+o.sSortJUIAscAllowed+" "+o.sSortJUIDescAllowed).addClass("asc"==a[t]?o.sSortJUIAsc:"desc"==a[t]?o.sSortJUIDesc:i.sSortingClassJUI))})}}});var Ne=function(t){return"string"==typeof t?t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):t};return zt.render={number:function(t,e,n,i,o){return{display:function(r){if("number"!=typeof r&&"string"!=typeof r)return r;var s=0>r?"-":"",a=parseFloat(r);return isNaN(a)?Ne(r):(a=a.toFixed(n),r=Math.abs(a),a=parseInt(r,10),r=n?e+(r-a).toFixed(n).substring(2):"",s+(i||"")+a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,t)+r+(o||""))}}},text:function(){return{display:Ne}}},t.extend(zt.ext.internal,{_fnExternApiFunc:qt,_fnBuildAjax:q,_fnAjaxUpdate:V,_fnAjaxParameters:H,_fnAjaxUpdateDraw:U,_fnAjaxDataSrc:W,_fnAddColumn:h,_fnColumnOptions:u,_fnAdjustColumnSizing:p,_fnVisibleToColumnIndex:g,_fnColumnIndexToVisible:m,_fnVisbleColumns:f,_fnGetColumns:y,_fnColumnTypes:v,_fnApplyColumnDefs:j,_fnHungarianMap:o,_fnCamelToHungarian:r,_fnLanguageCompat:s,_fnBrowserDetect:d,_fnAddData:x,_fnAddTr:_,_fnNodeToDataIndex:function(t,e){return e._DT_RowIndex!==i?e._DT_RowIndex:null},_fnNodeToColumnIndex:function(e,n,i){return t.inArray(i,e.aoData[n].anCells)},_fnGetCellData:S,_fnSetCellData:b,_fnSplitObjNotation:E,_fnGetObjectDataFn:C,_fnSetObjectDataFn:I,_fnGetDataMaster:w,_fnClearTable:L,_fnDeleteIndex:P,_fnInvalidate:T,_fnGetRowElements:N,_fnCreateTr:D,_fnBuildHead:A,_fnDrawHead:R,_fnDraw:M,_fnReDraw:F,_fnAddOptionsHtml:k,_fnDetectHeader:G,_fnGetUniqueThs:B,_fnFeatureHtmlFilter:z,_fnFilterComplete:X,_fnFilterCustom:Y,_fnFilterColumn:Q,_fnFilter:$,_fnFilterCreateSearch:K,_fnEscapeRegex:ue,_fnFilterData:J,_fnFeatureHtmlInfo:et,_fnUpdateInfo:nt,_fnInfoMacros:it,_fnInitialise:ot,_fnInitComplete:rt,_fnLengthChange:st,_fnFeatureHtmlLength:at,_fnFeatureHtmlPaginate:lt,_fnPageChange:dt,_fnFeatureHtmlProcessing:ct,_fnProcessingDisplay:ht,_fnFeatureHtmlTable:ut,_fnScrollDraw:pt,_fnApplyToChildren:gt,_fnCalculateColumnWidths:mt,_fnThrottle:fe,_fnConvertToWidth:ft,_fnGetWidestNode:yt,_fnGetMaxLenString:vt,_fnStringToCss:jt,_fnSortFlatten:xt,_fnSort:_t,_fnSortAria:St,_fnSortListener:bt,_fnSortAttachListener:Et,_fnSortingClasses:Ct,_fnSortData:It,_fnSaveState:wt,_fnLoadState:Lt,_fnSettingsFromNode:Pt,_fnLog:Tt,_fnMap:Nt,_fnBindAction:Ot,_fnCallbackReg:At,_fnCallbackFire:Rt,_fnLengthOverflow:Mt,_fnRenderer:Ft,_fnDataSource:kt,_fnRowAttributes:O,_fnCalculateEnd:function(){}}),t.fn.dataTable=zt,zt.$=t,t.fn.dataTableSettings=zt.settings,t.fn.dataTableExt=zt.ext,t.fn.DataTable=function(e){return t(this).dataTable(e).api()},t.each(zt,function(e,n){t.fn.DataTable[e]=n}),t.fn.dataTable}),function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return t(e,window,document)}):"object"==typeof exports?module.exports=function(e,n){return e||(e=window),n&&n.fn.dataTable||(n=require("datatables.net")(e,n).$),t(n,e,e.document)}:t(jQuery,window,document)}(function(t,e,n,i){var o=t.fn.dataTable;return t.extend(!0,o.defaults,{dom:"<'ui stackable grid'<'row'<'eight wide column'l><'right aligned eight wide column'f>><'row dt-table'<'sixteen wide column'tr>><'row'<'seven wide column'i><'right aligned nine wide column'p>>>",renderer:"semanticUI"}),t.extend(o.ext.classes,{sWrapper:"dataTables_wrapper dt-semanticUI",sFilter:"dataTables_filter ui input",sProcessing:"dataTables_processing ui segment",sPageButton:"paginate_button item"}),o.ext.renderer.pageButton.semanticUI=function(e,r,s,a,l,d){var c,h,u,p=new o.Api(e),g=e.oClasses,m=e.oLanguage.oPaginate,f=e.oLanguage.oAria.paginate||{},y=0,v=function(n,i){var o,r,a,u,j=function(e){e.preventDefault(),!t(e.currentTarget).hasClass("disabled")&&p.page()!=e.data.action&&p.page(e.data.action).draw("page")};for(o=0,r=i.length;o<r;o++)if(u=i[o],t.isArray(u))v(n,u);else{switch(h=c="",u){case"ellipsis":c="&#x2026;",h="disabled";break;case"first":c=m.sFirst,h=u+(0<l?"":" disabled");break;case"previous":c=m.sPrevious,h=u+(0<l?"":" disabled");break;case"next":c=m.sNext,h=u+(l<d-1?"":" disabled");break;case"last":c=m.sLast,h=u+(l<d-1?"":" disabled");break;default:c=u+1,h=l===u?"active":""}a=-1===h.indexOf("disabled")?"a":"div",c&&(a=t("<"+a+">",{class:g.sPageButton+" "+h,id:0===s&&"string"==typeof u?e.sTableId+"_"+u:null,href:"#","aria-controls":e.sTableId,"aria-label":f[u],"data-dt-idx":y,tabindex:e.iTabIndex}).html(c).appendTo(n),e.oApi._fnBindAction(a,{action:u},j),y++)}};try{u=t(r).find(n.activeElement).data("dt-idx")}catch(t){}v(t(r).empty().html('<div class="ui stackable pagination menu"/>').children(),a),u!==i&&t(r).find("[data-dt-idx="+u+"]").focus()},t(n).on("init.dt",function(e,n){if("dt"===e.namespace&&t.fn.dropdown){var i=new t.fn.dataTable.Api(n);t("div.dataTables_length select",i.table().container()).dropdown()}}),o}),function(t){var e=function(e){var n=e.table();this.s={dt:e,host:t(n.container()).parent(),header:t(n.header()),footer:t(n.footer()),body:t(n.body()),container:t(n.container()),table:t(n.node())},e=this.s.host,"static"===e.css("position")&&e.css("position","relative"),this._attach(),this._size()};e.prototype={_size:function(){var e=this.s,n=e.dt,i=n.table(),o=t(e.table).offset().top,r=t("tr",e.body).eq(0).height(),s=e.host.height();i.header().parentNode===i.body().parentNode&&(s-=e.header.height(),s-=e.footer.height()),s=s-o-(e.container.height()-(o+e.table.height())),e=Math.floor(s/r),1/0!==e&&-(1/0)!==e&&!isNaN(e)&&0<e&&e!==n.page.len()&&n.page.len(e).draw()},_attach:function(){var e=this,n=t("<object/>").css({position:"absolute",top:0,left:0,height:"100%",width:"100%",zIndex:-1}).attr("type","text/html");n[0].onload=function(){var t=this.contentDocument.body,n=t.offsetHeight;this.contentDocument.defaultView.onresize=function(){var i=t.clientHeight||t.offsetHeight;i!==n&&(n=i,e._size())}},n.appendTo(this.s.host).attr("data","about:blank")}},t.fn.dataTable.PageResize=e,t.fn.DataTable.PageResize=e,t(document).on("init.dt",function(n,i){if("dt"===n.namespace){var o=new t.fn.dataTable.Api(i);(t(o.table().node()).hasClass("pageResize")||i.oInit.pageResize||t.fn.dataTable.defaults.pageResize)&&new e(o)}})}(jQuery),!function(t){var e={config:{},container:{},errors:{},controls:{},items:{},utils:{}};e.utils.F=function(){},e.utils.extend=function(t,n){t.prototype=e.utils.createObject(n.prototype),t.prototype.contructor=t},e.utils.createObject=function(t){return"function"==typeof Object.create?Object.create(t):(e.utils.F.prototype=t,new e.utils.F)},e.utils.objectKeys=function(t){var e,n;if("function"==typeof Object.keys)return Object.keys(t);e=[];for(n in t)e.push(n);return e},e.utils.getQueryStringParam=function(t){if(!window.location.search)return null;var e,n,i=window.location.search.substr(1).split("&"),o={};for(n=0;n<i.length;n++)e=i[n].split("="),o[e[0]]=e[1];return o[t]||null},e.utils.copy=function(t,e){for(var n in e)t[n]=e[n];return t},e.utils.animFrame=function(t){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)})(function(){t()})},e.utils.indexOf=function(t,e){if(!(e instanceof Array))throw new Error("Haystack is not an Array");if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},e.utils.fnBind=function(t,e,n){if(void 0!==Function.prototype.bind)return Function.prototype.bind.apply(t,[e].concat(n||[]));var i=function(){var o=(n||[]).concat(Array.prototype.slice.call(arguments,0));return this instanceof i?void t.apply(this,o):t.apply(e,o)};return i.prototype=t.prototype,i},e.utils.removeFromArray=function(t,n){var i=e.utils.indexOf(t,n);if(-1===i)throw new Error("Can't remove item from array. Item is not in the array");n.splice(i,1)},e.utils.now=function(){return"function"==typeof Date.now?Date.now():(new Date).getTime()},e.utils.getUniqueId=function(){return(1e15*Math.random()).toString(36).replace(".","")},e.utils.filterXss=function(t,e){var n=t.replace(/javascript/gi,"j&#97;vascript").replace(/expression/gi,"expr&#101;ssion").replace(/onload/gi,"onlo&#97;d").replace(/script/gi,"&#115;cript").replace(/onerror/gi,"on&#101;rror");return e===!0?n:n.replace(/>/g,"&gt;").replace(/</g,"&lt;")},e.utils.stripTags=function(e){return t.trim(e.replace(/(<([^>]+)>)/gi,""))},e.utils.EventEmitter=function(){this._mSubscriptions={},this._mSubscriptions[e.utils.EventEmitter.ALL_EVENT]=[],this.on=function(t,e,n){this._mSubscriptions[t]||(this._mSubscriptions[t]=[]),this._mSubscriptions[t].push({fn:e,ctx:n})},this.emit=function(t){var n,i,o;if(o=Array.prototype.slice.call(arguments,1),this._mSubscriptions[t])for(n=0;n<this._mSubscriptions[t].length;n++)i=this._mSubscriptions[t][n].ctx||{},this._mSubscriptions[t][n].fn.apply(i,o);for(o.unshift(t),n=0;n<this._mSubscriptions[e.utils.EventEmitter.ALL_EVENT].length;n++)i=this._mSubscriptions[e.utils.EventEmitter.ALL_EVENT][n].ctx||{},this._mSubscriptions[e.utils.EventEmitter.ALL_EVENT][n].fn.apply(i,o)},this.unbind=function(t,e,n){if(!this._mSubscriptions[t])throw new Error("No subscribtions to unsubscribe for event "+t);var i,o=!1;for(i=0;i<this._mSubscriptions[t].length;i++)this._mSubscriptions[t][i].fn!==e||n&&n!==this._mSubscriptions[t][i].ctx||(this._mSubscriptions[t].splice(i,1),o=!0);if(o===!1)throw new Error("Nothing to unbind for "+t)},this.off=this.unbind,this.trigger=this.emit},e.utils.EventEmitter.ALL_EVENT="__all",e.utils.DragListener=function(n,i){e.utils.EventEmitter.call(this),this._eElement=t(n),this._oDocument=t(document),this._eBody=t(document.body),this._nButtonCode=i||0,this._nDelay=200,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._bDragging=!1,this._fMove=e.utils.fnBind(this.onMouseMove,this),this._fUp=e.utils.fnBind(this.onMouseUp,this),this._fDown=e.utils.fnBind(this.onMouseDown,this),this._eElement.on("mousedown touchstart",this._fDown)},e.utils.DragListener.timeout=null,e.utils.copy(e.utils.DragListener.prototype,{destroy:function(){this._eElement.unbind("mousedown touchstart",this._fDown)},onMouseDown:function(t){t.preventDefault();var n=this._getCoordinates(t);this._nOriginalX=n.x,this._nOriginalY=n.y,this._oDocument.on("mousemove touchmove",this._fMove),this._oDocument.one("mouseup touchend",this._fUp),this._timeout=setTimeout(e.utils.fnBind(this._startDrag,this),this._nDelay)},onMouseMove:function(t){t.preventDefault();var e=this._getCoordinates(t);this._nX=e.x-this._nOriginalX,this._nY=e.y-this._nOriginalY,this._bDragging===!1&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&(clearTimeout(this._timeout),this._startDrag()),this._bDragging&&this.emit("drag",this._nX,this._nY,t)},onMouseUp:function(t){clearTimeout(this._timeout),this._eBody.removeClass("lm_dragging"),this._oDocument.unbind("mousemove touchmove",this._fMove),this._bDragging===!0&&(this._bDragging=!1,this.emit("dragStop",t,this._nOriginalX+this._nX))},_startDrag:function(){this._bDragging=!0,this._eBody.addClass("lm_dragging"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)},_getCoordinates:function(t){var e={};return"touch"===t.type.substr(0,5)?(e.x=t.originalEvent.targetTouches[0].pageX,e.y=t.originalEvent.targetTouches[0].pageY):(e.x=t.pageX,e.y=t.pageY),e}}),e.LayoutManager=function(n,i){if(!t||"function"!=typeof t.noConflict){var o="jQuery is missing as dependency for GoldenLayout. ";throw o+='Please either expose $ on GoldenLayout\'s scope (e.g. window) or add "jquery" to ',o+="your paths when using RequireJS/AMD",new Error(o)}e.utils.EventEmitter.call(this),this.isInitialised=!1,this._isFullPage=!1,this._resizeTimeoutId=null,this._components={"lm-react-component":e.utils.ReactComponentHandler},this._itemAreas=[],this._resizeFunction=e.utils.fnBind(this._onResize,this),this._maximisedItem=null,this._maximisePlaceholder=t('<div class="lm_maximise_place"></div>'),this._creationTimeoutPassed=!1,this._subWindowsCreated=!1,this.width=null,this.height=null,this.root=null,this.openPopouts=[],this.selectedItem=null,this.isSubWindow=!1,this.eventHub=new e.utils.EventHub(this),this.config=this._createConfig(n),this.container=i,this.dropTargetIndicator=null,this.transitionIndicator=null,this.tabDropPlaceholder=t('<div class="lm_drop_tab_placeholder"></div>'),this.isSubWindow===!0&&t("body").css("visibility","hidden"),t(window).on("unload beforeunload",e.utils.fnBind(this._onUnload,this)),this._typeToItem={column:e.utils.fnBind(e.items.RowOrColumn,this,[!0]),row:e.utils.fnBind(e.items.RowOrColumn,this,[!1]),stack:e.items.Stack,component:e.items.Component}},e.LayoutManager.__lm=e,e.LayoutManager.minifyConfig=function(t){return(new e.utils.ConfigMinifier).minifyConfig(t)},e.LayoutManager.unminifyConfig=function(t){return(new e.utils.ConfigMinifier).unminifyConfig(t)},e.utils.copy(e.LayoutManager.prototype,{registerComponent:function(t,e){if("function"!=typeof e)throw new Error("Please register a constructor function");if(void 0!==this._components[t])throw new Error("Component "+t+" is already registered");this._components[t]=e},toConfig:function(t){var n,i,o;if(this.isInitialised===!1)throw new Error("Can't create config, layout not yet initialised");if(t&&!(t instanceof e.items.AbstractContentItem))throw new Error("Root must be a ContentItem");for(n={settings:e.utils.copy({},this.config.settings),dimensions:e.utils.copy({},this.config.dimensions),labels:e.utils.copy({},this.config.labels)},n.content=[],i=function(t,e){var n,o;for(n in e.config)"content"!==n&&(t[n]=e.config[n]);if(e.contentItems.length)for(t.content=[],o=0;o<e.contentItems.length;o++)t.content[o]={},i(t.content[o],e.contentItems[o])},t?i(n,{contentItems:[t]}):i(n,this.root),this._$reconcilePopoutWindows(),n.openPopouts=[],o=0;o<this.openPopouts.length;o++)n.openPopouts.push(this.openPopouts[o].toConfig());return n.maximisedItemId=this._maximisedItem?"__glMaximised":null,n},getComponent:function(t){if(void 0===this._components[t])throw new e.errors.ConfigurationError('Unknown component "'+t+'"');return this._components[t]},init:function(){return this._subWindowsCreated===!1&&(this._createSubWindows(),this._subWindowsCreated=!0),"loading"===document.readyState||null===document.body?void t(document).ready(e.utils.fnBind(this.init,this)):this.isSubWindow===!0&&this._creationTimeoutPassed===!1?(setTimeout(e.utils.fnBind(this.init,this),7),void(this._creationTimeoutPassed=!0)):(this.isSubWindow===!0&&this._adjustToWindowMode(),this._setContainer(),this.dropTargetIndicator=new e.controls.DropTargetIndicator(this.container),this.transitionIndicator=new e.controls.TransitionIndicator,this.updateSize(),this._create(this.config),this._bindEvents(),this.isInitialised=!0,void this.emit("initialised"))},updateSize:function(t,e){2===arguments.length?(this.width=t,this.height=e):(this.width=this.container.width(),this.height=this.container.height()),this.isInitialised===!0&&(this.root.callDownwards("setSize"),this._maximisedItem&&(this._maximisedItem.element.width(this.container.width()),this._maximisedItem.element.height(this.container.height()),this._maximisedItem.callDownwards("setSize")))},destroy:function(){this.isInitialised!==!1&&(this._onUnload(),t(window).off("resize",this._resizeFunction),this.root.callDownwards("_$destroy",[],!0),this.root.contentItems=[],this.tabDropPlaceholder.remove(),this.dropTargetIndicator.destroy(),this.transitionIndicator.destroy())},createContentItem:function(t,n){var i,o;if("string"!=typeof t.type)throw new e.errors.ConfigurationError("Missing parameter 'type'",t);if("react-component"===t.type&&(t.type="component",t.componentName="lm-react-component"),!this._typeToItem[t.type])throw i="Unknown type '"+t.type+"'. Valid types are "+e.utils.objectKeys(this._typeToItem).join(","),new e.errors.ConfigurationError(i);return"component"!==t.type||n instanceof e.items.Stack||!n||this.isSubWindow===!0&&n instanceof e.items.Root||(t={type:"stack",isClosable:t.isClosable,width:t.width,height:t.height,content:[t]}),o=new this._typeToItem[t.type](this,t,n)},createPopout:function(t,n,i,o){var r,s,a,l,d,c,h=t,u=t instanceof e.items.AbstractContentItem,p=this;if(i=i||null,u){for(h=this.toConfig(t).content,i=e.utils.getUniqueId(),l=t.parent,d=t;1===l.contentItems.length&&!l.isRoot;)l=l.parent,d=d.parent;l.addId(i),isNaN(o)&&(o=e.utils.indexOf(d,l.contentItems))}else h instanceof Array||(h=[h]);return!n&&u&&(r=window.screenX||window.screenLeft,s=window.screenY||window.screenTop,a=t.element.offset(),n={left:r+a.left,top:s+a.top,width:t.element.width(),height:t.element.height()}),n||u||(n={left:window.screenX||window.screenLeft+20,top:window.screenY||window.screenTop+20,width:500,height:309}),u&&t.remove(),c=new e.controls.BrowserPopout(h,n,i,o,this),c.on("initialised",function(){p.emit("windowOpened",c)}),c.on("closed",function(){p._$reconcilePopoutWindows()}),this.openPopouts.push(c),c},createDragSource:function(n,i){this.config.settings.constrainDragToContainer=!1,new e.controls.DragSource(t(n),i,this)},selectItem:function(t,e){if(this.config.settings.selectionEnabled!==!0)throw new Error("Please set selectionEnabled to true to use this feature");t!==this.selectedItem&&(null!==this.selectedItem&&this.selectedItem.deselect(),t&&e!==!0&&t.select(),this.selectedItem=t,this.emit("selectionChanged",t))},_$maximiseItem:function(t){null!==this._maximisedItem&&this._$minimiseItem(this._maximisedItem),this._maximisedItem=t,this._maximisedItem.addId("__glMaximised"),t.element.addClass("lm_maximised"),t.element.after(this._maximisePlaceholder),this.root.element.prepend(t.element),t.element.width(this.container.width()),t.element.height(this.container.height()),t.callDownwards("setSize"),this._maximisedItem.emit("maximised"),this.emit("stateChanged")},_$minimiseItem:function(t){t.element.removeClass("lm_maximised"),t.removeId("__glMaximised"),this._maximisePlaceholder.after(t.element),this._maximisePlaceholder.remove(),t.parent.callDownwards("setSize"),this._maximisedItem=null,t.emit("minimised"),this.emit("stateChanged")},_$closeWindow:function(){window.setTimeout(function(){window.close()},1)},_$getArea:function(t,e){var n,i,o=1/0,r=null;for(n=0;n<this._itemAreas.length;n++)i=this._itemAreas[n],t>i.x1&&t<i.x2&&e>i.y1&&e<i.y2&&o>i.surface&&(o=i.surface,r=i);return r},_$calculateItemAreas:function(){var t,e,n=this._getAllContentItems();if(this._itemAreas=[],1===n.length)return void this._itemAreas.push(this.root._$getArea());for(t=0;t<n.length;t++)n[t].isStack&&(e=n[t]._$getArea(),null!==e&&(e instanceof Array?this._itemAreas=this._itemAreas.concat(e):this._itemAreas.push(e)))},_$normalizeContentItem:function(n,i){if(!n)throw new Error("No content item defined");if(n instanceof e.items.AbstractContentItem)return n;if(t.isPlainObject(n)&&n.type){var o=this.createContentItem(n,i);return o.callDownwards("_$init"),o}throw new Error("Invalid contentItem")},_$reconcilePopoutWindows:function(){var t,e=[];for(t=0;t<this.openPopouts.length;t++)this.openPopouts[t].getWindow().closed===!1?e.push(this.openPopouts[t]):this.emit("windowClosed",this.openPopouts[t]);this.openPopouts.length!==e.length&&(this.emit("stateChanged"),this.openPopouts=e)},_getAllContentItems:function(){var t=[],e=function(n){if(t.push(n),n.contentItems instanceof Array)for(var i=0;i<n.contentItems.length;i++)e(n.contentItems[i])};return e(this.root),t},_bindEvents:function(){this._isFullPage&&t(window).resize(this._resizeFunction)},_onResize:function(){clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(e.utils.fnBind(this.updateSize,this),100)},_createConfig:function(n){var i=e.utils.getQueryStringParam("gl-window");i&&(this.isSubWindow=!0,n=localStorage.getItem(i),n=JSON.parse(n),n=(new e.utils.ConfigMinifier).unminifyConfig(n),localStorage.removeItem(i)),n=t.extend(!0,{},e.config.defaultConfig,n);var o=function(t){for(var e in t)"props"!==e&&"object"==typeof t[e]?o(t[e]):"type"===e&&"react-component"===t[e]&&(t.type="component",t.componentName="lm-react-component")};return o(n),n.settings.hasHeaders===!1&&(n.dimensions.headerHeight=0),n},_adjustToWindowMode:function(){var n=t('<div class="lm_popin" title="'+this.config.labels.popin+'"><div class="lm_icon"></div><div class="lm_bg"></div></div>');n.click(e.utils.fnBind(function(){this.emit("popIn")},this)),document.title=e.utils.stripTags(this.config.content[0].title),t("head").append(t("body link, body style, template, .gl_keep")),this.container=t("body").html("").css("visibility","visible").append(n),document.body.offsetHeight,window.__glInstance=this},_createSubWindows:function(){var t,e;for(t=0;t<this.config.openPopouts.length;t++)e=this.config.openPopouts[t],this.createPopout(e.content,e.dimensions,e.parentId,e.indexInParent)},_setContainer:function(){var e=t(this.container||"body");if(0===e.length)throw new Error("GoldenLayout container not found");if(e.length>1)throw new Error("GoldenLayout more than one container element specified");e[0]===document.body&&(this._isFullPage=!0,t("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"})),this.container=e},_create:function(t){var n;if(!(t.content instanceof Array))throw n=void 0===t.content?"Missing setting 'content' on top level of configuration":"Configuration parameter 'content' must be an array",new e.errors.ConfigurationError(n,t);if(t.content.length>1)throw n="Top level content can't contain more then one element.",new e.errors.ConfigurationError(n,t);this.root=new e.items.Root(this,{content:t.content},this.container),this.root.callDownwards("_$init"),"__glMaximised"===t.maximisedItemId&&this.root.getItemsById(t.maximisedItemId)[0].toggleMaximise()},_onUnload:function(){if(this.config.settings.closePopoutsOnUnload===!0)for(var t=0;t<this.openPopouts.length;t++)this.openPopouts[t].close()}}),function(){"function"==typeof define&&define.amd?define(["jquery"],function(n){return t=n,e.LayoutManager}):"object"==typeof exports?module.exports=e.LayoutManager:window.GoldenLayout=e.LayoutManager}(),e.config.defaultConfig={openPopouts:[],settings:{hasHeaders:!0,constrainDragToContainer:!0,reorderEnabled:!0,selectionEnabled:!1,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,showPopoutIcon:!0,showMaximiseIcon:!0,showCloseIcon:!0},dimensions:{borderWidth:5,minItemHeight:10,minItemWidth:10,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200},labels:{close:"close",maximise:"maximise",minimise:"minimise",popout:"open in new window",popin:"pop in"}},e.config.itemDefaultConfig={isClosable:!0,reorderEnabled:!0,title:""},e.container.ItemContainer=function(n,i,o){e.utils.EventEmitter.call(this),this.width=null,this.height=null,this.title=n.componentName,this.parent=i,this.layoutManager=o,this.isHidden=!1,this._config=n,this._element=t(['<div class="lm_item_container">','<div class="lm_content"></div>',"</div>"].join("")),this._contentElement=this._element.find(".lm_content")},e.utils.copy(e.container.ItemContainer.prototype,{getElement:function(){return this._contentElement},hide:function(){this.emit("hide"),this.isHidden=!0,this._element.hide()},show:function(){this.emit("show"),this.isHidden=!1,this._element.show()},setSize:function(t,e){for(var n,i,o,r,s,a,l=this.parent,d=this;!l.isColumn&&!l.isRow;)if(d=l,l=l.parent,l.isRoot)return!1;for(o=l.isColumn?"height":"width",r="height"===o?e:t,n=this[o]*(1/(d.config[o]/100)),i=r/n*100,s=(d.config[o]-i)/l.contentItems.length,a=0;a<l.contentItems.length;a++)l.contentItems[a]===d?l.contentItems[a].config[o]=i:l.contentItems[a].config[o]+=s;return l.callDownwards("setSize"),!0},close:function(){this._config.isClosable&&(this.emit("close"),this.parent.close())},getState:function(){return this._config.componentState},extendState:function(e){this.setState(t.extend(!0,this.getState(),e))},setState:function(t){this._config.componentState=t,this.parent.emitBubblingEvent("stateChanged")},setTitle:function(t){this.parent.setTitle(t)},_$setSize:function(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this._contentElement.width(this.width).height(this.height),this.emit("resize"))}}),e.controls.BrowserPopout=function(t,n,i,o,r){e.utils.EventEmitter.call(this),this.isInitialised=!1,this._config=t,this._dimensions=n,this._parentId=i,this._indexInParent=o,this._layoutManager=r,this._popoutWindow=null,this._id=null,this._createWindow()},e.utils.copy(e.controls.BrowserPopout.prototype,{toConfig:function(){return{dimensions:{width:this.getGlInstance().width,height:this.getGlInstance().height,left:this._popoutWindow.screenX||this._popoutWindow.screenLeft,top:this._popoutWindow.screenY||this._popoutWindow.screenTop},content:this.getGlInstance().toConfig().content,parentId:this._parentId,indexInParent:this._indexInParent}},getGlInstance:function(){return this._popoutWindow.__glInstance},getWindow:function(){return this._popoutWindow},close:function(){if(this.getGlInstance())this.getGlInstance()._$closeWindow();else try{this.getWindow().close()}catch(t){}},popIn:function(){var e,n,i=this._indexInParent;this._parentId&&(e=t.extend(!0,{},this.getGlInstance().toConfig()).content[0],n=this._layoutManager.root.getItemsById(this._parentId)[0],n||(n=this._layoutManager.root.contentItems.length>0?this._layoutManager.root.contentItems[0]:this._layoutManager.root,i=0)),n.addChild(e,this._indexInParent),this.close()},_createWindow:function(){var n,i=this._createUrl(),o=Math.floor(1e6*Math.random()).toString(36),r=this._serializeWindowOptions({width:this._dimensions.width,height:this._dimensions.height,innerWidth:this._dimensions.width,innerHeight:this._dimensions.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=window.open(i,o,r),this._popoutWindow)t(this._popoutWindow).on("load",e.utils.fnBind(this._positionWindow,this)).on("unload beforeunload",e.utils.fnBind(this._onClose,this)),n=setInterval(e.utils.fnBind(function(){this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this._onInitialised(),clearInterval(n))},this),10);else if(this._layoutManager.config.settings.blockedPopoutsThrowError===!0){var s=new Error("Popout blocked");throw s.type="popoutBlocked",s}},_serializeWindowOptions:function(t){var e,n=[];for(e in t)n.push(e+"="+t[e]);return n.join(",")},_createUrl:function(){var t,n={content:this._config},i="gl-window-config-"+e.utils.getUniqueId();n=(new e.utils.ConfigMinifier).minifyConfig(n);try{localStorage.setItem(i,JSON.stringify(n))}catch(t){throw new Error("Error while writing to localStorage "+t.toString())}return t=document.location.href.split("?"),1===t.length?t[0]+"?gl-window="+i:document.location.href+"&gl-window="+i},_positionWindow:function(){this._popoutWindow.moveTo(this._dimensions.left,this._dimensions.top),this._popoutWindow.focus()},_onInitialised:function(){this.isInitialised=!0,this.getGlInstance().on("popIn",this.popIn,this),this.emit("initialised")},_onClose:function(){setTimeout(e.utils.fnBind(this.emit,this,["closed"]),50)}}),e.controls.DragProxy=function(n,i,o,r,s,a){e.utils.EventEmitter.call(this),this._dragListener=o,this._layoutManager=r,this._contentItem=s,this._originalParent=a,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",this._onDrag,this),this._dragListener.on("dragStop",this._onDrop,this),this.element=t(e.controls.DragProxy._template),this.element.css({left:n,top:i}),this.element.find(".lm_title").html(this._contentItem.config.title),this.childElementContainer=this.element.find(".lm_content"),this.childElementContainer.append(s.element),this._updateTree(),this._layoutManager._$calculateItemAreas(),this._setDimensions(),t(document.body).append(this.element);var l=this._layoutManager.container.offset();this._minX=l.left,this._minY=l.top,this._maxX=this._layoutManager.container.width()+this._minX,this._maxY=this._layoutManager.container.height()+this._minY,this._width=this.element.width(),this._height=this.element.height()},e.controls.DragProxy._template='<div class="lm_dragProxy"><div class="lm_header"><ul class="lm_tabs"><li class="lm_tab lm_active"><i class="lm_left"></i><span class="lm_title"></span><i class="lm_right"></i></li></ul></div><div class="lm_content"></div></div>',e.utils.copy(e.controls.DragProxy.prototype,{_onDrag:function(t,e,n){var i=n.pageX,o=n.pageY,r=i>this._minX&&i<this._maxX&&o>this._minY&&o<this._maxY;(r||this._layoutManager.config.settings.constrainDragToContainer!==!0)&&(this.element.css({left:i,top:o}),this._area=this._layoutManager._$getArea(i,o),null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem._$highlightDropZone(i,o,this._area)))},_onDrop:function(){this._layoutManager.dropTargetIndicator.hide(),null!==this._area?this._area.contentItem._$onDrop(this._contentItem):null!==this._lastValidArea?this._lastValidArea.contentItem._$onDrop(this._contentItem):this._originalParent&&this._originalParent.addChild(this._contentItem),this.element.remove()},_updateTree:function(){this._contentItem.parent&&this._contentItem.parent.removeChild(this._contentItem,!0),this._contentItem._$setParent(this)},_setDimensions:function(){var t=this._layoutManager.config.dimensions,e=t.dragProxyWidth,n=t.dragProxyHeight-t.headerHeight;this.childElementContainer.width(e),this.childElementContainer.height(n),this._contentItem.element.width(e),this._contentItem.element.height(n),this._contentItem.callDownwards("_$show"),this._contentItem.callDownwards("setSize")}}),e.controls.DragSource=function(t,e,n){this._element=t,this._itemConfig=e,this._layoutManager=n,this._dragListener=null,this._createDragListener()},e.utils.copy(e.controls.DragSource.prototype,{_createDragListener:function(){null!==this._dragListener&&this._dragListener.destroy(),this._dragListener=new e.utils.DragListener(this._element),this._dragListener.on("dragStart",this._onDragStart,this),this._dragListener.on("dragStop",this._createDragListener,this)},_onDragStart:function(t,n){var i=this._layoutManager._$normalizeContentItem(this._itemConfig),o=new e.controls.DragProxy(t,n,this._dragListener,this._layoutManager,i,null);this._layoutManager.transitionIndicator.transitionElements(this._element,o.element)}}),e.controls.DropTargetIndicator=function(){this.element=t(e.controls.DropTargetIndicator._template),t(document.body).append(this.element)},e.controls.DropTargetIndicator._template='<div class="lm_dropTargetIndicator"><div class="lm_inner"></div></div>',e.utils.copy(e.controls.DropTargetIndicator.prototype,{destroy:function(){this.element.remove()},highlight:function(t,e,n,i){this.highlightArea({x1:t,y1:e,x2:n,y2:i})},highlightArea:function(t){this.element.css({left:t.x1,top:t.y1,width:t.x2-t.x1,height:t.y2-t.y1}).show()},hide:function(){this.element.hide()}}),e.controls.Header=function(n,i){e.utils.EventEmitter.call(this),this.layoutManager=n,this.element=t(e.controls.Header._template),
this.layoutManager.config.settings.selectionEnabled===!0&&(this.element.addClass("lm_selectable"),this.element.click(e.utils.fnBind(this._onHeaderClick,this))),this.element.height(n.config.dimensions.headerHeight),this.tabsContainer=this.element.find(".lm_tabs"),this.controlsContainer=this.element.find(".lm_controls"),this.parent=i,this.parent.on("resize",this._updateTabSizes,this),this.tabs=[],this.activeContentItem=null,this._createControls()},e.controls.Header._template=['<div class="lm_header">','<ul class="lm_tabs"></ul>','<ul class="lm_controls"></ul>',"</div>"].join(""),e.utils.copy(e.controls.Header.prototype,{createTab:function(t,n){var i,o;for(o=0;o<this.tabs.length;o++)if(this.tabs[o].contentItem===t)return;return i=new e.controls.Tab(this,t),0===this.tabs.length?(this.tabs.push(i),void this.tabsContainer.append(i.element)):(void 0===n&&(n=this.tabs.length),n>0?this.tabs[n-1].element.after(i.element):this.tabs[0].element.before(i.element),this.tabs.splice(n,0,i),void this._updateTabSizes())},removeTab:function(t){for(var e=0;e<this.tabs.length;e++)if(this.tabs[e].contentItem===t)return this.tabs[e]._$destroy(),void this.tabs.splice(e,1);throw new Error("contentItem is not controlled by this header")},setActiveContentItem:function(t){var e,n;for(e=0;e<this.tabs.length;e++)n=this.tabs[e].contentItem===t,this.tabs[e].setActive(n),n===!0&&(this.activeContentItem=t,this.parent.config.activeItemIndex=e);this._updateTabSizes(),this.parent.emitBubblingEvent("stateChanged")},_$destroy:function(){this.emit("destroy");for(var t=0;t<this.tabs.length;t++)this.tabs[t]._$destroy();this.element.remove()},_createControls:function(){var t,n,i,o,r,s,a;this.layoutManager.config.settings.showPopoutIcon&&(n=e.utils.fnBind(this._onPopoutClick,this),i=this.layoutManager.config.labels.popout,new e.controls.HeaderButton(this,i,"lm_popout",n)),this.layoutManager.config.settings.showMaximiseIcon&&(s=e.utils.fnBind(this.parent.toggleMaximise,this.parent),o=this.layoutManager.config.labels.maximise,r=this.layoutManager.config.labels.minimise,a=new e.controls.HeaderButton(this,o,"lm_maximise",s),this.parent.on("maximised",function(){a.element.attr("title",r)}),this.parent.on("minimised",function(){a.element.attr("title",o)})),this.parent.config.isClosable&&this.layoutManager.config.settings.showCloseIcon&&(t=e.utils.fnBind(this.parent.remove,this.parent),i=this.layoutManager.config.labels.close,new e.controls.HeaderButton(this,i,"lm_close",t))},_onPopoutClick:function(){this.layoutManager.config.settings.popoutWholeStack===!0?this.parent.popout():this.activeContentItem.popout()},_onHeaderClick:function(t){t.target===this.element[0]&&this.parent.select()},_updateTabSizes:function(){if(0!==this.tabs.length){var t,e,n,i,o=this.element.outerWidth()-this.controlsContainer.outerWidth(),r=0;for(e=0;e<this.tabs.length;e++)t=this.tabs[e].element,t.css("z-index",this.tabs.length-e),r+=t.outerWidth()+parseInt(t.css("margin-right"),10);for(i=(r-o)/(this.tabs.length-1),e=0;e<this.tabs.length;e++)n=!this.tabs[e].isActive&&i>0?"-"+Math.floor(i)+"px":"",this.tabs[e].element.css("margin-left",n);r>o?this.element.css("overflow","hidden"):this.element.css("overflow","visible")}}}),e.controls.HeaderButton=function(e,n,i,o){this._header=e,this.element=t('<li class="'+i+'" title="'+n+'"></li>'),this._header.on("destroy",this._$destroy,this),this._action=o,this.element.click(this._action),this._header.controlsContainer.append(this.element)},e.utils.copy(e.controls.HeaderButton.prototype,{_$destroy:function(){this.element.off(),this.element.remove()}}),e.controls.Splitter=function(t,n){this._isVertical=t,this._size=n,this.element=this._createElement(),this._dragListener=new e.utils.DragListener(this.element)},e.utils.copy(e.controls.Splitter.prototype,{on:function(t,e,n){this._dragListener.on(t,e,n)},_$destroy:function(){this.element.remove()},_createElement:function(){var e=t('<div class="lm_splitter"><div class="lm_drag_handle"></div></div>');return e.addClass("lm_"+(this._isVertical?"vertical":"horizontal")),e[this._isVertical?"height":"width"](this._size),e}}),e.controls.Tab=function(n,i){this.header=n,this.contentItem=i,this.element=t(e.controls.Tab._template),this.titleElement=this.element.find(".lm_title"),this.closeElement=this.element.find(".lm_close_tab"),this.closeElement[i.config.isClosable?"show":"hide"](),this.isActive=!1,this.setTitle(i.config.title),this.contentItem.on("titleChanged",this.setTitle,this),this._layoutManager=this.contentItem.layoutManager,this._layoutManager.config.settings.reorderEnabled===!0&&i.config.reorderEnabled===!0&&(this._dragListener=new e.utils.DragListener(this.element),this._dragListener.on("dragStart",this._onDragStart,this)),this._onTabClickFn=e.utils.fnBind(this._onTabClick,this),this._onCloseClickFn=e.utils.fnBind(this._onCloseClick,this),this.element.click(this._onTabClickFn),this._layoutManager.config.settings.showCloseIcon===!0?this.closeElement.click(this._onCloseClickFn):this.closeElement.remove(),this.contentItem.tab=this,this.contentItem.emit("tab",this),this.contentItem.layoutManager.emit("tabCreated",this),this.contentItem.isComponent&&(this.contentItem.container.tab=this,this.contentItem.container.emit("tab",this))},e.controls.Tab._template='<li class="lm_tab"><i class="lm_left"></i><span class="lm_title"></span><div class="lm_close_tab"></div><i class="lm_right"></i></li>',e.utils.copy(e.controls.Tab.prototype,{setTitle:function(t){this.element.attr("title",e.utils.stripTags(t)),this.titleElement.html(t)},setActive:function(t){t!==this.isActive&&(this.isActive=t,t?this.element.addClass("lm_active"):this.element.removeClass("lm_active"))},_$destroy:function(){this.element.off("click",this._onTabClickFn),this.closeElement.off("click",this._onCloseClickFn),this.element.remove()},_onDragStart:function(t,n){this.contentItem.parent.isMaximised===!0&&this.contentItem.parent.toggleMaximise(),new e.controls.DragProxy(t,n,this._dragListener,this._layoutManager,this.contentItem,this.header.parent)},_onTabClick:function(t){0===t.button?this.header.parent.setActiveContentItem(this.contentItem):1===t.button&&this.contentItem.config.isClosable&&this._onCloseClick(t)},_onCloseClick:function(t){t.stopPropagation(),this.header.parent.removeChild(this.contentItem)}}),e.controls.TransitionIndicator=function(){this._element=t('<div class="lm_transition_indicator"></div>'),t(document.body).append(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null},e.utils.copy(e.controls.TransitionIndicator.prototype,{destroy:function(){this._element.remove()},transitionElements:function(t,e){},_nextAnimationFrame:function(){var t,n=this._measure(this._toElement),i=(e.utils.now()-this._animationStartTime)/this._totalAnimationDuration,o={};if(i>=1)return void this._element.hide();n.opacity=0;for(t in this._fromDimensions)o[t]=this._fromDimensions[t]+(n[t]-this._fromDimensions[t])*i;this._element.css(o),e.utils.animFrame(e.utils.fnBind(this._nextAnimationFrame,this))},_measure:function(t){var e=t.offset();return{left:e.left,top:e.top,width:t.outerWidth(),height:t.outerHeight()}}}),e.errors.ConfigurationError=function(t,e){Error.call(this),this.name="Configuration Error",this.message=t,this.node=e},e.errors.ConfigurationError.prototype=new Error,e.items.AbstractContentItem=function(t,n,i){e.utils.EventEmitter.call(this),this.config=this._extendItemNode(n),this.type=n.type,this.contentItems=[],this.parent=i,this.isInitialised=!1,this.isMaximised=!1,this.isRoot=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.layoutManager=t,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this.on(e.utils.EventEmitter.ALL_EVENT,this._propagateEvent,this),n.content&&this._createContentItems(n)},e.utils.copy(e.items.AbstractContentItem.prototype,{setSize:function(){throw new Error("Abstract Method")},callDownwards:function(t,e,n,i){var o;for(n!==!0&&i!==!0&&this[t].apply(this,e||[]),o=0;o<this.contentItems.length;o++)this.contentItems[o].callDownwards(t,e,n);n===!0&&i!==!0&&this[t].apply(this,e||[])},removeChild:function(t,n){var i=e.utils.indexOf(t,this.contentItems);if(-1===i)throw new Error("Can't remove child item. Unknown content item");n!==!0&&this.contentItems[i]._$destroy(),this.contentItems.splice(i,1),this.config.content.splice(i,1),this.contentItems.length>0?this.callDownwards("setSize"):this instanceof e.items.Root||this.config.isClosable!==!0||this.parent.removeChild(this)},addChild:function(t,e){void 0===e&&(e=this.contentItems.length),this.contentItems.splice(e,0,t),void 0===this.config.content&&(this.config.content=[]),this.config.content.splice(e,0,t.config),t.parent=this,t.parent.isInitialised===!0&&t.isInitialised===!1&&t._$init()},replaceChild:function(t,n,i){n=this.layoutManager._$normalizeContentItem(n);var o=e.utils.indexOf(t,this.contentItems),r=t.element[0].parentNode;if(-1===o)throw new Error("Can't replace child. oldChild is not child of this");r.replaceChild(n.element[0],t.element[0]),i===!0&&(t.parent=null,t._$destroy()),this.contentItems[o]=n,n.parent=this,n.parent.isInitialised===!0&&n.isInitialised===!1&&n._$init(),this.callDownwards("setSize")},remove:function(){this.parent.removeChild(this)},popout:function(){var t=this.layoutManager.createPopout(this);return this.emitBubblingEvent("stateChanged"),t},toggleMaximise:function(){this.isMaximised===!0?this.layoutManager._$minimiseItem(this):this.layoutManager._$maximiseItem(this),this.isMaximised=!this.isMaximised,this.emitBubblingEvent("stateChanged")},select:function(){this.layoutManager.selectedItem!==this&&(this.layoutManager.selectItem(this,!0),this.element.addClass("lm_selected"))},deselect:function(){this.layoutManager.selectedItem===this&&(this.layoutManager.selectedItem=null,this.element.removeClass("lm_selected"))},setTitle:function(t){this.config.title=t,this.emit("titleChanged",t),this.emit("stateChanged")},hasId:function(t){return!!this.config.id&&("string"==typeof this.config.id?this.config.id===t:this.config.id instanceof Array?-1!==e.utils.indexOf(t,this.config.id):void 0)},addId:function(t){this.hasId(t)||(this.config.id?"string"==typeof this.config.id?this.config.id=[this.config.id,t]:this.config.id instanceof Array&&this.config.id.push(t):this.config.id=t)},removeId:function(t){if(!this.hasId(t))throw new Error("Id not found");if("string"==typeof this.config.id)delete this.config.id;else if(this.config.id instanceof Array){var n=e.utils.indexOf(t,this.config.id);this.config.id.splice(n,1)}},getItemsByFilter:function(t){var e=[],n=function(i){for(var o=0;o<i.contentItems.length;o++)t(i.contentItems[o])===!0&&e.push(i.contentItems[o]),n(i.contentItems[o])};return n(this),e},getItemsById:function(t){return this.getItemsByFilter(function(n){return n.config.id instanceof Array?-1!==e.utils.indexOf(t,n.config.id):n.config.id===t})},getItemsByType:function(t){return this._$getItemsByProperty("type",t)},getComponentsByName:function(t){var e,n=this._$getItemsByProperty("componentName",t),i=[];for(e=0;e<n.length;e++)i.push(n[e].instance);return i},_$getItemsByProperty:function(t,e){return this.getItemsByFilter(function(n){return n[t]===e})},_$setParent:function(t){this.parent=t},_$highlightDropZone:function(t,e,n){this.layoutManager.dropTargetIndicator.highlightArea(n)},_$onDrop:function(t){this.addChild(t)},_$hide:function(){this._callOnActiveComponents("hide"),this.element.hide(),this.layoutManager.updateSize()},_$show:function(){this._callOnActiveComponents("show"),this.element.show(),this.layoutManager.updateSize()},_callOnActiveComponents:function(t){var e,n,i=this.getItemsByType("stack");for(n=0;n<i.length;n++)e=i[n].getActiveContentItem(),e&&e.isComponent&&e.container[t]()},_$destroy:function(){this.emitBubblingEvent("beforeItemDestroyed"),this.callDownwards("_$destroy",[],!0,!0),this.element.remove(),this.emitBubblingEvent("itemDestroyed")},_$getArea:function(t){t=t||this.element;var e=t.offset(),n=t.width(),i=t.height();return{x1:e.left,y1:e.top,x2:e.left+n,y2:e.top+i,surface:n*i,contentItem:this}},_$init:function(){var t;for(this.setSize(),t=0;t<this.contentItems.length;t++)this.childElementContainer.append(this.contentItems[t].element);this.isInitialised=!0,this.emitBubblingEvent("itemCreated"),this.emitBubblingEvent(this.type+"Created")},emitBubblingEvent:function(t){var n=new e.utils.BubblingEvent(t,this);this.emit(t,n)},_createContentItems:function(t){var n,i;if(!(t.content instanceof Array))throw new e.errors.ConfigurationError("content must be an Array",t);for(i=0;i<t.content.length;i++)n=this.layoutManager.createContentItem(t.content[i],this),this.contentItems.push(n)},_extendItemNode:function(t){for(var n in e.config.itemDefaultConfig)void 0===t[n]&&(t[n]=e.config.itemDefaultConfig[n]);return t},_propagateEvent:function(t,n){n instanceof e.utils.BubblingEvent&&n.isPropagationStopped===!1&&this.isInitialised===!0&&(this.isRoot===!1&&this.parent?this.parent.emit.apply(this.parent,Array.prototype.slice.call(arguments,0)):this._scheduleEventPropagationToLayoutManager(t,n))},_scheduleEventPropagationToLayoutManager:function(t,n){-1===e.utils.indexOf(t,this._throttledEvents)?this.layoutManager.emit(t,n.origin):this._pendingEventPropagations[t]!==!0&&(this._pendingEventPropagations[t]=!0,e.utils.animFrame(e.utils.fnBind(this._propagateEventToLayoutManager,this,[t,n])))},_propagateEventToLayoutManager:function(t,e){this._pendingEventPropagations[t]=!1,this.layoutManager.emit(t,e)}}),e.items.Component=function(n,i,o){e.items.AbstractContentItem.call(this,n,i,o);var r=n.getComponent(this.config.componentName),s=t.extend(!0,{},this.config.componentState||{});s.componentName=this.config.componentName,this.componentName=this.config.componentName,""===this.config.title&&(this.config.title=this.config.componentName),this.isComponent=!0,this.container=new e.container.ItemContainer(this.config,this,n),this.instance=new r(this.container,s),this.element=this.container._element},e.utils.extend(e.items.Component,e.items.AbstractContentItem),e.utils.copy(e.items.Component.prototype,{close:function(){this.parent.removeChild(this)},setSize:function(){this.container._$setSize(this.element.width(),this.element.height())},_$init:function(){e.items.AbstractContentItem.prototype._$init.call(this),this.container.emit("open")},_$hide:function(){this.container.hide(),e.items.AbstractContentItem.prototype._$hide.call(this)},_$show:function(){this.container.show(),e.items.AbstractContentItem.prototype._$show.call(this)},_$destroy:function(){this.container.emit("destroy"),e.items.AbstractContentItem.prototype._$destroy.call(this)},_$getArea:function(){return null}}),e.items.Root=function(n,i,o){e.items.AbstractContentItem.call(this,n,i,null),this.isRoot=!0,this.type="root",this.element=t('<div class="lm_goldenlayout lm_item lm_root"></div>'),this.childElementContainer=this.element,this._containerElement=o,this._containerElement.append(this.element)},e.utils.extend(e.items.Root,e.items.AbstractContentItem),e.utils.copy(e.items.Root.prototype,{addChild:function(t){if(this.contentItems.length>0)throw new Error("Root node can only have a single child");t=this.layoutManager._$normalizeContentItem(t,this),this.childElementContainer.append(t.element),e.items.AbstractContentItem.prototype.addChild.call(this,t),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(){var t=this._containerElement.width(),e=this._containerElement.height();this.element.width(t),this.element.height(e),this.contentItems[0]&&(this.contentItems[0].element.width(t),this.contentItems[0].element.height(e))},_$onDrop:function(t){var e;t.isComponent===!0?(e=this.layoutManager.createContentItem({type:"stack"},this),e.addChild(t),this.addChild(e)):this.addChild(t)}}),e.items.RowOrColumn=function(n,i,o,r){e.items.AbstractContentItem.call(this,i,o,r),this.isRow=!n,this.isColumn=n,this.element=t('<div class="lm_item lm_'+(n?"column":"row")+'"></div>'),this.childElementContainer=this.element,this._splitterSize=i.config.dimensions.borderWidth,this._isColumn=n,this._dimension=n?"height":"width",this._splitter=[],this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null},e.utils.extend(e.items.RowOrColumn,e.items.AbstractContentItem),e.utils.copy(e.items.RowOrColumn.prototype,{addChild:function(t,n,i){var o,r,s,a;if(t=this.layoutManager._$normalizeContentItem(t,this),void 0===n&&(n=this.contentItems.length),this.contentItems.length>0?(a=this._createSplitter(Math.max(0,n-1)).element,n>0?(this.contentItems[n-1].element.after(a),a.after(t.element)):(this.contentItems[0].element.before(a),a.before(t.element))):this.childElementContainer.append(t.element),e.items.AbstractContentItem.prototype.addChild.call(this,t,n),o=1/this.contentItems.length*100,i===!0)return void this.emitBubblingEvent("stateChanged");for(s=0;s<this.contentItems.length;s++)this.contentItems[s]===t?t.config[this._dimension]=o:(r=this.contentItems[s].config[this._dimension]*=(100-o)/100,this.contentItems[s].config[this._dimension]=r);this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},removeChild:function(t,n){var i,o,r=t.config[this._dimension],s=e.utils.indexOf(t,this.contentItems),a=Math.max(s-1,0);if(-1===s)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");for(this._splitter[a]&&(this._splitter[a]._$destroy(),this._splitter.splice(a,1)),i=0;i<this.contentItems.length;i++)this.contentItems[i]!==t&&(this.contentItems[i].config[this._dimension]+=r/(this.contentItems.length-1));e.items.AbstractContentItem.prototype.removeChild.call(this,t,n),1===this.contentItems.length&&this.config.isClosable===!0?(o=this.contentItems[0],this.contentItems=[],this.parent.replaceChild(this,o,!0)):(this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged"))},replaceChild:function(t,n){var i=t.config[this._dimension];e.items.AbstractContentItem.prototype.replaceChild.call(this,t,n),n.config[this._dimension]=i,this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},setSize:function(){this.contentItems.length>0&&(this._calculateRelativeSizes(),this._setAbsoluteSizes()),this.emitBubblingEvent("stateChanged"),this.emit("resize")},_$init:function(){if(this.isInitialised!==!0){var t;for(e.items.AbstractContentItem.prototype._$init.call(this),t=0;t<this.contentItems.length-1;t++)this.contentItems[t].element.after(this._createSplitter(t).element)}},_setAbsoluteSizes:function(){var t,e,n,i=(this.contentItems.length-1)*this._splitterSize,o=this.element.width(),r=this.element.height(),s=0,a=[];for(this._isColumn?r-=i:o-=i,t=0;t<this.contentItems.length;t++)n=this._isColumn?Math.floor(r*(this.contentItems[t].config.height/100)):Math.floor(o*(this.contentItems[t].config.width/100)),s+=n,a.push(n);for(e=(this._isColumn?r:o)-s,t=0;t<this.contentItems.length;t++)e-t>0&&a[t]++,this._isColumn?(this.contentItems[t].element.width(o),this.contentItems[t].element.height(a[t])):(this.contentItems[t].element.width(a[t]),this.contentItems[t].element.height(r))},_calculateRelativeSizes:function(){var t,e=0,n=[],i=this._isColumn?"height":"width";for(t=0;t<this.contentItems.length;t++)void 0!==this.contentItems[t].config[i]?e+=this.contentItems[t].config[i]:n.push(this.contentItems[t]);if(100!==Math.round(e))if(Math.round(e)<100&&n.length>0)for(t=0;t<n.length;t++)n[t].config[i]=(100-e)/n.length;else{if(Math.round(e)>100)for(t=0;t<n.length;t++)n[t].config[i]=50,e+=50;for(t=0;t<this.contentItems.length;t++)this.contentItems[t].config[i]=this.contentItems[t].config[i]/e*100}},_createSplitter:function(t){var n;return n=new e.controls.Splitter(this._isColumn,this._splitterSize),n.on("drag",e.utils.fnBind(this._onSplitterDrag,this,[n]),this),n.on("dragStop",e.utils.fnBind(this._onSplitterDragStop,this,[n]),this),n.on("dragStart",e.utils.fnBind(this._onSplitterDragStart,this,[n]),this),this._splitter.splice(t,0,n),n},_getItemsForSplitter:function(t){var n=e.utils.indexOf(t,this._splitter);return{before:this.contentItems[n],after:this.contentItems[n+1]}},_onSplitterDragStart:function(t){var e=this._getItemsForSplitter(t),n=this.layoutManager.config.dimensions[this._isColumn?"minItemHeight":"minItemWidth"];this._splitterPosition=0,this._splitterMinPosition=-1*(e.before.element[this._dimension]()-n),this._splitterMaxPosition=e.after.element[this._dimension]()-n},_onSplitterDrag:function(t,e,n){var i=this._isColumn?n:e;i>this._splitterMinPosition&&i<this._splitterMaxPosition&&(this._splitterPosition=i,t.element.css(this._isColumn?"top":"left",i))},_onSplitterDragStop:function(t){var n=this._getItemsForSplitter(t),i=n.before.element[this._dimension](),o=n.after.element[this._dimension](),r=(this._splitterPosition+i)/(i+o),s=n.before.config[this._dimension]+n.after.config[this._dimension];n.before.config[this._dimension]=r*s,n.after.config[this._dimension]=(1-r)*s,t.element.css({top:0,left:0}),e.utils.animFrame(e.utils.fnBind(this.callDownwards,this,["setSize"]))}}),e.items.Stack=function(n,i,o){e.items.AbstractContentItem.call(this,n,i,o),this.element=t('<div class="lm_item lm_stack"></div>'),this._activeContentItem=null,this._dropZones={},this._dropSegment=null,this._contentAreaDimensions=null,this._dropIndex=null,this.isStack=!0,this.childElementContainer=t('<div class="lm_items"></div>'),this.header=new e.controls.Header(n,this),n.config.settings.hasHeaders===!0&&this.element.append(this.header.element),this.element.append(this.childElementContainer)},e.utils.extend(e.items.Stack,e.items.AbstractContentItem),e.utils.copy(e.items.Stack.prototype,{setSize:function(){var t,e=this.element.width(),n=this.element.height()-this.layoutManager.config.dimensions.headerHeight;for(this.childElementContainer.width(e),this.childElementContainer.height(n),t=0;t<this.contentItems.length;t++)this.contentItems[t].element.width(e).height(n);this.emit("resize"),this.emitBubblingEvent("stateChanged")},_$init:function(){var t,n;if(this.isInitialised!==!0){for(e.items.AbstractContentItem.prototype._$init.call(this),t=0;t<this.contentItems.length;t++)this.header.createTab(this.contentItems[t]),this.contentItems[t]._$hide();if(this.contentItems.length>0){if(n=this.contentItems[this.config.activeItemIndex||0],!n)throw new Error("Configured activeItemIndex out of bounds");this.setActiveContentItem(n)}}},setActiveContentItem:function(t){if(-1===e.utils.indexOf(t,this.contentItems))throw new Error("contentItem is not a child of this stack");null!==this._activeContentItem&&this._activeContentItem._$hide(),this._activeContentItem=t,this.header.setActiveContentItem(t),t._$show(),this.emit("activeContentItemChanged",t),this.emitBubblingEvent("stateChanged")},getActiveContentItem:function(){return this.header.activeContentItem},addChild:function(t,n){t=this.layoutManager._$normalizeContentItem(t,this),e.items.AbstractContentItem.prototype.addChild.call(this,t,n),this.childElementContainer.append(t.element),this.header.createTab(t,n),this.setActiveContentItem(t),this.callDownwards("setSize"),this.emitBubblingEvent("stateChanged")},removeChild:function(t,n){var i=e.utils.indexOf(t,this.contentItems);e.items.AbstractContentItem.prototype.removeChild.call(this,t,n),this.header.removeTab(t),this.contentItems.length>0?this.setActiveContentItem(this.contentItems[Math.max(i-1,0)]):this._activeContentItem=null,this.emitBubblingEvent("stateChanged")},_$destroy:function(){e.items.AbstractContentItem.prototype._$destroy.call(this),this.header._$destroy()},_$onDrop:function(t){if("header"===this._dropSegment)return this._resetHeaderDropZone(),void this.addChild(t,this._dropIndex);if("body"===this._dropSegment)return void this.addChild(t);var n,i,o,r="top"===this._dropSegment||"bottom"===this._dropSegment,s="left"===this._dropSegment||"right"===this._dropSegment,a="top"===this._dropSegment||"left"===this._dropSegment,l=r&&this.parent.isColumn||s&&this.parent.isRow,d=r?"column":"row",c=r?"height":"width";t.isComponent&&(i=this.layoutManager.createContentItem({type:"stack"},this),i._$init(),i.addChild(t),t=i),l?(n=e.utils.indexOf(this,this.parent.contentItems),this.parent.addChild(t,a?n:n+1,!0),this.config[c]*=.5,t.config[c]=this.config[c],this.parent.callDownwards("setSize")):(d=r?"column":"row",o=this.layoutManager.createContentItem({type:d},this),this.parent.replaceChild(this,o),o.addChild(t,a?0:void 0,!0),o.addChild(this,a?void 0:0,!0),this.config[c]=50,t.config[c]=50,o.callDownwards("setSize"))},_$highlightDropZone:function(t,e){var n,i;for(n in this._contentAreaDimensions)if(i=this._contentAreaDimensions[n].hoverArea,i.x1<t&&i.x2>t&&i.y1<e&&i.y2>e)return void("header"===n?(this._dropSegment="header",this._highlightHeaderDropZone(t)):(this._resetHeaderDropZone(),this._highlightBodyDropZone(n)))},_$getArea:function(){if(this.element.is(":visible")===!1)return null;var t=e.items.AbstractContentItem.prototype._$getArea,n=t.call(this,this.header.element),i=t.call(this,this.childElementContainer),o=i.x2-i.x1,r=i.y2-i.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2},highlightArea:{x1:n.x1,y1:n.y1,x2:n.x2,y2:n.y2}}},this._activeContentItem&&this._activeContentItem.isComponent===!1?n:0===this.contentItems.length?(this._contentAreaDimensions.body={hoverArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2}},t.call(this,this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:i.x1,y1:i.y1,x2:i.x1+.25*o,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x1+.5*o,y2:i.y2}},this._contentAreaDimensions.top={hoverArea:{x1:i.x1+.25*o,y1:i.y1,x2:i.x1+.75*o,y2:i.y1+.5*r},highlightArea:{x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y1+.5*r}},this._contentAreaDimensions.right={hoverArea:{x1:i.x1+.75*o,y1:i.y1,x2:i.x2,y2:i.y2},highlightArea:{x1:i.x1+.5*o,y1:i.y1,x2:i.x2,y2:i.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:i.x1+.25*o,y1:i.y1+.5*r,x2:i.x1+.75*o,y2:i.y2},highlightArea:{x1:i.x1,y1:i.y1+.5*r,x2:i.x2,y2:i.y2}},t.call(this,this.element))},_highlightHeaderDropZone:function(t){var e,n,i,o,r,s,a,l,d,c=this.header.tabs.length,h=!1;if(0===c)return a=this.header.element.offset(),void this.layoutManager.dropTargetIndicator.highlightArea({x1:a.left,x2:a.left+100,y1:a.top+this.header.element.height()-20,y2:a.top+this.header.element.height()});for(e=0;c>e;e++)if(n=this.header.tabs[e].element,r=n.offset(),o=r.left,i=r.top,l=n.width(),t>o&&o+l>t){h=!0;break}h===!1&&o>t||(d=o+l/2,d>t?(this._dropIndex=e,n.before(this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(e+1,c),n.after(this.layoutManager.tabDropPlaceholder)),s=this.layoutManager.tabDropPlaceholder.offset().left,this.layoutManager.dropTargetIndicator.highlightArea({x1:s,x2:s+this.layoutManager.tabDropPlaceholder.width(),y1:i,y2:i+n.innerHeight()}))},_resetHeaderDropZone:function(){this.layoutManager.tabDropPlaceholder.remove()},_highlightBodyDropZone:function(t){var e=this._contentAreaDimensions[t].highlightArea;this.layoutManager.dropTargetIndicator.highlightArea(e),this._dropSegment=t}}),e.utils.BubblingEvent=function(t,e){this.name=t,this.origin=e,this.isPropagationStopped=!1},e.utils.BubblingEvent.prototype.stopPropagation=function(){this.isPropagationStopped=!0},e.utils.ConfigMinifier=function(){this._keys=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentName","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled"],this._values=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"]},e.utils.copy(e.utils.ConfigMinifier.prototype,{minifyConfig:function(t){var e={};return this._nextLevel(t,e,"_min"),e},unminifyConfig:function(t){var e={};return this._nextLevel(t,e,"_max"),e},_nextLevel:function(t,e,n){var i,o;for(i in t)t instanceof Array&&(i=parseInt(i,10)),t.hasOwnProperty(i)&&(o=this[n](i,this._keys),"object"==typeof t[i]?(e[o]=t[i]instanceof Array?[]:{},this._nextLevel(t[i],e[o],n)):e[o]=this[n](t[i],this._values))},_min:function(t,n){if("string"==typeof t&&1===t.length)return"___"+t;var i=e.utils.indexOf(t,n);return-1===i?t:i.toString(36)},_max:function(t,e){return"string"==typeof t&&1===t.length?e[parseInt(t,36)]:"string"==typeof t&&"___"===t.substr(0,3)?t[3]:t}}),e.utils.EventHub=function(n){e.utils.EventEmitter.call(this),this._layoutManager=n,this._dontPropagateToParent=null,this._childEventSource=null,this.on(e.utils.EventEmitter.ALL_EVENT,e.utils.fnBind(this._onEventFromThis,this)),t(window).on("gl_child_event",e.utils.fnBind(this._onEventFromChild,this))},e.utils.EventHub.prototype._onEventFromThis=function(){var t=Array.prototype.slice.call(arguments);this._layoutManager.isSubWindow&&t[0]!==this._dontPropagateToParent&&this._propagateToParent(t),this._propagateToChildren(t),this._dontPropagateToParent=null,this._childEventSource=null},e.utils.EventHub.prototype._$onEventFromParent=function(t){this._dontPropagateToParent=t[0],this.emit.apply(this,t)},e.utils.EventHub.prototype._onEventFromChild=function(t){this._childEventSource=t.originalEvent.__gl,this.emit.apply(this,t.originalEvent.__glArgs)},e.utils.EventHub.prototype._propagateToParent=function(t){var e,n="gl_child_event";document.createEvent?(e=window.opener.document.createEvent("HTMLEvents"),e.initEvent(n,!0,!0)):(e=window.opener.document.createEventObject(),e.eventType=n),e.eventName=n,e.__glArgs=t,e.__gl=this._layoutManager,document.createEvent?window.opener.dispatchEvent(e):window.opener.fireEvent("on"+e.eventType,e)},e.utils.EventHub.prototype._propagateToChildren=function(t){var e,n;for(n=0;n<this._layoutManager.openPopouts.length;n++)e=this._layoutManager.openPopouts[n].getGlInstance(),e!==this._childEventSource&&e.eventHub._$onEventFromParent(t)},e.utils.ReactComponentHandler=function(t,e){this._reactComponent=null,this._originalComponentWillUpdate=null,this._container=t,this._initialState=e,this._reactClass=this._getReactClass(),this._container.on("open",this._render,this),this._container.on("destroy",this._destroy,this)},e.utils.copy(e.utils.ReactComponentHandler.prototype,{_render:function(){this._reactComponent=ReactDOM.render(this._getReactComponent(),this._container.getElement()[0]),this._originalComponentWillUpdate=this._reactComponent.componentWillUpdate||function(){},this._reactComponent.componentWillUpdate=this._onUpdate.bind(this),this._container.getState()&&this._reactComponent.setState(this._container.getState())},_destroy:function(){ReactDOM.unmountComponentAtNode(this._container.getElement()[0]),this._container.off("open",this._render,this),this._container.off("destroy",this._destroy,this)},_onUpdate:function(t,e){this._container.setState(e),this._originalComponentWillUpdate.call(this._reactComponent,t,e)},_getReactClass:function(){var t,e=this._container._config.component;if(!e)throw new Error("No react component name. type: react-component needs a field `component`");if(t=this._container.layoutManager.getComponent(e),!t)throw new Error('React component "'+e+'" not found. Please register all components with GoldenLayout using `registerComponent(name, component)`');return t},_getReactComponent:function(){var e={glEventHub:this._container.layoutManager.eventHub,glContainer:this._container},n=t.extend(e,this._container._config.props);return React.createElement(this._reactClass,n)}})}(window.$),function(){function t(t,e){var n=t.split("."),i=T;n[0]in i||!i.execScript||i.execScript("var "+n[0]);for(var o;n.length&&(o=n.shift());)n.length||void 0===e?i=i[o]?i[o]:i[o]={}:i[o]=e}function e(t,e){function n(){}n.prototype=e.prototype,t.l=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.k=function(t,n,i){for(var o=Array(arguments.length-2),r=2;r<arguments.length;r++)o[r-2]=arguments[r];return e.prototype[n].apply(t,o)}}function n(){}function i(t){this.message=t||"";
}function o(){}function r(){}function s(t){this.message=t||""}function a(){}function l(){}function d(){}function c(t){this.message=t||""}function h(){}function u(){this.c=[]}function p(t){this.message=t||""}function g(t){this.a=[],t instanceof a&&this.d(t)}function m(t){this.e=t,this.d=0}function f(t){this.a=[],t instanceof a&&this.d(t)}function y(t){this.e=t,this.d=0}function v(){this.b={}}function j(){}function x(t){this.a=[],t instanceof a&&this.d(t)}function _(t){this.e=t,this.d=0}function S(t){return null==t?null:t.parent}function b(t,e){null!==t&&(t.color=e)}function E(t){return null==t?null:t.left}function C(t){return null==t?null:t.right}function I(){this.b=null,this.f=0}function w(t,e){if(null!=e){var n=e.right;e.right=n.left,null!=n.left&&(n.left.parent=e),n.parent=e.parent,null==e.parent?t.b=n:e.parent.left==e?e.parent.left=n:e.parent.right=n,n.left=e,e.parent=n}}function L(t,e){if(null!=e){var n=e.left;e.left=n.right,null!=n.right&&(n.right.parent=e),n.parent=e.parent,null==e.parent?t.b=n:e.parent.right==e?e.parent.right=n:e.parent.left=n,n.right=e,e.parent=n}}function P(t){if(null===t)return null;if(null!==t.right)for(var e=t.right;null!==e.left;)e=e.left;else for(e=t.parent;null!==e&&t===e.right;)t=e,e=e.parent;return e}var T=this;t("javascript.util.Iterator",n),n.prototype.hasNext=n.prototype.b,n.prototype.next=n.prototype.c,n.prototype.remove=n.prototype.a,e(i,Error),t("javascript.util.OperationNotSupported",i),i.prototype.name="OperationNotSupported",t("javascript.util.Map",o),e(r,o),t("javascript.util.SortedMap",r),e(s,Error),t("javascript.util.IndexOutOfBoundsException",s),s.prototype.name="IndexOutOfBoundsException",t("javascript.util.Collection",a),e(l,a),t("javascript.util.Set",l),e(d,l),t("javascript.util.SortedSet",d),e(c,Error),t("javascript.util.EmptyStackException",c),c.prototype.name="EmptyStackException",e(h,a),t("javascript.util.List",h),e(u,h),t("javascript.util.Stack",u),u.prototype.push=function(t){return this.c.push(t),t},u.prototype.push=u.prototype.push,u.prototype.d=function(){if(0===this.c.length)throw new c;return this.c.pop()},u.prototype.pop=u.prototype.d,u.prototype.g=function(){if(0===this.c.length)throw new c;return this.c[this.c.length-1]},u.prototype.peek=u.prototype.g,u.prototype.a=function(){return 0===this.c.length},u.prototype.empty=u.prototype.a,u.prototype.f=function(){return this.a()},u.prototype.isEmpty=u.prototype.f,u.prototype.i=function(t){return this.c.indexOf(t)},u.prototype.search=u.prototype.i,u.prototype.b=function(){return this.c.length},u.prototype.size=u.prototype.b,u.prototype.h=function(){for(var t=[],e=0,n=this.c.length;e<n;e++)t.push(this.c[e]);return t},u.prototype.toArray=u.prototype.h,e(p,Error),t("javascript.util.NoSuchElementException",p),p.prototype.name="NoSuchElementException",e(g,d),t("javascript.util.TreeSet",g),g.prototype.g=function(t){for(var e=0,n=this.a.length;e<n;e++)if(0===this.a[e].compareTo(t))return!0;return!1},g.prototype.contains=g.prototype.g,g.prototype.c=function(t){if(this.g(t))return!1;for(var e=0,n=this.a.length;e<n;e++)if(1===this.a[e].compareTo(t))return this.a.splice(e,0,t),!0;return this.a.push(t),!0},g.prototype.add=g.prototype.c,g.prototype.d=function(t){for(t=t.e();t.b();)this.c(t.c());return!0},g.prototype.addAll=g.prototype.d,g.prototype.i=function(){throw new i},g.prototype.remove=g.prototype.i,g.prototype.b=function(){return this.a.length},g.prototype.size=g.prototype.b,g.prototype.f=function(){return 0===this.a.length},g.prototype.isEmpty=g.prototype.f,g.prototype.h=function(){for(var t=[],e=0,n=this.a.length;e<n;e++)t.push(this.a[e]);return t},g.prototype.toArray=g.prototype.h,g.prototype.e=function(){return new m(this)},g.prototype.iterator=g.prototype.e,t("$jscomp.scope.Iterator_",m),m.prototype.c=function(){if(this.d===this.e.b())throw new p;return this.e.a[this.d++]},m.prototype.next=m.prototype.c,m.prototype.b=function(){return this.d<this.e.b()},m.prototype.hasNext=m.prototype.b,m.prototype.a=function(){throw new i},m.prototype.remove=m.prototype.a,e(f,h),t("javascript.util.ArrayList",f),f.prototype.c=function(t){return this.a.push(t),!0},f.prototype.add=f.prototype.c,f.prototype.d=function(t){for(t=t.e();t.b();)this.c(t.c());return!0},f.prototype.addAll=f.prototype.d,f.prototype.j=function(t,e){var n=this.a[t];return this.a[t]=e,n},f.prototype.set=f.prototype.j,f.prototype.e=function(){return new y(this)},f.prototype.iterator=f.prototype.e,f.prototype.g=function(t){if(0>t||t>=this.b())throw new s;return this.a[t]},f.prototype.get=f.prototype.g,f.prototype.f=function(){return 0===this.a.length},f.prototype.isEmpty=f.prototype.f,f.prototype.b=function(){return this.a.length},f.prototype.size=f.prototype.b,f.prototype.h=function(){for(var t=[],e=0,n=this.a.length;e<n;e++)t.push(this.a[e]);return t},f.prototype.toArray=f.prototype.h,f.prototype.i=function(t){for(var e=!1,n=0,i=this.a.length;n<i;n++)if(this.a[n]===t){this.a.splice(n,1),e=!0;break}return e},f.prototype.remove=f.prototype.i,t("$jscomp.scope.Iterator_$1",y),y.prototype.c=function(){if(this.d===this.e.b())throw new p;return this.e.g(this.d++)},y.prototype.next=y.prototype.c,y.prototype.b=function(){return this.d<this.e.b()},y.prototype.hasNext=y.prototype.b,y.prototype.a=function(){throw new i},y.prototype.remove=y.prototype.a,e(v,o),t("javascript.util.HashMap",v),v.prototype.a=function(t){return this.b[t]||null},v.prototype.get=v.prototype.a,v.prototype.d=function(t,e){return this.b[t]=e},v.prototype.put=v.prototype.d,v.prototype.c=function(){var t,e=new f;for(t in this.b)this.b.hasOwnProperty(t)&&e.c(this.b[t]);return e},v.prototype.values=v.prototype.c,v.prototype.e=function(){return this.c().b()},v.prototype.size=v.prototype.e,t("javascript.util.Arrays",j),j.sort=function(){var t,e,n,i=arguments[0];if(1===arguments.length)i.sort();else if(2===arguments.length)e=arguments[1],n=function(t,n){return e.compare(t,n)},i.sort(n);else if(3===arguments.length)for(t=i.slice(arguments[1],arguments[2]),t.sort(),n=i.slice(0,arguments[1]).concat(t,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<n.length;t++)i.push(n[t]);else if(4===arguments.length)for(t=i.slice(arguments[1],arguments[2]),e=arguments[3],n=function(t,n){return e.compare(t,n)},t.sort(n),n=i.slice(0,arguments[1]).concat(t,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<n.length;t++)i.push(n[t])},j.asList=function(t){for(var e=new f,n=0,i=t.length;n<i;n++)e.c(t[n]);return e},e(x,l),t("javascript.util.HashSet",x),x.prototype.g=function(t){for(var e=0,n=this.a.length;e<n;e++)if(this.a[e]===t)return!0;return!1},x.prototype.contains=x.prototype.g,x.prototype.c=function(t){return!this.g(t)&&(this.a.push(t),!0)},x.prototype.add=x.prototype.c,x.prototype.d=function(t){for(t=t.e();t.b();)this.c(t.c());return!0},x.prototype.addAll=x.prototype.d,x.prototype.i=function(){throw new i},x.prototype.remove=x.prototype.i,x.prototype.b=function(){return this.a.length},x.prototype.size=x.prototype.b,x.prototype.f=function(){return 0===this.a.length},x.prototype.isEmpty=x.prototype.f,x.prototype.h=function(){for(var t=[],e=0,n=this.a.length;e<n;e++)t.push(this.a[e]);return t},x.prototype.toArray=x.prototype.h,x.prototype.e=function(){return new _(this)},x.prototype.iterator=x.prototype.e,t("$jscomp.scope.Iterator_$2",_),_.prototype.c=function(){if(this.d===this.e.b())throw new p;return this.e.a[this.d++]},_.prototype.next=_.prototype.c,_.prototype.b=function(){return this.d<this.e.b()},_.prototype.hasNext=_.prototype.b,_.prototype.a=function(){throw new i},_.prototype.remove=_.prototype.a,e(I,r),t("javascript.util.TreeMap",I),I.prototype.a=function(t){for(var e=this.b;null!==e;){var n=t.compareTo(e.key);if(0>n)e=e.left;else{if(!(0<n))return e.value;e=e.right}}return null},I.prototype.get=I.prototype.a,I.prototype.d=function(t,e){if(null===this.b)return this.b={key:t,value:e,left:null,right:null,parent:null,color:0},this.f=1,null;var n,i,o=this.b;do if(n=o,i=t.compareTo(o.key),0>i)o=o.left;else{if(!(0<i))return n=o.value,o.value=e,n;o=o.right}while(null!==o);for(o={key:t,left:null,right:null,value:e,parent:n,color:0},0>i?n.left=o:n.right=o,o.color=1;null!=o&&o!=this.b&&1==o.parent.color;)S(o)==E(S(S(o)))?(n=C(S(S(o))),1==(null==n?0:n.color)?(b(S(o),0),b(n,0),b(S(S(o)),1),o=S(S(o))):(o==C(S(o))&&(o=S(o),w(this,o)),b(S(o),0),b(S(S(o)),1),L(this,S(S(o))))):(n=E(S(S(o))),1==(null==n?0:n.color)?(b(S(o),0),b(n,0),b(S(S(o)),1),o=S(S(o))):(o==E(S(o))&&(o=S(o),L(this,o)),b(S(o),0),b(S(S(o)),1),w(this,S(S(o)))));return this.b.color=0,this.f++,null},I.prototype.put=I.prototype.d,I.prototype.c=function(){var t,e=new f;if(t=this.b,null!=t)for(;null!=t.left;)t=t.left;if(null!==t)for(e.c(t.value);null!==(t=P(t));)e.c(t.value);return e},I.prototype.values=I.prototype.c,I.prototype.e=function(){return this.f},I.prototype.size=I.prototype.e}(),jsts={version:"0.17.0",algorithm:{distance:{},locate:{}},error:{},geom:{util:{}},geomgraph:{index:{}},index:{bintree:{},chain:{},kdtree:{},quadtree:{},strtree:{}},io:{},noding:{snapround:{}},operation:{buffer:{},distance:{},linemerge:{},overlay:{snap:{}},polygonize:{},predicate:{},relate:{},union:{},valid:{}},planargraph:{},precision:{},simplify:{},triangulate:{quadedge:{}},densify:{},util:{}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),jsts.abstractFunc=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.error={},jsts.error.IllegalArgumentError=function(t){this.name="IllegalArgumentError",this.message=t},jsts.error.IllegalArgumentError.prototype=new Error,jsts.error.TopologyError=function(t,e){this.name="TopologyError",this.message=e?t+" [ "+e+" ]":t},jsts.error.TopologyError.prototype=new Error,jsts.error.AbstractMethodInvocationError=function(){this.name="AbstractMethodInvocationError",this.message="Abstract method called, should be implemented in subclass."},jsts.error.AbstractMethodInvocationError.prototype=new Error,jsts.error.NotImplementedError=function(){this.name="NotImplementedError",this.message="This method has not yet been implemented."},jsts.error.NotImplementedError.prototype=new Error,jsts.error.NotRepresentableError=function(t){this.name="NotRepresentableError",this.message=t},jsts.error.NotRepresentableError.prototype=new Error,jsts.error.LocateFailureError=function(t){this.name="LocateFailureError",this.message=t},jsts.error.LocateFailureError.prototype=new Error,"undefined"!=typeof module&&(module.exports=jsts),jsts.geom.GeometryFilter=function(){},jsts.geom.GeometryFilter.prototype.filter=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.util.PolygonExtracter=function(t){this.comps=t},jsts.geom.util.PolygonExtracter.prototype=new jsts.geom.GeometryFilter,jsts.geom.util.PolygonExtracter.prototype.comps=null,jsts.geom.util.PolygonExtracter.getPolygons=function(t,e){return void 0===e&&(e=[]),t instanceof jsts.geom.Polygon?e.push(t):t instanceof jsts.geom.GeometryCollection&&t.apply(new jsts.geom.util.PolygonExtracter(e)),e},jsts.geom.util.PolygonExtracter.prototype.filter=function(t){t instanceof jsts.geom.Polygon&&this.comps.push(t)},jsts.io.WKTParser=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/}},jsts.io.WKTParser.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var o=this.regExes.typeStr.exec(t);if(t.search("EMPTY")!==-1&&(o=this.regExes.emptyTypeStr.exec(t),o[2]=void 0),o&&(n=o[1].toLowerCase(),i=o[2],this.parse[n]&&(e=this.parse[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},jsts.io.WKTParser.prototype.write=function(t){return this.extractGeometry(t)},jsts.io.WKTParser.prototype.extractGeometry=function(t){var e=t.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[e])return null;var n,i=e.toUpperCase();return n=t.isEmpty()?i+" EMPTY":i+"("+this.extract[e].apply(this,[t])+")"},jsts.io.WKTParser.prototype.extract={coordinate:function(t){return t.x+" "+t.y},point:function(t){return t.coordinate.x+" "+t.coordinate.y},multipoint:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push("("+this.extract.point.apply(this,[t.geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t.points.length;n<i;++n)e.push(this.extract.coordinate.apply(this,[t.points[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push("("+this.extract.linestring.apply(this,[t.geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+this.extract.linestring.apply(this,[t.shell])+")");for(var n=0,i=t.holes.length;n<i;++n)e.push("("+this.extract.linestring.apply(this,[t.holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push("("+this.extract.polygon.apply(this,[t.geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t.geometries.length;n<i;++n)e.push(this.extractGeometry.apply(this,[t.geometries[n]]));return e.join(",")}},jsts.io.WKTParser.prototype.parse={point:function(t){if(void 0===t)return this.geometryFactory.createPoint(null);var e=t.trim().split(this.regExes.spaces);return this.geometryFactory.createPoint(new jsts.geom.Coordinate(e[0],e[1]))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint(null);for(var e,n=t.trim().split(","),i=[],o=0,r=n.length;o<r;++o)e=n[o].replace(this.regExes.trimParens,"$1"),i.push(this.parse.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString(null);for(var e,n=t.trim().split(","),i=[],o=0,r=n.length;o<r;++o)e=n[o].trim().split(this.regExes.spaces),i.push(new jsts.geom.Coordinate(e[0],e[1]));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing(null);for(var e,n=t.trim().split(","),i=[],o=0,r=n.length;o<r;++o)e=n[o].trim().split(this.regExes.spaces),i.push(new jsts.geom.Coordinate(e[0],e[1]));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString(null);for(var e,n=t.trim().split(this.regExes.parenComma),i=[],o=0,r=n.length;o<r;++o)e=n[o].replace(this.regExes.trimParens,"$1"),i.push(this.parse.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon(null);for(var e,n,i,o,r=t.trim().split(this.regExes.parenComma),s=[],a=0,l=r.length;a<l;++a)e=r[a].replace(this.regExes.trimParens,"$1"),n=this.parse.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n.points),0===a?o=i:s.push(i);return this.geometryFactory.createPolygon(o,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon(null);for(var e,n=t.trim().split(this.regExes.doubleParenComma),i=[],o=0,r=n.length;o<r;++o)e=n[o].replace(this.regExes.trimParens,"$1"),i.push(this.parse.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection(null);t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var e=t.trim().split("|"),n=[],i=0,o=e.length;i<o;++i)n.push(jsts.io.WKTParser.prototype.read.apply(this,[e[i]]));return this.geometryFactory.createGeometryCollection(n)}},jsts.index.ItemVisitor=function(){},jsts.index.ItemVisitor.prototype.visitItem=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.CGAlgorithms=function(){},jsts.algorithm.CGAlgorithms.CLOCKWISE=-1,jsts.algorithm.CGAlgorithms.RIGHT=jsts.algorithm.CGAlgorithms.CLOCKWISE,jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE=1,jsts.algorithm.CGAlgorithms.LEFT=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE,jsts.algorithm.CGAlgorithms.COLLINEAR=0,jsts.algorithm.CGAlgorithms.STRAIGHT=jsts.algorithm.CGAlgorithms.COLLINEAR,jsts.algorithm.CGAlgorithms.orientationIndex=function(t,e,n){var i,o,r,s;return i=e.x-t.x,o=e.y-t.y,r=n.x-e.x,s=n.y-e.y,jsts.algorithm.RobustDeterminant.signOfDet2x2(i,o,r,s)},jsts.algorithm.CGAlgorithms.isPointInRing=function(t,e){return jsts.algorithm.CGAlgorithms.locatePointInRing(t,e)!==jsts.geom.Location.EXTERIOR},jsts.algorithm.CGAlgorithms.locatePointInRing=function(t,e){return jsts.algorithm.RayCrossingCounter.locatePointInRing(t,e)},jsts.algorithm.CGAlgorithms.isOnLine=function(t,e){var n,i,o,r,s;for(n=new jsts.algorithm.RobustLineIntersector,i=1,o=e.length;i<o;i++)if(r=e[i-1],s=e[i],n.computeIntersection(t,r,s),n.hasIntersection())return!0;return!1},jsts.algorithm.CGAlgorithms.isCCW=function(t){var e,n,i,o,r,s,a,l,d,c,h;if(e=t.length-1,e<3)throw new jsts.IllegalArgumentError("Ring has fewer than 3 points, so orientation cannot be determined");for(n=t[0],i=0,d=1;d<=e;d++)o=t[d],o.y>n.y&&(n=o,i=d);r=i;do r-=1,r<0&&(r=e);while(t[r].equals2D(n)&&r!==i);s=i;do s=(s+1)%e;while(t[s].equals2D(n)&&s!==i);return a=t[r],l=t[s],!(a.equals2D(n)||l.equals2D(n)||a.equals2D(l))&&(c=jsts.algorithm.CGAlgorithms.computeOrientation(a,n,l),h=!1,h=0===c?a.x>l.x:c>0)},jsts.algorithm.CGAlgorithms.computeOrientation=function(t,e,n){return jsts.algorithm.CGAlgorithms.orientationIndex(t,e,n)},jsts.algorithm.CGAlgorithms.distancePointLine=function(t,e,n){if(e instanceof jsts.geom.Coordinate||jsts.algorithm.CGAlgorithms.distancePointLine2.apply(this,arguments),e.x===n.x&&e.y===n.y)return t.distance(e);var i,o;return i=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)),i<=0?t.distance(e):i>=1?t.distance(n):(o=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)),Math.abs(o)*Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)))},jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular=function(t,e,n){var i=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y));return Math.abs(i)*Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y))},jsts.algorithm.CGAlgorithms.distancePointLine2=function(t,e){var n,i,o,r;if(0===e.length)throw new jsts.error.IllegalArgumentError("Line array must contain at least one vertex");for(n=t.distance(e[0]),i=0,o=e.length-1;i<o;i++)r=jsts.algorithm.CGAlgorithms.distancePointLine(t,e[i],e[i+1]),r<n&&(n=r);return n},jsts.algorithm.CGAlgorithms.distanceLineLine=function(t,e,n,i){if(t.equals(e))return jsts.algorithm.CGAlgorithms.distancePointLine(t,n,i);if(n.equals(i))return jsts.algorithm.CGAlgorithms.distancePointLine(i,t,e);var o,r,s,a,l,d;return o=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),r=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x),s=(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y),a=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x),0===r||0===a?Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(t,n,i),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(e,n,i),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(n,t,e),jsts.algorithm.CGAlgorithms.distancePointLine(i,t,e)))):(l=s/a,d=o/r,d<0||d>1||l<0||l>1?Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(t,n,i),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(e,n,i),Math.min(jsts.algorithm.CGAlgorithms.distancePointLine(n,t,e),jsts.algorithm.CGAlgorithms.distancePointLine(i,t,e)))):0)},jsts.algorithm.CGAlgorithms.signedArea=function(t){if(t.length<3)return 0;var e,n,i,o,r,s,a;for(e=0,n=0,i=t.length-1;n<i;n++)o=t[n].x,r=t[n].y,s=t[n+1].x,a=t[n+1].y,e+=(o+s)*(a-r);return-e/2},jsts.algorithm.CGAlgorithms.signedArea=function(t){var e,n,i,o,r,s,a,l;if(e=t.length,e<3)return 0;for(n=0,i=t[0],o=i.x,r=i.y,s=1;s<e;s++)i=t[s],a=i.x,l=i.y,n+=(o+a)*(l-r),o=a,r=l;return-n/2},jsts.algorithm.CGAlgorithms.computeLength=function(t){var e,n,i,o,r,s,a,l,d,c,h=t.length;if(h<=1)return 0;for(e=0,l=t[0],n=l.x,i=l.y,d=1,c=h,d;d<h;d++)l=t[d],o=l.x,r=l.y,s=o-n,a=r-i,e+=Math.sqrt(s*s+a*a),n=o,i=r;return e},jsts.algorithm.CGAlgorithms.length=function(){},jsts.algorithm.Angle=function(){},jsts.algorithm.Angle.PI_TIMES_2=2*Math.PI,jsts.algorithm.Angle.PI_OVER_2=Math.PI/2,jsts.algorithm.Angle.PI_OVER_4=Math.PI/4,jsts.algorithm.Angle.COUNTERCLOCKWISE=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE,jsts.algorithm.Angle.CLOCKWISE=jsts.algorithm.CGAlgorithms.CLOCKWISE,jsts.algorithm.Angle.NONE=jsts.algorithm.CGAlgorithms.COLLINEAR,jsts.algorithm.Angle.toDegrees=function(t){return 180*t/Math.PI},jsts.algorithm.Angle.toRadians=function(t){return t*Math.PI/180},jsts.algorithm.Angle.angle=function(){return 1===arguments.length?jsts.algorithm.Angle.angleFromOrigo(arguments[0]):jsts.algorithm.Angle.angleBetweenCoords(arguments[0],arguments[1])},jsts.algorithm.Angle.angleBetweenCoords=function(t,e){var n,i;return n=e.x-t.x,i=e.y-t.y,Math.atan2(i,n)},jsts.algorithm.Angle.angleFromOrigo=function(t){return Math.atan2(t.y,t.x)},jsts.algorithm.Angle.isAcute=function(t,e,n){var i,o,r,s,a;return i=t.x-e.x,o=t.y-e.y,r=n.x-e.x,s=n.y-e.y,a=i*r+o*s,a>0},jsts.algorithm.Angle.isObtuse=function(t,e,n){var i,o,r,s,a;return i=t.x-e.x,o=t.y-e.y,r=n.x-e.x,s=n.y-e.y,a=i*r+o*s,a<0},jsts.algorithm.Angle.angleBetween=function(t,e,n){var i,o;return i=jsts.algorithm.Angle.angle(e,t),o=jsts.algorithm.Angle.angle(e,n),jsts.algorithm.Angle.diff(i,o)},jsts.algorithm.Angle.angleBetweenOriented=function(t,e,n){var i,o,r;return i=jsts.algorithm.Angle.angle(e,t),o=jsts.algorithm.Angle.angle(e,n),r=o-i,r<=-Math.PI?r+jsts.algorithm.Angle.PI_TIMES_2:r>Math.PI?r-jsts.algorithm.Angle.PI_TIMES_2:r},jsts.algorithm.Angle.interiorAngle=function(t,e,n){var i,o;return i=jsts.algorithm.Angle.angle(e,t),o=jsts.algorithm.Angle.angle(e,n),Math.abs(o-i)},jsts.algorithm.Angle.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?jsts.algorithm.Angle.COUNTERCLOCKWISE:n<0?jsts.algorithm.Angle.CLOCKWISE:jsts.algorithm.Angle.NONE},jsts.algorithm.Angle.normalize=function(t){for(;t>Math.PI;)t-=jsts.algorithm.Angle.PI_TIMES_2;for(;t<=-Math.PI;)t+=jsts.algorithm.Angle.PI_TIMES_2;return t},jsts.algorithm.Angle.normalizePositive=function(t){if(t<0){for(;t<0;)t+=jsts.algorithm.Angle.PI_TIMES_2;t>=jsts.algorithm.Angle.PI_TIMES_2&&(t=0)}else{for(;t>=jsts.algorithm.Angle.PI_TIMES_2;)t-=jsts.algorithm.Angle.PI_TIMES_2;t<0&&(t=0)}return t},jsts.algorithm.Angle.diff=function(t,e){var n;return n=t<e?e-t:t-e,n>Math.PI&&(n=2*Math.PI-n),n},jsts.geom.GeometryComponentFilter=function(){},jsts.geom.GeometryComponentFilter.prototype.filter=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.util.LinearComponentExtracter=function(t,e){this.lines=t,this.isForcedToLineString=e},jsts.geom.util.LinearComponentExtracter.prototype=new jsts.geom.GeometryComponentFilter,jsts.geom.util.LinearComponentExtracter.prototype.lines=null,jsts.geom.util.LinearComponentExtracter.prototype.isForcedToLineString=!1,jsts.geom.util.LinearComponentExtracter.getLines=function(t,e){if(1==arguments.length)return jsts.geom.util.LinearComponentExtracter.getLines5.apply(this,arguments);if(2==arguments.length&&"boolean"==typeof e)return jsts.geom.util.LinearComponentExtracter.getLines6.apply(this,arguments);if(2==arguments.length&&t instanceof jsts.geom.Geometry)return jsts.geom.util.LinearComponentExtracter.getLines3.apply(this,arguments);if(3==arguments.length&&t instanceof jsts.geom.Geometry)return jsts.geom.util.LinearComponentExtracter.getLines4.apply(this,arguments);if(3==arguments.length)return jsts.geom.util.LinearComponentExtracter.getLines2.apply(this,arguments);for(var n=0;n<t.length;n++){var i=t[n];jsts.geom.util.LinearComponentExtracter.getLines3(i,e)}return e},jsts.geom.util.LinearComponentExtracter.getLines2=function(t,e,n){for(var i=0;i<t.length;i++){var o=t[i];jsts.geom.util.LinearComponentExtracter.getLines4(o,e,n)}return e},jsts.geom.util.LinearComponentExtracter.getLines3=function(t,e){return t instanceof LineString?e.add(t):t.apply(new jsts.geom.util.LinearComponentExtracter(e)),e},jsts.geom.util.LinearComponentExtracter.getLines4=function(t,e,n){return t.apply(new jsts.geom.util.LinearComponentExtracter(e,n)),e},jsts.geom.util.LinearComponentExtracter.getLines5=function(t){return jsts.geom.util.LinearComponentExtracter.getLines6(t,!1)},jsts.geom.util.LinearComponentExtracter.getLines6=function(t,e){var n=[];return t.apply(new jsts.geom.util.LinearComponentExtracter(n,e)),n},jsts.geom.util.LinearComponentExtracter.prototype.setForceToLineString=function(t){this.isForcedToLineString=t},jsts.geom.util.LinearComponentExtracter.prototype.filter=function(t){if(this.isForcedToLineString&&t instanceof jsts.geom.LinearRing){var e=t.getFactory().createLineString(t.getCoordinateSequence());return void this.lines.push(e)}(t instanceof jsts.geom.LineString||t instanceof jsts.geom.LinearRing)&&this.lines.push(t)},jsts.geom.Location=function(){},jsts.geom.Location.INTERIOR=0,jsts.geom.Location.BOUNDARY=1,jsts.geom.Location.EXTERIOR=2,jsts.geom.Location.NONE=-1,jsts.geom.Location.toLocationSymbol=function(t){switch(t){case jsts.geom.Location.EXTERIOR:return"e";case jsts.geom.Location.BOUNDARY:return"b";case jsts.geom.Location.INTERIOR:return"i";case jsts.geom.Location.NONE:return"-"}throw new jsts.IllegalArgumentError("Unknown location value: "+t)},function(){jsts.io.GeoJSONReader=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new jsts.io.GeoJSONParser(this.geometryFactory)},jsts.io.GeoJSONReader.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED&&this.reducePrecision(e),e},jsts.io.GeoJSONReader.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])}}(),jsts.geom.Geometry=function(t){this.factory=t},jsts.geom.Geometry.prototype.envelope=null,jsts.geom.Geometry.prototype.factory=null,jsts.geom.Geometry.prototype.getGeometryType=function(){return"Geometry"},jsts.geom.Geometry.hasNonEmptyElements=function(t){var e;for(e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},jsts.geom.Geometry.hasNullElements=function(t){var e;for(e=0;e<t.length;e++)if(null===t[e])return!0;return!1},jsts.geom.Geometry.prototype.getFactory=function(){return null!==this.factory&&void 0!==this.factory||(this.factory=new jsts.geom.GeometryFactory),this.factory},jsts.geom.Geometry.prototype.getNumGeometries=function(){return 1},jsts.geom.Geometry.prototype.getGeometryN=function(t){return this},jsts.geom.Geometry.prototype.getPrecisionModel=function(){return this.getFactory().getPrecisionModel()},jsts.geom.Geometry.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getCoordinates=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getNumPoints=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.isSimple=function(){this.checkNotGeometryCollection(this);var t=new jsts.operation.IsSimpleOp(this);return t.isSimple()},jsts.geom.Geometry.prototype.isValid=function(){var t=new jsts.operation.valid.IsValidOp(this);return t.isValid()},jsts.geom.Geometry.prototype.isEmpty=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.distance=function(t){return jsts.operation.distance.DistanceOp.distance(this,t)},jsts.geom.Geometry.prototype.isWithinDistance=function(t,e){var n=this.getEnvelopeInternal().distance(t.getEnvelopeInternal());return!(n>e)&&DistanceOp.isWithinDistance(this,t,e)},jsts.geom.Geometry.prototype.isRectangle=function(){return!1},jsts.geom.Geometry.prototype.getArea=function(){return 0},jsts.geom.Geometry.prototype.getLength=function(){return 0},jsts.geom.Geometry.prototype.getCentroid=function(){if(this.isEmpty())return null;var t,e=null,n=this.getDimension();return 0===n?(t=new jsts.algorithm.CentroidPoint,t.add(this),e=t.getCentroid()):1===n?(t=new jsts.algorithm.CentroidLine,t.add(this),e=t.getCentroid()):(t=new jsts.algorithm.CentroidArea,t.add(this),e=t.getCentroid()),this.createPointFromInternalCoord(e,this)},jsts.geom.Geometry.prototype.getInteriorPoint=function(){var t,e=null,n=this.getDimension();return 0===n?(t=new jsts.algorithm.InteriorPointPoint(this),e=t.getInteriorPoint()):1===n?(t=new jsts.algorithm.InteriorPointLine(this),e=t.getInteriorPoint()):(t=new jsts.algorithm.InteriorPointArea(this),e=t.getInteriorPoint()),this.createPointFromInternalCoord(e,this)},jsts.geom.Geometry.prototype.getDimension=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getBoundary=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getBoundaryDimension=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},jsts.geom.Geometry.prototype.getEnvelopeInternal=function(){return null===this.envelope&&(this.envelope=this.computeEnvelopeInternal()),this.envelope},jsts.geom.Geometry.prototype.disjoint=function(t){return!this.intersects(t)},jsts.geom.Geometry.prototype.touches=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&this.relate(t).isTouches(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.intersects=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&(this.isRectangle()?jsts.operation.predicate.RectangleIntersects.intersects(this,t):t.isRectangle()?jsts.operation.predicate.RectangleIntersects.intersects(t,this):this.relate(t).isIntersects())},jsts.geom.Geometry.prototype.crosses=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&this.relate(t).isCrosses(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.within=function(t){return t.contains(this)},jsts.geom.Geometry.prototype.contains=function(t){return!!this.getEnvelopeInternal().contains(t.getEnvelopeInternal())&&(this.isRectangle()?jsts.operation.predicate.RectangleContains.contains(this,t):this.relate(t).isContains())},jsts.geom.Geometry.prototype.overlaps=function(t){return!!this.getEnvelopeInternal().intersects(t.getEnvelopeInternal())&&this.relate(t).isOverlaps(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.covers=function(t){return!!this.getEnvelopeInternal().covers(t.getEnvelopeInternal())&&(!!this.isRectangle()||this.relate(t).isCovers())},jsts.geom.Geometry.prototype.coveredBy=function(t){return t.covers(this)},jsts.geom.Geometry.prototype.relate=function(t,e){return 1===arguments.length?this.relate2.apply(this,arguments):this.relate2(t).matches(e)},jsts.geom.Geometry.prototype.relate2=function(t){return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.relate.RelateOp.relate(this,t)},jsts.geom.Geometry.prototype.equalsTopo=function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&this.relate(t).isEquals(this.getDimension(),t.getDimension())},jsts.geom.Geometry.prototype.equals=function(t){return(t instanceof jsts.geom.Geometry||t instanceof jsts.geom.LinearRing||t instanceof jsts.geom.Polygon||t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)&&this.equalsExact(t)},jsts.geom.Geometry.prototype.buffer=function(t,e,n){var i=new jsts.operation.buffer.BufferParameters(e,n);return jsts.operation.buffer.BufferOp.bufferOp2(this,t,i)},jsts.geom.Geometry.prototype.convexHull=function(){return new jsts.algorithm.ConvexHull(this).getConvexHull()},jsts.geom.Geometry.prototype.intersection=function(t){if(this.isEmpty())return this.getFactory().createGeometryCollection(null);
if(t.isEmpty())return this.getFactory().createGeometryCollection(null);if(this.isGeometryCollection(this));return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.INTERSECTION)},jsts.geom.Geometry.prototype.union=function(t){return 0===arguments.length?jsts.operation.union.UnaryUnionOp.union(this):this.isEmpty()?t.clone():t.isEmpty()?this.clone():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.UNION))},jsts.geom.Geometry.prototype.difference=function(t){return this.isEmpty()?this.getFactory().createGeometryCollection(null):t.isEmpty()?this.clone():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.DIFFERENCE))},jsts.geom.Geometry.prototype.symDifference=function(t){return this.isEmpty()?t.clone():t.isEmpty()?this.clone():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),jsts.operation.overlay.snap.SnapIfNeededOverlayOp.overlayOp(this,t,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE))},jsts.geom.Geometry.prototype.equalsExact=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.equalsNorm=function(t){return null!==t&&void 0!==t&&this.norm().equalsExact(t.norm())},jsts.geom.Geometry.prototype.apply=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.clone=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.normalize=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.norm=function(){var t=this.clone();return t.normalize(),t},jsts.geom.Geometry.prototype.compareTo=function(t){var e=t;return this.getClassSortIndex()!==e.getClassSortIndex()?this.getClassSortIndex()-e.getClassSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)},jsts.geom.Geometry.prototype.isEquivalentClass=function(t){return this instanceof jsts.geom.Point&&t instanceof jsts.geom.Point||(!!(this instanceof jsts.geom.LineString&&t instanceof jsts.geom.LineString|t instanceof jsts.geom.LinearRing)||(!!(this instanceof jsts.geom.LinearRing&&t instanceof jsts.geom.LineString|t instanceof jsts.geom.LinearRing)||(this instanceof jsts.geom.Polygon&&t instanceof jsts.geom.Polygon||(this instanceof jsts.geom.MultiPoint&&t instanceof jsts.geom.MultiPoint||(this instanceof jsts.geom.MultiLineString&&t instanceof jsts.geom.MultiLineString||(this instanceof jsts.geom.MultiPolygon&&t instanceof jsts.geom.MultiPolygon||this instanceof jsts.geom.GeometryCollection&&t instanceof jsts.geom.GeometryCollection))))))},jsts.geom.Geometry.prototype.checkNotGeometryCollection=function(t){if(t.isGeometryCollectionBase())throw new jsts.error.IllegalArgumentError("This method does not support GeometryCollection")},jsts.geom.Geometry.prototype.isGeometryCollection=function(){return this instanceof jsts.geom.GeometryCollection},jsts.geom.Geometry.prototype.isGeometryCollectionBase=function(){return"jsts.geom.GeometryCollection"===this.CLASS_NAME},jsts.geom.Geometry.prototype.computeEnvelopeInternal=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.compareToSameClass=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.Geometry.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var o=n.next(),r=i.next(),s=o.compareTo(r);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},jsts.geom.Geometry.prototype.equal=function(t,e,n){return void 0===n||null===n||0===n?t.equals(e):t.distance(e)<=n},jsts.geom.Geometry.prototype.getClassSortIndex=function(){for(var t=[jsts.geom.Point,jsts.geom.MultiPoint,jsts.geom.LineString,jsts.geom.LinearRing,jsts.geom.MultiLineString,jsts.geom.Polygon,jsts.geom.MultiPolygon,jsts.geom.GeometryCollection],e=0;e<t.length;e++)if(this instanceof t[e])return e;return jsts.util.Assert.shouldNeverReachHere("Class not supported: "+this),-1},jsts.geom.Geometry.prototype.toString=function(){return(new jsts.io.WKTWriter).write(this)},jsts.geom.Geometry.prototype.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},function(){jsts.geom.Coordinate=function(t,e){"number"==typeof t?(this.x=t,this.y=e):t instanceof jsts.geom.Coordinate?(this.x=parseFloat(t.x),this.y=parseFloat(t.y)):void 0===t||null===t?(this.x=0,this.y=0):"string"==typeof t&&(this.x=parseFloat(t),this.y=parseFloat(e))},jsts.geom.Coordinate.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y},jsts.geom.Coordinate.prototype.clone=function(){return new jsts.geom.Coordinate(this.x,this.y)},jsts.geom.Coordinate.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},jsts.geom.Coordinate.prototype.equals2D=function(t){return this.x===t.x&&this.y===t.y},jsts.geom.Coordinate.prototype.equals=function(t){return!(!t instanceof jsts.geom.Coordinate||void 0===t)&&this.equals2D(t)},jsts.geom.Coordinate.prototype.compareTo=function(t){return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0},jsts.geom.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"}}(),jsts.geom.Envelope=function(){jsts.geom.Envelope.prototype.init.apply(this,arguments)},jsts.geom.Envelope.prototype.minx=null,jsts.geom.Envelope.prototype.maxx=null,jsts.geom.Envelope.prototype.miny=null,jsts.geom.Envelope.prototype.maxy=null,jsts.geom.Envelope.prototype.init=function(){"number"==typeof arguments[0]&&4===arguments.length?this.initFromValues(arguments[0],arguments[1],arguments[2],arguments[3]):arguments[0]instanceof jsts.geom.Coordinate&&1===arguments.length?this.initFromCoordinate(arguments[0]):arguments[0]instanceof jsts.geom.Coordinate&&2===arguments.length?this.initFromCoordinates(arguments[0],arguments[1]):arguments[0]instanceof jsts.geom.Envelope&&1===arguments.length?this.initFromEnvelope(arguments[0]):this.setToNull()},jsts.geom.Envelope.prototype.initFromValues=function(t,e,n,i){t<e?(this.minx=t,this.maxx=e):(this.minx=e,this.maxx=t),n<i?(this.miny=n,this.maxy=i):(this.miny=i,this.maxy=n)},jsts.geom.Envelope.prototype.initFromCoordinates=function(t,e){this.initFromValues(t.x,e.x,t.y,e.y)},jsts.geom.Envelope.prototype.initFromCoordinate=function(t){this.initFromValues(t.x,t.x,t.y,t.y)},jsts.geom.Envelope.prototype.initFromEnvelope=function(t){this.minx=t.minx,this.maxx=t.maxx,this.miny=t.miny,this.maxy=t.maxy},jsts.geom.Envelope.prototype.setToNull=function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},jsts.geom.Envelope.prototype.isNull=function(){return this.maxx<this.minx},jsts.geom.Envelope.prototype.getHeight=function(){return this.isNull()?0:this.maxy-this.miny},jsts.geom.Envelope.prototype.getWidth=function(){return this.isNull()?0:this.maxx-this.minx},jsts.geom.Envelope.prototype.getMinX=function(){return this.minx},jsts.geom.Envelope.prototype.getMaxX=function(){return this.maxx},jsts.geom.Envelope.prototype.getMinY=function(){return this.miny},jsts.geom.Envelope.prototype.getMaxY=function(){return this.maxy},jsts.geom.Envelope.prototype.getArea=function(){return this.getWidth()*this.getHeight()},jsts.geom.Envelope.prototype.expandToInclude=function(){arguments[0]instanceof jsts.geom.Coordinate?this.expandToIncludeCoordinate(arguments[0]):arguments[0]instanceof jsts.geom.Envelope?this.expandToIncludeEnvelope(arguments[0]):this.expandToIncludeValues(arguments[0],arguments[1])};jsts.geom.Envelope.prototype.expandToIncludeCoordinate=function(t){this.expandToIncludeValues(t.x,t.y)};jsts.geom.Envelope.prototype.expandToIncludeValues=function(t,e){this.isNull()?(this.minx=t,this.maxx=t,this.miny=e,this.maxy=e):(t<this.minx&&(this.minx=t),t>this.maxx&&(this.maxx=t),e<this.miny&&(this.miny=e),e>this.maxy&&(this.maxy=e))},jsts.geom.Envelope.prototype.expandToIncludeEnvelope=function(t){t.isNull()||(this.isNull()?(this.minx=t.getMinX(),this.maxx=t.getMaxX(),this.miny=t.getMinY(),this.maxy=t.getMaxY()):(t.minx<this.minx&&(this.minx=t.minx),t.maxx>this.maxx&&(this.maxx=t.maxx),t.miny<this.miny&&(this.miny=t.miny),t.maxy>this.maxy&&(this.maxy=t.maxy)))},jsts.geom.Envelope.prototype.expandBy=function(){1===arguments.length?this.expandByDistance(arguments[0]):this.expandByDistances(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.expandByDistance=function(t){this.expandByDistances(t,t)},jsts.geom.Envelope.prototype.expandByDistances=function(t,e){this.isNull()||(this.minx-=t,this.maxx+=t,this.miny-=e,this.maxy+=e,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull())},jsts.geom.Envelope.prototype.translate=function(t,e){this.isNull()||this.init(this.minx+t,this.maxx+t,this.miny+e,this.maxy+e)},jsts.geom.Envelope.prototype.centre=function(){return this.isNull()?null:new jsts.geom.Coordinate((this.minx+this.maxx)/2,(this.miny+this.maxy)/2)},jsts.geom.Envelope.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new jsts.geom.Envelope;var e=this.minx>t.minx?this.minx:t.minx,n=this.miny>t.miny?this.miny:t.miny,i=this.maxx<t.maxx?this.maxx:t.maxx,o=this.maxy<t.maxy?this.maxy:t.maxy;return new jsts.geom.Envelope(e,i,n,o)},jsts.geom.Envelope.prototype.intersects=function(){return arguments[0]instanceof jsts.geom.Envelope?this.intersectsEnvelope(arguments[0]):arguments[0]instanceof jsts.geom.Coordinate?this.intersectsCoordinate(arguments[0]):this.intersectsValues(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.intersectsEnvelope=function(t){if(this.isNull()||t.isNull())return!1;var e=!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny);return e},jsts.geom.Envelope.prototype.intersectsCoordinate=function(t){return this.intersectsValues(t.x,t.y)},jsts.geom.Envelope.prototype.intersectsValues=function(t,e){return!this.isNull()&&!(t>this.maxx||t<this.minx||e>this.maxy||e<this.miny)},jsts.geom.Envelope.prototype.contains=function(){return arguments[0]instanceof jsts.geom.Envelope?this.containsEnvelope(arguments[0]):arguments[0]instanceof jsts.geom.Coordinate?this.containsCoordinate(arguments[0]):this.containsValues(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.containsEnvelope=function(t){return this.coversEnvelope(t)},jsts.geom.Envelope.prototype.containsCoordinate=function(t){return this.coversCoordinate(t)},jsts.geom.Envelope.prototype.containsValues=function(t,e){return this.coversValues(t,e)},jsts.geom.Envelope.prototype.covers=function(){return arguments[0]instanceof jsts.geom.Envelope?this.coversEnvelope(arguments[0]):arguments[0]instanceof jsts.geom.Coordinate?this.coversCoordinate(arguments[0]):this.coversValues(arguments[0],arguments[1])},jsts.geom.Envelope.prototype.coversValues=function(t,e){return!this.isNull()&&(t>=this.minx&&t<=this.maxx&&e>=this.miny&&e<=this.maxy)},jsts.geom.Envelope.prototype.coversCoordinate=function(t){return this.coversValues(t.x,t.y)},jsts.geom.Envelope.prototype.coversEnvelope=function(t){return!this.isNull()&&!t.isNull()&&(t.minx>=this.minx&&t.maxx<=this.maxx&&t.miny>=this.miny&&t.maxy<=this.maxy)},jsts.geom.Envelope.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this.maxx<t.minx&&(e=t.minx-this.maxx),this.minx>t.maxx&&(e=this.minx-t.maxx);var n=0;return this.maxy<t.miny&&(n=t.miny-this.maxy),this.miny>t.maxy&&(n=this.miny-t.maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},jsts.geom.Envelope.prototype.equals=function(t){return this.isNull()?t.isNull():this.maxx===t.maxx&&this.maxy===t.maxy&&this.minx===t.minx&&this.miny===t.miny},jsts.geom.Envelope.prototype.toString=function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},jsts.geom.Envelope.intersects=function(t,e,n){if(4===arguments.length)return jsts.geom.Envelope.intersectsEnvelope(arguments[0],arguments[1],arguments[2],arguments[3]);var i=t.x<e.x?t.x:e.x,o=t.x>e.x?t.x:e.x,r=t.y<e.y?t.y:e.y,s=t.y>e.y?t.y:e.y;return n.x>=i&&n.x<=o&&n.y>=r&&n.y<=s},jsts.geom.Envelope.intersectsEnvelope=function(t,e,n,i){var o=Math.min(n.x,i.x),r=Math.max(n.x,i.x),s=Math.min(t.x,e.x),a=Math.max(t.x,e.x);return!(s>r)&&(!(a<o)&&(o=Math.min(n.y,i.y),r=Math.max(n.y,i.y),s=Math.min(t.y,e.y),a=Math.max(t.y,e.y),!(s>r)&&!(a<o)))},jsts.geom.Envelope.prototype.clone=function(){return new jsts.geom.Envelope(this.minx,this.maxx,this.miny,this.maxy)},jsts.geom.util.GeometryCombiner=function(t){this.geomFactory=jsts.geom.util.GeometryCombiner.extractFactory(t),this.inputGeoms=t},jsts.geom.util.GeometryCombiner.combine=function(t){if(arguments.length>1)return this.combine2.apply(this,arguments);var e=new jsts.geom.util.GeometryCombiner(t);return e.combine()},jsts.geom.util.GeometryCombiner.combine2=function(){var t=new javascript.util.ArrayList;Array.prototype.slice.call(arguments).forEach(function(e){t.add(e)});var e=new jsts.geom.util.GeometryCombiner(t);return e.combine()},jsts.geom.util.GeometryCombiner.prototype.geomFactory=null,jsts.geom.util.GeometryCombiner.prototype.skipEmpty=!1,jsts.geom.util.GeometryCombiner.prototype.inputGeoms,jsts.geom.util.GeometryCombiner.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},jsts.geom.util.GeometryCombiner.prototype.combine=function(){var t,e=new javascript.util.ArrayList;for(t=this.inputGeoms.iterator();t.hasNext();){var n=t.next();this.extractElements(n,e)}return 0===e.size()?null!==this.geomFactory?this.geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(e)},jsts.geom.util.GeometryCombiner.prototype.extractElements=function(t,e){if(null!==t)for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this.skipEmpty&&i.isEmpty()||e.add(i)}},jsts.geom.PrecisionModel=function(t){return"number"==typeof t?(this.modelType=jsts.geom.PrecisionModel.FIXED,void(this.scale=t)):(this.modelType=t||jsts.geom.PrecisionModel.FLOATING,void(this.modelType===jsts.geom.PrecisionModel.FIXED&&(this.scale=1)))},jsts.geom.PrecisionModel.FLOATING="FLOATING",jsts.geom.PrecisionModel.FIXED="FIXED",jsts.geom.PrecisionModel.FLOATING_SINGLE="FLOATING_SINGLE",jsts.geom.PrecisionModel.prototype.scale=null,jsts.geom.PrecisionModel.prototype.modelType=null,jsts.geom.PrecisionModel.prototype.isFloating=function(){return this.modelType===jsts.geom.PrecisionModel.FLOATING||this.modelType===jsts.geom.PrecisionModel.FLOATING_SINLGE},jsts.geom.PrecisionModel.prototype.getScale=function(){return this.scale},jsts.geom.PrecisionModel.prototype.getType=function(){return this.modelType},jsts.geom.PrecisionModel.prototype.equals=function(t){return!0},jsts.geom.PrecisionModel.prototype.makePrecise=function(t){return t instanceof jsts.geom.Coordinate?void this.makePrecise2(t):isNaN(t)?t:this.modelType===jsts.geom.PrecisionModel.FIXED?Math.round(t*this.scale)/this.scale:t},jsts.geom.PrecisionModel.prototype.makePrecise2=function(t){this.modelType!==jsts.geom.PrecisionModel.FLOATING&&(t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y))},jsts.geom.PrecisionModel.prototype.compareTo=function(t){return 0},jsts.geom.CoordinateFilter=function(){},jsts.geom.CoordinateFilter.prototype.filter=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.simplify.DouglasPeuckerLineSimplifier=function(t){this.pts=t,this.seg=new jsts.geom.LineSegment},jsts.simplify.DouglasPeuckerLineSimplifier.prototype.pts=null,jsts.simplify.DouglasPeuckerLineSimplifier.prototype.usePt=null,jsts.simplify.DouglasPeuckerLineSimplifier.prototype.distanceTolerance=null,jsts.simplify.DouglasPeuckerLineSimplifier.simplify=function(t,e){var n=new jsts.simplify.DouglasPeuckerLineSimplifier(t);return n.setDistanceTolerance(e),n.simplify()},jsts.simplify.DouglasPeuckerLineSimplifier.prototype.setDistanceTolerance=function(t){this.distanceTolerance=t},jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplify=function(){this.usePt=[];for(var t=0;t<this.pts.length;t++)this.usePt[t]=!0;this.simplifySection(0,this.pts.length-1);for(var e=new jsts.geom.CoordinateList,n=0;n<this.pts.length;n++)this.usePt[n]&&e.add(new jsts.geom.Coordinate(this.pts[n]));return e.toCoordinateArray()},jsts.simplify.DouglasPeuckerLineSimplifier.prototype.seg=null,jsts.simplify.DouglasPeuckerLineSimplifier.prototype.simplifySection=function(t,e){if(t+1!=e){this.seg.p0=this.pts[t],this.seg.p1=this.pts[e];for(var n=-1,i=t,o=t+1;o<e;o++){var r=this.seg.distance(this.pts[o]);r>n&&(n=r,i=o)}if(n<=this.distanceTolerance)for(var s=t+1;s<e;s++)this.usePt[s]=!1;else this.simplifySection(t,i),this.simplifySection(i,e)}},jsts.geomgraph.EdgeIntersection=function(t,e,n){this.coord=new jsts.geom.Coordinate(t),this.segmentIndex=e,this.dist=n},jsts.geomgraph.EdgeIntersection.prototype.coord=null,jsts.geomgraph.EdgeIntersection.prototype.segmentIndex=null,jsts.geomgraph.EdgeIntersection.prototype.dist=null,jsts.geomgraph.EdgeIntersection.prototype.getCoordinate=function(){return this.coord},jsts.geomgraph.EdgeIntersection.prototype.getSegmentIndex=function(){return this.segmentIndex},jsts.geomgraph.EdgeIntersection.prototype.getDistance=function(){return this.dist},jsts.geomgraph.EdgeIntersection.prototype.compareTo=function(t){return this.compare(t.segmentIndex,t.dist)},jsts.geomgraph.EdgeIntersection.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},jsts.geomgraph.EdgeIntersection.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},jsts.geomgraph.EdgeIntersection.prototype.toString=function(){return""+this.segmentIndex+this.dist},function(){var t=jsts.geomgraph.EdgeIntersection,e=javascript.util.TreeMap;jsts.geomgraph.EdgeIntersectionList=function(t){this.nodeMap=new e,this.edge=t},jsts.geomgraph.EdgeIntersectionList.prototype.nodeMap=null,jsts.geomgraph.EdgeIntersectionList.prototype.edge=null,jsts.geomgraph.EdgeIntersectionList.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next();if(n.coord.equals(t))return!0}return!1},jsts.geomgraph.EdgeIntersectionList.prototype.add=function(e,n,i){var o=new t(e,n,i),r=this.nodeMap.get(o);return null!==r?r:(this.nodeMap.put(o,o),o)},jsts.geomgraph.EdgeIntersectionList.prototype.iterator=function(){return this.nodeMap.values().iterator()},jsts.geomgraph.EdgeIntersectionList.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},jsts.geomgraph.EdgeIntersectionList.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),o=this.createSplitEdge(n,i);t.add(o),n=i}},jsts.geomgraph.EdgeIntersectionList.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],o=e.dist>0||!e.coord.equals2D(i);o||n--;var r=[],s=0;r[s++]=new jsts.geom.Coordinate(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)r[s++]=this.edge.pts[a];return o&&(r[s]=e.coord),new jsts.geomgraph.Edge(r,new jsts.geomgraph.Label(this.edge.label))}}(),function(){var t=function(t){this.message=t};t.prototype=new Error,t.prototype.name="AssertionFailedException",jsts.util.AssertionFailedException=t}(),function(){var t=jsts.util.AssertionFailedException;jsts.util.Assert=function(){},jsts.util.Assert.isTrue=function(e,n){if(!e)throw null===n?new t:new t(n)},jsts.util.Assert.equals=function(e,n,i){if(!n.equals(e))throw new t("Expected "+e+" but encountered "+n+(null!=i?": "+i:""))},jsts.util.Assert.shouldNeverReachHere=function(e){throw new t("Should never reach here"+(null!=e?": "+e:""))}}(),function(){var t=jsts.geom.Location,e=jsts.util.Assert,n=javascript.util.ArrayList;jsts.operation.relate.RelateComputer=function(t){this.li=new jsts.algorithm.RobustLineIntersector,this.ptLocator=new jsts.algorithm.PointLocator,this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory),this.isolatedEdges=new n,this.arg=t},jsts.operation.relate.RelateComputer.prototype.li=null,jsts.operation.relate.RelateComputer.prototype.ptLocator=null,jsts.operation.relate.RelateComputer.prototype.arg=null,jsts.operation.relate.RelateComputer.prototype.nodes=null,jsts.operation.relate.RelateComputer.prototype.im=null,jsts.operation.relate.RelateComputer.prototype.isolatedEdges=null,jsts.operation.relate.RelateComputer.prototype.invalidPoint=null,jsts.operation.relate.RelateComputer.prototype.computeIM=function(){var e=new jsts.geom.IntersectionMatrix;if(e.set(t.EXTERIOR,t.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(e),e;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var n=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(n,e);var i=new jsts.operation.relate.EdgeEndBuilder,o=i.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(o);var r=i.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(e),e},jsts.operation.relate.RelateComputer.prototype.insertEdgeEnds=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},jsts.operation.relate.RelateComputer.prototype.computeProperIntersectionIM=function(t,e){var n=this.arg[0].getGeometry().getDimension(),i=this.arg[1].getGeometry().getDimension(),o=t.hasProperIntersection(),r=t.hasProperInteriorIntersection();2===n&&2===i?o&&e.setAtLeast("212101212"):2===n&&1===i?(o&&e.setAtLeast("FFF0FFFF2"),r&&e.setAtLeast("1FFFFF1FF")):1===n&&2===i?(o&&e.setAtLeast("F0FFFFFF2"),r&&e.setAtLeast("1F1FFFFFF")):1===n&&1===i&&r&&e.setAtLeast("0FFFFFFFF")},jsts.operation.relate.RelateComputer.prototype.copyNodesAndLabels=function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next(),i=this.nodes.addNode(n.getCoordinate());i.setLabel(t,n.getLabel().getLocation(t))}},jsts.operation.relate.RelateComputer.prototype.computeIntersectionNodes=function(e){for(var n=this.arg[e].getEdgeIterator();n.hasNext();)for(var i=n.next(),o=i.getLabel().getLocation(e),r=i.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),a=this.nodes.addNode(s.coord);o===t.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,t.INTERIOR)}},jsts.operation.relate.RelateComputer.prototype.labelIntersectionNodes=function(e){for(var n=this.arg[e].getEdgeIterator();n.hasNext();)for(var i=n.next(),o=i.getLabel().getLocation(e),r=i.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),a=this.nodes.find(s.coord);a.getLabel().isNull(e)&&(o===t.BOUNDARY?a.setLabelBoundary(e):a.setLabel(e,t.INTERIOR))}},jsts.operation.relate.RelateComputer.prototype.computeDisjointIM=function(e){var n=this.arg[0].getGeometry();n.isEmpty()||(e.set(t.INTERIOR,t.EXTERIOR,n.getDimension()),e.set(t.BOUNDARY,t.EXTERIOR,n.getBoundaryDimension()));var i=this.arg[1].getGeometry();i.isEmpty()||(e.set(t.EXTERIOR,t.INTERIOR,i.getDimension()),e.set(t.EXTERIOR,t.BOUNDARY,i.getBoundaryDimension()))},jsts.operation.relate.RelateComputer.prototype.labelNodeEdges=function(){for(var t=this.nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().computeLabelling(this.arg)}},jsts.operation.relate.RelateComputer.prototype.updateIM=function(t){for(var e=this.isolatedEdges.iterator();e.hasNext();){var n=e.next();n.updateIM(t)}for(var i=this.nodes.iterator();i.hasNext();){var o=i.next();o.updateIM(t),o.updateIMFromEdges(t)}},jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdges=function(t,e){for(var n=this.arg[t].getEdgeIterator();n.hasNext();){var i=n.next();i.isIsolated()&&(this.labelIsolatedEdge(i,e,this.arg[e].getGeometry()),this.isolatedEdges.add(i))}},jsts.operation.relate.RelateComputer.prototype.labelIsolatedEdge=function(e,n,i){if(i.getDimension()>0){var o=this.ptLocator.locate(e.getCoordinate(),i);e.getLabel().setAllLocations(n,o)}else e.getLabel().setAllLocations(n,t.EXTERIOR)},jsts.operation.relate.RelateComputer.prototype.labelIsolatedNodes=function(){for(var t=this.nodes.iterator();t.hasNext();){var n=t.next(),i=n.getLabel();e.isTrue(i.getGeometryCount()>0,"node with empty label found"),n.isIsolated()&&(i.isNull(0)?this.labelIsolatedNode(n,0):this.labelIsolatedNode(n,1))}},jsts.operation.relate.RelateComputer.prototype.labelIsolatedNode=function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setAllLocations(e,n)}}(),function(){var t=jsts.util.Assert;jsts.geomgraph.GraphComponent=function(t){this.label=t},jsts.geomgraph.GraphComponent.prototype.label=null,jsts.geomgraph.GraphComponent.prototype._isInResult=!1,jsts.geomgraph.GraphComponent.prototype._isCovered=!1,jsts.geomgraph.GraphComponent.prototype._isCoveredSet=!1,jsts.geomgraph.GraphComponent.prototype._isVisited=!1,jsts.geomgraph.GraphComponent.prototype.getLabel=function(){return this.label},jsts.geomgraph.GraphComponent.prototype.setLabel=function(t){return 2===arguments.length?void this.setLabel2.apply(this,arguments):void(this.label=t)},jsts.geomgraph.GraphComponent.prototype.setInResult=function(t){this._isInResult=t},jsts.geomgraph.GraphComponent.prototype.isInResult=function(){return this._isInResult},jsts.geomgraph.GraphComponent.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},jsts.geomgraph.GraphComponent.prototype.isCovered=function(){return this._isCovered},jsts.geomgraph.GraphComponent.prototype.isCoveredSet=function(){return this._isCoveredSet},jsts.geomgraph.GraphComponent.prototype.isVisited=function(){return this._isVisited},jsts.geomgraph.GraphComponent.prototype.setVisited=function(t){this._isVisited=t},jsts.geomgraph.GraphComponent.prototype.getCoordinate=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.GraphComponent.prototype.computeIM=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.GraphComponent.prototype.isIsolated=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.GraphComponent.prototype.updateIM=function(e){t.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)}}(),jsts.geomgraph.Node=function(t,e){this.coord=t,this.edges=e,this.label=new jsts.geomgraph.Label(0,jsts.geom.Location.NONE)},jsts.geomgraph.Node.prototype=new jsts.geomgraph.GraphComponent,jsts.geomgraph.Node.prototype.coord=null,jsts.geomgraph.Node.prototype.edges=null,jsts.geomgraph.Node.prototype.isIsolated=function(){return 1==this.label.getGeometryCount()},jsts.geomgraph.Node.prototype.setLabel2=function(t,e){null===this.label?this.label=new jsts.geomgraph.Label(t,e):this.label.setLocation(t,e)},jsts.geomgraph.Node.prototype.setLabelBoundary=function(t){var e=jsts.geom.Location.NONE;null!==this.label&&(e=this.label.getLocation(t));var n;switch(e){case jsts.geom.Location.BOUNDARY:n=jsts.geom.Location.INTERIOR;break;case jsts.geom.Location.INTERIOR:n=jsts.geom.Location.BOUNDARY;break;default:n=jsts.geom.Location.BOUNDARY}this.label.setLocation(t,n)},jsts.geomgraph.Node.prototype.add=function(t){this.edges.insert(t),t.setNode(this)},jsts.geomgraph.Node.prototype.getCoordinate=function(){return this.coord},jsts.geomgraph.Node.prototype.getEdges=function(){return this.edges},jsts.geomgraph.Node.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();){var e=t.next();if(e.getEdge().isInResult())return!0}return!1},jsts.geom.Point=function(t,e){this.factory=e,void 0!==t&&(this.coordinate=t)},jsts.geom.Point.prototype=new jsts.geom.Geometry,jsts.geom.Point.constructor=jsts.geom.Point,jsts.geom.Point.CLASS_NAME="jsts.geom.Point",jsts.geom.Point.prototype.coordinate=null,jsts.geom.Point.prototype.getX=function(){return this.coordinate.x},jsts.geom.Point.prototype.getY=function(){return this.coordinate.y},jsts.geom.Point.prototype.getCoordinate=function(){return this.coordinate},jsts.geom.Point.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.coordinate]},jsts.geom.Point.prototype.getCoordinateSequence=function(){return this.isEmpty()?[]:[this.coordinate]},jsts.geom.Point.prototype.isEmpty=function(){return null===this.coordinate},jsts.geom.Point.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.equal(t.getCoordinate(),this.getCoordinate(),e))},jsts.geom.Point.prototype.getNumPoints=function(){return this.isEmpty()?0:1},jsts.geom.Point.prototype.isSimple=function(){return!0},jsts.geom.Point.prototype.getBoundary=function(){return new jsts.geom.GeometryCollection(null)},jsts.geom.Point.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new jsts.geom.Envelope:new jsts.geom.Envelope(this.coordinate)},jsts.geom.Point.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryFilter||t instanceof jsts.geom.GeometryComponentFilter)t.filter(this);else if(t instanceof jsts.geom.CoordinateFilter){if(this.isEmpty())return;t.filter(this.getCoordinate())}},jsts.geom.Point.prototype.clone=function(){return new jsts.geom.Point(this.coordinate.clone(),this.factory)},jsts.geom.Point.prototype.getDimension=function(){return 0},jsts.geom.Point.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE},jsts.geom.Point.prototype.reverse=function(){return this.clone()},jsts.geom.Point.prototype.isValid=function(){return!!jsts.operation.valid.IsValidOp.isValid(this.getCoordinate())},jsts.geom.Point.prototype.normalize=function(){},jsts.geom.Point.prototype.compareToSameClass=function(t){var e=t;return this.getCoordinate().compareTo(e.getCoordinate())},jsts.geom.Point.prototype.getGeometryType=function(){return"Point"},jsts.geom.Point.prototype.hashCode=function(){return"Point_"+this.coordinate.hashCode()},jsts.geom.Point.prototype.CLASS_NAME="jsts.geom.Point",jsts.geom.Dimension=function(){},jsts.geom.Dimension.P=0,jsts.geom.Dimension.L=1,jsts.geom.Dimension.A=2,jsts.geom.Dimension.FALSE=-1,jsts.geom.Dimension.TRUE=-2,jsts.geom.Dimension.DONTCARE=-3,jsts.geom.Dimension.toDimensionSymbol=function(t){switch(t){case jsts.geom.Dimension.FALSE:return"F";case jsts.geom.Dimension.TRUE:return"T";case jsts.geom.Dimension.DONTCARE:return"*";case jsts.geom.Dimension.P:return"0";case jsts.geom.Dimension.L:return"1";case jsts.geom.Dimension.A:return"2"}throw new jsts.IllegalArgumentError("Unknown dimension value: "+t)},jsts.geom.Dimension.toDimensionValue=function(t){switch(t.toUpperCase()){case"F":return jsts.geom.Dimension.FALSE;case"T":return jsts.geom.Dimension.TRUE;case"*":return jsts.geom.Dimension.DONTCARE;case"0":return jsts.geom.Dimension.P;case"1":return jsts.geom.Dimension.L;case"2":return jsts.geom.Dimension.A}throw new jsts.error.IllegalArgumentError("Unknown dimension symbol: "+t)},function(){var t=jsts.geom.Dimension;jsts.geom.LineString=function(t,e){this.factory=e,this.points=t||[]},jsts.geom.LineString.prototype=new jsts.geom.Geometry,jsts.geom.LineString.constructor=jsts.geom.LineString,jsts.geom.LineString.prototype.points=null,jsts.geom.LineString.prototype.getCoordinates=function(){return this.points},jsts.geom.LineString.prototype.getCoordinateSequence=function(){return this.points},jsts.geom.LineString.prototype.getCoordinateN=function(t){return this.points[t]},jsts.geom.LineString.prototype.getCoordinate=function(){return this.isEmpty()?null:this.getCoordinateN(0)},jsts.geom.LineString.prototype.getDimension=function(){return 1},jsts.geom.LineString.prototype.getBoundaryDimension=function(){return this.isClosed()?t.FALSE:0},jsts.geom.LineString.prototype.isEmpty=function(){return 0===this.points.length;
},jsts.geom.LineString.prototype.getNumPoints=function(){return this.points.length},jsts.geom.LineString.prototype.getPointN=function(t){return this.getFactory().createPoint(this.points[t])},jsts.geom.LineString.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},jsts.geom.LineString.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},jsts.geom.LineString.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.points.length-1))},jsts.geom.LineString.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},jsts.geom.LineString.prototype.getGeometryType=function(){return"LineString"},jsts.geom.LineString.prototype.getLength=function(){return jsts.algorithm.CGAlgorithms.computeLength(this.points)},jsts.geom.LineString.prototype.getBoundary=function(){return new jsts.operation.BoundaryOp(this).getBoundary()},jsts.geom.LineString.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new jsts.geom.Envelope;var t=new jsts.geom.Envelope;return this.points.forEach(function(e){t.expandToInclude(e)}),t},jsts.geom.LineString.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&(this.points.length===t.points.length&&(!(!this.isEmpty()||!t.isEmpty())||this.points.reduce(function(n,i,o){return n&&jsts.geom.Geometry.prototype.equal(i,t.points[o],e)})))},jsts.geom.LineString.prototype.isEquivalentClass=function(t){return t instanceof jsts.geom.LineString},jsts.geom.LineString.prototype.compareToSameClass=function(t){for(var e=t,n=0,i=this.points.length,o=0,r=e.points.length;n<i&&o<r;){var s=this.points[n].compareTo(e.points[o]);if(0!==s)return s;n++,o++}return n<i?1:o<r?-1:0},jsts.geom.LineString.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryFilter||t instanceof jsts.geom.GeometryComponentFilter)t.filter(this);else if(t instanceof jsts.geom.CoordinateFilter)for(var e=0,n=this.points.length;e<n;e++)t.filter(this.points[e]);else t instanceof jsts.geom.CoordinateSequenceFilter&&this.apply2.apply(this,arguments)},jsts.geom.LineString.prototype.apply2=function(t){if(0!==this.points.length){for(var e=0;e<this.points.length&&(t.filter(this.points,e),!t.isDone());e++);t.isGeometryChanged()}},jsts.geom.LineString.prototype.clone=function(){for(var t=[],e=0,n=this.points.length;e<n;e++)t.push(this.points[e].clone());return this.factory.createLineString(t)},jsts.geom.LineString.prototype.normalize=function(){var t,e,n,i,o,r;for(r=this.points.length,e=parseInt(r/2),t=0;t<e;t++)if(n=r-1-t,i=this.points[t],o=this.points[n],!i.equals(o))return void(i.compareTo(o)>0&&this.points.reverse())},jsts.geom.LineString.prototype.CLASS_NAME="jsts.geom.LineString"}(),function(){jsts.geom.Polygon=function(t,e,n){this.shell=t||n.createLinearRing(null),this.holes=e||[],this.factory=n},jsts.geom.Polygon.prototype=new jsts.geom.Geometry,jsts.geom.Polygon.constructor=jsts.geom.Polygon,jsts.geom.Polygon.prototype.getCoordinate=function(){return this.shell.getCoordinate()},jsts.geom.Polygon.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=[],e=-1,n=this.shell.getCoordinates(),i=0;i<n.length;i++)e++,t[e]=n[i];for(var o=0;o<this.holes.length;o++)for(var r=this.holes[o].getCoordinates(),s=0;s<r.length;s++)e++,t[e]=r[s];return t},jsts.geom.Polygon.prototype.getNumPoints=function(){for(var t=this.shell.getNumPoints(),e=0;e<this.holes.length;e++)t+=this.holes[e].getNumPoints();return t},jsts.geom.Polygon.prototype.isEmpty=function(){return this.shell.isEmpty()},jsts.geom.Polygon.prototype.isRectangle=function(){if(0!=this.getNumInteriorRing())return!1;if(null==this.shell)return!1;if(5!=this.shell.getNumPoints())return!1;for(var t=this.shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t[n].x;if(i!=e.getMinX()&&i!=e.getMaxX())return!1;var o=t[n].y;if(o!=e.getMinY()&&o!=e.getMaxY())return!1}for(var r=t[0].x,s=t[0].y,n=1;n<=4;n++){var i=t[n].x,o=t[n].y,a=i!=r,l=o!=s;if(a==l)return!1;r=i,s=o}return!0},jsts.geom.Polygon.prototype.getExteriorRing=function(){return this.shell},jsts.geom.Polygon.prototype.getInteriorRingN=function(t){return this.holes[t]},jsts.geom.Polygon.prototype.getNumInteriorRing=function(){return this.holes.length},jsts.geom.Polygon.prototype.getArea=function(){var t=0;t+=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.shell.getCoordinateSequence()));for(var e=0;e<this.holes.length;e++)t-=Math.abs(jsts.algorithm.CGAlgorithms.signedArea(this.holes[e].getCoordinateSequence()));return t},jsts.geom.Polygon.prototype.getLength=function(){var t=0;t+=this.shell.getLength();for(var e=0;e<this.holes.length;e++)t+=this.holes[e].getLength();return t},jsts.geom.Polygon.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString(null);var t=[];t[0]=this.shell.clone();for(var e=0,n=this.holes.length;e<n;e++)t[e+1]=this.holes[e].clone();return t.length<=1?t[0]:this.getFactory().createMultiLineString(t)},jsts.geom.Polygon.prototype.computeEnvelopeInternal=function(){return this.shell.getEnvelopeInternal()},jsts.geom.Polygon.prototype.getDimension=function(){return 2},jsts.geom.Polygon.prototype.getBoundaryDimension=function(){return 1},jsts.geom.Polygon.prototype.equalsExact=function(t,e){if(!this.isEquivalentClass(t))return!1;if(this.isEmpty()&&t.isEmpty())return!0;if(this.isEmpty()!==t.isEmpty())return!1;if(!this.shell.equalsExact(t.shell,e))return!1;if(this.holes.length!==t.holes.length)return!1;if(this.holes.length!==t.holes.length)return!1;for(var n=0;n<this.holes.length;n++)if(!this.holes[n].equalsExact(t.holes[n],e))return!1;return!0},jsts.geom.Polygon.prototype.compareToSameClass=function(t){return this.shell.compareToSameClass(t.shell)},jsts.geom.Polygon.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryComponentFilter){t.filter(this),this.shell.apply(t);for(var e=0,n=this.holes.length;e<n;e++)this.holes[e].apply(t)}else if(t instanceof jsts.geom.GeometryFilter)t.filter(this);else if(t instanceof jsts.geom.CoordinateFilter){this.shell.apply(t);for(var e=0,n=this.holes.length;e<n;e++)this.holes[e].apply(t)}else t instanceof jsts.geom.CoordinateSequenceFilter&&this.apply2.apply(this,arguments)},jsts.geom.Polygon.prototype.apply2=function(t){if(this.shell.apply(t),!t.isDone())for(var e=0;e<this.holes.length&&(this.holes[e].apply(t),!t.isDone());e++);t.isGeometryChanged()},jsts.geom.Polygon.prototype.clone=function(){for(var t=[],e=0,n=this.holes.length;e<n;e++)t.push(this.holes[e].clone());return this.factory.createPolygon(this.shell.clone(),t)},jsts.geom.Polygon.prototype.normalize=function(){this.normalize2(this.shell,!0);for(var t=0,e=this.holes.length;t<e;t++)this.normalize2(this.holes[t],!1);this.holes.sort()},jsts.geom.Polygon.prototype.normalize2=function(t,e){if(!t.isEmpty()){var n=t.points.slice(0,t.points.length-1),i=jsts.geom.CoordinateArrays.minCoordinate(t.points);jsts.geom.CoordinateArrays.scroll(n,i),t.points=n.concat(),t.points[n.length]=n[0],jsts.algorithm.CGAlgorithms.isCCW(t.points)===e&&t.points.reverse()}},jsts.geom.Polygon.prototype.getGeometryType=function(){return"Polygon"},jsts.geom.Polygon.prototype.CLASS_NAME="jsts.geom.Polygon"}(),function(){var t=jsts.geom.Geometry,e=javascript.util.TreeSet,n=javascript.util.Arrays;jsts.geom.GeometryCollection=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.GeometryCollection.prototype=new t,jsts.geom.GeometryCollection.constructor=jsts.geom.GeometryCollection,jsts.geom.GeometryCollection.prototype.isEmpty=function(){for(var t=0,e=this.geometries.length;t<e;t++){var n=this.getGeometryN(t);if(!n.isEmpty())return!1}return!0},jsts.geom.GeometryCollection.prototype.getArea=function(){for(var t=0,e=0,n=this.geometries.length;e<n;e++)t+=this.getGeometryN(e).getArea();return t},jsts.geom.GeometryCollection.prototype.getLength=function(){for(var t=0,e=0,n=this.geometries.length;e<n;e++)t+=this.getGeometryN(e).getLength();return t},jsts.geom.GeometryCollection.prototype.getCoordinate=function(){return this.isEmpty()?null:this.getGeometryN(0).getCoordinate()},jsts.geom.GeometryCollection.prototype.getCoordinates=function(){for(var t=[],e=-1,n=0,i=this.geometries.length;n<i;n++)for(var o=this.getGeometryN(n),r=o.getCoordinates(),s=0;s<r.length;s++)e++,t[e]=r[s];return t},jsts.geom.GeometryCollection.prototype.getNumGeometries=function(){return this.geometries.length},jsts.geom.GeometryCollection.prototype.getGeometryN=function(t){var e=this.geometries[t];return e instanceof jsts.geom.Coordinate&&(e=new jsts.geom.Point(e)),e},jsts.geom.GeometryCollection.prototype.getNumPoints=function(t){for(var e=0,n=0;n<this.geometries.length;n++)e+=this.geometries[n].getNumPoints();return e},jsts.geom.GeometryCollection.prototype.equalsExact=function(t,e){if(!this.isEquivalentClass(t))return!1;if(this.geometries.length!==t.geometries.length)return!1;for(var n=0,i=this.geometries.length;n<i;n++){var o=this.getGeometryN(n);if(!o.equalsExact(t.getGeometryN(n),e))return!1}return!0},jsts.geom.GeometryCollection.prototype.clone=function(){for(var t=[],e=0,n=this.geometries.length;e<n;e++)t.push(this.geometries[e].clone());return this.factory.createGeometryCollection(t)},jsts.geom.GeometryCollection.prototype.normalize=function(){for(var t=0,e=this.geometries.length;t<e;t++)this.getGeometryN(t).normalize();this.geometries.sort()},jsts.geom.GeometryCollection.prototype.compareToSameClass=function(t){var i=new e(n.asList(this.geometries)),o=new e(n.asList(t.geometries));return this.compare(i,o)},jsts.geom.GeometryCollection.prototype.apply=function(t){if(t instanceof jsts.geom.GeometryFilter||t instanceof jsts.geom.GeometryComponentFilter){t.filter(this);for(var e=0,n=this.geometries.length;e<n;e++)this.getGeometryN(e).apply(t)}else if(t instanceof jsts.geom.CoordinateFilter)for(var e=0,n=this.geometries.length;e<n;e++)this.getGeometryN(e).apply(t);else t instanceof jsts.geom.CoordinateSequenceFilter&&this.apply2.apply(this,arguments)},jsts.geom.GeometryCollection.prototype.apply2=function(t){if(0!=this.geometries.length){for(var e=0;e<this.geometries.length&&(this.geometries[e].apply(t),!t.isDone());e++);t.isGeometryChanged()}},jsts.geom.GeometryCollection.prototype.getDimension=function(){for(var t=jsts.geom.Dimension.FALSE,e=0,n=this.geometries.length;e<n;e++){var i=this.getGeometryN(e);t=Math.max(t,i.getDimension())}return t},jsts.geom.GeometryCollection.prototype.computeEnvelopeInternal=function(){for(var t=new jsts.geom.Envelope,e=0,n=this.geometries.length;e<n;e++){var i=this.getGeometryN(e);t.expandToInclude(i.getEnvelopeInternal())}return t},jsts.geom.GeometryCollection.prototype.CLASS_NAME="jsts.geom.GeometryCollection"}(),jsts.algorithm.Centroid=function(t){this.areaBasePt=null,this.triangleCent3=new jsts.geom.Coordinate,this.areasum2=0,this.cg3=new jsts.geom.Coordinate,this.lineCentSum=new jsts.geom.Coordinate,this.totalLength=0,this.ptCount=0,this.ptCentSum=new jsts.geom.Coordinate,this.add(t)},jsts.algorithm.Centroid.getCentroid=function(t){var e=new jsts.algorithm.Centroid(t);return e.getCentroid()},jsts.algorithm.Centroid.centroid3=function(t,e,n,i){i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y},jsts.algorithm.Centroid.area2=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},jsts.algorithm.Centroid.prototype.add=function(t){if(!t.isEmpty())if(t instanceof jsts.geom.Point)this.addPoint(t.getCoordinate());else if(t instanceof jsts.geom.LineString)this.addLineSegments(t.getCoordinates());else if(t instanceof jsts.geom.Polygon)this.addPolygon(t);else if(t instanceof jsts.geom.GeometryCollection)for(var e=0;e<t.getNumGeometries();e++)this.add(t.getGeometryN(e))},jsts.algorithm.Centroid.prototype.getCentroid=function(){var t=new jsts.geom.Coordinate;if(Math.abs(this.areasum2)>0)t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2;else if(this.totalLength>0)t.x=this.lineCentSum.x/this.totalLength,t.y=this.lineCentSum.y/this.totalLength;else{if(!(this.ptCount>0))return null;t.x=this.ptCentSum.x/this.ptCount,t.y=this.ptCentSum.y/this.ptCount}return t},jsts.algorithm.Centroid.prototype.setBasePoint=function(t){null===this.areaBasePt&&(this.areaBasePt=t)},jsts.algorithm.Centroid.prototype.addPolygon=function(t){this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())},jsts.algorithm.Centroid.prototype.addShell=function(t){t.length>0&&this.setBasePoint(t[0]);for(var e=!jsts.algorithm.CGAlgorithms.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},jsts.algorithm.Centroid.prototype.addHole=function(t){for(var e=jsts.algorithm.CGAlgorithms.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},jsts.algorithm.Centroid.prototype.addTriangle=function(t,e,n,i){var o=i?1:-1;jsts.algorithm.Centroid.centroid3(t,e,n,this.triangleCent3);var r=jsts.algorithm.Centroid.area2(t,e,n);this.cg3.x+=o*r*this.triangleCent3.x,this.cg3.y+=o*r*this.triangleCent3.y,this.areasum2+=o*r},jsts.algorithm.Centroid.prototype.addLineSegments=function(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);if(0!==i){e+=i;var o=(t[n].x+t[n+1].x)/2;this.lineCentSum.x+=i*o;var r=(t[n].y+t[n+1].y)/2;this.lineCentSum.y+=i*r}}this.totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])},jsts.algorithm.Centroid.prototype.addPoint=function(t){this.ptCount+=1,this.ptCentSum.x+=t.x,this.ptCentSum.y+=t.y},function(){var t=function(t){this.deList=new javascript.util.ArrayList,this.factory=t};t.findEdgeRingContaining=function(t,e){for(var n=t.getRing(),i=n.getEnvelopeInternal(),o=n.getCoordinateN(0),r=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),d=l.getRing(),c=d.getEnvelopeInternal();null!=r&&(s=r.getRing().getEnvelopeInternal());var h=!1;c.equals(i)||(o=jsts.geom.CoordinateArrays.ptNotInList(n.getCoordinates(),d.getCoordinates()),c.contains(i)&&jsts.algorithm.CGAlgorithms.isPointInRing(o,d.getCoordinates())&&(h=!0),h&&(null==r||s.contains(c))&&(r=l))}return r},t.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(!isInList(i,e))return i}return null},t.isInList=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return!0;return!1},t.prototype.factory=null,t.prototype.deList=null,t.prototype.ring=null,t.prototype.ringPts=null,t.prototype.holes=null,t.prototype.add=function(t){this.deList.add(t)},t.prototype.isHole=function(){var t=this.getRing();return jsts.algorithm.CGAlgorithms.isCCW(t.getCoordinates())},t.prototype.addHole=function(t){null==this.holes&&(this.holes=new javascript.util.ArrayList),this.holes.add(t)},t.prototype.getPolygon=function(){var t=null;if(null!=this.holes){t=[];for(var e=0;e<this.holes.size();e++)t[e]=this.holes.get(e)}var n=this.factory.createPolygon(this.ring,t);return n},t.prototype.isValid=function(){return this.getCoordinates(),!(this.ringPts.length<=3)&&(this.getRing(),this.ring.isValid())},t.prototype.getCoordinates=function(){if(null==this.ringPts){for(var e=new jsts.geom.CoordinateList,n=this.deList.iterator();n.hasNext();){var i=n.next(),o=i.getEdge();t.addEdge(o.getLine().getCoordinates(),i.getEdgeDirection(),e)}this.ringPts=e.toCoordinateArray()}return this.ringPts},t.prototype.getLineString=function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},t.prototype.getRing=function(){if(null!=this.ring)return this.ring;this.getCoordinates(),this.ringPts.length<3&&console.log(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){console.log(this.ringPts)}return this.ring},t.addEdge=function(t,e,n){if(e)for(var i=0;i<t.length;i++)n.add(t[i],!1);else for(var i=t.length-1;i>=0;i--)n.add(t[i],!1)},jsts.operation.polygonize.EdgeRing=t}(),function(){var t=function(){};t.setVisited=function(t,e){for(;t.hasNext();){var n=t.next();n.setVisited(e)}},t.setMarked=function(t,e){for(;t.hasNext();){var n=t.next();n.setMarked(e)}},t.getComponentWithVisitedState=function(t,e){for(;t.hasNext();){var n=t.next();if(n.isVisited()==e)return n}return null},t.prototype._isMarked=!1,t.prototype._isVisited=!1,t.prototype.data,t.prototype.isVisited=function(){return this._isVisited},t.prototype.setVisited=function(t){this._isVisited=t},t.prototype.isMarked=function(){return this._isMarked},t.prototype.setMarked=function(t){this._isMarked=t},t.prototype.setContext=function(t){this.data=t},t.prototype.getContext=function(){return data},t.prototype.setData=function(t){this.data=t},t.prototype.getData=function(){return data},t.prototype.isRemoved=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.planargraph.GraphComponent=t}(),function(){var t=jsts.planargraph.GraphComponent,e=function(t,e){void 0!==t&&this.setDirectedEdges(t,e)};e.prototype=new t,e.prototype.dirEdge=null,e.prototype.setDirectedEdges=function(t,e){this.dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)},e.prototype.getDirEdge=function(t){return t instanceof jsts.planargraph.Node&&this.getDirEdge2(t),this.dirEdge[t]},e.prototype.getDirEdge2=function(t){return this.dirEdge[0].getFromNode()==t?this.dirEdge[0]:this.dirEdge[1].getFromNode()==t?this.dirEdge[1]:null},e.prototype.getOppositeNode=function(t){return this.dirEdge[0].getFromNode()==t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()==t?this.dirEdge[1].getToNode():null},e.prototype.remove=function(){this.dirEdge=null},e.prototype.isRemoved=function(){return null==dirEdge},jsts.planargraph.Edge=e}(),jsts.operation.polygonize.PolygonizeEdge=function(t){this.line=t},jsts.operation.polygonize.PolygonizeEdge.prototype=new jsts.planargraph.Edge,jsts.operation.polygonize.PolygonizeEdge.prototype.line=null,jsts.operation.polygonize.PolygonizeEdge.prototype.getLine=function(){return this.line},function(){var t=javascript.util.ArrayList,e=jsts.planargraph.GraphComponent,n=function(t,e,n,i){if(void 0!==t){this.from=t,this.to=e,this.edgeDirection=i,this.p0=t.getCoordinate(),this.p1=n;var o=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y;this.quadrant=jsts.geomgraph.Quadrant.quadrant(o,r),this.angle=Math.atan2(r,o)}};n.prototype=new e,n.toEdges=function(e){for(var n=new t,i=e.iterator();i.hasNext();)n.add(i.next().parentEdge);return n},n.prototype.parentEdge=null,n.prototype.from=null,n.prototype.to=null,n.prototype.p0=null,n.prototype.p1=null,n.prototype.sym=null,n.prototype.edgeDirection=null,n.prototype.quadrant=null,n.prototype.angle=null,n.prototype.getEdge=function(){return this.parentEdge},n.prototype.setEdge=function(t){this.parentEdge=t},n.prototype.getQuadrant=function(){return this.quadrant},n.prototype.getDirectionPt=function(){return this.p1},n.prototype.getEdgeDirection=function(){return this.edgeDirection},n.prototype.getFromNode=function(){return this.from},n.prototype.getToNode=function(){return this.to},n.prototype.getCoordinate=function(){return this.from.getCoordinate()},n.prototype.getAngle=function(){return this.angle},n.prototype.getSym=function(){return this.sym},n.prototype.setSym=function(t){this.sym=t},n.prototype.remove=function(){this.sym=null,this.parentEdge=null},n.prototype.isRemoved=function(){return null==this.parentEdge},n.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},n.prototype.compareDirection=function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:jsts.algorithm.CGAlgorithms.computeOrientation(t.p0,t.p1,this.p1)},jsts.planargraph.DirectedEdge=n}(),function(){var t=jsts.planargraph.DirectedEdge,e=function(e,n,i,o){t.apply(this,arguments)};e.prototype=new t,e.prototype.edgeRing=null,e.prototype.next=null,e.prototype.label=-1,e.prototype.getLabel=function(){return this.label},e.prototype.setLabel=function(t){this.label=t},e.prototype.getNext=function(){return this.next},e.prototype.setNext=function(t){this.next=t},e.prototype.isInRing=function(){return null!=this.edgeRing},e.prototype.setRing=function(t){this.edgeRing=t},jsts.operation.polygonize.PolygonizeDirectedEdge=e}(),function(){var t=javascript.util.ArrayList,e=function(){this.outEdges=new t};e.prototype.outEdges=null,e.prototype.sorted=!1,e.prototype.add=function(t){this.outEdges.add(t),this.sorted=!1},e.prototype.remove=function(t){this.outEdges.remove(t)},e.prototype.iterator=function(){return this.sortEdges(),this.outEdges.iterator()},e.prototype.getDegree=function(){return this.outEdges.size()},e.prototype.getCoordinate=function(){var t=iterator();if(!t.hasNext())return null;var e=t.next();return e.getCoordinate()},e.prototype.getEdges=function(){return this.sortEdges(),this.outEdges},e.prototype.sortEdges=function(){if(!this.sorted){var t=this.outEdges.toArray();t.sort(function(t,e){return t.compareTo(e)}),this.outEdges=javascript.util.Arrays.asList(t),this.sorted=!0}},e.prototype.getIndex=function(t){if(t instanceof jsts.planargraph.DirectedEdge)return this.getIndex2(t);if("number"==typeof t)return this.getIndex3(t);this.sortEdges();for(var e=0;e<this.outEdges.size();e++){var n=this.outEdges.get(e);if(n.getEdge()==t)return e}return-1},e.prototype.getIndex2=function(t){this.sortEdges();for(var e=0;e<this.outEdges.size();e++){var n=this.outEdges.get(e);if(n==t)return e}return-1},e.prototype.getIndex3=function(t){var e=toInt(t%this.outEdges.size());return e<0&&(e+=this.outEdges.size()),e},e.prototype.getNextEdge=function(t){var e=this.getIndex(t);return this.outEdges.get(getIndex(e+1))},e.prototype.getNextCWEdge=function(t){var e=this.getIndex(t);return this.outEdges.get(getIndex(e-1))},jsts.planargraph.DirectedEdgeStar=e}(),function(){var t=jsts.planargraph.GraphComponent,e=jsts.planargraph.DirectedEdgeStar,n=function(t,n){this.pt=t,this.deStar=n||new e};n.prototype=new t,n.getEdgesBetween=function(t,e){var n=DirectedEdge.toEdges(t.getOutEdges().getEdges()),i=new javascript.util.HashSet(n),o=DirectedEdge.toEdges(e.getOutEdges().getEdges());return i.retainAll(o),i},n.prototype.pt=null,n.prototype.deStar=null,n.prototype.getCoordinate=function(){return this.pt},n.prototype.addOutEdge=function(t){this.deStar.add(t)},n.prototype.getOutEdges=function(){return this.deStar},n.prototype.getDegree=function(){return this.deStar.getDegree()},n.prototype.getIndex=function(t){return this.deStar.getIndex(t)},n.prototype.remove=function(t){return void 0===t?this.remove2():void this.deStar.remove(t)},n.prototype.remove2=function(){this.pt=null},n.prototype.isRemoved=function(){return null==this.pt},jsts.planargraph.Node=n}(),function(){var t=function(){this.nodeMap=new javascript.util.TreeMap};t.prototype.nodeMap=null,t.prototype.add=function(t){return this.nodeMap.put(t.getCoordinate(),t),t},t.prototype.remove=function(t){return this.nodeMap.remove(t)},t.prototype.find=function(t){return this.nodeMap.get(t)},t.prototype.iterator=function(){return this.nodeMap.values().iterator()},t.prototype.values=function(){return this.nodeMap.values()},jsts.planargraph.NodeMap=t}(),function(){var t=javascript.util.ArrayList,e=function(){this.edges=new javascript.util.HashSet,this.dirEdges=new javascript.util.HashSet,this.nodeMap=new jsts.planargraph.NodeMap};e.prototype.edges=null,e.prototype.dirEdges=null,e.prototype.nodeMap=null,e.prototype.findNode=function(t){return this.nodeMap.find(t)},e.prototype.add=function(t){return t instanceof jsts.planargraph.Edge?this.add2(t):t instanceof jsts.planargraph.DirectedEdge?this.add3(t):void this.nodeMap.add(t)},e.prototype.add2=function(t){this.edges.add(t),this.add(t.getDirEdge(0)),this.add(t.getDirEdge(1))},e.prototype.add3=function(t){this.dirEdges.add(t)},e.prototype.nodeIterator=function(){return this.nodeMap.iterator()},e.prototype.contains=function(t){return t instanceof jsts.planargraph.DirectedEdge?this.contains2(t):this.edges.contains(t)},e.prototype.contains2=function(t){return this.dirEdges.contains(t)},e.prototype.getNodes=function(){return this.nodeMap.values()},e.prototype.dirEdgeIterator=function(){return this.dirEdges.iterator()},e.prototype.edgeIterator=function(){return this.edges.iterator()},e.prototype.getEdges=function(){return this.edges},e.prototype.remove=function(t){return t instanceof jsts.planargraph.DirectedEdge?this.remove2(t):(this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),void this.edge.remove())},e.prototype.remove2=function(t){if(t instanceof jsts.planargraph.Node)return this.remove3(t);var e=t.getSym();null!=e&&e.setSym(null),t.getFromNode().remove(t),t.remove(),this.dirEdges.remove(t)},e.prototype.remove3=function(t){for(var e=t.getOutEdges().getEdges(),n=e.iterator();n.hasNext();){var i=n.next(),o=i.getSym();null!=o&&this.remove(o),this.dirEdges.remove(i);var r=i.getEdge();null!=r&&this.edges.remove(r)}this.nodeMap.remove(t.getCoordinate()),t.remove()},e.prototype.findNodesOfDegree=function(e){for(var n=new t,i=this.nodeIterator();i.hasNext();){var o=i.next();o.getDegree()==e&&n.add(o)}return n},jsts.planargraph.PlanarGraph=e}(),function(){var t=javascript.util.ArrayList,e=javascript.util.Stack,n=javascript.util.HashSet,i=jsts.util.Assert,o=jsts.operation.polygonize.EdgeRing,r=jsts.operation.polygonize.PolygonizeEdge,s=jsts.operation.polygonize.PolygonizeDirectedEdge,a=jsts.planargraph.PlanarGraph,l=jsts.planargraph.Node,d=function(t){a.apply(this),this.factory=t};d.prototype=new a,d.getDegreeNonDeleted=function(t){for(var e=t.getOutEdges().getEdges(),n=0,i=e.iterator();i.hasNext();){var o=i.next();o.isMarked()||n++}return n},d.getDegree=function(t,e){for(var n=t.getOutEdges().getEdges(),i=0,o=n.iterator();o.hasNext();){var r=o.next();r.getLabel()==e&&i++}return i},d.deleteAllEdges=function(t){for(var e=t.getOutEdges().getEdges(),n=e.iterator();n.hasNext();){var i=n.next();i.setMarked(!0);var o=i.getSym();null!=o&&o.setMarked(!0)}},d.prototype.factory=null,d.prototype.addEdge=function(t){if(!t.isEmpty()){var e=jsts.geom.CoordinateArrays.removeRepeatedPoints(t.getCoordinates());if(!(e.length<2)){var n=e[0],i=e[e.length-1],o=this.getNode(n),a=this.getNode(i),l=new s(o,a,e[1],(!0)),d=new s(a,o,e[e.length-2],(!1)),c=new r(t);c.setDirectedEdges(l,d),this.add(c)}}},d.prototype.getNode=function(t){var e=this.findNode(t);return null==e&&(e=new l(t),this.add(e)),e},d.prototype.computeNextCWEdges=function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();d.computeNextCWEdges(e)}},d.prototype.convertMaximalToMinimalEdgeRings=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel(),o=d.findIntersectionNodes(n,i);if(null!=o)for(var r=o.iterator();r.hasNext();){var s=r.next();d.computeNextCCWEdges(s,i)}}},d.findIntersectionNodes=function(e,n){var o=e,r=null;do{var s=o.getFromNode();d.getDegree(s,n)>1&&(null==r&&(r=new t),r.add(s)),o=o.getNext(),i.isTrue(null!=o,"found null DE in ring"),i.isTrue(o==e||!o.isInRing(),"found DE already in ring")}while(o!=e);return r},d.prototype.getEdgeRings=function(){this.computeNextCWEdges(),d.label(this.dirEdges,-1);var e=d.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(e);for(var n=new t,i=this.dirEdges.iterator();i.hasNext();){var o=i.next();if(!o.isMarked()&&!o.isInRing()){var r=this.findEdgeRing(o);n.add(r)}}return n},d.findLabeledEdgeRings=function(e){for(var n=new t,i=1,o=e.iterator();o.hasNext();){var r=o.next();if(!(r.isMarked()||r.getLabel()>=0)){n.add(r);var s=d.findDirEdgesInRing(r);d.label(s,i),i++}}return n},d.prototype.deleteCutEdges=function(){this.computeNextCWEdges(),d.findLabeledEdgeRings(this.dirEdges);for(var e=new t,n=this.dirEdges.iterator();n.hasNext();){var i=n.next();if(!i.isMarked()){var o=i.getSym();if(i.getLabel()==o.getLabel()){i.setMarked(!0),o.setMarked(!0);var r=i.getEdge();e.add(r.getLine())}}}return e},d.label=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();i.setLabel(e)}},d.computeNextCWEdges=function(t){for(var e=t.getOutEdges(),n=null,i=null,o=e.getEdges().iterator();o.hasNext();){var r=o.next();if(!r.isMarked()){if(null==n&&(n=r),null!=i){var s=i.getSym();s.setNext(r)}i=r}}if(null!=i){var s=i.getSym();s.setNext(n)}},d.computeNextCCWEdges=function(t,e){for(var n=t.getOutEdges(),o=null,r=null,s=n.getEdges(),a=s.size()-1;a>=0;a--){var l=s.get(a),d=l.getSym(),c=null;l.getLabel()==e&&(c=l);var h=null;d.getLabel()==e&&(h=d),null==c&&null==h||(null!=h&&(r=h),null!=c&&(null!=r&&(r.setNext(c),r=null),null==o&&(o=c)))}null!=r&&(i.isTrue(null!=o),r.setNext(o))},d.findDirEdgesInRing=function(e){var n=e,o=new t;do o.add(n),n=n.getNext(),i.isTrue(null!=n,"found null DE in ring"),i.isTrue(n==e||!n.isInRing(),"found DE already in ring");while(n!=e);return o},d.prototype.findEdgeRing=function(t){var e=t,n=new o(this.factory);do n.add(e),e.setRing(n),e=e.getNext(),i.isTrue(null!=e,"found null DE in ring"),i.isTrue(e==t||!e.isInRing(),"found DE already in ring");while(e!=t);return n},d.prototype.deleteDangles=function(){for(var t=this.findNodesOfDegree(1),i=new n,o=new e,r=t.iterator();r.hasNext();)o.push(r.next());for(;!o.isEmpty();){var s=o.pop();d.deleteAllEdges(s);for(var a=s.getOutEdges().getEdges(),r=a.iterator();r.hasNext();){var l=r.next();l.setMarked(!0);var c=l.getSym();null!=c&&c.setMarked(!0);var h=l.getEdge();i.add(h.getLine());var u=l.getToNode();1==d.getDegreeNonDeleted(u)&&o.push(u)}}return i},d.prototype.computeDepthParity=function(){for(;;){var t=null;if(null==t)return;this.computeDepthParity(t)}},d.prototype.computeDepthParity=function(t){},jsts.operation.polygonize.PolygonizeGraph=d}(),jsts.index.strtree.Interval=function(){var t;return 1===arguments.length?(t=arguments[0],jsts.index.strtree.Interval(t.min,t.max)):void(2===arguments.length&&(jsts.util.Assert.isTrue(this.min<=this.max),this.min=arguments[0],this.max=arguments[1]))},jsts.index.strtree.Interval.prototype.min=null,jsts.index.strtree.Interval.prototype.max=null,jsts.index.strtree.Interval.prototype.getCentre=function(){return(this.min+this.max)/2},jsts.index.strtree.Interval.prototype.expandToInclude=function(t){return this.max=Math.max(this.max,t.max),this.min=Math.min(this.min,t.min),this},jsts.index.strtree.Interval.prototype.intersects=function(t){return!(t.min>this.max||t.max<this.min)},jsts.index.strtree.Interval.prototype.equals=function(t){return t instanceof jsts.index.strtree.Interval&&(other=t,this.min===other.min&&this.max===other.max)},jsts.geom.GeometryFactory=function(t){this.precisionModel=t||new jsts.geom.PrecisionModel},jsts.geom.GeometryFactory.prototype.precisionModel=null,jsts.geom.GeometryFactory.prototype.getPrecisionModel=function(){return this.precisionModel},jsts.geom.GeometryFactory.prototype.createPoint=function(t){var e=new jsts.geom.Point(t,this);return e},jsts.geom.GeometryFactory.prototype.createLineString=function(t){var e=new jsts.geom.LineString(t,this);return e},jsts.geom.GeometryFactory.prototype.createLinearRing=function(t){var e=new jsts.geom.LinearRing(t,this);return e},jsts.geom.GeometryFactory.prototype.createPolygon=function(t,e){var n=new jsts.geom.Polygon(t,e,this);return n},jsts.geom.GeometryFactory.prototype.createMultiPoint=function(t){if(t&&t[0]instanceof jsts.geom.Coordinate){var e,n=[];for(e=0;e<t.length;e++)n.push(this.createPoint(t[e]));t=n}return new jsts.geom.MultiPoint(t,this)},jsts.geom.GeometryFactory.prototype.createMultiLineString=function(t){return new jsts.geom.MultiLineString(t,this)},jsts.geom.GeometryFactory.prototype.createMultiPolygon=function(t){return new jsts.geom.MultiPolygon(t,this)},jsts.geom.GeometryFactory.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,o=t.iterator();o.hasNext();){var r=o.next(),s=r.CLASS_NAME;null===e&&(e=s),s!==e&&(n=!0),r.isGeometryCollectionBase()&&(i=!0)}if(null===e)return this.createGeometryCollection(null);if(n||i)return this.createGeometryCollection(t.toArray());var a=t.get(0),l=t.size()>1;if(l){if(a instanceof jsts.geom.Polygon)return this.createMultiPolygon(t.toArray());if(a instanceof jsts.geom.LineString)return this.createMultiLineString(t.toArray());if(a instanceof jsts.geom.Point)return this.createMultiPoint(t.toArray());
jsts.util.Assert.shouldNeverReachHere("Unhandled class: "+a)}return a},jsts.geom.GeometryFactory.prototype.createGeometryCollection=function(t){return new jsts.geom.GeometryCollection(t,this)},jsts.geom.GeometryFactory.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new jsts.geom.Coordinate(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new jsts.geom.Coordinate(t.getMinX(),t.getMinY()),new jsts.geom.Coordinate(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new jsts.geom.Coordinate(t.getMinX(),t.getMinY()),new jsts.geom.Coordinate(t.getMinX(),t.getMaxY()),new jsts.geom.Coordinate(t.getMaxX(),t.getMaxY()),new jsts.geom.Coordinate(t.getMaxX(),t.getMinY()),new jsts.geom.Coordinate(t.getMinX(),t.getMinY())]),null)},jsts.geomgraph.NodeFactory=function(){},jsts.geomgraph.NodeFactory.prototype.createNode=function(t){return new jsts.geomgraph.Node(t,null)},function(){jsts.geomgraph.Position=function(){},jsts.geomgraph.Position.ON=0,jsts.geomgraph.Position.LEFT=1,jsts.geomgraph.Position.RIGHT=2,jsts.geomgraph.Position.opposite=function(t){return t===jsts.geomgraph.Position.LEFT?jsts.geomgraph.Position.RIGHT:t===jsts.geomgraph.Position.RIGHT?jsts.geomgraph.Position.LEFT:t}}(),jsts.geomgraph.TopologyLocation=function(){if(this.location=[],3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];this.init(3),this.location[jsts.geomgraph.Position.ON]=t,this.location[jsts.geomgraph.Position.LEFT]=e,this.location[jsts.geomgraph.Position.RIGHT]=n}else if(arguments[0]instanceof jsts.geomgraph.TopologyLocation){var i=arguments[0];if(this.init(i.location.length),null!=i)for(var o=0;o<this.location.length;o++)this.location[o]=i.location[o]}else if("number"==typeof arguments[0]){var t=arguments[0];this.init(1),this.location[jsts.geomgraph.Position.ON]=t}else if(arguments[0]instanceof Array){var r=arguments[0];this.init(r.length)}},jsts.geomgraph.TopologyLocation.prototype.location=null,jsts.geomgraph.TopologyLocation.prototype.init=function(t){this.location[t-1]=null,this.setAllLocations(jsts.geom.Location.NONE)},jsts.geomgraph.TopologyLocation.prototype.get=function(t){return t<this.location.length?this.location[t]:jsts.geom.Location.NONE},jsts.geomgraph.TopologyLocation.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==jsts.geom.Location.NONE)return!1;return!0},jsts.geomgraph.TopologyLocation.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===jsts.geom.Location.NONE)return!0;return!1},jsts.geomgraph.TopologyLocation.prototype.isEqualOnSide=function(t,e){return this.location[e]==t.location[e]},jsts.geomgraph.TopologyLocation.prototype.isArea=function(){return this.location.length>1},jsts.geomgraph.TopologyLocation.prototype.isLine=function(){return 1===this.location.length},jsts.geomgraph.TopologyLocation.prototype.flip=function(){if(!(this.location.length<=1)){var t=this.location[jsts.geomgraph.Position.LEFT];this.location[jsts.geomgraph.Position.LEFT]=this.location[jsts.geomgraph.Position.RIGHT],this.location[jsts.geomgraph.Position.RIGHT]=t}},jsts.geomgraph.TopologyLocation.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},jsts.geomgraph.TopologyLocation.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===jsts.geom.Location.NONE&&(this.location[e]=t)},jsts.geomgraph.TopologyLocation.prototype.setLocation=function(t,e){void 0!==e?this.location[t]=e:this.setLocation(jsts.geomgraph.Position.ON,t)},jsts.geomgraph.TopologyLocation.prototype.getLocations=function(){return location},jsts.geomgraph.TopologyLocation.prototype.setLocations=function(t,e,n){this.location[jsts.geomgraph.Position.ON]=t,this.location[jsts.geomgraph.Position.LEFT]=e,this.location[jsts.geomgraph.Position.RIGHT]=n},jsts.geomgraph.TopologyLocation.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},jsts.geomgraph.TopologyLocation.prototype.merge=function(t){if(t.location.length>this.location.length){var e=[];e[jsts.geomgraph.Position.ON]=this.location[jsts.geomgraph.Position.ON],e[jsts.geomgraph.Position.LEFT]=jsts.geom.Location.NONE,e[jsts.geomgraph.Position.RIGHT]=jsts.geom.Location.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===jsts.geom.Location.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},jsts.geomgraph.Label=function(){this.elt=[];var t,e,n,i,o;4===arguments.length?(t=arguments[0],e=arguments[1],n=arguments[2],o=arguments[3],this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE),this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE),this.elt[t].setLocations(e,n,o)):3===arguments.length?(e=arguments[0],n=arguments[1],o=arguments[2],this.elt[0]=new jsts.geomgraph.TopologyLocation(e,n,o),this.elt[1]=new jsts.geomgraph.TopologyLocation(e,n,o)):2===arguments.length?(t=arguments[0],e=arguments[1],this.elt[0]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE),this.elt[1]=new jsts.geomgraph.TopologyLocation(jsts.geom.Location.NONE),this.elt[t].setLocation(e)):arguments[0]instanceof jsts.geomgraph.Label?(i=arguments[0],this.elt[0]=new jsts.geomgraph.TopologyLocation(i.elt[0]),this.elt[1]=new jsts.geomgraph.TopologyLocation(i.elt[1])):"number"==typeof arguments[0]&&(e=arguments[0],this.elt[0]=new jsts.geomgraph.TopologyLocation(e),this.elt[1]=new jsts.geomgraph.TopologyLocation(e))},jsts.geomgraph.Label.toLineLabel=function(t){var e,n=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(e=0;e<2;e++)n.setLocation(e,t.getLocation(e));return n},jsts.geomgraph.Label.prototype.elt=null,jsts.geomgraph.Label.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},jsts.geomgraph.Label.prototype.getLocation=function(t,e){return 1==arguments.length?this.getLocation2.apply(this,arguments):this.elt[t].get(e)},jsts.geomgraph.Label.prototype.getLocation2=function(t){return this.elt[t].get(jsts.geomgraph.Position.ON)},jsts.geomgraph.Label.prototype.setLocation=function(t,e,n){return 2==arguments.length?void this.setLocation2.apply(this,arguments):void this.elt[t].setLocation(e,n)},jsts.geomgraph.Label.prototype.setLocation2=function(t,e){this.elt[t].setLocation(jsts.geomgraph.Position.ON,e)};jsts.geomgraph.Label.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)};jsts.geomgraph.Label.prototype.setAllLocationsIfNull=function(t,e){return 1==arguments.length?void this.setAllLocationsIfNull2.apply(this,arguments):void this.elt[t].setAllLocationsIfNull(e)},jsts.geomgraph.Label.prototype.setAllLocationsIfNull2=function(t){this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)},jsts.geomgraph.Label.prototype.merge=function(t){var e;for(e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new jsts.geomgraph.TopologyLocation(t.elt[e]):this.elt[e].merge(t.elt[e])},jsts.geomgraph.Label.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},jsts.geomgraph.Label.prototype.isNull=function(t){return this.elt[t].isNull()},jsts.geomgraph.Label.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},jsts.geomgraph.Label.prototype.isArea=function(){return 1==arguments.length?this.isArea2(arguments[0]):this.elt[0].isArea()||this.elt[1].isArea()},jsts.geomgraph.Label.prototype.isArea2=function(t){return this.elt[t].isArea()},jsts.geomgraph.Label.prototype.isLine=function(t){return this.elt[t].isLine()},jsts.geomgraph.Label.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},jsts.geomgraph.Label.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},jsts.geomgraph.Label.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new jsts.geomgraph.TopologyLocation(this.elt[t].location[0]))},jsts.geomgraph.EdgeRing=function(t,e){this.edges=[],this.pts=[],this.holes=[],this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE),this.geometryFactory=e,t&&(this.computePoints(t),this.computeRing())},jsts.geomgraph.EdgeRing.prototype.startDe=null,jsts.geomgraph.EdgeRing.prototype.maxNodeDegree=-1,jsts.geomgraph.EdgeRing.prototype.edges=null,jsts.geomgraph.EdgeRing.prototype.pts=null,jsts.geomgraph.EdgeRing.prototype.label=null,jsts.geomgraph.EdgeRing.prototype.ring=null,jsts.geomgraph.EdgeRing.prototype._isHole=null,jsts.geomgraph.EdgeRing.prototype.shell=null,jsts.geomgraph.EdgeRing.prototype.holes=null,jsts.geomgraph.EdgeRing.prototype.geometryFactory=null,jsts.geomgraph.EdgeRing.prototype.isIsolated=function(){return 1==this.label.getGeometryCount()},jsts.geomgraph.EdgeRing.prototype.isHole=function(){return this._isHole},jsts.geomgraph.EdgeRing.prototype.getCoordinate=function(t){return this.pts[t]},jsts.geomgraph.EdgeRing.prototype.getLinearRing=function(){return this.ring},jsts.geomgraph.EdgeRing.prototype.getLabel=function(){return this.label},jsts.geomgraph.EdgeRing.prototype.isShell=function(){return null===this.shell},jsts.geomgraph.EdgeRing.prototype.getShell=function(){return this.shell},jsts.geomgraph.EdgeRing.prototype.setShell=function(t){this.shell=t,null!==t&&t.addHole(this)},jsts.geomgraph.EdgeRing.prototype.addHole=function(t){this.holes.push(t)},jsts.geomgraph.EdgeRing.prototype.toPolygon=function(t){for(var e=[],n=0;n<this.holes.length;n++)e[n]=this.holes[n].getLinearRing();var i=this.geometryFactory.createPolygon(this.getLinearRing(),e);return i},jsts.geomgraph.EdgeRing.prototype.computeRing=function(){if(null===this.ring){for(var t=[],e=0;e<this.pts.length;e++)t[e]=this.pts[e];this.ring=this.geometryFactory.createLinearRing(t),this._isHole=jsts.algorithm.CGAlgorithms.isCCW(this.ring.getCoordinates())}},jsts.geomgraph.EdgeRing.prototype.getNext=function(t){throw new jsts.error.AbstractInvocationError},jsts.geomgraph.EdgeRing.prototype.setEdgeRing=function(t,e){throw new jsts.error.AbstractInvocationError},jsts.geomgraph.EdgeRing.prototype.getEdges=function(){return this.edges},jsts.geomgraph.EdgeRing.prototype.computePoints=function(t){this.startDe=t;var e=t,n=!0;do{if(null===e)throw new jsts.error.TopologyError("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new jsts.error.TopologyError("Directed Edge visited twice during ring-building at "+e.getCoordinate());this.edges.push(e);var i=e.getLabel();jsts.util.Assert.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this.startDe)},jsts.geomgraph.EdgeRing.prototype.getMaxNodeDegree=function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},jsts.geomgraph.EdgeRing.prototype.computeMaxNodeDegree=function(){this.maxNodeDegree=0;var t=this.startDe;do{var e=t.getNode(),n=e.getEdges().getOutgoingDegree(this);n>this.maxNodeDegree&&(this.maxNodeDegree=n),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},jsts.geomgraph.EdgeRing.prototype.setInResult=function(){var t=this.startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!=this.startDe)},jsts.geomgraph.EdgeRing.prototype.mergeLabel=function(t){this.mergeLabel2(t,0),this.mergeLabel2(t,1)},jsts.geomgraph.EdgeRing.prototype.mergeLabel2=function(t,e){var n=t.getLocation(e,jsts.geomgraph.Position.RIGHT);if(n!=jsts.geom.Location.NONE)return this.label.getLocation(e)===jsts.geom.Location.NONE?void this.label.setLocation(e,n):void 0},jsts.geomgraph.EdgeRing.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var o=1;n&&(o=0);for(var r=o;r<i.length;r++)this.pts.push(i[r])}else{var o=i.length-2;n&&(o=i.length-1);for(var r=o;r>=0;r--)this.pts.push(i[r])}},jsts.geomgraph.EdgeRing.prototype.containsPoint=function(t){var e=this.getLinearRing(),n=e.getEnvelopeInternal();if(!n.contains(t))return!1;if(!jsts.algorithm.CGAlgorithms.isPointInRing(t,e.getCoordinates()))return!1;for(var i=0;i<this.holes.length;i++){var o=this.holes[i];if(o.containsPoint(t))return!1}return!0},function(){jsts.geom.LinearRing=function(t,e){jsts.geom.LineString.apply(this,arguments)},jsts.geom.LinearRing.prototype=new jsts.geom.LineString,jsts.geom.LinearRing.constructor=jsts.geom.LinearRing,jsts.geom.LinearRing.prototype.getBoundaryDimension=function(){return jsts.geom.Dimension.FALSE},jsts.geom.LinearRing.prototype.isSimple=function(){return!0},jsts.geom.LinearRing.prototype.getGeometryType=function(){return"LinearRing"},jsts.geom.LinearRing.MINIMUM_VALID_SIZE=4,jsts.geom.LinearRing.prototype.CLASS_NAME="jsts.geom.LinearRing"}(),jsts.index.strtree.Boundable=function(){},jsts.index.strtree.Boundable.prototype.getBounds=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractNode=function(t){this.level=t,this.childBoundables=[]},jsts.index.strtree.AbstractNode.prototype=new jsts.index.strtree.Boundable,jsts.index.strtree.AbstractNode.constructor=jsts.index.strtree.AbstractNode,jsts.index.strtree.AbstractNode.prototype.childBoundables=null,jsts.index.strtree.AbstractNode.prototype.bounds=null,jsts.index.strtree.AbstractNode.prototype.level=null,jsts.index.strtree.AbstractNode.prototype.getChildBoundables=function(){return this.childBoundables},jsts.index.strtree.AbstractNode.prototype.computeBounds=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractNode.prototype.getBounds=function(){return null===this.bounds&&(this.bounds=this.computeBounds()),this.bounds},jsts.index.strtree.AbstractNode.prototype.getLevel=function(){return this.level},jsts.index.strtree.AbstractNode.prototype.addChildBoundable=function(t){this.childBoundables.push(t)},function(){jsts.noding.Noder=function(){},jsts.noding.Noder.prototype.computeNodes=jsts.abstractFunc,jsts.noding.Noder.prototype.getNodedSubstrings=jsts.abstractFunc}(),function(){var t=jsts.noding.Noder;jsts.noding.SinglePassNoder=function(){},jsts.noding.SinglePassNoder.prototype=new t,jsts.noding.SinglePassNoder.constructor=jsts.noding.SinglePassNoder,jsts.noding.SinglePassNoder.prototype.segInt=null,jsts.noding.SinglePassNoder.prototype.setSegmentIntersector=function(t){this.segInt=t}}(),jsts.index.SpatialIndex=function(){},jsts.index.SpatialIndex.prototype.insert=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.SpatialIndex.prototype.query=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.SpatialIndex.prototype.remove=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree=function(t){void 0!==t&&(this.itemBoundables=[],jsts.util.Assert.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t)},jsts.index.strtree.AbstractSTRtree.IntersectsOp=function(){},jsts.index.strtree.AbstractSTRtree.IntersectsOp.prototype.intersects=function(t,e){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree.prototype.root=null,jsts.index.strtree.AbstractSTRtree.prototype.built=!1,jsts.index.strtree.AbstractSTRtree.prototype.itemBoundables=null,jsts.index.strtree.AbstractSTRtree.prototype.nodeCapacity=null,jsts.index.strtree.AbstractSTRtree.prototype.build=function(){jsts.util.Assert.isTrue(!this.built),this.root=0===this.itemBoundables.length?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.built=!0},jsts.index.strtree.AbstractSTRtree.prototype.createNode=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables=function(t,e){jsts.util.Assert.isTrue(!(0===t.length));var n=[];n.push(this.createNode(e));for(var i=[],o=0;o<t.length;o++)i.push(t[o]);i.sort(this.getComparator());for(var o=0;o<i.length;o++){var r=i[o];this.lastNode(n).getChildBoundables().length===this.getNodeCapacity()&&n.push(this.createNode(e)),this.lastNode(n).addChildBoundable(r)}return n},jsts.index.strtree.AbstractSTRtree.prototype.lastNode=function(t){return t[t.length-1]},jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},jsts.index.strtree.AbstractSTRtree.prototype.createHigherLevels=function(t,e){jsts.util.Assert.isTrue(!(0===t.length));var n=this.createParentBoundables(t,e+1);return 1===n.length?n[0]:this.createHigherLevels(n,e+1)},jsts.index.strtree.AbstractSTRtree.prototype.getRoot=function(){return this.built||this.build(),this.root},jsts.index.strtree.AbstractSTRtree.prototype.getNodeCapacity=function(){return this.nodeCapacity},jsts.index.strtree.AbstractSTRtree.prototype.size=function(){return 1===arguments.length?this.size2(arguments[0]):(this.built||this.build(),0===this.itemBoundables.length?0:this.size2(root))},jsts.index.strtree.AbstractSTRtree.prototype.size2=function(t){for(var e=0,n=t.getChildBoundables(),i=0;i<n.length;i++){var o=n[i];o instanceof jsts.index.strtree.AbstractNode?e+=this.size(o):o instanceof jsts.index.strtree.ItemBoundable&&(e+=1)}return e},jsts.index.strtree.AbstractSTRtree.prototype.depth=function(){return 1===arguments.length?this.depth2(arguments[0]):(this.built||this.build(),0===this.itemBoundables.length?0:this.depth2(root))},jsts.index.strtree.AbstractSTRtree.prototype.depth2=function(){for(var t=0,e=node.getChildBoundables(),n=0;n<e.length;n++){var i=e[n];if(i instanceof jsts.index.strtree.AbstractNode){var o=this.depth(i);o>t&&(t=o)}}return t+1},jsts.index.strtree.AbstractSTRtree.prototype.insert=function(t,e){jsts.util.Assert.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.push(new jsts.index.strtree.ItemBoundable(t,e))},jsts.index.strtree.AbstractSTRtree.prototype.query=function(t){arguments.length>1&&this.query2.apply(this,arguments),this.built||this.build();var e=[];return 0===this.itemBoundables.length?(jsts.util.Assert.isTrue(null===this.root.getBounds()),e):(this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query3(t,this.root,e),e)},jsts.index.strtree.AbstractSTRtree.prototype.query2=function(t,e){arguments.length>2&&this.query3.apply(this,arguments),this.built||this.build(),0===this.itemBoundables.length&&jsts.util.Assert.isTrue(null===this.root.getBounds()),this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query4(t,this.root,e)},jsts.index.strtree.AbstractSTRtree.prototype.query3=function(t,e,n){arguments[2]instanceof Array||this.query4.apply(this,arguments);for(var i=e.getChildBoundables(),o=0;o<i.length;o++){var r=i[o];this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof jsts.index.strtree.AbstractNode?this.query3(t,r,n):r instanceof jsts.index.strtree.ItemBoundable?n.push(r.getItem()):jsts.util.Assert.shouldNeverReachHere())}},jsts.index.strtree.AbstractSTRtree.prototype.query4=function(t,e,n){for(var i=e.getChildBoundables(),o=0;o<i.length;o++){var r=i[o];this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof jsts.index.strtree.AbstractNode?this.query4(t,r,n):r instanceof jsts.index.strtree.ItemBoundable?n.visitItem(r.getItem()):jsts.util.Assert.shouldNeverReachHere())}},jsts.index.strtree.AbstractSTRtree.prototype.getIntersectsOp=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.AbstractSTRtree.prototype.itemsTree=function(){if(1===arguments.length)return this.itemsTree2.apply(this,arguments);this.built||this.build();var t=this.itemsTree2(this.root);return null===t?[]:t},jsts.index.strtree.AbstractSTRtree.prototype.itemsTree2=function(t){for(var e=[],n=t.getChildBoundables(),i=0;i<n.length;i++){var o=n[i];if(o instanceof jsts.index.strtree.AbstractNode){var r=this.itemsTree(o);null!=r&&e.push(r)}else o instanceof jsts.index.strtree.ItemBoundable?e.push(o.getItem()):jsts.util.Assert.shouldNeverReachHere()}return e.length<=0?null:e},jsts.index.strtree.AbstractSTRtree.prototype.remove=function(t,e){return this.built||this.build(),0===this.itemBoundables.length&&jsts.util.Assert.isTrue(null==this.root.getBounds()),!!this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.remove2(t,this.root,e)},jsts.index.strtree.AbstractSTRtree.prototype.remove2=function(t,e,n){var i=this.removeItem(e,n);if(i)return!0;for(var o=null,r=e.getChildBoundables(),s=0;s<r.length;s++){var a=r[s];if(this.getIntersectsOp().intersects(a.getBounds(),t)&&a instanceof jsts.index.strtree.AbstractNode&&(i=this.remove(t,a,n))){o=a;break}}return null!=o&&0===o.getChildBoundables().length&&r.splice(r.indexOf(o),1),i},jsts.index.strtree.AbstractSTRtree.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables(),o=0;o<i.length;o++){var r=i[o];r instanceof jsts.index.strtree.ItemBoundable&&r.getItem()===e&&(n=r)}return null!==n&&(i.splice(i.indexOf(n),1),!0)},jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel=function(t){if(arguments.length>1)return void this.boundablesAtLevel2.apply(this,arguments);var e=[];return this.boundablesAtLevel2(t,this.root,e),e},jsts.index.strtree.AbstractSTRtree.prototype.boundablesAtLevel2=function(t,e,n){if(jsts.util.Assert.isTrue(t>-2),e.getLevel()===t)return void n.add(e);for(var i=node.getChildBoundables(),o=0;o<i.length;o++){var r=i[o];r instanceof jsts.index.strtree.AbstractNode?this.boundablesAtLevel(t,r,n):(jsts.util.Assert.isTrue(r instanceof jsts.index.strtree.ItemBoundable),t===-1&&n.add(r))}},jsts.index.strtree.AbstractSTRtree.prototype.getComparator=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.index.strtree.STRtree=function(t){t=t||jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY,jsts.index.strtree.AbstractSTRtree.call(this,t)},jsts.index.strtree.STRtree.prototype=new jsts.index.strtree.AbstractSTRtree,jsts.index.strtree.STRtree.constructor=jsts.index.strtree.STRtree,jsts.index.strtree.STRtree.prototype.xComparator=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreX(t.getBounds()),jsts.index.strtree.STRtree.prototype.centreX(e.getBounds()))},jsts.index.strtree.STRtree.prototype.yComparator=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.compareDoubles(jsts.index.strtree.STRtree.prototype.centreY(t.getBounds()),jsts.index.strtree.STRtree.prototype.centreY(e.getBounds()))},jsts.index.strtree.STRtree.prototype.centreX=function(t){return jsts.index.strtree.STRtree.prototype.avg(t.getMinX(),t.getMaxX())},jsts.index.strtree.STRtree.prototype.centreY=function(t){return jsts.index.strtree.STRtree.prototype.avg(t.getMinY(),t.getMaxY())},jsts.index.strtree.STRtree.prototype.avg=function(t,e){return(t+e)/2},jsts.index.strtree.STRtree.prototype.intersectsOp={intersects:function(t,e){return t.intersects(e)}},jsts.index.strtree.STRtree.prototype.createParentBoundables=function(t,e){jsts.util.Assert.isTrue(!(0===t.length));for(var n=Math.ceil(t.length/this.getNodeCapacity()),i=[],o=0;o<t.length;o++)i.push(t[o]);i.sort(this.xComparator);var r=this.verticalSlices(i,Math.ceil(Math.sqrt(n)));return this.createParentBoundablesFromVerticalSlices(r,e)},jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlices=function(t,e){jsts.util.Assert.isTrue(t.length>0);for(var n=[],i=0;i<t.length;i++)n=n.concat(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},jsts.index.strtree.STRtree.prototype.createParentBoundablesFromVerticalSlice=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.createParentBoundables.call(this,t,e)},jsts.index.strtree.STRtree.prototype.verticalSlices=function(t,e){for(var n,i,o=Math.ceil(t.length/e),r=[],s=0,a=0;a<e;a++)for(r[a]=[],n=0;s<t.length&&n<o;)i=t[s++],r[a].push(i),n++;return r},jsts.index.strtree.STRtree.DEFAULT_NODE_CAPACITY=10,jsts.index.strtree.STRtree.prototype.createNode=function(t){var e=new jsts.index.strtree.AbstractNode(t);return e.computeBounds=function(){for(var t=null,e=this.getChildBoundables(),n=0;n<e.length;n++){var i=e[n];null===t?t=new jsts.geom.Envelope(i.getBounds()):t.expandToInclude(i.getBounds())}return t},e},jsts.index.strtree.STRtree.prototype.getIntersectsOp=function(){return this.intersectsOp},jsts.index.strtree.STRtree.prototype.insert=function(t,e){t.isNull()||jsts.index.strtree.AbstractSTRtree.prototype.insert.call(this,t,e)},jsts.index.strtree.STRtree.prototype.query=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.query.apply(this,arguments)},jsts.index.strtree.STRtree.prototype.remove=function(t,e){return jsts.index.strtree.AbstractSTRtree.prototype.remove.call(this,t,e)},jsts.index.strtree.STRtree.prototype.size=function(){return jsts.index.strtree.AbstractSTRtree.prototype.size.call(this)},jsts.index.strtree.STRtree.prototype.depth=function(){return jsts.index.strtree.AbstractSTRtree.prototype.depth.call(this)},jsts.index.strtree.STRtree.prototype.getComparator=function(){return this.yComparator},jsts.index.strtree.STRtree.prototype.nearestNeighbour=function(t){var e=new jsts.index.strtree.BoundablePair(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour4(e)},jsts.index.strtree.STRtree.prototype.nearestNeighbour2=function(t,e,n){var i=new jsts.index.strtree.ItemBoundable(t,e),o=new jsts.index.strtree.BoundablePair(this.getRoot(),i,n);return this.nearestNeighbour4(o)[0]},jsts.index.strtree.STRtree.prototype.nearestNeighbour3=function(t,e){var n=new jsts.index.strtree.BoundablePair(this.getRoot(),t.getRoot(),e);return this.nearestNeighbour4(n)},jsts.index.strtree.STRtree.prototype.nearestNeighbour4=function(t){return this.nearestNeighbour5(t,Double.POSITIVE_INFINITY)},jsts.index.strtree.STRtree.prototype.nearestNeighbour5=function(t,e){var n=e,i=null,o=[];for(o.push(t);!o.isEmpty()&&n>0;){var r=o.pop(),s=r.getDistance();if(s>=n)break;r.isLeaves()?(n=s,i=r):r.expandToQueue(o,n)}return[i.getBoundable(0).getItem(),i.getBoundable(1).getItem()]},jsts.noding.SegmentString=function(){},jsts.noding.SegmentString.prototype.getData=jsts.abstractFunc,jsts.noding.SegmentString.prototype.setData=jsts.abstractFunc,jsts.noding.SegmentString.prototype.size=jsts.abstractFunc,jsts.noding.SegmentString.prototype.getCoordinate=jsts.abstractFunc,jsts.noding.SegmentString.prototype.getCoordinates=jsts.abstractFunc,jsts.noding.SegmentString.prototype.isClosed=jsts.abstractFunc,jsts.noding.NodableSegmentString=function(){},jsts.noding.NodableSegmentString.prototype=new jsts.noding.SegmentString,jsts.noding.NodableSegmentString.prototype.addIntersection=jsts.abstractFunc,jsts.noding.NodedSegmentString=function(t,e){this.nodeList=new jsts.noding.SegmentNodeList(this),this.pts=t,this.data=e},jsts.noding.NodedSegmentString.prototype=new jsts.noding.NodableSegmentString,jsts.noding.NodedSegmentString.constructor=jsts.noding.NodedSegmentString,jsts.noding.NodedSegmentString.getNodedSubstrings=function(t){if(2===arguments.length)return void jsts.noding.NodedSegmentString.getNodedSubstrings2.apply(this,arguments);var e=new javascript.util.ArrayList;return jsts.noding.NodedSegmentString.getNodedSubstrings2(t,e),e},jsts.noding.NodedSegmentString.getNodedSubstrings2=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();i.getNodeList().addSplitEdges(e)}},jsts.noding.NodedSegmentString.prototype.nodeList=null,jsts.noding.NodedSegmentString.prototype.pts=null,jsts.noding.NodedSegmentString.prototype.data=null,jsts.noding.NodedSegmentString.prototype.getData=function(){return this.data},jsts.noding.NodedSegmentString.prototype.setData=function(t){this.data=t},jsts.noding.NodedSegmentString.prototype.getNodeList=function(){return this.nodeList},jsts.noding.NodedSegmentString.prototype.size=function(){return this.pts.length},jsts.noding.NodedSegmentString.prototype.getCoordinate=function(t){return this.pts[t]},jsts.noding.NodedSegmentString.prototype.getCoordinates=function(){return this.pts},jsts.noding.NodedSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.noding.NodedSegmentString.prototype.getSegmentOctant=function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},jsts.noding.NodedSegmentString.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:jsts.noding.Octant.octant(t,e)},jsts.noding.NodedSegmentString.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},jsts.noding.NodedSegmentString.prototype.addIntersection=function(t,e,n,i){if(t instanceof jsts.geom.Coordinate)return void this.addIntersection2.apply(this,arguments);var o=new jsts.geom.Coordinate(t.getIntersection(i));this.addIntersection2(o,e)},jsts.noding.NodedSegmentString.prototype.addIntersection2=function(t,e){this.addIntersectionNode(t,e)},jsts.noding.NodedSegmentString.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this.pts.length){var o=this.pts[i];t.equals2D(o)&&(n=i)}var r=this.nodeList.add(t,n);return r},jsts.noding.NodedSegmentString.prototype.toString=function(){var t=new jsts.geom.GeometryFactory;return(new jsts.io.WKTWriter).write(t.createLineString(this.pts))},jsts.index.chain.MonotoneChainBuilder=function(){},jsts.index.chain.MonotoneChainBuilder.toIntArray=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n];return e},jsts.index.chain.MonotoneChainBuilder.getChains=function(t){return 2===arguments.length?jsts.index.chain.MonotoneChainBuilder.getChains2.apply(this,arguments):jsts.index.chain.MonotoneChainBuilder.getChains2(t,null)},jsts.index.chain.MonotoneChainBuilder.getChains2=function(t,e){for(var n=[],i=jsts.index.chain.MonotoneChainBuilder.getChainStartIndices(t),o=0;o<i.length-1;o++){var r=new jsts.index.chain.MonotoneChain(t,i[o],i[o+1],e);n.push(r)}return n},jsts.index.chain.MonotoneChainBuilder.getChainStartIndices=function(t){var e=0,n=[];n.push(e);do{var i=jsts.index.chain.MonotoneChainBuilder.findChainEnd(t,e);n.push(i),e=i}while(e<t.length-1);var o=jsts.index.chain.MonotoneChainBuilder.toIntArray(n);return o},jsts.index.chain.MonotoneChainBuilder.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=jsts.geomgraph.Quadrant.quadrant(t[n],t[n+1]),o=e+1;o<t.length;){if(!t[o-1].equals2D(t[o])){var r=jsts.geomgraph.Quadrant.quadrant(t[o-1],t[o]);if(r!==i)break}o++}return o-1},jsts.algorithm.LineIntersector=function(){this.inputLines=[[],[]],this.intPt=[null,null],this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION},jsts.algorithm.LineIntersector.NO_INTERSECTION=0,jsts.algorithm.LineIntersector.POINT_INTERSECTION=1,jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION=2,jsts.algorithm.LineIntersector.prototype.setPrecisionModel=function(t){this.precisionModel=t},jsts.algorithm.LineIntersector.prototype.getEndpoint=function(t,e){return this.inputLines[t][e]},jsts.algorithm.LineIntersector.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),o=Math.abs(n.y-e.y),r=-1;if(t.equals(e))r=0;else if(t.equals(n))r=i>o?i:o;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);r=i>o?s:a,0!==r||t.equals(e)||(r=Math.max(s,a))}if(0===r&&!t.equals(e))throw new jsts.error.IllegalArgumentError("Bad distance calculation");return r},jsts.algorithm.LineIntersector.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,o=t.y-e.y,r=Math.sqrt(i*i+o*o);if(0!==r||t.equals(e))throw new jsts.error.IllegalArgumentError("Invalid distance calculation");return r},jsts.algorithm.LineIntersector.prototype.result=null,jsts.algorithm.LineIntersector.prototype.inputLines=null,jsts.algorithm.LineIntersector.prototype.intPt=null,jsts.algorithm.LineIntersector.prototype.intLineIndex=null,jsts.algorithm.LineIntersector.prototype._isProper=null,jsts.algorithm.LineIntersector.prototype.pa=null,jsts.algorithm.LineIntersector.prototype.pb=null,jsts.algorithm.LineIntersector.prototype.precisionModel=null,
jsts.algorithm.LineIntersector.prototype.computeIntersection=function(t,e,n){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.LineIntersector.prototype.isCollinear=function(){return this.result===jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION},jsts.algorithm.LineIntersector.prototype.computeIntersection=function(t,e,n,i){this.inputLines[0][0]=t,this.inputLines[0][1]=e,this.inputLines[1][0]=n,this.inputLines[1][1]=i,this.result=this.computeIntersect(t,e,n,i)},jsts.algorithm.LineIntersector.prototype.computeIntersect=function(t,e,n,i){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.LineIntersector.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},jsts.algorithm.LineIntersector.prototype.hasIntersection=function(){return this.result!==jsts.algorithm.LineIntersector.NO_INTERSECTION},jsts.algorithm.LineIntersector.prototype.getIntersectionNum=function(){return this.result},jsts.algorithm.LineIntersector.prototype.getIntersection=function(t){return this.intPt[t]},jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(){null===this.intLineIndex&&(this.intLineIndex=[[],[]],this.computeIntLineIndex(0),this.computeIntLineIndex(1))},jsts.algorithm.LineIntersector.prototype.isIntersection=function(t){var e;for(e=0;e<this.result;e++)if(this.intPt[e].equals2D(t))return!0;return!1},jsts.algorithm.LineIntersector.prototype.isInteriorIntersection=function(){return 1===arguments.length?this.isInteriorIntersection2.apply(this,arguments):!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1)},jsts.algorithm.LineIntersector.prototype.isInteriorIntersection2=function(t){var e;for(e=0;e<this.result;e++)if(!this.intPt[e].equals2D(this.inputLines[t][0])&&!this.intPt[e].equals2D(this.inputLines[t][1]))return!0;return!1},jsts.algorithm.LineIntersector.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},jsts.algorithm.LineIntersector.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this.intPt[intLineIndex[t][e]]},jsts.algorithm.LineIntersector.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this.intLineIndex[t][e]},jsts.algorithm.LineIntersector.prototype.computeIntLineIndex=function(t){var e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);e>n?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)},jsts.algorithm.LineIntersector.prototype.getEdgeDistance=function(t,e){var n=jsts.algorithm.LineIntersector.computeEdgeDistance(this.intPt[e],this.inputLines[t][0],this.inputLines[t][1]);return n},jsts.algorithm.RobustLineIntersector=function(){jsts.algorithm.RobustLineIntersector.prototype.constructor.call(this)},jsts.algorithm.RobustLineIntersector.prototype=new jsts.algorithm.LineIntersector,jsts.algorithm.RobustLineIntersector.prototype.computeIntersection=function(t,e,n){return 4===arguments.length?void jsts.algorithm.LineIntersector.prototype.computeIntersection.apply(this,arguments):(this._isProper=!1,jsts.geom.Envelope.intersects(e,n,t)&&0===jsts.algorithm.CGAlgorithms.orientationIndex(e,n,t)&&0===jsts.algorithm.CGAlgorithms.orientationIndex(n,e,t)?(this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),void(this.result=jsts.algorithm.LineIntersector.POINT_INTERSECTION)):void(this.result=jsts.algorithm.LineIntersector.NO_INTERSECTION))},jsts.algorithm.RobustLineIntersector.prototype.computeIntersect=function(t,e,n,i){if(this._isProper=!1,!jsts.geom.Envelope.intersects(t,e,n,i))return jsts.algorithm.LineIntersector.NO_INTERSECTION;var o=jsts.algorithm.CGAlgorithms.orientationIndex(t,e,n),r=jsts.algorithm.CGAlgorithms.orientationIndex(t,e,i);if(o>0&&r>0||o<0&&r<0)return jsts.algorithm.LineIntersector.NO_INTERSECTION;var s=jsts.algorithm.CGAlgorithms.orientationIndex(n,i,t),a=jsts.algorithm.CGAlgorithms.orientationIndex(n,i,e);if(s>0&&a>0||s<0&&a<0)return jsts.algorithm.LineIntersector.NO_INTERSECTION;var l=0===o&&0===r&&0===s&&0===a;return l?this.computeCollinearIntersection(t,e,n,i):(0===o||0===r||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this.intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this.intPt[0]=e:0===o?this.intPt[0]=new jsts.geom.Coordinate(n):0===r?this.intPt[0]=new jsts.geom.Coordinate(i):0===s?this.intPt[0]=new jsts.geom.Coordinate(t):0===a&&(this.intPt[0]=new jsts.geom.Coordinate(e))):(this._isProper=!0,this.intPt[0]=this.intersection(t,e,n,i)),jsts.algorithm.LineIntersector.POINT_INTERSECTION)};jsts.algorithm.RobustLineIntersector.prototype.computeCollinearIntersection=function(t,e,n,i){var o=jsts.geom.Envelope.intersects(t,e,n),r=jsts.geom.Envelope.intersects(t,e,i),s=jsts.geom.Envelope.intersects(n,i,t),a=jsts.geom.Envelope.intersects(n,i,e);return o&&r?(this.intPt[0]=n,this.intPt[1]=i,jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION):s&&a?(this.intPt[0]=t,this.intPt[1]=e,jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION):o&&s?(this.intPt[0]=n,this.intPt[1]=t,!n.equals(t)||r||a?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):o&&a?(this.intPt[0]=n,this.intPt[1]=e,!n.equals(e)||r||s?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):r&&s?(this.intPt[0]=i,this.intPt[1]=t,!i.equals(t)||o||a?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):r&&a?(this.intPt[0]=i,this.intPt[1]=e,!i.equals(e)||o||s?jsts.algorithm.LineIntersector.COLLINEAR_INTERSECTION:jsts.algorithm.LineIntersector.POINT_INTERSECTION):jsts.algorithm.LineIntersector.NO_INTERSECTION};jsts.algorithm.RobustLineIntersector.prototype.intersection=function(t,e,n,i){var o=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(o)||(o=jsts.algorithm.CentralEndpointIntersector.getIntersection(t,e,n,i)),null!==this.precisionModel&&this.precisionModel.makePrecise(o),o},jsts.algorithm.RobustLineIntersector.prototype.intersectionWithNormalization=function(t,e,n,i){var o=new jsts.geom.Coordinate(t),r=new jsts.geom.Coordinate(e),s=new jsts.geom.Coordinate(n),a=new jsts.geom.Coordinate(i),l=new jsts.geom.Coordinate;this.normalizeToEnvCentre(o,r,s,a,l);var d=this.safeHCoordinateIntersection(o,r,s,a);return d.x+=l.x,d.y+=l.y,d},jsts.algorithm.RobustLineIntersector.prototype.safeHCoordinateIntersection=function(t,e,n,i){var o=null;try{o=jsts.algorithm.HCoordinate.intersection(t,e,n,i)}catch(r){if(!(r instanceof jsts.error.NotRepresentableError))throw r;o=jsts.algorithm.CentralEndpointIntersector.getIntersection(t,e,n,i)}return o},jsts.algorithm.RobustLineIntersector.prototype.normalizeToMinimum=function(t,e,n,i,o){o.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),o.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=o.x,t.y-=o.y,e.x-=o.x,e.y-=o.y,n.x-=o.x,n.y-=o.y,i.x-=o.x,i.y-=o.y},jsts.algorithm.RobustLineIntersector.prototype.normalizeToEnvCentre=function(t,e,n,i,o){var r=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,d=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,u=n.y>i.y?n.y:i.y,p=r>d?r:d,g=a<h?a:h,m=s>c?s:c,f=l<u?l:u,y=(p+g)/2,v=(m+f)/2;o.x=y,o.y=v,t.x-=o.x,t.y-=o.y,e.x-=o.x,e.y-=o.y,n.x-=o.x,n.y-=o.y,i.x-=o.x,i.y-=o.y},jsts.algorithm.RobustLineIntersector.prototype.smallestInAbsValue=function(t,e,n,i){var o=t,r=Math.abs(o);return Math.abs(e)<r&&(o=e,r=Math.abs(e)),Math.abs(n)<r&&(o=n,r=Math.abs(n)),Math.abs(i)<r&&(o=i),o},jsts.algorithm.RobustLineIntersector.prototype.isInSegmentEnvelopes=function(t){var e=new jsts.geom.Envelope(this.inputLines[0][0],this.inputLines[0][1]),n=new jsts.geom.Envelope(this.inputLines[1][0],this.inputLines[1][1]);return e.contains(t)&&n.contains(t)},jsts.algorithm.HCoordinate=function(){this.x=0,this.y=0,this.w=1,1===arguments.length?this.initFrom1Coordinate(arguments[0]):2===arguments.length&&arguments[0]instanceof jsts.geom.Coordinate?this.initFrom2Coordinates(arguments[0],arguments[1]):2===arguments.length&&arguments[0]instanceof jsts.algorithm.HCoordinate?this.initFrom2HCoordinates(arguments[0],arguments[1]):2===arguments.length?this.initFromXY(arguments[0],arguments[1]):3===arguments.length?this.initFromXYW(arguments[0],arguments[1],arguments[2]):4===arguments.length&&this.initFromXYW(arguments[0],arguments[1],arguments[2],arguments[3])},jsts.algorithm.HCoordinate.intersection=function(t,e,n,i){var o,r,s,a,l,d,c,h,u,p,g;if(o=t.y-e.y,r=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,d=n.x*i.y-i.x*n.y,c=r*d-l*s,h=a*s-o*d,u=o*l-a*r,p=c/u,g=h/u,!isFinite(p)||!isFinite(g))throw new jsts.error.NotRepresentableError;return new jsts.geom.Coordinate(p,g)},jsts.algorithm.HCoordinate.prototype.initFrom1Coordinate=function(t){this.x=t.x,this.y=t.y,this.w=1},jsts.algorithm.HCoordinate.prototype.initFrom2Coordinates=function(t,e){this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y},jsts.algorithm.HCoordinate.prototype.initFrom2HCoordinates=function(t,e){this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y},jsts.algorithm.HCoordinate.prototype.initFromXYW=function(t,e,n){this.x=t,this.y=e,this.w=n},jsts.algorithm.HCoordinate.prototype.initFromXY=function(t,e){this.x=t,this.y=e,this.w=1},jsts.algorithm.HCoordinate.prototype.initFrom4Coordinates=function(t,e,n,i){var o,r,s,a,l,d;o=t.y-e.y,r=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,d=n.x*i.y-i.x*n.y,this.x=r*d-l*s,this.y=a*s-o*d,this.w=o*l-a*r},jsts.algorithm.HCoordinate.prototype.getX=function(){var t=this.x/this.w;if(!isFinite(t))throw new jsts.error.NotRepresentableError;return t},jsts.algorithm.HCoordinate.prototype.getY=function(){var t=this.y/this.w;if(!isFinite(t))throw new jsts.error.NotRepresentableError;return t},jsts.algorithm.HCoordinate.prototype.getCoordinate=function(){var t=new jsts.geom.Coordinate;return t.x=this.getX(),t.y=this.getY(),t},jsts.geom.LineSegment=function(){0===arguments.length?(this.p0=new jsts.geom.Coordinate,this.p1=new jsts.geom.Coordinate):1===arguments.length?(this.p0=arguments[0].p0,this.p1=arguments[0].p1):2===arguments.length?(this.p0=arguments[0],this.p1=arguments[1]):4===arguments.length&&(this.p0=new jsts.geom.Coordinate(arguments[0],arguments[1]),this.p1=new jsts.geom.Coordinate(arguments[2],arguments[3]))},jsts.geom.LineSegment.prototype.p0=null,jsts.geom.LineSegment.prototype.p1=null,jsts.geom.LineSegment.midPoint=function(t,e){return new jsts.geom.Coordinate((t.x+e.x)/2,(t.y+e.y)/2)},jsts.geom.LineSegment.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},jsts.geom.LineSegment.prototype.getLength=function(){return this.p0.distance(this.p1)},jsts.geom.LineSegment.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},jsts.geom.LineSegment.prototype.isVertical=function(){return this.p0.x===this.p1.x},jsts.geom.LineSegment.prototype.orientationIndex=function(t){return t instanceof jsts.geom.LineSegment?this.orientationIndex1(t):t instanceof jsts.geom.Coordinate?this.orientationIndex2(t):void 0},jsts.geom.LineSegment.prototype.orientationIndex1=function(t){var e=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,t.p0),n=jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0?Math.max(e,n):e<=0&&n<=0?Math.max(e,n):0},jsts.geom.LineSegment.prototype.orientationIndex2=function(t){return jsts.algorithm.CGAlgorithms.orientationIndex(this.p0,this.p1,t)},jsts.geom.LineSegment.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},jsts.geom.LineSegment.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},jsts.geom.LineSegment.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},jsts.geom.LineSegment.prototype.midPoint=function(){return jsts.geom.LineSegment.midPoint(this.p0,this.p1)},jsts.geom.LineSegment.prototype.distance=function(t){return t instanceof jsts.geom.LineSegment?this.distance1(t):t instanceof jsts.geom.Coordinate?this.distance2(t):void 0},jsts.geom.LineSegment.prototype.distance1=function(t){return jsts.algorithm.CGAlgorithms.distanceLineLine(this.p0,this.p1,t.p0,t.p1)},jsts.geom.LineSegment.prototype.distance2=function(t){return jsts.algorithm.CGAlgorithms.distancePointLine(t,this.p0,this.p1)},jsts.geom.LineSegment.prototype.pointAlong=function(t){var e=new jsts.geom.Coordinate;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},jsts.geom.LineSegment.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),o=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,s=Math.sqrt(o*o+r*r),a=0,l=0;if(0!==e){if(s<=0)throw"Cannot compute offset from zero-length line segment";a=e*o/s,l=e*r/s}var d=n-l,c=i+a,h=new jsts.geom.Coordinate(d,c);return h},jsts.geom.LineSegment.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n,o=((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i;return o},jsts.geom.LineSegment.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||isNaN(e))&&(e=1),e},jsts.geom.LineSegment.prototype.project=function(t){return t instanceof jsts.geom.Coordinate?this.project1(t):t instanceof jsts.geom.LineSegment?this.project2(t):void 0},jsts.geom.LineSegment.prototype.project1=function(t){if(t.equals(this.p0)||t.equals(this.p1))return new jsts.geom.Coordinate(t);var e=this.projectionFactor(t),n=new jsts.geom.Coordinate;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n},jsts.geom.LineSegment.prototype.project2=function(t){var e=this.projectionFactor(t.p0),n=this.projectionFactor(t.p1);if(e>=1&&n>=1)return null;if(e<=0&&n<=0)return null;var i=this.project(t.p0);e<0&&(i=p0),e>1&&(i=p1);var o=this.project(t.p1);return n<0&&(o=p0),n>1&&(o=p1),new jsts.geom.LineSegment(i,o)},jsts.geom.LineSegment.prototype.closestPoint=function(t){var e=this.projectionFactor(t);if(e>0&&e<1)return this.project(t);var n=this.p0.distance(t),i=this.p1.distance(t);return n<i?this.p0:this.p1},jsts.geom.LineSegment.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n,i=[],o=Number.MAX_VALUE,r=this.closestPoint(t.p0);o=r.distance(t.p0),i[0]=r,i[1]=t.p0;var s=this.closestPoint(t.p1);n=s.distance(t.p1),n<o&&(o=n,i[0]=s,i[1]=t.p1);var a=t.closestPoint(this.p0);n=a.distance(this.p0),n<o&&(o=n,i[0]=this.p0,i[1]=a);var l=t.closestPoint(this.p1);return n=l.distance(this.p1),n<o&&(o=n,i[0]=this.p1,i[1]=l),i},jsts.geom.LineSegment.prototype.intersection=function(t){var e=new jsts.algorithm.RobustLineIntersector;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},jsts.geom.LineSegment.prototype.setCoordinates=function(t){return t instanceof jsts.geom.Coordinate?void this.setCoordinates2.apply(this,arguments):void this.setCoordinates2(t.p0,t.p1)},jsts.geom.LineSegment.prototype.setCoordinates2=function(t,e){this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y},jsts.geom.LineSegment.prototype.distancePerpendicular=function(t){return jsts.algorithm.CGAlgorithms.distancePointLinePerpendicular(t,this.p0,this.p1)},jsts.geom.LineSegment.prototype.lineIntersection=function(t){try{var e=jsts.algorithm.HCoordinate.intersection(this.p0,this.p1,t.p0,t.p1);return e}catch(t){}return null},jsts.geom.LineSegment.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},jsts.geom.LineSegment.prototype.equals=function(t){return t instanceof jsts.geom.LineSegment&&(this.p0.equals(t.p0)&&this.p1.equals(t.p1))},jsts.geom.LineSegment.prototype.compareTo=function(t){var e=this.p0.compareTo(t.p0);return 0!==e?e:this.p1.compareTo(t.p1)},jsts.geom.LineSegment.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)},jsts.geom.LineSegment.prototype.toString=function(){return"LINESTRING("+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},jsts.index.chain.MonotoneChainOverlapAction=function(){this.tempEnv1=new jsts.geom.Envelope,this.tempEnv2=new jsts.geom.Envelope,this.overlapSeg1=new jsts.geom.LineSegment,this.overlapSeg2=new jsts.geom.LineSegment},jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv1=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.tempEnv2=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg1=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.overlapSeg2=null,jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap=function(t,e,n,i){this.mc1.getLineSegment(e,this.overlapSeg1),this.mc2.getLineSegment(i,this.overlapSeg2),this.overlap2(this.overlapSeg1,this.overlapSeg2)},jsts.index.chain.MonotoneChainOverlapAction.prototype.overlap2=function(t,e){},function(){var t=jsts.index.chain.MonotoneChainOverlapAction,e=jsts.noding.SinglePassNoder,n=jsts.index.strtree.STRtree,i=jsts.noding.NodedSegmentString,o=jsts.index.chain.MonotoneChainBuilder,r=function(t){this.si=t};r.prototype=new t,r.constructor=r,r.prototype.si=null,r.prototype.overlap=function(t,e,n,i){var o=t.getContext(),r=n.getContext();this.si.processIntersections(o,e,r,i)},jsts.noding.MCIndexNoder=function(){this.monoChains=[],this.index=new n},jsts.noding.MCIndexNoder.prototype=new e,jsts.noding.MCIndexNoder.constructor=jsts.noding.MCIndexNoder,jsts.noding.MCIndexNoder.prototype.monoChains=null,jsts.noding.MCIndexNoder.prototype.index=null,jsts.noding.MCIndexNoder.prototype.idCounter=0,jsts.noding.MCIndexNoder.prototype.nodedSegStrings=null,jsts.noding.MCIndexNoder.prototype.nOverlaps=0,jsts.noding.MCIndexNoder.prototype.getMonotoneChains=function(){return this.monoChains},jsts.noding.MCIndexNoder.prototype.getIndex=function(){return this.index},jsts.noding.MCIndexNoder.prototype.getNodedSubstrings=function(){return i.getNodedSubstrings(this.nodedSegStrings)},jsts.noding.MCIndexNoder.prototype.computeNodes=function(t){this.nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},jsts.noding.MCIndexNoder.prototype.intersectChains=function(){for(var t=new r(this.segInt),e=0;e<this.monoChains.length;e++)for(var n=this.monoChains[e],i=this.index.query(n.getEnvelope()),o=0;o<i.length;o++){var s=i[o];if(s.getId()>n.getId()&&(n.computeOverlaps(s,t),this.nOverlaps++),this.segInt.isDone())return}},jsts.noding.MCIndexNoder.prototype.add=function(t){for(var e=o.getChains(t.getCoordinates(),t),n=0;n<e.length;n++){var i=e[n];i.setId(this.idCounter++),this.index.insert(i.getEnvelope(),i),this.monoChains.push(i)}}}(),jsts.simplify.LineSegmentIndex=function(){this.index=new jsts.index.quadtree.Quadtree},jsts.simplify.LineSegmentIndex.prototype.index=null,jsts.simplify.LineSegmentIndex.prototype.add=function(t){if(t instanceof jsts.geom.LineSegment)return void this.add2(t);for(var e=t.getSegments(),n=0;n<e.length;n++){var i=e[n];this.add2(i)}},jsts.simplify.LineSegmentIndex.prototype.add2=function(t){this.index.insert(new jsts.geom.Envelope(t.p0,t.p1),t)},jsts.simplify.LineSegmentIndex.prototype.remove=function(t){this.index.remove(new jsts.geom.Envelope(t.p0,t.p1),t)},jsts.simplify.LineSegmentIndex.prototype.query=function(t){var e=new jsts.geom.Envelope(t.p0,t.p1),n=new jsts.simplify.LineSegmentIndex.LineSegmentVisitor(t);this.index.query(e,n);var i=n.getItems();return i},jsts.simplify.LineSegmentIndex.LineSegmentVisitor=function(t){this.items=[],this.querySeg=t},jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype=new jsts.index.ItemVisitor,jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.querySeg=null,jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.items=null,jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.visitItem=function(t){var e=t;jsts.geom.Envelope.intersects(e.p0,e.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.push(t)},jsts.simplify.LineSegmentIndex.LineSegmentVisitor.prototype.getItems=function(){return this.items},jsts.geomgraph.EdgeEndStar=function(){this.edgeMap=new javascript.util.TreeMap,this.edgeList=null,this.ptInAreaLocation=[jsts.geom.Location.NONE,jsts.geom.Location.NONE]},jsts.geomgraph.EdgeEndStar.prototype.edgeMap=null,jsts.geomgraph.EdgeEndStar.prototype.edgeList=null,jsts.geomgraph.EdgeEndStar.prototype.ptInAreaLocation=null,jsts.geomgraph.EdgeEndStar.prototype.insert=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.EdgeEndStar.prototype.insertEdgeEnd=function(t,e){this.edgeMap.put(t,e),this.edgeList=null},jsts.geomgraph.EdgeEndStar.prototype.getCoordinate=function(){var t=this.iterator();if(!t.hasNext())return null;var e=t.next();return e.getCoordinate()},jsts.geomgraph.EdgeEndStar.prototype.getDegree=function(){return this.edgeMap.size()},jsts.geomgraph.EdgeEndStar.prototype.iterator=function(){return this.getEdges().iterator()},jsts.geomgraph.EdgeEndStar.prototype.getEdges=function(){return null===this.edgeList&&(this.edgeList=new javascript.util.ArrayList(this.edgeMap.values())),this.edgeList},jsts.geomgraph.EdgeEndStar.prototype.getNextCW=function(t){this.getEdges();var e=this.edgeList.indexOf(t),n=e-1;return 0===e&&(n=this.edgeList.length-1),this.edgeList[n]},jsts.geomgraph.EdgeEndStar.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next(),o=i.getLabel(),r=0;r<2;r++)o.isLine(r)&&o.getLocation(r)===jsts.geom.Location.BOUNDARY&&(e[r]=!0);for(var n=this.iterator();n.hasNext();)for(var i=n.next(),o=i.getLabel(),r=0;r<2;r++)if(o.isAnyNull(r)){var s=jsts.geom.Location.NONE;if(e[r])s=jsts.geom.Location.EXTERIOR;else{var a=i.getCoordinate();s=this.getLocation(r,a,t)}o.setAllLocationsIfNull(r,s)}},jsts.geomgraph.EdgeEndStar.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next();n.computeLabel(t)}},jsts.geomgraph.EdgeEndStar.prototype.getLocation=function(t,e,n){return this.ptInAreaLocation[t]===jsts.geom.Location.NONE&&(this.ptInAreaLocation[t]=jsts.algorithm.locate.SimplePointInAreaLocator.locate(e,n[t].getGeometry())),this.ptInAreaLocation[t]},jsts.geomgraph.EdgeEndStar.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},jsts.geomgraph.EdgeEndStar.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel(),o=i.getLocation(t,jsts.geomgraph.Position.LEFT);jsts.util.Assert.isTrue(o!=jsts.geom.Location.NONE,"Found unlabelled area edge");for(var r=o,s=this.iterator();s.hasNext();){var a=s.next(),l=a.getLabel();jsts.util.Assert.isTrue(l.isArea(t),"Found non-area edge");var d=l.getLocation(t,jsts.geomgraph.Position.LEFT),c=l.getLocation(t,jsts.geomgraph.Position.RIGHT);if(d===c)return!1;if(c!==r)return!1;r=d}return!0},jsts.geomgraph.EdgeEndStar.prototype.propagateSideLabels=function(t){for(var e=jsts.geom.Location.NONE,n=this.iterator();n.hasNext();){var i=n.next(),o=i.getLabel();o.isArea(t)&&o.getLocation(t,jsts.geomgraph.Position.LEFT)!==jsts.geom.Location.NONE&&(e=o.getLocation(t,jsts.geomgraph.Position.LEFT))}if(e!==jsts.geom.Location.NONE)for(var r=e,n=this.iterator();n.hasNext();){var i=n.next(),o=i.getLabel();if(o.getLocation(t,jsts.geomgraph.Position.ON)===jsts.geom.Location.NONE&&o.setLocation(t,jsts.geomgraph.Position.ON,r),o.isArea(t)){var s=o.getLocation(t,jsts.geomgraph.Position.LEFT),a=o.getLocation(t,jsts.geomgraph.Position.RIGHT);if(a!==jsts.geom.Location.NONE){if(a!==r)throw new jsts.error.TopologyError("side location conflict",i.getCoordinate());s===jsts.geom.Location.NONE&&jsts.util.Assert.shouldNeverReachHere("found single null side (at "+i.getCoordinate()+")"),r=s}else jsts.util.Assert.isTrue(o.getLocation(t,jsts.geomgraph.Position.LEFT)===jsts.geom.Location.NONE,"found single null side"),o.setLocation(t,jsts.geomgraph.Position.RIGHT,r),o.setLocation(t,jsts.geomgraph.Position.LEFT,r)}}},jsts.geomgraph.EdgeEndStar.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this.edgeList.size();e++){var n=this.edgeList.get(e);if(n===t)return e}return-1},jsts.operation.relate.EdgeEndBundleStar=function(){jsts.geomgraph.EdgeEndStar.apply(this,arguments)},jsts.operation.relate.EdgeEndBundleStar.prototype=new jsts.geomgraph.EdgeEndStar,jsts.operation.relate.EdgeEndBundleStar.prototype.insert=function(t){var e=this.edgeMap.get(t);null===e?(e=new jsts.operation.relate.EdgeEndBundle(t),this.insertEdgeEnd(t,e)):e.insert(t)},jsts.operation.relate.EdgeEndBundleStar.prototype.updateIM=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next();n.updateIM(t)}},jsts.index.ArrayListVisitor=function(){this.items=[]},jsts.index.ArrayListVisitor.prototype.visitItem=function(t){this.items.push(t)},jsts.index.ArrayListVisitor.prototype.getItems=function(){return this.items},jsts.algorithm.distance.DistanceToPoint=function(){},jsts.algorithm.distance.DistanceToPoint.computeDistance=function(t,e,n){if(t instanceof jsts.geom.LineString)jsts.algorithm.distance.DistanceToPoint.computeDistance2(t,e,n);else if(t instanceof jsts.geom.Polygon)jsts.algorithm.distance.DistanceToPoint.computeDistance4(t,e,n);else if(t instanceof jsts.geom.GeometryCollection)for(var i=t,o=0;o<i.getNumGeometries();o++){var r=i.getGeometryN(o);jsts.algorithm.distance.DistanceToPoint.computeDistance(r,e,n)}else n.setMinimum(t.getCoordinate(),e)},jsts.algorithm.distance.DistanceToPoint.computeDistance2=function(t,e,n){for(var i=new jsts.geom.LineSegment,o=t.getCoordinates(),r=0;r<o.length-1;r++){i.setCoordinates(o[r],o[r+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}},jsts.algorithm.distance.DistanceToPoint.computeDistance3=function(t,e,n){var i=t.closestPoint(e);n.setMinimum(i,e)},jsts.algorithm.distance.DistanceToPoint.computeDistance4=function(t,e,n){jsts.algorithm.distance.DistanceToPoint.computeDistance2(t.getExteriorRing(),e,n);for(var i=0;i<t.getNumInteriorRing();i++)jsts.algorithm.distance.DistanceToPoint.computeDistance2(t.getInteriorRingN(i),e,n)},jsts.index.strtree.ItemBoundable=function(t,e){this.bounds=t,this.item=e},jsts.index.strtree.ItemBoundable.prototype=new jsts.index.strtree.Boundable,jsts.index.strtree.ItemBoundable.constructor=jsts.index.strtree.ItemBoundable,jsts.index.strtree.ItemBoundable.prototype.bounds=null,jsts.index.strtree.ItemBoundable.prototype.item=null,jsts.index.strtree.ItemBoundable.prototype.getBounds=function(){return this.bounds},jsts.index.strtree.ItemBoundable.prototype.getItem=function(){return this.item},function(){var t=javascript.util.ArrayList,e=javascript.util.TreeMap;jsts.geomgraph.EdgeList=function(){this.edges=new t,this.ocaMap=new e},jsts.geomgraph.EdgeList.prototype.edges=null,jsts.geomgraph.EdgeList.prototype.ocaMap=null,jsts.geomgraph.EdgeList.prototype.add=function(t){this.edges.add(t);var e=new jsts.noding.OrientedCoordinateArray(t.getCoordinates());this.ocaMap.put(e,t)},jsts.geomgraph.EdgeList.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges},jsts.geomgraph.EdgeList.prototype.findEqualEdge=function(t){var e=new jsts.noding.OrientedCoordinateArray(t.getCoordinates()),n=this.ocaMap.get(e);return n},jsts.geomgraph.EdgeList.prototype.getEdges=function(){return this.edges},jsts.geomgraph.EdgeList.prototype.iterator=function(){return this.edges.iterator()},jsts.geomgraph.EdgeList.prototype.get=function(t){return this.edges.get(t)},jsts.geomgraph.EdgeList.prototype.findEdgeIndex=function(t){for(var e=0;e<this.edges.size();e++)if(this.edges.get(e).equals(t))return e;return-1}}(),jsts.operation.IsSimpleOp=function(t){this.geom=t},jsts.operation.IsSimpleOp.prototype.geom=null,jsts.operation.IsSimpleOp.prototype.isClosedEndpointsInInterior=!0,jsts.operation.IsSimpleOp.prototype.nonSimpleLocation=null,jsts.operation.IsSimpleOp.prototype.IsSimpleOp=function(t){this.geom=t},jsts.operation.IsSimpleOp.prototype.isSimple=function(){return this.nonSimpleLocation=null,this.geom instanceof jsts.geom.LineString?this.isSimpleLinearGeometry(this.geom):this.geom instanceof jsts.geom.MultiLineString?this.isSimpleLinearGeometry(this.geom):!(this.geom instanceof jsts.geom.MultiPoint)||this.isSimpleMultiPoint(this.geom)},jsts.operation.IsSimpleOp.prototype.isSimpleMultiPoint=function(t){if(t.isEmpty())return!0;for(var e=[],n=0;n<t.getNumGeometries();n++){for(var i=t.getGeometryN(n),o=i.getCoordinate(),r=0;r<e.length;r++){var s=e[r];if(o.equals2D(s))return this.nonSimpleLocation=o,!1}e.push(o)}return!0},jsts.operation.IsSimpleOp.prototype.isSimpleLinearGeometry=function(t){if(t.isEmpty())return!0;var e=new jsts.geomgraph.GeometryGraph(0,t),n=new jsts.algorithm.RobustLineIntersector,i=e.computeSelfNodes(n,!0);return!i.hasIntersection()||(i.hasProperIntersection()?(this.nonSimpleLocation=i.getProperIntersectionPoint(),!1):!this.hasNonEndpointIntersection(e)&&(!this.isClosedEndpointsInInterior||!this.hasClosedEndpointIntersection(e)))},jsts.operation.IsSimpleOp.prototype.hasNonEndpointIntersection=function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getMaximumSegmentIndex(),o=n.getEdgeIntersectionList().iterator();o.hasNext();){var r=o.next();if(!r.isEndPoint(i))return this.nonSimpleLocation=r.getCoordinate(),!0}return!1},jsts.operation.IsSimpleOp.prototype.hasClosedEndpointIntersection=function(t){for(var e=new javascript.util.TreeMap,n=t.getEdgeIterator();n.hasNext();){var i=n.next(),o=(i.getMaximumSegmentIndex(),i.isClosed()),r=i.getCoordinate(0);this.addEndpoint(e,r,o);var s=i.getCoordinate(i.getNumPoints()-1);this.addEndpoint(e,s,o)}for(var n=e.values().iterator();n.hasNext();){var a=n.next();if(a.isClosed&&2!=a.degree)return this.nonSimpleLocation=a.getCoordinate(),!0}return!1},jsts.operation.IsSimpleOp.EndpointInfo=function(t){this.pt=t,this.isClosed=!1,this.degree=0},jsts.operation.IsSimpleOp.EndpointInfo.prototype.pt=null,jsts.operation.IsSimpleOp.EndpointInfo.prototype.isClosed=null,jsts.operation.IsSimpleOp.EndpointInfo.prototype.degree=null,jsts.operation.IsSimpleOp.EndpointInfo.prototype.getCoordinate=function(){return this.pt},jsts.operation.IsSimpleOp.EndpointInfo.prototype.addEndpoint=function(t){this.degree++,this.isClosed=this.isClosed||t},jsts.operation.IsSimpleOp.prototype.addEndpoint=function(t,e,n){var i=t.get(e);null===i&&(i=new jsts.operation.IsSimpleOp.EndpointInfo(e),t.put(e,i)),i.addEndpoint(n)},function(){var t=function(){this.snapTolerance=0,this.seg=new jsts.geom.LineSegment,this.allowSnappingToSourceVertices=!1,this.isClosed=!1,this.srcPts=[],arguments[0]instanceof jsts.geom.LineString?this.initFromLine.apply(this,arguments):this.initFromPoints.apply(this,arguments)};t.prototype.initFromLine=function(t,e){this.initFromPoints(t.getCoordinates(),e)},t.prototype.initFromPoints=function(t,e){this.srcPts=t,this.isClosed=this.calcIsClosed(t),this.snapTolerance=e},t.prototype.setAllowSnappingToSourceVertices=function(t){this.allowSnappingToSourceVertices=t},t.prototype.calcIsClosed=function(t){return!(t.length<=1)&&t[0].equals(t[t.length-1])},t.prototype.snapTo=function(t){var e=new jsts.geom.CoordinateList(this.srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},t.prototype.snapVertices=function(t,e){var n,i,o=this.isClosed?t.size()-1:t.size(),r=0;for(r;r<o;r++)n=t.get(r),i=this.findSnapForVertex(n,e),null!==i&&(t.set(r,new jsts.geom.Coordinate(i)),0===r&&this.isClosed&&t.set(t.size()-1,new jsts.geom.Coordinate(i)))},t.prototype.findSnapForVertex=function(t,e){var n=0,i=e.length;for(n=0;n<i;n++){if(t.equals(e[n]))return null;if(t.distance(e[n])<this.snapTolerance)return e[n]}return null},t.prototype.snapSegments=function(t,e){if(0!==e.length){var n,i,o,r=e.length;for(e.length>1&&e[0].equals2D(e[e.length-1])&&(r=e.length-1),n=0;n<r;n++)i=e[n],o=this.findSegmentIndexToSnap(i,t),o>=0&&t.add(o+1,new jsts.geom.Coordinate(i),!1)}},t.prototype.findSegmentIndexToSnap=function(t,e){
var n,i=Number.MAX_VALUE,o=-1,r=0;for(r;r<e.size()-1;r++){if(this.seg.p0=e.get(r),this.seg.p1=e.get(r+1),this.seg.p0.equals(t)||this.seg.p1.equals(t)){if(this.allowSnappingToSourceVertices)continue;return-1}n=this.seg.distance(t),n<this.snapTolerance&&n<i&&(i=n,o=r)}return o},jsts.operation.overlay.snap.LineStringSnapper=t}(),function(){var t=javascript.util.ArrayList,e=jsts.geom.GeometryComponentFilter,n=jsts.geom.LineString,i=jsts.operation.polygonize.EdgeRing,o=jsts.operation.polygonize.PolygonizeGraph,r=function(){var i=this,o=function(){};o.prototype=new e,o.prototype.filter=function(t){t instanceof n&&i.add(t)},this.lineStringAdder=new o,this.dangles=new t,this.cutEdges=new t,this.invalidRingLines=new t};r.prototype.lineStringAdder=null,r.prototype.graph=null,r.prototype.dangles=null,r.prototype.cutEdges=null,r.prototype.invalidRingLines=null,r.prototype.holeList=null,r.prototype.shellList=null,r.prototype.polyList=null,r.prototype.add=function(t){if(t instanceof jsts.geom.LineString)return this.add3(t);if(t instanceof jsts.geom.Geometry)return this.add2(t);for(var e=t.iterator();e.hasNext();){var n=e.next();this.add2(n)}},r.prototype.add2=function(t){t.apply(this.lineStringAdder)},r.prototype.add3=function(t){null==this.graph&&(this.graph=new o(t.getFactory())),this.graph.addEdge(t)},r.prototype.getPolygons=function(){return this.polygonize(),this.polyList},r.prototype.getDangles=function(){return this.polygonize(),this.dangles},r.prototype.getCutEdges=function(){return this.polygonize(),this.cutEdges},r.prototype.getInvalidRingLines=function(){return this.polygonize(),this.invalidRingLines},r.prototype.polygonize=function(){if(null==this.polyList&&(this.polyList=new t,null!=this.graph)){this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var e=this.graph.getEdgeRings(),n=new t;this.invalidRingLines=new t,this.findValidRings(e,n,this.invalidRingLines),this.findShellsAndHoles(n),r.assignHolesToShells(this.holeList,this.shellList),this.polyList=new t;for(var i=this.shellList.iterator();i.hasNext();){var o=i.next();this.polyList.add(o.getPolygon())}}},r.prototype.findValidRings=function(t,e,n){for(var i=t.iterator();i.hasNext();){var o=i.next();o.isValid()?e.add(o):n.add(o.getLineString())}},r.prototype.findShellsAndHoles=function(e){this.holeList=new t,this.shellList=new t;for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()?this.holeList.add(i):this.shellList.add(i)}},r.assignHolesToShells=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();r.assignHoleToShell(i,e)}},r.assignHoleToShell=function(t,e){var n=i.findEdgeRingContaining(t,e);null!=n&&n.addHole(t.getRing())},jsts.operation.polygonize.Polygonizer=r}(),jsts.geomgraph.index.EdgeSetIntersector=function(){},jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections=function(t,e,n){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.index.EdgeSetIntersector.prototype.computeIntersections2=function(t,e,n){throw new jsts.error.AbstractMethodInvocationError},jsts.geomgraph.index.SimpleMCSweepLineIntersector=function(){this.events=[]},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector,jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.events=null,jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.nOverlaps=0,jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections=function(t,e,n){return e instanceof javascript.util.List?void this.computeIntersections2.apply(this,arguments):(n?this.addList2(t,null):this.addList(t),void this.computeIntersections3(e))},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections2=function(t,e,n){this.addList2(t,t),this.addList2(e,e),this.computeIntersections3(n)},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.add=function(t,e){if(t instanceof javascript.util.List)return void this.addList.apply(this,arguments);for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),o=0;o<i.length-1;o++){var r=new jsts.geomgraph.index.MonotoneChain(n,o),s=new jsts.geomgraph.index.SweepLineEvent(n.getMinX(o),r,e);this.events.push(s),this.events.push(new jsts.geomgraph.index.SweepLineEvent(n.getMaxX(o),s))}},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.add(n,n)}},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.addList2=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();this.add(i,e)}},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(t,e){return t.compareTo(e)});for(var t=0;t<this.events.length;t++){var e=this.events[t];e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.computeIntersections3=function(t){this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.length;e++){var n=this.events[e];n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t)}},jsts.geomgraph.index.SimpleMCSweepLineIntersector.prototype.processOverlaps=function(t,e,n,i){for(var o=n.getObject(),r=t;r<e;r++){var s=this.events[r];if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(o.computeIntersections(a,i),this.nOverlaps++)}}},jsts.algorithm.locate.SimplePointInAreaLocator=function(t){this.geom=t},jsts.algorithm.locate.SimplePointInAreaLocator.locate=function(t,e){return e.isEmpty()?jsts.geom.Location.EXTERIOR:jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(t,e)?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR},jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint=function(t,e){if(e instanceof jsts.geom.Polygon)return jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon(t,e);if(e instanceof jsts.geom.GeometryCollection||e instanceof jsts.geom.MultiPoint||e instanceof jsts.geom.MultiLineString||e instanceof jsts.geom.MultiPolygon)for(var n=0;n<e.geometries.length;n++){var i=e.geometries[n];if(i!==e&&jsts.algorithm.locate.SimplePointInAreaLocator.containsPoint(t,i))return!0}return!1},jsts.algorithm.locate.SimplePointInAreaLocator.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i);if(jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing(t,o))return!1}return!0},jsts.algorithm.locate.SimplePointInAreaLocator.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&jsts.algorithm.CGAlgorithms.isPointInRing(t,e.getCoordinates())},jsts.algorithm.locate.SimplePointInAreaLocator.prototype.geom=null,jsts.algorithm.locate.SimplePointInAreaLocator.prototype.locate=function(t){return jsts.algorithm.locate.SimplePointInAreaLocator.locate(t,geom)},function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position,n=jsts.geomgraph.EdgeEndStar,i=jsts.util.Assert;jsts.geomgraph.DirectedEdgeStar=function(){jsts.geomgraph.EdgeEndStar.call(this)},jsts.geomgraph.DirectedEdgeStar.prototype=new n,jsts.geomgraph.DirectedEdgeStar.constructor=jsts.geomgraph.DirectedEdgeStar,jsts.geomgraph.DirectedEdgeStar.prototype.resultAreaEdgeList=null,jsts.geomgraph.DirectedEdgeStar.prototype.label=null,jsts.geomgraph.DirectedEdgeStar.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},jsts.geomgraph.DirectedEdgeStar.prototype.getLabel=function(){return this.label},jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(){for(var t=0,e=this.iterator();e.hasNext();){var n=e.next();n.isInResult()&&t++}return t},jsts.geomgraph.DirectedEdgeStar.prototype.getOutgoingDegree=function(t){for(var e=0,n=this.iterator();n.hasNext();){var i=n.next();i.getEdgeRing()===t&&e++}return e},jsts.geomgraph.DirectedEdgeStar.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1==e)return n;var o=t.get(e-1),r=n.getQuadrant(),s=o.getQuadrant();if(jsts.geomgraph.Quadrant.isNorthern(r)&&jsts.geomgraph.Quadrant.isNorthern(s))return n;if(!jsts.geomgraph.Quadrant.isNorthern(r)&&!jsts.geomgraph.Quadrant.isNorthern(s))return o;return 0!=n.getDy()?n:0!=o.getDy()?o:(i.shouldNeverReachHere("found two horizontal edges incident on node"),null)},jsts.geomgraph.DirectedEdgeStar.prototype.computeLabelling=function(e){n.prototype.computeLabelling.call(this,e),this.label=new jsts.geomgraph.Label(t.NONE);for(var i=this.iterator();i.hasNext();)for(var o=i.next(),r=o.getEdge(),s=r.getLabel(),a=0;a<2;a++){var l=s.getLocation(a);l!==t.INTERIOR&&l!==t.BOUNDARY||this.label.setLocation(a,t.INTERIOR)}},jsts.geomgraph.DirectedEdgeStar.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next(),n=e.getLabel();n.merge(e.getSym().getLabel())}},jsts.geomgraph.DirectedEdgeStar.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}},jsts.geomgraph.DirectedEdgeStar.prototype.getResultAreaEdges=function(){if(null!==this.resultAreaEdgeList)return this.resultAreaEdgeList;this.resultAreaEdgeList=new javascript.util.ArrayList;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this.resultAreaEdgeList.add(e)}return this.resultAreaEdgeList},jsts.geomgraph.DirectedEdgeStar.prototype.SCANNING_FOR_INCOMING=1,jsts.geomgraph.DirectedEdgeStar.prototype.LINKING_TO_OUTGOING=2,jsts.geomgraph.DirectedEdgeStar.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this.SCANNING_FOR_INCOMING,o=0;o<this.resultAreaEdgeList.size();o++){var r=this.resultAreaEdgeList.get(o),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this.SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,n=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this.SCANNING_FOR_INCOMING}}if(n===this.LINKING_TO_OUTGOING){if(null===t)throw new jsts.error.TopologyError("no outgoing dirEdge found",this.getCoordinate());i.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},jsts.geomgraph.DirectedEdgeStar.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,o=this.SCANNING_FOR_INCOMING,r=this.resultAreaEdgeList.size()-1;r>=0;r--){var s=this.resultAreaEdgeList.get(r),a=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),o){case this.SCANNING_FOR_INCOMING:if(a.getEdgeRing()!=t)continue;n=a,o=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),o=this.SCANNING_FOR_INCOMING}}o===this.LINKING_TO_OUTGOING&&(i.isTrue(null!==e,"found null for first outgoing dirEdge"),i.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},jsts.geomgraph.DirectedEdgeStar.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this.edgeList.size()-1;n>=0;n--){var i=this.edgeList.get(n),o=i.getSym();null===e&&(e=o),null!==t&&o.setNext(t),t=i}e.setNext(t)},jsts.geomgraph.DirectedEdgeStar.prototype.findCoveredLineEdges=function(){for(var e=t.NONE,n=this.iterator();n.hasNext();){var i=n.next(),o=i.getSym();if(!i.isLineEdge()){if(i.isInResult()){e=t.INTERIOR;break}if(o.isInResult()){e=t.EXTERIOR;break}}}if(e!==t.NONE)for(var r=e,n=this.iterator();n.hasNext();){var i=n.next(),o=i.getSym();i.isLineEdge()?i.getEdge().setCovered(r===t.INTERIOR):(i.isInResult()&&(r=t.EXTERIOR),o.isInResult()&&(r=t.INTERIOR))}},jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths=function(t){if(2===arguments.length)return void this.computeDepths2.apply(this,arguments);var n=this.findIndex(t),i=(t.getLabel(),t.getDepth(e.LEFT)),o=t.getDepth(e.RIGHT),r=this.computeDepths2(n+1,this.edgeList.size(),i),s=this.computeDepths2(0,n,r);if(s!=o)throw new jsts.error.TopologyError("depth mismatch at "+t.getCoordinate())},jsts.geomgraph.DirectedEdgeStar.prototype.computeDepths2=function(t,n,i){for(var o=i,r=t;r<n;r++){var s=this.edgeList.get(r);s.getLabel();s.setEdgeDepths(e.RIGHT,o),o=s.getDepth(e.LEFT)}return o}}(),jsts.algorithm.CentroidLine=function(){this.centSum=new jsts.geom.Coordinate},jsts.algorithm.CentroidLine.prototype.centSum=null,jsts.algorithm.CentroidLine.prototype.totalLength=0,jsts.algorithm.CentroidLine.prototype.add=function(t){if(t instanceof Array)return void this.add2.apply(this,arguments);if(t instanceof jsts.geom.LineString)this.add(t.getCoordinates());else if(t instanceof jsts.geom.Polygon){var e=t;this.add(e.getExteriorRing().getCoordinates());for(var n=0;n<e.getNumInteriorRing();n++)this.add(e.getInteriorRingN(n).getCoordinates())}else if(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)for(var i=t,n=0;n<i.getNumGeometries();n++)this.add(i.getGeometryN(n))},jsts.algorithm.CentroidLine.prototype.getCentroid=function(){var t=new jsts.geom.Coordinate;return t.x=this.centSum.x/this.totalLength,t.y=this.centSum.y/this.totalLength,t},jsts.algorithm.CentroidLine.prototype.add2=function(t){for(var e=0;e<t.length-1;e++){var n=t[e].distance(t[e+1]);this.totalLength+=n;var i=(t[e].x+t[e+1].x)/2;this.centSum.x+=n*i;var o=(t[e].y+t[e+1].y)/2;this.centSum.y+=n*o}},jsts.algorithm.PointLocator=function(t){this.boundaryRule=t?t:jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE},jsts.algorithm.PointLocator.prototype.boundaryRule=null,jsts.algorithm.PointLocator.prototype.isIn=null,jsts.algorithm.PointLocator.prototype.numBoundaries=null,jsts.algorithm.PointLocator.prototype.intersects=function(t,e){return this.locate(t,e)!==jsts.geom.Location.EXTERIOR},jsts.algorithm.PointLocator.prototype.locate=function(t,e){return e.isEmpty()?jsts.geom.Location.EXTERIOR:e instanceof jsts.geom.Point?this.locate2(t,e):e instanceof jsts.geom.LineString?this.locate3(t,e):e instanceof jsts.geom.Polygon?this.locate4(t,e):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,e),this.boundaryRule.isInBoundary(this.numBoundaries)?jsts.geom.Location.BOUNDARY:this.numBoundaries>0||this.isIn?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR)},jsts.algorithm.PointLocator.prototype.computeLocation=function(t,e){if(e instanceof jsts.geom.Point||e instanceof jsts.geom.LineString||e instanceof jsts.geom.Polygon)this.updateLocationInfo(this.locate(t,e));else if(e instanceof jsts.geom.MultiLineString)for(var n=e,i=0;i<n.getNumGeometries();i++){var o=n.getGeometryN(i);this.updateLocationInfo(this.locate(t,o))}else if(e instanceof jsts.geom.MultiPolygon)for(var r=e,i=0;i<r.getNumGeometries();i++){var s=r.getGeometryN(i);this.updateLocationInfo(this.locate(t,s))}else if(e instanceof jsts.geom.MultiPoint||e instanceof jsts.geom.GeometryCollection)for(var i=0;i<e.getNumGeometries();i++){var a=e.getGeometryN(i);a!==e&&this.computeLocation(t,a)}},jsts.algorithm.PointLocator.prototype.updateLocationInfo=function(t){t===jsts.geom.Location.INTERIOR&&(this.isIn=!0),t===jsts.geom.Location.BOUNDARY&&this.numBoundaries++},jsts.algorithm.PointLocator.prototype.locate2=function(t,e){var n=e.getCoordinate();return n.equals2D(t)?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR},jsts.algorithm.PointLocator.prototype.locate3=function(t,e){if(!e.getEnvelopeInternal().intersects(t))return jsts.geom.Location.EXTERIOR;var n=e.getCoordinates();return e.isClosed()||!t.equals(n[0])&&!t.equals(n[n.length-1])?jsts.algorithm.CGAlgorithms.isOnLine(t,n)?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR:jsts.geom.Location.BOUNDARY},jsts.algorithm.PointLocator.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?jsts.algorithm.CGAlgorithms.locatePointInRing(t,e.getCoordinates()):jsts.geom.Location.EXTERIOR},jsts.algorithm.PointLocator.prototype.locate4=function(t,e){if(e.isEmpty())return jsts.geom.Location.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===jsts.geom.Location.EXTERIOR)return jsts.geom.Location.EXTERIOR;if(i===jsts.geom.Location.BOUNDARY)return jsts.geom.Location.BOUNDARY;for(var o=0;o<e.getNumInteriorRing();o++){var r=e.getInteriorRingN(o),s=this.locateInPolygonRing(t,r);if(s===jsts.geom.Location.INTERIOR)return jsts.geom.Location.EXTERIOR;if(s===jsts.geom.Location.BOUNDARY)return jsts.geom.Location.BOUNDARY}return jsts.geom.Location.INTERIOR},function(){var t=jsts.geom.Location,e=javascript.util.ArrayList,n=javascript.util.TreeMap;jsts.geomgraph.NodeMap=function(t){this.nodeMap=new n,this.nodeFact=t},jsts.geomgraph.NodeMap.prototype.nodeMap=null,jsts.geomgraph.NodeMap.prototype.nodeFact=null,jsts.geomgraph.NodeMap.prototype.addNode=function(t){var e,n;if(t instanceof jsts.geom.Coordinate)return n=t,e=this.nodeMap.get(n),null===e&&(e=this.nodeFact.createNode(n),this.nodeMap.put(n,e)),e;if(t instanceof jsts.geomgraph.Node){var i=t;return n=i.getCoordinate(),e=this.nodeMap.get(n),null===e?(this.nodeMap.put(n,i),i):(e.mergeLabel(i),e)}},jsts.geomgraph.NodeMap.prototype.add=function(t){var e=t.getCoordinate(),n=this.addNode(e);n.add(t)},jsts.geomgraph.NodeMap.prototype.find=function(t){return this.nodeMap.get(t)},jsts.geomgraph.NodeMap.prototype.values=function(){return this.nodeMap.values()},jsts.geomgraph.NodeMap.prototype.iterator=function(){return this.values().iterator()},jsts.geomgraph.NodeMap.prototype.getBoundaryNodes=function(n){for(var i=new e,o=this.iterator();o.hasNext();){var r=o.next();r.getLabel().getLocation(n)===t.BOUNDARY&&i.add(r)}return i}}(),function(){var t=javascript.util.ArrayList;jsts.geomgraph.PlanarGraph=function(e){this.edges=new t,this.edgeEndList=new t,this.nodes=new jsts.geomgraph.NodeMap(e||new jsts.geomgraph.NodeFactory)},jsts.geomgraph.PlanarGraph.prototype.edges=null,jsts.geomgraph.PlanarGraph.prototype.nodes=null,jsts.geomgraph.PlanarGraph.prototype.edgeEndList=null,jsts.geomgraph.PlanarGraph.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.getEdges().linkResultDirectedEdges()}},jsts.geomgraph.PlanarGraph.prototype.getEdgeIterator=function(){return this.edges.iterator()},jsts.geomgraph.PlanarGraph.prototype.getEdgeEnds=function(){return this.edgeEndList},jsts.geomgraph.PlanarGraph.prototype.isBoundaryNode=function(t,e){var n=this.nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===jsts.geom.Location.BOUNDARY},jsts.geomgraph.PlanarGraph.prototype.insertEdge=function(t){this.edges.add(t)},jsts.geomgraph.PlanarGraph.prototype.add=function(t){this.nodes.add(t),this.edgeEndList.add(t)},jsts.geomgraph.PlanarGraph.prototype.getNodeIterator=function(){return this.nodes.iterator()},jsts.geomgraph.PlanarGraph.prototype.getNodes=function(){return this.nodes.values()},jsts.geomgraph.PlanarGraph.prototype.addNode=function(t){return this.nodes.addNode(t)},jsts.geomgraph.PlanarGraph.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.edges.add(n);var i=new jsts.geomgraph.DirectedEdge(n,(!0)),o=new jsts.geomgraph.DirectedEdge(n,(!1));i.setSym(o),o.setSym(i),this.add(i),this.add(o)}},jsts.geomgraph.PlanarGraph.prototype.linkResultDirectedEdges=function(){for(var t=this.nodes.iterator();t.hasNext();){var e=t.next();e.getEdges().linkResultDirectedEdges()}},jsts.geomgraph.PlanarGraph.prototype.findEdgeInSameDirection=function(t,e){var n,i,o=0,r=this.edges.size();for(o;o<r;o++){if(n=this.edges.get(o),i=n.getCoordinates(),this.matchInSameDirection(t,e,i[0],i[1]))return n;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return n}return null},jsts.geomgraph.PlanarGraph.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&(jsts.algorithm.CGAlgorithms.computeOrientation(t,e,i)===jsts.algorithm.CGAlgorithms.COLLINEAR&&jsts.geomgraph.Quadrant.quadrant(t,e)===jsts.geomgraph.Quadrant.quadrant(n,i))},jsts.geomgraph.PlanarGraph.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null}}(),jsts.noding.SegmentIntersector=function(){},jsts.noding.SegmentIntersector.prototype.processIntersections=jsts.abstractFunc,jsts.noding.SegmentIntersector.prototype.isDone=jsts.abstractFunc,function(){var t=jsts.noding.SegmentIntersector,e=javascript.util.ArrayList;jsts.noding.InteriorIntersectionFinder=function(t){this.li=t,this.intersections=new e,this.interiorIntersection=null},jsts.noding.InteriorIntersectionFinder.prototype=new t,jsts.noding.InteriorIntersectionFinder.constructor=jsts.noding.InteriorIntersectionFinder,jsts.noding.InteriorIntersectionFinder.prototype.findAllIntersections=!1,jsts.noding.InteriorIntersectionFinder.prototype.isCheckEndSegmentsOnly=!1,jsts.noding.InteriorIntersectionFinder.prototype.li=null,jsts.noding.InteriorIntersectionFinder.prototype.interiorIntersection=null,jsts.noding.InteriorIntersectionFinder.prototype.intSegments=null,jsts.noding.InteriorIntersectionFinder.prototype.intersections=null,jsts.noding.InteriorIntersectionFinder.prototype.setFindAllIntersections=function(t){this.findAllIntersections=t},jsts.noding.InteriorIntersectionFinder.prototype.getIntersections=function(){return intersections},jsts.noding.InteriorIntersectionFinder.prototype.setCheckEndSegmentsOnly=function(t){this.isCheckEndSegmentsOnly=t},jsts.noding.InteriorIntersectionFinder.prototype.hasIntersection=function(){return null!=this.interiorIntersection},jsts.noding.InteriorIntersectionFinder.prototype.getInteriorIntersection=function(){return this.interiorIntersection},jsts.noding.InteriorIntersectionFinder.prototype.getIntersectionSegments=function(){return this.intSegments},jsts.noding.InteriorIntersectionFinder.prototype.processIntersections=function(t,e,n,i){if(!this.hasIntersection()&&(t!=n||e!=i)){if(this.isCheckEndSegmentsOnly){var o=this.isEndSegment(t,e)||isEndSegment(n,i);if(!o)return}var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],a=n.getCoordinates()[i],l=n.getCoordinates()[i+1];this.li.computeIntersection(r,s,a,l),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=[],this.intSegments[0]=r,this.intSegments[1]=s,this.intSegments[2]=a,this.intSegments[3]=l,this.interiorIntersection=this.li.getIntersection(0),this.intersections.add(this.interiorIntersection))}},jsts.noding.InteriorIntersectionFinder.prototype.isEndSegment=function(t,e){return 0==e||e>=t.size()-2},jsts.noding.InteriorIntersectionFinder.prototype.isDone=function(){return!this.findAllIntersections&&null!=this.interiorIntersection}}(),function(){var t=jsts.algorithm.RobustLineIntersector,e=jsts.noding.InteriorIntersectionFinder,n=jsts.noding.MCIndexNoder;jsts.noding.FastNodingValidator=function(e){this.li=new t,this.segStrings=e},jsts.noding.FastNodingValidator.prototype.li=null,jsts.noding.FastNodingValidator.prototype.segStrings=null,jsts.noding.FastNodingValidator.prototype.findAllIntersections=!1,jsts.noding.FastNodingValidator.prototype.segInt=null,jsts.noding.FastNodingValidator.prototype._isValid=!0,jsts.noding.FastNodingValidator.prototype.setFindAllIntersections=function(t){this.findAllIntersections=t},jsts.noding.FastNodingValidator.prototype.getIntersections=function(){return segInt.getIntersections()},jsts.noding.FastNodingValidator.prototype.isValid=function(){return this.execute(),this._isValid},jsts.noding.FastNodingValidator.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+jsts.io.WKTWriter.toLineString(t[0],t[1])+" and "+jsts.io.WKTWriter.toLineString(t[2],t[3])},jsts.noding.FastNodingValidator.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new jsts.error.TopologyError(this.getErrorMessage(),this.segInt.getInteriorIntersection())},jsts.noding.FastNodingValidator.prototype.execute=function(){null==this.segInt&&this.checkInteriorIntersections()},jsts.noding.FastNodingValidator.prototype.checkInteriorIntersections=function(){this._isValid=!0,this.segInt=new e(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new n;if(t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection())return void(this._isValid=!1)}}(),function(){jsts.noding.BasicSegmentString=function(t,e){this.pts=t,this.data=e},jsts.noding.BasicSegmentString.prototype=new jsts.noding.SegmentString,jsts.noding.BasicSegmentString.prototype.pts=null,jsts.noding.BasicSegmentString.prototype.data=null,jsts.noding.BasicSegmentString.prototype.getData=function(){return this.data},jsts.noding.BasicSegmentString.prototype.setData=function(t){this.data=t},jsts.noding.BasicSegmentString.prototype.size=function(){return this.pts.length},jsts.noding.BasicSegmentString.prototype.getCoordinate=function(t){return this.pts[t]},jsts.noding.BasicSegmentString.prototype.getCoordinates=function(){return this.pts},jsts.noding.BasicSegmentString.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.noding.BasicSegmentString.prototype.getSegmentOctant=function(t){return t==this.pts.length-1?-1:jsts.noding.Octant.octant(this.getCoordinate(t),this.getCoordinate(t+1))}}(),function(){var t=jsts.noding.FastNodingValidator,e=jsts.noding.BasicSegmentString,n=javascript.util.ArrayList;jsts.geomgraph.EdgeNodingValidator=function(e){this.nv=new t(jsts.geomgraph.EdgeNodingValidator.toSegmentStrings(e))},jsts.geomgraph.EdgeNodingValidator.checkValid=function(t){var e=new jsts.geomgraph.EdgeNodingValidator(t);e.checkValid()},jsts.geomgraph.EdgeNodingValidator.toSegmentStrings=function(t){for(var i=new n,o=t.iterator();o.hasNext();){var r=o.next();i.add(new e(r.getCoordinates(),r))}return i},jsts.geomgraph.EdgeNodingValidator.prototype.nv=null,jsts.geomgraph.EdgeNodingValidator.prototype.checkValid=function(){this.nv.checkValid()}}(),jsts.operation.GeometryGraphOperation=function(t,e,n){if(this.li=new jsts.algorithm.RobustLineIntersector,this.arg=[],void 0!==t){if(void 0===e)return this.setComputationPrecision(t.getPrecisionModel()),void(this.arg[0]=new jsts.geomgraph.GeometryGraph(0,t));n=n||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE,t.getPrecisionModel().compareTo(e.getPrecisionModel())>=0?this.setComputationPrecision(t.getPrecisionModel()):this.setComputationPrecision(e.getPrecisionModel()),this.arg[0]=new jsts.geomgraph.GeometryGraph(0,t,n),this.arg[1]=new jsts.geomgraph.GeometryGraph(1,e,n)}},jsts.operation.GeometryGraphOperation.prototype.li=null,jsts.operation.GeometryGraphOperation.prototype.resultPrecisionModel=null,jsts.operation.GeometryGraphOperation.prototype.arg=null,jsts.operation.GeometryGraphOperation.prototype.getArgGeometry=function(t){return arg[t].getGeometry()},jsts.operation.GeometryGraphOperation.prototype.setComputationPrecision=function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},jsts.operation.overlay.OverlayNodeFactory=function(){},jsts.operation.overlay.OverlayNodeFactory.prototype=new jsts.geomgraph.NodeFactory,jsts.operation.overlay.OverlayNodeFactory.constructor=jsts.operation.overlay.OverlayNodeFactory,jsts.operation.overlay.OverlayNodeFactory.prototype.createNode=function(t){return new jsts.geomgraph.Node(t,new jsts.geomgraph.DirectedEdgeStar)},jsts.operation.overlay.PolygonBuilder=function(t){this.shellList=[],this.geometryFactory=t},jsts.operation.overlay.PolygonBuilder.prototype.geometryFactory=null,jsts.operation.overlay.PolygonBuilder.prototype.shellList=null,jsts.operation.overlay.PolygonBuilder.prototype.add=function(t){return 2===arguments.length?void this.add2.apply(this,arguments):void this.add2(t.getEdgeEnds(),t.getNodes())},jsts.operation.overlay.PolygonBuilder.prototype.add2=function(t,e){jsts.geomgraph.PlanarGraph.linkResultDirectedEdges(e);var n=this.buildMaximalEdgeRings(t),i=[],o=this.buildMinimalEdgeRings(n,this.shellList,i);this.sortShellsAndHoles(o,this.shellList,i),this.placeFreeHoles(this.shellList,i)},jsts.operation.overlay.PolygonBuilder.prototype.getPolygons=function(){var t=this.computePolygons(this.shellList);return t},jsts.operation.overlay.PolygonBuilder.prototype.buildMaximalEdgeRings=function(t){for(var e=[],n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null==i.getEdgeRing()){var o=new jsts.operation.overlay.MaximalEdgeRing(i,this.geometryFactory);e.push(o),o.setInResult()}}return e},jsts.operation.overlay.PolygonBuilder.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=[],o=0;o<t.length;o++){var r=t[o];if(r.getMaxNodeDegree()>2){r.linkDirectedEdgesForMinimalEdgeRings();var s=r.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.push(a)):s.forEach(function(t){n.push(t)})}else i.push(r)}return i};jsts.operation.overlay.PolygonBuilder.prototype.findShell=function(t){for(var e=0,n=null,i=0;i<t.length;i++){var o=t[i];o.isHole()||(n=o,e++)}return jsts.util.Assert.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n};jsts.operation.overlay.PolygonBuilder.prototype.placePolygonHoles=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.isHole()&&i.setShell(t)}},jsts.operation.overlay.PolygonBuilder.prototype.sortShellsAndHoles=function(t,e,n){for(var i=0;i<t.length;i++){var o=t[i];o.isHole()?n.push(o):e.push(o)}},jsts.operation.overlay.PolygonBuilder.prototype.placeFreeHoles=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(null==i.getShell()){var o=this.findEdgeRingContaining(i,t);if(null===o)throw new jsts.error.TopologyError("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(o)}}},jsts.operation.overlay.PolygonBuilder.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),o=n.getCoordinateN(0),r=null,s=null,a=0;a<e.length;a++){var l=e[a],d=l.getLinearRing(),c=d.getEnvelopeInternal();null!==r&&(s=r.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(i)&&jsts.algorithm.CGAlgorithms.isPointInRing(o,d.getCoordinates())&&(h=!0),h&&(null==r||s.contains(c))&&(r=l)}return r},jsts.operation.overlay.PolygonBuilder.prototype.computePolygons=function(t){for(var e=new javascript.util.ArrayList,n=0;n<t.length;n++){var i=t[n],o=i.toPolygon(this.geometryFactory);e.add(o)}return e},jsts.operation.overlay.PolygonBuilder.prototype.containsPoint=function(t){for(var e=0;e<this.shellList.length;e++){var n=this.shellList[e];if(n.containsPoint(t))return!0}return!1},function(){var t=jsts.util.Assert,e=javascript.util.ArrayList,n=function(t,n,i){this.lineEdgesList=new e,this.resultLineList=new e,this.op=t,this.geometryFactory=n,this.ptLocator=i};n.prototype.op=null,n.prototype.geometryFactory=null,n.prototype.ptLocator=null,n.prototype.lineEdgesList=null,n.prototype.resultLineList=null,n.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},n.prototype.findCoveredLineEdges=function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();){var e=t.next();e.getEdges().findCoveredLineEdges()}for(var n=this.op.getGraph().getEdgeEnds().iterator();n.hasNext();){var i=n.next(),o=i.getEdge();if(i.isLineEdge()&&!o.isCoveredSet()){var r=this.op.isCoveredByA(i.getCoordinate());o.setCovered(r)}}},n.prototype.collectLines=function(t){for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this.lineEdgesList),this.collectBoundaryTouchEdge(n,t,this.lineEdgesList)}},n.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),o=t.getEdge();t.isLineEdge()&&(t.isVisited()||!jsts.operation.overlay.OverlayOp.isResultOfOp(i,e)||o.isCovered()||(n.add(o),t.setVisitedEdge(!0)))},n.prototype.collectBoundaryTouchEdge=function(e,n,i){var o=e.getLabel();e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult()||(t.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),
jsts.operation.overlay.OverlayOp.isResultOfOp(o,n)&&n===jsts.operation.overlay.OverlayOp.INTERSECTION&&(i.add(e.getEdge()),e.setVisitedEdge(!0)))},n.prototype.buildLines=function(t){for(var e=this.lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=(n.getLabel(),this.geometryFactory.createLineString(n.getCoordinates()));this.resultLineList.add(i),n.setInResult(!0)}},n.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},n.prototype.labelIsolatedLine=function(t,e){var n=ptLocator.locate(t.getCoordinate(),op.getArgGeometry(e));t.getLabel().setLocation(e,n)},jsts.operation.overlay.LineBuilder=n}(),function(){var t=javascript.util.ArrayList,e=function(e,n,i){this.resultPointList=new t,this.op=e,this.geometryFactory=n};e.prototype.op=null,e.prototype.geometryFactory=null,e.prototype.resultPointList=null,e.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},e.prototype.extractNonCoveredResultNodes=function(t){for(var e=this.op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==jsts.operation.overlay.OverlayOp.INTERSECTION)){var i=n.getLabel();jsts.operation.overlay.OverlayOp.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},e.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this.op.isCoveredByLA(e)){var n=this.geometryFactory.createPoint(e);this.resultPointList.add(n)}},jsts.operation.overlay.PointBuilder=e}(),function(){var t=jsts.algorithm.PointLocator,e=jsts.geom.Location,n=jsts.geomgraph.EdgeList,i=jsts.geomgraph.Label,o=jsts.geomgraph.PlanarGraph,r=jsts.geomgraph.Position,s=jsts.geomgraph.EdgeNodingValidator,a=jsts.operation.GeometryGraphOperation,l=jsts.operation.overlay.OverlayNodeFactory,d=jsts.operation.overlay.PolygonBuilder,c=jsts.operation.overlay.LineBuilder,h=jsts.operation.overlay.PointBuilder,u=jsts.util.Assert,p=javascript.util.ArrayList;jsts.operation.overlay.OverlayOp=function(e,i){this.ptLocator=new t,this.edgeList=new n,this.resultPolyList=new p,this.resultLineList=new p,this.resultPointList=new p,a.call(this,e,i),this.graph=new o(new l),this.geomFact=e.getFactory()},jsts.operation.overlay.OverlayOp.prototype=new a,jsts.operation.overlay.OverlayOp.constructor=jsts.operation.overlay.OverlayOp,jsts.operation.overlay.OverlayOp.INTERSECTION=1,jsts.operation.overlay.OverlayOp.UNION=2,jsts.operation.overlay.OverlayOp.DIFFERENCE=3,jsts.operation.overlay.OverlayOp.SYMDIFFERENCE=4,jsts.operation.overlay.OverlayOp.overlayOp=function(t,e,n){var i=new jsts.operation.overlay.OverlayOp(t,e),o=i.getResultGeometry(n);return o},jsts.operation.overlay.OverlayOp.isResultOfOp=function(t,e){if(3===arguments.length)return jsts.operation.overlay.OverlayOp.isResultOfOp2.apply(this,arguments);var n=t.getLocation(0),i=t.getLocation(1);return jsts.operation.overlay.OverlayOp.isResultOfOp2(n,i,e)},jsts.operation.overlay.OverlayOp.isResultOfOp2=function(t,n,i){switch(t==e.BOUNDARY&&(t=e.INTERIOR),n==e.BOUNDARY&&(n=e.INTERIOR),i){case jsts.operation.overlay.OverlayOp.INTERSECTION:return t==e.INTERIOR&&n==e.INTERIOR;case jsts.operation.overlay.OverlayOp.UNION:return t==e.INTERIOR||n==e.INTERIOR;case jsts.operation.overlay.OverlayOp.DIFFERENCE:return t==e.INTERIOR&&n!=e.INTERIOR;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:return t==e.INTERIOR&&n!=e.INTERIOR||t!=e.INTERIOR&&n==e.INTERIOR}return!1},jsts.operation.overlay.OverlayOp.prototype.ptLocator=null,jsts.operation.overlay.OverlayOp.prototype.geomFact=null,jsts.operation.overlay.OverlayOp.prototype.resultGeom=null,jsts.operation.overlay.OverlayOp.prototype.graph=null,jsts.operation.overlay.OverlayOp.prototype.edgeList=null,jsts.operation.overlay.OverlayOp.prototype.resultPolyList=null,jsts.operation.overlay.OverlayOp.prototype.resultLineList=null,jsts.operation.overlay.OverlayOp.prototype.resultPointList=null,jsts.operation.overlay.OverlayOp.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this.resultGeom},jsts.operation.overlay.OverlayOp.prototype.getGraph=function(){return this.graph},jsts.operation.overlay.OverlayOp.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var e=new p;this.arg[0].computeSplitEdges(e),this.arg[1].computeSplitEdges(e);this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),s.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new d(this.geomFact);n.add(this.graph),this.resultPolyList=n.getPolygons();var i=new c(this,this.geomFact,this.ptLocator);this.resultLineList=i.build(t);var o=new h(this,this.geomFact,this.ptLocator);this.resultPointList=o.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},jsts.operation.overlay.OverlayOp.prototype.insertUniqueEdge=function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),o=t.getLabel();e.isPointwiseEqual(t)||(o=new i(t.getLabel()),o.flip());var r=e.getDepth();r.isNull()&&r.add(n),r.add(o),n.merge(o)}else this.edgeList.add(t)},jsts.operation.overlay.OverlayOp.prototype.computeLabelsFromDepths=function(){for(var t=this.edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var o=0;o<2;o++)n.isNull(o)||!n.isArea()||i.isNull(o)||(0==i.getDelta(o)?n.toLine(o):(u.isTrue(!i.isNull(o,r.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(o,r.LEFT,i.getLocation(o,r.LEFT)),u.isTrue(!i.isNull(o,r.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(o,r.RIGHT,i.getLocation(o,r.RIGHT))))}}},jsts.operation.overlay.OverlayOp.prototype.replaceCollapsedEdges=function(){for(var t=new p,e=this.edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this.edgeList.addAll(t)},jsts.operation.overlay.OverlayOp.prototype.copyPoints=function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next(),i=this.graph.addNode(n.getCoordinate());i.setLabel(t,n.getLabel().getLocation(t))}},jsts.operation.overlay.OverlayOp.prototype.computeLabelling=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.getEdges().computeLabelling(this.arg)}this.mergeSymLabels(),this.updateNodeLabelling()},jsts.operation.overlay.OverlayOp.prototype.mergeSymLabels=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.getEdges().mergeSymLabels()}},jsts.operation.overlay.OverlayOp.prototype.updateNodeLabelling=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNodes=function(){for(var t=0,e=this.graph.getNodes().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(t++,i.isNull(0)?this.labelIncompleteNode(n,0):this.labelIncompleteNode(n,1)),n.getEdges().updateLabelling(i)}},jsts.operation.overlay.OverlayOp.prototype.labelIncompleteNode=function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setLocation(e,n)},jsts.operation.overlay.OverlayOp.prototype.findResultAreaEdges=function(t){for(var e=this.graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&jsts.operation.overlay.OverlayOp.isResultOfOp(i.getLocation(0,r.RIGHT),i.getLocation(1,r.RIGHT),t)&&n.setInResult(!0)}},jsts.operation.overlay.OverlayOp.prototype.cancelDuplicateResultEdges=function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},jsts.operation.overlay.OverlayOp.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this.resultLineList)||!!this.isCovered(t,this.resultPolyList)},jsts.operation.overlay.OverlayOp.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this.resultPolyList)},jsts.operation.overlay.OverlayOp.prototype.isCovered=function(t,n){for(var i=n.iterator();i.hasNext();){var o=i.next(),r=this.ptLocator.locate(t,o);if(r!=e.EXTERIOR)return!0}return!1},jsts.operation.overlay.OverlayOp.prototype.computeGeometry=function(t,e,n,i){var o=new p;return o.addAll(t),o.addAll(e),o.addAll(n),this.geomFact.buildGeometry(o)},jsts.operation.overlay.OverlayOp.prototype.createEmptyResult=function(t){var e=null;switch(resultDimension(t,this.arg[0].getGeometry(),this.arg[1].getGeometry())){case-1:e=geomFact.createGeometryCollection();break;case 0:e=geomFact.createPoint(null);break;case 1:e=geomFact.createLineString(null);break;case 2:e=geomFact.createPolygon(null,null)}return e},jsts.operation.overlay.OverlayOp.prototype.resultDimension=function(t,e,n){var i=e.getDimension(),o=n.getDimension(),r=-1;switch(t){case jsts.operation.overlay.OverlayOp.INTERSECTION:r=Math.min(i,o);break;case jsts.operation.overlay.OverlayOp.UNION:r=Math.max(i,o);break;case jsts.operation.overlay.OverlayOp.DIFFERENCE:r=i;break;case jsts.operation.overlay.OverlayOp.SYMDIFFERENCE:r=Math.max(i,o)}return r}}(),jsts.index.IntervalSize=function(){},jsts.index.IntervalSize.MIN_BINARY_EXPONENT=-50,jsts.index.IntervalSize.isZeroWidth=function(t,e){var n=e-t;if(0===n)return!0;var i,o,r;return i=Math.max(Math.abs(t),Math.abs(e)),o=n/i,r=jsts.index.DoubleBits.exponent(o),r<=jsts.index.IntervalSize.MIN_BINARY_EXPONENT},jsts.geomgraph.index.SimpleEdgeSetIntersector=function(){},jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector,jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.nOverlaps=0,jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections=function(t,e,n){if(e instanceof javascript.util.List)return void this.computeIntersections2.apply(this,arguments);this.nOverlaps=0;for(var i=t.iterator();i.hasNext();)for(var o=i.next(),r=t.iterator();r.hasNext();){var s=r.next();(n||o!=s)&&this.computeIntersects(o,s,e)}},jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersections2=function(t,e,n){this.nOverlaps=0;for(var i=t.iterator();i.hasNext();)for(var o=i.next(),r=e.iterator();r.hasNext();){var s=r.next();this.computeIntersects(o,s,n)}},jsts.geomgraph.index.SimpleEdgeSetIntersector.prototype.computeIntersects=function(t,e,n){var i,o,r=t.getCoordinates(),s=e.getCoordinates();for(i=0;i<r.length-1;i++)for(o=0;o<s.length-1;o++)n.addIntersections(t,i,e,o)},jsts.geomgraph.Edge=function(t,e){this.pts=t,this.label=e,this.eiList=new jsts.geomgraph.EdgeIntersectionList(this),this.depth=new jsts.geomgraph.Depth},jsts.geomgraph.Edge.prototype=new jsts.geomgraph.GraphComponent,jsts.geomgraph.Edge.constructor=jsts.geomgraph.Edge,jsts.geomgraph.Edge.updateIM=function(t,e){e.setAtLeastIfValid(t.getLocation(0,jsts.geomgraph.Position.ON),t.getLocation(1,jsts.geomgraph.Position.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,jsts.geomgraph.Position.LEFT),t.getLocation(1,jsts.geomgraph.Position.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,jsts.geomgraph.Position.RIGHT),t.getLocation(1,jsts.geomgraph.Position.RIGHT),2))},jsts.geomgraph.Edge.prototype.pts=null,jsts.geomgraph.Edge.prototype.env=null,jsts.geomgraph.Edge.prototype.name=null,jsts.geomgraph.Edge.prototype.mce=null,jsts.geomgraph.Edge.prototype._isIsolated=!0,jsts.geomgraph.Edge.prototype.depth=null,jsts.geomgraph.Edge.prototype.depthDelta=0,jsts.geomgraph.Edge.prototype.eiList=null,jsts.geomgraph.Edge.prototype.getNumPoints=function(){return this.pts.length},jsts.geomgraph.Edge.prototype.getEnvelope=function(){if(null===this.env){this.env=new jsts.geom.Envelope;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(pts[t])}return env},jsts.geomgraph.Edge.prototype.getDepth=function(){return this.depth},jsts.geomgraph.Edge.prototype.getDepthDelta=function(){return this.depthDelta},jsts.geomgraph.Edge.prototype.setDepthDelta=function(t){this.depthDelta=t},jsts.geomgraph.Edge.prototype.getCoordinates=function(){return this.pts},jsts.geomgraph.Edge.prototype.getCoordinate=function(t){return void 0===t?this.pts.length>0?this.pts[0]:null:this.pts[t]},jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.geomgraph.Edge.prototype.setIsolated=function(t){this._isIsolated=t},jsts.geomgraph.Edge.prototype.isIsolated=function(){return this._isIsolated},jsts.geomgraph.Edge.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},jsts.geomgraph.Edge.prototype.addIntersection=function(t,e,n,i){var o=new jsts.geom.Coordinate(t.getIntersection(i)),r=e,s=t.getEdgeDistance(n,i),a=r+1;if(a<this.pts.length){var l=this.pts[a];o.equals2D(l)&&(r=a,s=0)}this.eiList.add(o,r,s)},jsts.geomgraph.Edge.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},jsts.geomgraph.Edge.prototype.getEdgeIntersectionList=function(){return this.eiList},jsts.geomgraph.Edge.prototype.getMonotoneChainEdge=function(){return null==this.mce&&(this.mce=new jsts.geomgraph.index.MonotoneChainEdge(this)),this.mce},jsts.geomgraph.Edge.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},jsts.geomgraph.Edge.prototype.isCollapsed=function(){return!!this.label.isArea()&&(3==this.pts.length&&!!this.pts[0].equals(this.pts[2]))},jsts.geomgraph.Edge.prototype.getCollapsedEdge=function(){var t=[];t[0]=this.pts[0],t[1]=this.pts[1];var e=new jsts.geomgraph.Edge(t,jsts.geomgraph.Label.toLineLabel(this.label));return e},jsts.geomgraph.Edge.prototype.computeIM=function(t){jsts.geomgraph.Edge.updateIM(this.label,t)},jsts.geomgraph.Edge.prototype.isPointwiseEqual=function(t){if(this.pts.length!=t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},function(){var t=javascript.util.ArrayList,e=function(){};e.prototype.inputGeom=null,e.prototype.factory=null,e.prototype.pruneEmptyGeometry=!0,e.prototype.preserveGeometryCollectionType=!0,e.prototype.preserveCollections=!1,e.prototype.reserveType=!1,e.prototype.getInputGeometry=function(){return this.inputGeom},e.prototype.transform=function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof jsts.geom.Point)return this.transformPoint(t,null);if(t instanceof jsts.geom.MultiPoint)return this.transformMultiPoint(t,null);if(t instanceof jsts.geom.LinearRing)return this.transformLinearRing(t,null);if(t instanceof jsts.geom.LineString)return this.transformLineString(t,null);if(t instanceof jsts.geom.MultiLineString)return this.transformMultiLineString(t,null);if(t instanceof jsts.geom.Polygon)return this.transformPolygon(t,null);if(t instanceof jsts.geom.MultiPolygon)return this.transformMultiPolygon(t,null);if(t instanceof jsts.geom.GeometryCollection)return this.transformGeometryCollection(t,null);throw new jsts.error.IllegalArgumentException("Unknown Geometry subtype: "+t.getClass().getName())},e.prototype.createCoordinateSequence=function(t){return this.factory.getCoordinateSequenceFactory().create(t)},e.prototype.copy=function(t){if(t instanceof javascript.util.ArrayList)return t.clone();if(t instanceof Array){for(var e=new Array,n=0;n<t.length;n++)e.push(t[n]);return e}},e.prototype.transformCoordinates=function(t,e){return this.copy(t)},e.prototype.transformPoint=function(t,e){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},e.prototype.transformMultiPoint=function(e,n){for(var i=new t,o=0;o<e.getNumGeometries();o++){var r=this.transformPoint(e.getGeometryN(o),e);null!=r&&(r.isEmpty()||i.add(r))}return this.factory.buildGeometry(i)},e.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t),i=n.length;return i>0&&i<4&&!this.preserveType?this.factory.createLineString(n):this.factory.createLinearRing(n)},e.prototype.transformLineString=function(t,e){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},e.prototype.transformMultiLineString=function(e,n){for(var i=new t,o=0;o<e.getNumGeometries();o++){var r=this.transformLineString(e.getGeometryN(o),e);null!=r&&(r.isEmpty()||i.add(r))}return this.factory.buildGeometry(i)},e.prototype.transformPolygon=function(e,n){var i=!0,o=this.transformLinearRing(e.getExteriorRing(),e);null!=o&&o instanceof jsts.geom.LinearRing&&!o.isEmpty()||(i=!1);for(var r=new t,s=0;s<e.getNumInteriorRing();s++){var a=this.transformLinearRing(e.getInteriorRingN(s),e);null==a||a.isEmpty()||(a instanceof jsts.geom.LinearRing||(i=!1),r.add(a))}if(i)return this.factory.createPolygon(o,r.toArray());var l=new t;return null!=o&&l.add(o),l.addAll(r),this.factory.buildGeometry(l)},e.prototype.transformMultiPolygon=function(e,n){for(var i=new t,o=0;o<e.getNumGeometries();o++){var r=this.transformPolygon(e.getGeometryN(o),e);null!=r&&(r.isEmpty()||i.add(r))}return this.factory.buildGeometry(i)},e.prototype.transformGeometryCollection=function(e,n){for(var i=new t,o=0;o<e.getNumGeometries();o++){var r=this.transform(e.getGeometryN(o));null!=r&&(this.pruneEmptyGeometry&&r.isEmpty()||i.add(r))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection(GeometryFactory.toGeometryArray(i)):this.factory.buildGeometry(i)},jsts.geom.util.GeometryTransformer=e}(),function(){var t=jsts.operation.overlay.snap.LineStringSnapper,e=jsts.geom.PrecisionModel,n=javascript.util.TreeSet,i=function(t,e,n){this.snapTolerance=t,this.snapPts=e,this.isSelfSnap=n||!1};i.prototype=new jsts.geom.util.GeometryTransformer,i.prototype.snapTolerance=null,i.prototype.snapPts=null,i.prototype.isSelfSnap=!1,i.prototype.transformCoordinates=function(t,e){var n=t,i=this.snapLine(n,this.snapPts);return i},i.prototype.snapLine=function(e,n){var i=new t(e,this.snapTolerance);return i.setAllowSnappingToSourceVertices(this.isSelfSnap),i.snapTo(n)};var o=function(t){this.srcGeom=t};o.SNAP_PRECISION_FACTOR=1e-9,o.computeOverlaySnapTolerance=function(t){if(2===arguments.length)return o.computeOverlaySnapTolerance2.apply(this,arguments);var n=this.computeSizeBasedSnapTolerance(t),i=t.getPrecisionModel();if(i.getType()==e.FIXED){var r=1/i.getScale()*2/1.415;r>n&&(n=r)}return n},o.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal(),n=Math.min(e.getHeight(),e.getWidth()),i=n*o.SNAP_PRECISION_FACTOR;return i},o.computeOverlaySnapTolerance2=function(t,e){return Math.min(this.computeOverlaySnapTolerance(t),this.computeOverlaySnapTolerance(e))},o.snap=function(t,e,n){var i=[],r=new o(t);i[0]=r.snapTo(e,n);var s=new o(e);return i[1]=s.snapTo(i[0],n),i},o.snapToSelf=function(t,e,n){var i=new o(t);return i.snapToSelf(e,n)},o.prototype.srcGeom=null,o.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t),o=new i(e,n);return o.transform(this.srcGeom)},o.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(srcGeom),o=new i(t,n,(!0)),r=o.transform(srcGeom),s=r;return e&&s instanceof Polygonal&&(s=r.buffer(0)),s},o.prototype.extractTargetCoordinates=function(t){for(var e=new n,i=t.getCoordinates(),o=0;o<i.length;o++)e.add(i[o]);return e.toArray()},o.prototype.computeSnapTolerance=function(t){var e=this.computeMinimumSegmentLength(t),n=e/10;return n},o.prototype.computeMinimumSegmentLength=function(t){for(var e=Number.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},jsts.operation.overlay.snap.GeometrySnapper=o}(),function(){var t=jsts.operation.overlay.OverlayOp,e=jsts.operation.overlay.snap.GeometrySnapper,n=function(t,e){this.geom=[],this.geom[0]=t,this.geom[1]=e,this.computeSnapTolerance()};n.overlayOp=function(t,e,i){var o=new n(t,e);return o.getResultGeometry(i)},n.intersection=function(e,n){return this.overlayOp(e,n,t.INTERSECTION)},n.union=function(e,n){return this.overlayOp(e,n,t.UNION)},n.difference=function(e,n){return overlayOp(e,n,t.DIFFERENCE)},n.symDifference=function(e,n){return overlayOp(e,n,t.SYMDIFFERENCE)},n.prototype.geom=null,n.prototype.snapTolerance=null,n.prototype.computeSnapTolerance=function(){this.snapTolerance=e.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},n.prototype.getResultGeometry=function(e){var n=this.snap(this.geom),i=t.overlayOp(n[0],n[1],e);return this.prepareResult(i)},n.prototype.selfSnap=function(t){var n=new e(t),i=n.snapTo(t,this.snapTolerance);return i},n.prototype.snap=function(t){var n=t,i=e.snap(n[0],n[1],this.snapTolerance);return i},n.prototype.prepareResult=function(t){return t},n.prototype.cbr=null,n.prototype.removeCommonBits=function(t){this.cbr=new jsts.precision.CommonBitsRemover,this.cbr.add(this.geom[0]),this.cbr.add(this.geom[1]);var e=[];return e[0]=cbr.removeCommonBits(this.geom[0].clone()),e[1]=cbr.removeCommonBits(this.geom[1].clone()),e},jsts.operation.overlay.snap.SnapOverlayOp=n}(),jsts.noding.Octant=function(){throw jsts.error.AbstractMethodInvocationError()},jsts.noding.Octant.octant=function(t,e){if(t instanceof jsts.geom.Coordinate)return jsts.noding.Octant.octant2.apply(this,arguments);if(0===t&&0===e)throw new jsts.error.IllegalArgumentError("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5},jsts.noding.Octant.octant2=function(t,e){var n=e.x-t.x,i=e.y-t.y;if(0===n&&0===i)throw new jsts.error.IllegalArgumentError("Cannot compute the octant for two identical points "+t);return jsts.noding.Octant.octant(n,i)},jsts.operation.union.UnionInteracting=function(t,e){this.g0=t,this.g1=e,this.geomFactory=t.getFactory(),this.interacts0=[],this.interacts1=[]},jsts.operation.union.UnionInteracting.union=function(t,e){var n=new jsts.operation.union.UnionInteracting(t,e);return n.union()},jsts.operation.union.UnionInteracting.prototype.geomFactory=null,jsts.operation.union.UnionInteracting.prototype.g0=null,jsts.operation.union.UnionInteracting.prototype.g1=null,jsts.operation.union.UnionInteracting.prototype.interacts0=null,jsts.operation.union.UnionInteracting.prototype.interacts1=null,jsts.operation.union.UnionInteracting.prototype.union=function(){this.computeInteracting();var t=this.extractElements(this.g0,this.interacts0,!0),e=this.extractElements(this.g1,this.interacts1,!0);t.isEmpty()||e.isEmpty();var n=in0.union(e),i=this.extractElements(this.g0,this.interacts0,!1),o=this.extractElements(this.g1,this.interacts1,!1),r=jsts.geom.util.GeometryCombiner.combine(n,i,o);return r},jsts.operation.union.UnionInteracting.prototype.bufferUnion=function(t,e){var n=t.getFactory(),i=n.createGeometryCollection([t,e]),o=i.buffer(0);return o},jsts.operation.union.UnionInteracting.prototype.computeInteracting=function(t){if(t){for(var e=!1,n=0,i=g1.getNumGeometries();n<i;n++){var o=this.g1.getGeometryN(n),r=o.getEnvelopeInternal().intersects(t.getEnvelopeInternal());r&&(this.interacts1[n]=!0,e=!0)}return e}for(var n=0,i=this.g0.getNumGeometries();n<i;n++){var s=this.g0.getGeometryN(n);this.interacts0[n]=this.computeInteracting(s)}},jsts.operation.union.UnionInteracting.prototype.extractElements=function(t,e,n){for(var i=[],o=0,r=t.getNumGeometries();o<r;o++){var s=t.getGeometryN(o);e[o]===n&&i.push(s)}return this.geomFactory.buildGeometry(i)},jsts.triangulate.quadedge.TrianglePredicate=function(){},jsts.triangulate.quadedge.TrianglePredicate.isInCircleNonRobust=function(t,e,n,i){var o=(t.x*t.x+t.y*t.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(e,n,i)-(e.x*e.x+e.y*e.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(t,n,i)+(n.x*n.x+n.y*n.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(t,e,i)-(i.x*i.x+i.y*i.y)*jsts.triangulate.quadedge.TrianglePredicate.triArea(t,e,n)>0;return o},jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized=function(t,e,n,i){var o,r,s,a,l,d,c,h,u,p,g,m,f;return o=t.x-i.x,r=t.y-i.y,s=e.x-i.x,a=e.y-i.y,l=n.x-i.x,d=n.y-i.y,c=o*a-s*r,h=s*d-l*a,u=l*r-o*d,p=o*o+r*r,g=s*s+a*a,m=l*l+d*d,f=p*h+g*u+m*c,f>0},jsts.triangulate.quadedge.TrianglePredicate.triArea=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust=function(t,e,n,i){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleNormalized(t,e,n,i)},jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDSlow=function(t,e,n,i){var o,r,s,a,l,d,c,h,u,p,g,m,f,y;return o=jsts.math.DD.valueOf(i.x),r=jsts.math.DD.valueOf(i.y),s=jsts.math.DD.valueOf(t.x),a=jsts.math.DD.valueOf(t.y),l=jsts.math.DD.valueOf(e.x),d=jsts.math.DD.valueOf(e.y),c=jsts.math.DD.valueOf(n.x),h=jsts.math.DD.valueOf(n.y),u=s.multiply(s).add(a.multiply(a)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(l,d,c,h,o,r)),p=l.multiply(l).add(d.multiply(d)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(s,a,c,h,o,r)),g=c.multiply(c).add(h.multiply(h)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(s,a,l,d,o,r)),m=o.multiply(o).add(r.multiply(r)).multiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow(s,a,l,d,c,h)),f=u.subtract(p).add(g).subtract(m),y=f.doubleValue()>0},jsts.triangulate.quadedge.TrianglePredicate.triAreaDDSlow=function(t,e,n,i,o,r){return n.subtract(t).multiply(r.subtract(e)).subtract(i.subtract(e).multiply(o.subtract(t)))},jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDFast=function(t,e,n,i){var o,r,s,a,l,d;return o=jsts.math.DD.sqr(t.x).selfAdd(jsts.math.DD.sqr(t.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(e,n,i)),r=jsts.math.DD.sqr(e.x).selfAdd(jsts.math.DD.sqr(e.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(t,n,i)),s=jsts.math.DD.sqr(n.x).selfAdd(jsts.math.DD.sqr(n.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(t,e,i)),a=jsts.math.DD.sqr(i.x).selfAdd(jsts.math.DD.sqr(i.y)).selfMultiply(jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast(t,e,n)),l=o.selfSubtract(r).selfAdd(s).selfSubtract(a),d=l.doubleValue()>0},jsts.triangulate.quadedge.TrianglePredicate.triAreaDDFast=function(t,e,n){var i,o;return i=jsts.math.DD.valueOf(e.x).selfSubtract(t.x).selfMultiply(jsts.math.DD.valueOf(n.y).selfSubtract(t.y)),o=jsts.math.DD.valueOf(e.y).selSubtract(t.y).selfMultiply(jsts.math.DD.valueOf(n.x).selfSubtract(t.x)),i.selfSubtract(o)},jsts.triangulate.quadedge.TrianglePredicate.isInCircleDDNormalized=function(t,e,n,i){var o,r,s,a,l,d,c,h,u,p,g,m,f,y;return o=jsts.math.DD.valueOf(t.x).selfSubtract(i.x),r=jsts.math.DD.valueOf(t.y).selfSubtract(i.y),s=jsts.math.DD.valueOf(e.x).selfSubtract(i.x),s=jsts.math.DD.valueOf(e.y).selfSubtract(i.y),l=jsts.math.DD.valueOf(n.x).selfSubtract(i.x),l=jsts.math.DD.valueOf(n.y).selfSubtract(i.y),c=o.multiply(a).selfSubtract(s.multiply(r)),h=s.multiply(d).selfSubtract(l.multiply(a)),u=l.multiply(r).selfSubtract(o.multiply(d)),p=o.multiply(o).selfAdd(r.multiply(r)),g=s.multiply(s).selfAdd(a.multiply(a)),m=l.multiply(l).selfAdd(d.multiply(d)),f=p.selfMultiply(h).selfAdd(g.selfMultiply(u)).selfAdd(m.selfMultiply(c)),y=f.doubleValue()>0},jsts.triangulate.quadedge.TrianglePredicate.isInCircleCC=function(t,e,n,i){var o,r,s;return o=jsts.geom.Triangle.circumcentre(t,e,n),r=t.distance(o),s=i.distance(o)-r,s<=0},jsts.operation.union.PointGeometryUnion=function(t,e){this.pointGeom=t,this.otherGeom=e,this.geomFact=e.getFactory()},jsts.operation.union.PointGeometryUnion.union=function(t,e){var n=new jsts.operation.union.PointGeometryUnion(t,e);return n.union()},jsts.operation.union.PointGeometryUnion.prototype.pointGeom=null,jsts.operation.union.PointGeometryUnion.prototype.otherGeom=null,jsts.operation.union.PointGeometryUnion.prototype.geomFact=null,jsts.operation.union.PointGeometryUnion.prototype.union=function(){for(var t=new jsts.algorithm.PointLocator,e=[],n=0,i=this.pointGeom.getNumGeometries();n<i;n++){var o=this.pointGeom.getGeometryN(n),r=o.getCoordinate(),s=t.locate(r,this.otherGeom);if(s===jsts.geom.Location.EXTERIOR){for(var a=!0,l=e.length;n--;)if(e[l].equals(r)){a=!1;break}a&&e.push(r)}}if(e.sort(function(t,e){return t.compareTo(e)}),0===e.length)return this.otherGeom;var d=null,c=jsts.geom.CoordinateArrays.toCoordinateArray(e);return d=1===c.length?this.geomFact.createPoint(c[0]):this.geomFact.createMultiPoint(c),jsts.geom.util.GeometryCombiner.combine(d,this.otherGeom)},jsts.noding.IntersectionFinderAdder=function(t){this.li=t,this.interiorIntersections=new javascript.util.ArrayList},jsts.noding.IntersectionFinderAdder.prototype=new jsts.noding.SegmentIntersector,jsts.noding.IntersectionFinderAdder.constructor=jsts.noding.IntersectionFinderAdder,jsts.noding.IntersectionFinderAdder.prototype.li=null,jsts.noding.IntersectionFinderAdder.prototype.interiorIntersections=null,jsts.noding.IntersectionFinderAdder.prototype.getInteriorIntersections=function(){return this.interiorIntersections},jsts.noding.IntersectionFinderAdder.prototype.processIntersections=function(t,e,n,i){if(t!==n||e!==i){var o=t.getCoordinates()[e],r=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this.li.computeIntersection(o,r,s,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var l=0;l<this.li.getIntersectionNum();l++)this.interiorIntersections.add(this.li.getIntersection(l));t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)}}},jsts.noding.IntersectionFinderAdder.prototype.isDone=function(){return!1},function(){jsts.densify.Densifier=function(t){this.geom=t},jsts.densify.Densifier.prototype.densify=function(t,e){var n=new jsts.densify.Densifier(t);return n.setDistanceTolerance(e),n.getResultGeometry()},jsts.densify.Densifier.densifyPoints=function(t,e,n){var o=new jsts.geom.LineSegment,r=new jsts.geom.CoordinateList;for(i=0;i<t.length-1;i++){o.p0=t[i],o.p1=t[i+1],r.add(o.p0,!1);var s=o.getLength(),a=s/e+1;if(a>1){var l=s/a;for(j=1;j<a;j++){var d=j*l/s,c=o.pointAlong(d);n.makePrecise(c),r.add(c,!1)}}}return r.add(t[t.length-1],!1),r.toCoordinateArray()},jsts.densify.Densifier.prototype.setDistanceTolerance=function(t){if(t<=0)throw new jsts.error.IllegalArgumentError("Tolerance must be positive");this.distanceTolerance=t},jsts.densify.Densifier.prototype.getResultGeometry=function(){return new jsts.densify.Densifier.DensifyTransformer(this.distanceTolerance).transform(this.geom)},jsts.densify.Densifier.DensifyTransformer=function(t){jsts.geom.util.GeometryTransformer.call(this),this.distanceTolerance=t},jsts.densify.Densifier.DensifyTransformer.prototype=new jsts.geom.util.GeometryTransformer,jsts.densify.Densifier.DensifyTransformer.constructor=jsts.densify.Densifier.DensifyTransformer,jsts.densify.Densifier.DensifyTransformer.CLASS_NAME="jsts.densify.Densifier.DensifyTransformer",jsts.densify.Densifier.DensifyTransformer.prototype.transformCoordinates=function(t,e){var n=t;n instanceof Array||(n=t.toCoordinateArray());var i=jsts.densify.Densifier.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof jsts.geom.LineString&&1==i.length&&(i=new jsts.geom.Coordinate(0)),i},jsts.densify.Densifier.DensifyTransformer.prototype.transformPolygon=function(t,e){var n=jsts.geom.util.GeometryTransformer.prototype.transformPolygon.call(this,t,e);return e instanceof jsts.geom.MultiPolygon?n:this.createValidArea(n)},jsts.densify.Densifier.DensifyTransformer.prototype.transformMultiPolygon=function(t,e){var n=this._super.transformMultiPolygon(t,e);return this.createValidArea(n)},jsts.densify.Densifier.DensifyTransformer.prototype.createValidArea=function(t){return t.buffer(0);
},jsts.densify.Densifier.DensifyTransformer.CLASS_NAME="jsts.densify.Densifier.DensifyTransformer"}(),jsts.operation.valid.ConnectedInteriorTester=function(t){this.geomGraph=t,this.geometryFactory=new jsts.geom.GeometryFactory,this.disconnectedRingcoord=null},jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint=function(t,e){var n=0,i=t.length;for(n;n<i;n++)if(!t[n].equals(e))return t[n];return null},jsts.operation.valid.ConnectedInteriorTester.prototype.getCoordinate=function(){return this.disconnectedRingcoord},jsts.operation.valid.ConnectedInteriorTester.prototype.isInteriorsConnected=function(){var t=new javascript.util.ArrayList;this.geomGraph.computeSplitEdges(t);var e=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)},jsts.operation.valid.ConnectedInteriorTester.prototype.setInteriorEdgesInResult=function(t){for(var e,n=t.getEdgeEnds().iterator();n.hasNext();)e=n.next(),e.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR&&e.setInResult(!0)},jsts.operation.valid.ConnectedInteriorTester.prototype.buildEdgeRings=function(t){for(var e=new javascript.util.ArrayList,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&null==i.getEdgeRing()){var o=new jsts.operation.overlay.MaximalEdgeRing(i,this.geometryFactory);o.linkDirectedEdgesForMinimalEdgeRings();var r=o.buildMinimalRings(),s=0,a=r.length;for(s;s<a;s++)e.add(r[s])}}return e},jsts.operation.valid.ConnectedInteriorTester.prototype.visitShellInteriors=function(t,e){if(t instanceof jsts.geom.Polygon){var n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof jsts.geom.MultiPolygon)for(var i=t,o=0;o<i.getNumGeometries();o++){var n=i.getGeometryN(o);this.visitInteriorRing(n.getExteriorRing(),e)}},jsts.operation.valid.ConnectedInteriorTester.prototype.visitInteriorRing=function(t,e){var n=t.getCoordinates(),i=n[0],o=jsts.operation.valid.ConnectedInteriorTester.findDifferentPoint(n,i),r=e.findEdgeInSameDirection(i,o),s=e.findEdgeEnd(r),a=null;s.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR?a=s:s.getSym().getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR&&(a=s.getSym()),this.visitLinkedDirectedEdges(a)},jsts.operation.valid.ConnectedInteriorTester.prototype.visitLinkedDirectedEdges=function(t){var e=t,n=t;do n.setVisited(!0),n=n.getNext();while(n!=e)},jsts.operation.valid.ConnectedInteriorTester.prototype.hasUnvisitedShellEdge=function(t){for(var e=0;e<t.size();e++){var n=t.get(e);if(!n.isHole()){var i=n.getEdges(),o=i[0];if(o.getLabel().getLocation(0,jsts.geomgraph.Position.RIGHT)==jsts.geom.Location.INTERIOR)for(var r=0;r<i.length;r++)if(o=i[r],!o.isVisited())return disconnectedRingcoord=o.getCoordinate(),!0}}return!1},jsts.algorithm.InteriorPointLine=function(t){this.centroid,this.minDistance=Number.MAX_VALUE,this.interiorPoint=null,this.centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null==this.interiorPoint&&this.addEndpoints(t)},jsts.algorithm.InteriorPointLine.prototype.getInteriorPoint=function(){return this.interiorPoint},jsts.algorithm.InteriorPointLine.prototype.addInterior=function(t){if(t instanceof jsts.geom.LineString)this.addInteriorCoord(t.getCoordinates());else if(t instanceof jsts.geom.GeometryCollection)for(var e=0;e<t.getNumGeometries();e++)this.addInterior(t.getGeometryN(e))},jsts.algorithm.InteriorPointLine.prototype.addInteriorCoord=function(t){for(var e=1;e<t.length-1;e++)this.add(t[e])},jsts.algorithm.InteriorPointLine.prototype.addEndpoints=function(t){if(t instanceof jsts.geom.LineString)this.addEndpointsCoord(t.getCoordinates());else if(t instanceof jsts.geom.GeometryCollection)for(var e=0;e<t.getNumGeometries();e++)this.addEndpoints(t.getGeometryN(e))},jsts.algorithm.InteriorPointLine.prototype.addEndpointsCoord=function(t){this.add(t[0]),this.add(t[t.length-1])},jsts.algorithm.InteriorPointLine.prototype.add=function(t){var e=t.distance(this.centroid);e<this.minDistance&&(this.interiorPoint=new jsts.geom.Coordinate(t),this.minDistance=e)},jsts.index.chain.MonotoneChainSelectAction=function(){this.tempEnv1=new jsts.geom.Envelope,this.selectedSegment=new jsts.geom.LineSegment},jsts.index.chain.MonotoneChainSelectAction.prototype.tempEnv1=null,jsts.index.chain.MonotoneChainSelectAction.prototype.selectedSegment=null,jsts.index.chain.MonotoneChainSelectAction.prototype.select=function(t,e){t.getLineSegment(e,this.selectedSegment),this.select2(this.selectedSegment)},jsts.index.chain.MonotoneChainSelectAction.prototype.select2=function(t){},jsts.algorithm.MCPointInRing=function(t){this.ring=t,this.tree=null,this.crossings=0,this.interval=new jsts.index.bintree.Interval,this.buildIndex()},jsts.algorithm.MCPointInRing.MCSelecter=function(t,e){this.parent=e,this.p=t},jsts.algorithm.MCPointInRing.MCSelecter.prototype=new jsts.index.chain.MonotoneChainSelectAction,jsts.algorithm.MCPointInRing.MCSelecter.prototype.constructor=jsts.algorithm.MCPointInRing.MCSelecter,jsts.algorithm.MCPointInRing.MCSelecter.prototype.select2=function(t){this.parent.testLineSegment.apply(this.parent,[this.p,t])},jsts.algorithm.MCPointInRing.prototype.buildIndex=function(){this.tree=new jsts.index.bintree.Bintree;for(var t=jsts.geom.CoordinateArrays.removeRepeatedPoints(this.ring.getCoordinates()),e=jsts.index.chain.MonotoneChainBuilder.getChains(t),n=0;n<e.length;n++){var i=e[n],o=i.getEnvelope();this.interval.min=o.getMinY(),this.interval.max=o.getMaxY(),this.tree.insert(this.interval,i)}},jsts.algorithm.MCPointInRing.prototype.isInside=function(t){this.crossings=0;var e=new jsts.geom.Envelope((-Number.MAX_VALUE),Number.MAX_VALUE,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var n=this.tree.query(this.interval),i=new jsts.algorithm.MCPointInRing.MCSelecter(t,this),o=n.iterator();o.hasNext();){var r=o.next();this.testMonotoneChain(e,i,r)}return this.crossings%2==1},jsts.algorithm.MCPointInRing.prototype.testMonotoneChain=function(t,e,n){n.select(t,e)},jsts.algorithm.MCPointInRing.prototype.testLineSegment=function(t,e){var n,i,o,r,s,a,l;a=e.p0,l=e.p1,i=a.x-t.x,o=a.y-t.y,r=l.x-t.x,s=l.y-t.y,(o>0&&s<=0||s>0&&o<=0)&&(n=jsts.algorithm.RobustDeterminant.signOfDet2x2(i,o,r,s)/(s-o),0<n&&this.crossings++)},jsts.operation.valid.TopologyValidationError=function(t,e){this.errorType=t,this.pt=null,null!=e&&(this.pt=e.clone())},jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL=2,jsts.operation.valid.TopologyValidationError.NESTED_HOLES=3,jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR=4,jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION=5,jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION=6,jsts.operation.valid.TopologyValidationError.NESTED_SHELLS=7,jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS=8,jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS=9,jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE=10,jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED=11,jsts.operation.valid.TopologyValidationError.prototype.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],jsts.operation.valid.TopologyValidationError.prototype.getCoordinate=function(){return this.pt},jsts.operation.valid.TopologyValidationError.prototype.getErrorType=function(){return this.errorType},jsts.operation.valid.TopologyValidationError.prototype.getMessage=function(){return this.errMsg[this.errorType]},jsts.operation.valid.TopologyValidationError.prototype.toString=function(){var t="";return null!=this.pt?(t=" at or near point "+this.pt,this.getMessage()+t):t},function(){var t=jsts.geom.Coordinate,e=jsts.geom.Envelope,n=jsts.algorithm.RobustLineIntersector;jsts.algorithm.RectangleLineIntersector=function(e){this.rectEnv=e,this.diagUp0=new t(this.rectEnv.getMinX(),this.rectEnv.getMinY()),this.diagUp1=new t(this.rectEnv.getMaxX(),this.rectEnv.getMaxY()),this.diagDown0=new t(this.rectEnv.getMinX(),this.rectEnv.getMaxY()),this.diagDown1=new t(this.rectEnv.getMaxX(),this.rectEnv.getMinY())},jsts.algorithm.RectangleLineIntersector.prototype.li=new n,jsts.algorithm.RectangleLineIntersector.prototype.rectEnv,jsts.algorithm.RectangleLineIntersector.prototype.diagUp0,jsts.algorithm.RectangleLineIntersector.prototype.diagUp1,jsts.algorithm.RectangleLineIntersector.prototype.diagDown0,jsts.algorithm.RectangleLineIntersector.prototype.diagDown1,jsts.algorithm.RectangleLineIntersector.prototype.intersects=function(t,n){var i=new e(t,n);if(!this.rectEnv.intersects(i))return!1;if(this.rectEnv.intersects(t))return!0;if(this.rectEnv.intersects(n))return!0;if(t.compareTo(n)>0){var o=t;t=n,n=o}var r=!1;return n.y>t.y&&(r=!0),r?this.li.computeIntersection(t,n,this.diagDown0,this.diagDown1):this.li.computeIntersection(t,n,this.diagUp0,this.diagUp1),!!this.li.hasIntersection()}}(),function(){jsts.geom.MultiPolygon=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.MultiPolygon.prototype=new jsts.geom.GeometryCollection,jsts.geom.MultiPolygon.constructor=jsts.geom.MultiPolygon,jsts.geom.MultiPolygon.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString(null);for(var t=[],e=0;e<this.geometries.length;e++)for(var n=this.geometries[e],i=n.getBoundary(),o=0;o<i.getNumGeometries();o++)t.push(i.getGeometryN(o));return this.getFactory().createMultiLineString(t)},jsts.geom.MultiPolygon.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&jsts.geom.GeometryCollection.prototype.equalsExact.call(this,t,e)},jsts.geom.MultiPolygon.prototype.CLASS_NAME="jsts.geom.MultiPolygon"}(),jsts.geom.CoordinateSequenceFilter=function(){},jsts.geom.CoordinateSequenceFilter.prototype.filter=jsts.abstractFunc,jsts.geom.CoordinateSequenceFilter.prototype.isDone=jsts.abstractFunc,jsts.geom.CoordinateSequenceFilter.prototype.isGeometryChanged=jsts.abstractFunc,jsts.operation.linemerge.LineMergeDirectedEdge=function(t,e,n,i){jsts.planargraph.DirectedEdge.call(this,t,e,n,i)},jsts.operation.linemerge.LineMergeDirectedEdge.prototype=new jsts.planargraph.DirectedEdge,jsts.operation.linemerge.LineMergeDirectedEdge.constructor=jsts.operation.linemerge.LineMergeDirectedEdge,jsts.operation.linemerge.LineMergeDirectedEdge.prototype.getNext=function(){return 2!=this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)==this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(jsts.util.Assert.isTrue(this.getToNode().getOutEdges().getEdges().get(1)==this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))},function(){var t=function(){if(this.min=0,this.max=0,1===arguments.length){var t=arguments[0];this.init(t.min,t.max)}else 2===arguments.length&&this.init(arguments[0],arguments[1])};t.prototype.init=function(t,e){this.min=t,this.max=e,t>e&&(this.min=e,this.max=t)},t.prototype.getMin=function(){return this.min},t.prototype.getMax=function(){return this.max},t.prototype.getWidth=function(){return this.max-this.min},t.prototype.expandToInclude=function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},t.prototype.overlaps=function(){return 1===arguments.length?this.overlapsInterval.apply(this,arguments):this.overlapsMinMax.apply(this,arguments)},t.prototype.overlapsInterval=function(t){return this.overlaps(t.min,t.max)},t.prototype.overlapsMinMax=function(t,e){return!(this.min>e||this.max<t)},t.prototype.contains=function(){var t;return arguments[0]instanceof jsts.index.bintree.Interval?(t=arguments[0],this.containsMinMax(t.min,t.max)):1===arguments.length?this.containsPoint(arguments[0]):this.containsMinMax(arguments[0],arguments[1])},t.prototype.containsMinMax=function(t,e){return t>=this.min&&e<=this.max},t.prototype.containsPoint=function(t){return t>=this.min&&t<=this.max},jsts.index.bintree.Interval=t}(),jsts.index.DoubleBits=function(){},jsts.index.DoubleBits.powerOf2=function(t){return Math.pow(2,t)},jsts.index.DoubleBits.exponent=function(t){return jsts.index.DoubleBits.CVTFWD(64,t)-1023},jsts.index.DoubleBits.CVTFWD=function(t,e){var n,i,o,r,s="",a={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}},l={32:8,64:11}[t];if(r||(n=e<0||1/e<0,isFinite(e)||(r=a[t],n&&(r.d+=1<<t/4-1),i=Math.pow(2,l)-1,o=0)),!r){for(i={32:127,64:1023}[t],o=Math.abs(e);o>=2;)i++,o/=2;for(;o<1&&i>0;)i--,o*=2;i<=0&&(o/=2,s="Zero or Denormal"),32===t&&i>254&&(s="Too big for Single",r={d:n?255:127,c:128,b:0,a:0},i=Math.pow(2,l)-1,o=0)}return i},function(){var t=jsts.index.DoubleBits,e=jsts.index.bintree.Interval,n=function(t){this.pt=0,this.level=0,this.computeKey(t)};n.computeLevel=function(e){var n,i=e.getWidth();return n=t.exponent(i)+1},n.prototype.getPoint=function(){return this.pt},n.prototype.getLevel=function(){return this.level},n.prototype.getInterval=function(){return this.interval},n.prototype.computeKey=function(t){for(this.level=n.computeLevel(t),this.interval=new e,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},n.prototype.computeInterval=function(e,n){var i=t.powerOf2(e);this.pt=Math.floor(n.getMin()/i)*i,this.interval.init(this.pt,this.pt+i)},jsts.index.bintree.Key=n}(),jsts.operation.buffer.SubgraphDepthLocater=function(t){this.subgraphs=[],this.seg=new jsts.geom.LineSegment,this.subgraphs=t},jsts.operation.buffer.SubgraphDepthLocater.prototype.subgraphs=null,jsts.operation.buffer.SubgraphDepthLocater.prototype.seg=null,jsts.operation.buffer.SubgraphDepthLocater.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);if(0===e.length)return 0;e.sort();var n=e[0];return n.leftDepth},jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments=function(t){if(3===arguments.length)return void this.findStabbedSegments2.apply(this,arguments);for(var e=[],n=0;n<this.subgraphs.length;n++){var i=this.subgraphs[n],o=i.getEnvelope();t.y<o.getMinY()||t.y>o.getMaxY()||this.findStabbedSegments2(t,i.getDirectedEdges(),e)}return e},jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments2=function(t,e,n){if(arguments[1]instanceof jsts.geomgraph.DirectedEdge)return void this.findStabbedSegments3(t,e,n);for(var i=e.iterator();i.hasNext();){var o=i.next();o.isForward()&&this.findStabbedSegments3(t,o,n)}},jsts.operation.buffer.SubgraphDepthLocater.prototype.findStabbedSegments3=function(t,e,n){for(var i=e.getEdge().getCoordinates(),o=0;o<i.length-1;o++){this.seg.p0=i[o],this.seg.p1=i[o+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse();var r=Math.max(this.seg.p0.x,this.seg.p1.x);if(!(r<t.x||this.seg.isHorizontal()||t.y<this.seg.p0.y||t.y>this.seg.p1.y||jsts.algorithm.CGAlgorithms.computeOrientation(this.seg.p0,this.seg.p1,t)===jsts.algorithm.CGAlgorithms.RIGHT)){var s=e.getDepth(jsts.geomgraph.Position.LEFT);this.seg.p0.equals(i[o])||(s=e.getDepth(jsts.geomgraph.Position.RIGHT));var a=new jsts.operation.buffer.SubgraphDepthLocater.DepthSegment(this.seg,s);n.push(a)}}},jsts.operation.buffer.SubgraphDepthLocater.DepthSegment=function(t,e){this.upwardSeg=new jsts.geom.LineSegment(t),this.leftDepth=e},jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.upwardSeg=null,jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.leftDepth=null,jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareTo=function(t){var e=t,n=this.upwardSeg.orientationIndex(e.upwardSeg);return 0===n&&(n=-1*e.upwardSeg.orientationIndex(upwardSeg)),0!==n?n:this.compareX(this.upwardSeg,e.upwardSeg)},jsts.operation.buffer.SubgraphDepthLocater.DepthSegment.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},jsts.noding.snapround.HotPixel=function(t,e,n){this.corner=[],this.originalPt=t,this.pt=t,this.scaleFactor=e,this.li=n,1!==this.scaleFactor&&(this.pt=new jsts.geom.Coordinate(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new jsts.geom.Coordinate,this.p1Scaled=new jsts.geom.Coordinate),this.initCorners(this.pt)},jsts.noding.snapround.HotPixel.prototype.li=null,jsts.noding.snapround.HotPixel.prototype.pt=null,jsts.noding.snapround.HotPixel.prototype.originalPt=null,jsts.noding.snapround.HotPixel.prototype.ptScaled=null,jsts.noding.snapround.HotPixel.prototype.p0Scaled=null,jsts.noding.snapround.HotPixel.prototype.p1Scaled=null,jsts.noding.snapround.HotPixel.prototype.scaleFactor=void 0,jsts.noding.snapround.HotPixel.prototype.minx=void 0,jsts.noding.snapround.HotPixel.prototype.maxx=void 0,jsts.noding.snapround.HotPixel.prototype.miny=void 0,jsts.noding.snapround.HotPixel.prototype.maxy=void 0,jsts.noding.snapround.HotPixel.prototype.corner=null,jsts.noding.snapround.HotPixel.prototype.safeEnv=null,jsts.noding.snapround.HotPixel.prototype.getCoordinate=function(){return this.originalPt},jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR=.75,jsts.noding.snapround.HotPixel.prototype.getSafeEnvelope=function(){if(null===this.safeEnv){var t=jsts.noding.snapround.HotPixel.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new jsts.geom.Envelope(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},jsts.noding.snapround.HotPixel.prototype.initCorners=function(t){var e=.5;this.minx=t.x-e,this.maxx=t.x+e,this.miny=t.y-e,this.maxy=t.y+e,this.corner[0]=new jsts.geom.Coordinate(this.maxx,this.maxy),this.corner[1]=new jsts.geom.Coordinate(this.minx,this.maxy),this.corner[2]=new jsts.geom.Coordinate(this.minx,this.miny),this.corner[3]=new jsts.geom.Coordinate(this.maxx,this.miny)},jsts.noding.snapround.HotPixel.prototype.scale=function(t){return Math.round(t*this.scaleFactor)},jsts.noding.snapround.HotPixel.prototype.intersects=function(t,e){return 1===this.scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this.p0Scaled),this.copyScaled(e,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},jsts.noding.snapround.HotPixel.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},jsts.noding.snapround.HotPixel.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),o=Math.min(t.y,e.y),r=Math.max(t.y,e.y),s=this.maxx<n||this.minx>i||this.maxy<o||this.miny>r;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return jsts.util.Assert.isTrue(!(s&&a),"Found bad envelope test"),a},jsts.noding.snapround.HotPixel.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.isProper()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.isProper()||(this.li.hasIntersection()&&(n=!0),this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.isProper()||(this.li.hasIntersection()&&(i=!0),this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.isProper()||(!(!n||!i)||(!!t.equals(this.pt)||!!e.equals(this.pt))))))},jsts.noding.snapround.HotPixel.prototype.intersectsPixelClosure=function(t,e){return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),!!this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),!!this.li.hasIntersection())))},jsts.noding.snapround.HotPixel.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},jsts.operation.buffer.BufferInputLineSimplifier=function(t){this.inputLine=t},jsts.operation.buffer.BufferInputLineSimplifier.simplify=function(t,e){var n=new jsts.operation.buffer.BufferInputLineSimplifier(t);return n.simplify(e)},jsts.operation.buffer.BufferInputLineSimplifier.INIT=0,jsts.operation.buffer.BufferInputLineSimplifier.DELETE=1,jsts.operation.buffer.BufferInputLineSimplifier.KEEP=1,jsts.operation.buffer.BufferInputLineSimplifier.prototype.inputLine=null,jsts.operation.buffer.BufferInputLineSimplifier.prototype.distanceTol=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeleted=null;jsts.operation.buffer.BufferInputLineSimplifier.prototype.angleOrientation=jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE,jsts.operation.buffer.BufferInputLineSimplifier.prototype.simplify=function(t){this.distanceTol=Math.abs(t),t<0&&(this.angleOrientation=jsts.algorithm.CGAlgorithms.CLOCKWISE),this.isDeleted=[],this.isDeleted.length=this.inputLine.length;var e=!1;do e=this.deleteShallowConcavities();while(e);return this.collapseLine()},jsts.operation.buffer.BufferInputLineSimplifier.prototype.deleteShallowConcavities=function(){for(var t=1,e=(this.inputLine.length-1,this.findNextNonDeletedIndex(t)),n=this.findNextNonDeletedIndex(e),i=!1;n<this.inputLine.length;){var o=!1;this.isDeletable(t,e,n,this.distanceTol)&&(this.isDeleted[e]=jsts.operation.buffer.BufferInputLineSimplifier.DELETE,o=!0,i=!0),t=o?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},jsts.operation.buffer.BufferInputLineSimplifier.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this.inputLine.length&&this.isDeleted[e]===jsts.operation.buffer.BufferInputLineSimplifier.DELETE;)e++;return e},jsts.operation.buffer.BufferInputLineSimplifier.prototype.collapseLine=function(){for(var t=[],e=0;e<this.inputLine.length;e++)this.isDeleted[e]!==jsts.operation.buffer.BufferInputLineSimplifier.DELETE&&t.push(this.inputLine[e]);return t},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isDeletable=function(t,e,n,i){var o=this.inputLine[t],r=this.inputLine[e],s=this.inputLine[n];return!!this.isConcave(o,r,s)&&(!!this.isShallow(o,r,s,i)&&this.isShallowSampled(o,r,t,n,i))},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowConcavity=function(t,e,n,i){var o=jsts.algorithm.CGAlgorithms.computeOrientation(t,e,n),r=o===this.angleOrientation;if(!r)return!1;var s=jsts.algorithm.CGAlgorithms.distancePointLine(e,t,n);return s<i},jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK=10,jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallowSampled=function(t,e,n,i,o){var r=parseInt((i-n)/jsts.operation.buffer.BufferInputLineSimplifier.NUM_PTS_TO_CHECK);r<=0&&(r=1);for(var s=n;s<i;s+=r)if(!this.isShallow(t,e,this.inputLine[s],o))return!1;return!0},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isShallow=function(t,e,n,i){var o=jsts.algorithm.CGAlgorithms.distancePointLine(e,t,n);return o<i},jsts.operation.buffer.BufferInputLineSimplifier.prototype.isConcave=function(t,e,n){var i=jsts.algorithm.CGAlgorithms.computeOrientation(t,e,n),o=i===this.angleOrientation;return o},jsts.geomgraph.index.SweepLineEvent=function(t,e,n){return e instanceof jsts.geomgraph.index.SweepLineEvent?(this.eventType=jsts.geomgraph.index.SweepLineEvent.DELETE,this.xValue=t,void(this.insertEvent=e)):(this.eventType=jsts.geomgraph.index.SweepLineEvent.INSERT,this.label=n,this.xValue=t,void(this.obj=e))},jsts.geomgraph.index.SweepLineEvent.INSERT=1,jsts.geomgraph.index.SweepLineEvent.DELETE=2,jsts.geomgraph.index.SweepLineEvent.prototype.label=null,jsts.geomgraph.index.SweepLineEvent.prototype.xValue=null,jsts.geomgraph.index.SweepLineEvent.prototype.eventType=null,jsts.geomgraph.index.SweepLineEvent.prototype.insertEvent=null,jsts.geomgraph.index.SweepLineEvent.prototype.deleteEventIndex=null,jsts.geomgraph.index.SweepLineEvent.prototype.obj=null,jsts.geomgraph.index.SweepLineEvent.prototype.isInsert=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.INSERT},jsts.geomgraph.index.SweepLineEvent.prototype.isDelete=function(){return this.eventType==jsts.geomgraph.index.SweepLineEvent.DELETE},jsts.geomgraph.index.SweepLineEvent.prototype.getInsertEvent=function(){return this.insertEvent},jsts.geomgraph.index.SweepLineEvent.prototype.getDeleteEventIndex=function(){return this.deleteEventIndex},jsts.geomgraph.index.SweepLineEvent.prototype.setDeleteEventIndex=function(t){this.deleteEventIndex=t},jsts.geomgraph.index.SweepLineEvent.prototype.getObject=function(){return this.obj},jsts.geomgraph.index.SweepLineEvent.prototype.isSameLabel=function(t){return null!=this.label&&this.label==t.label},jsts.geomgraph.index.SweepLineEvent.prototype.compareTo=function(t){return this.xValue<t.xValue?-1:this.xValue>t.xValue?1:this.eventType<t.eventType?-1:this.eventType>t.eventType?1:0},jsts.geom.CoordinateList=function(t,e){this.array=[],e=void 0===e||e,void 0!==t&&this.add(t,e)},jsts.geom.CoordinateList.prototype=new javascript.util.ArrayList,jsts.geom.CoordinateList.prototype.iterator=null,jsts.geom.CoordinateList.prototype.remove=null,jsts.geom.CoordinateList.prototype.get=function(t){return this.array[t]},jsts.geom.CoordinateList.prototype.set=function(t,e){var n=this.array[t];return this.array[t]=e,n},jsts.geom.CoordinateList.prototype.size=function(){return this.array.length},jsts.geom.CoordinateList.prototype.add=function(){return arguments.length>1?this.addCoordinates.apply(this,arguments):this.array.push(arguments[0])},jsts.geom.CoordinateList.prototype.addCoordinates=function(t,e,n){if(t instanceof jsts.geom.Coordinate)return this.addCoordinate.apply(this,arguments);if("number"==typeof t)return this.insertCoordinate.apply(this,arguments);if(n=void 0===n||n)for(var i=0;i<t.length;i++)this.addCoordinate(t[i],e);else for(var i=t.length-1;i>=0;i--)this.addCoordinate(t[i],e);return!0},jsts.geom.CoordinateList.prototype.addCoordinate=function(t,e){if(!e&&this.size()>=1){var n=this.get(this.size()-1);if(n.equals2D(t))return}this.add(t)},jsts.geom.CoordinateList.prototype.insertCoordinate=function(t,e,n){if(!n){var i=t>0?t-1:-1;if(i!==-1&&this.get(i).equals2D(e))return;var o=t<this.size()-1?t+1:-1;if(o!==-1&&this.get(o).equals2D(e))return}this.array.splice(t,0,e)},jsts.geom.CoordinateList.prototype.closeRing=function(){this.size()>0&&this.addCoordinate(new jsts.geom.Coordinate(this.get(0)),!1)},jsts.geom.CoordinateList.prototype.toArray=function(){return this.array},jsts.geom.CoordinateList.prototype.toCoordinateArray=function(){return this.array},jsts.operation.buffer.OffsetSegmentGenerator=function(t,e,n){this.seg0=new jsts.geom.LineSegment,this.seg1=new jsts.geom.LineSegment,this.offset0=new jsts.geom.LineSegment,this.offset1=new jsts.geom.LineSegment,this.precisionModel=t,this.bufParams=e,this.li=new jsts.algorithm.RobustLineIntersector,this.filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),this.bufParams.getQuadrantSegments()>=8&&this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_ROUND&&(this.closingSegLengthFactor=jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)},jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,jsts.operation.buffer.OffsetSegmentGenerator.MAX_CLOSING_SEG_LEN_FACTOR=80,jsts.operation.buffer.OffsetSegmentGenerator.prototype.maxCurveSegmentError=0,jsts.operation.buffer.OffsetSegmentGenerator.prototype.filletAngleQuantum=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.closingSegLengthFactor=1,jsts.operation.buffer.OffsetSegmentGenerator.prototype.segList=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.distance=0,jsts.operation.buffer.OffsetSegmentGenerator.prototype.precisionModel=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.bufParams=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.li=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.s0=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.s1=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.s2=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg0=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.seg1=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset0=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.offset1=null,jsts.operation.buffer.OffsetSegmentGenerator.prototype.side=0,jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=!1,jsts.operation.buffer.OffsetSegmentGenerator.prototype.hasNarrowConcaveAngle=function(){return this.hasNarrowConcaveAngle},jsts.operation.buffer.OffsetSegmentGenerator.prototype.init=function(t){this.distance=t,this.maxCurveSegmentError=this.distance*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new jsts.operation.buffer.OffsetSegmentString,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(this.distance*jsts.operation.buffer.OffsetSegmentGenerator.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.initSideSegments=function(t,e,n){this.s1=t,this.s2=e,this.side=n,this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.getCoordinates=function(){return this.segList.getCoordinates()},jsts.operation.buffer.OffsetSegmentGenerator.prototype.closeRing=function(){this.segList.closeRing()},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addSegments=function(t,e){this.segList.addPts(t,e)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFirstSegment=function(){this.segList.addPt(this.offset1.p0)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLastSegment=function(){this.segList.addPt(this.offset1.p1)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addNextSegment=function(t,e){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),!this.s1.equals(this.s2)){var n=jsts.algorithm.CGAlgorithms.computeOrientation(this.s0,this.s1,this.s2),i=n===jsts.algorithm.CGAlgorithms.CLOCKWISE&&this.side===jsts.geomgraph.Position.LEFT||n===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE&&this.side===jsts.geomgraph.Position.RIGHT;0==n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addCollinear=function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2);var e=this.li.getIntersectionNum();e>=2&&(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL||this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance))},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addOutsideTurn=function(t,e){return this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.OFFSET_SEGMENT_SEPARATION_FACTOR?void this.segList.addPt(this.offset0.p1):void(this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===jsts.operation.buffer.BufferParameters.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(e&&this.segList.addPt(this.offset0.p1),this.addFillet(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0)))},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addInsideTurn=function(t,e){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),
this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this.hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*jsts.operation.buffer.OffsetSegmentGenerator.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var n=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(n);var i=new jsts.geom.Coordinate((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(i)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.computeOffsetSegment=function(t,e,n,i){var o=e===jsts.geomgraph.Position.LEFT?1:-1,r=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(r*r+s*s),l=o*n*r/a,d=o*n*s/a;i.p0.x=t.p0.x-d,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-d,i.p1.y=t.p1.y+l},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLineEndCap=function(t,e){var n=new jsts.geom.LineSegment(t,e),i=new jsts.geom.LineSegment;this.computeOffsetSegment(n,jsts.geomgraph.Position.LEFT,this.distance,i);var o=new jsts.geom.LineSegment;this.computeOffsetSegment(n,jsts.geomgraph.Position.RIGHT,this.distance,o);var r=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,r);switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:this.segList.addPt(i.p1),this.addFillet(e,a+Math.PI/2,a-Math.PI/2,jsts.algorithm.CGAlgorithms.CLOCKWISE,this.distance),this.segList.addPt(o.p1);break;case jsts.operation.buffer.BufferParameters.CAP_FLAT:this.segList.addPt(i.p1),this.segList.addPt(o.p1);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:var l=new jsts.geom.Coordinate;l.x=Math.abs(this.distance)*Math.cos(a),l.y=Math.abs(this.distance)*Math.sin(a);var d=new jsts.geom.Coordinate(i.p1.x+l.x,i.p1.y+l.y),c=new jsts.geom.Coordinate(o.p1.x+l.x,o.p1.y+l.y);this.segList.addPt(d),this.segList.addPt(c)}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addMitreJoin=function(t,e,n,i){var o=!0,r=null;try{r=jsts.algorithm.HCoordinate.intersection(e.p0,e.p1,n.p0,n.p1);var s=i<=0?1:r.distance(t)/Math.abs(i);s>this.bufParams.getMitreLimit()&&(this.isMitreWithinLimit=!1)}catch(t){t instanceof jsts.error.NotRepresentableError&&(r=new jsts.geom.Coordinate(0,0),this.isMitreWithinLimit=!1)}o?this.segList.addPt(r):this.addLimitedMitreJoin(e,n,i,bufParams.getMitreLimit())},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addLimitedMitreJoin=function(t,e,n,i){var o=this.seg0.p1,r=jsts.algorithm.Angle.angle(o,this.seg0.p0),s=(jsts.algorithm.Angle.angle(o,this.seg1.p1),jsts.algorithm.Angle.angleBetweenOriented(this.seg0.p0,o,this.seg1.p1)),a=s/2,l=jsts.algorithm.Angle.normalize(r+a),d=jsts.algorithm.Angle.normalize(l+Math.PI),c=i*n,h=c*Math.abs(Math.sin(a)),u=n-h,p=o.x+c*Math.cos(d),g=o.y+c*Math.sin(d),m=new jsts.geom.Coordinate(p,g),f=new jsts.geom.LineSegment(o,m),y=f.pointAlongOffset(1,u),v=f.pointAlongOffset(1,-u);this.side==jsts.geomgraph.Position.LEFT?(this.segList.addPt(y),this.segList.addPt(v)):(this.segList.addPt(v),this.segList.addPt(y))},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addBevelJoin=function(t,e){this.segList.addPt(t.p1),this.segList.addPt(e.p0)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet=function(t,e,n,i,o){if(!(n instanceof jsts.geom.Coordinate))return void this.addFillet2.apply(this,arguments);var r=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,r),l=n.x-t.x,d=n.y-t.y,c=Math.atan2(d,l);i===jsts.algorithm.CGAlgorithms.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this.segList.addPt(e),this.addFillet(t,a,c,i,o),this.segList.addPt(n)},jsts.operation.buffer.OffsetSegmentGenerator.prototype.addFillet2=function(t,e,n,i,o){var r=i===jsts.algorithm.CGAlgorithms.CLOCKWISE?-1:1,s=Math.abs(e-n),a=parseInt(s/this.filletAngleQuantum+.5);if(!(a<1)){var l,d;l=0,d=s/a;for(var c=l,h=new jsts.geom.Coordinate;c<s;){var u=e+r*c;h.x=t.x+o*Math.cos(u),h.y=t.y+o*Math.sin(u),this.segList.addPt(h),c+=d}}},jsts.operation.buffer.OffsetSegmentGenerator.prototype.createCircle=function(t){var e=new jsts.geom.Coordinate(t.x+this.distance,t.y);this.segList.addPt(e),this.addFillet(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},jsts.operation.buffer.OffsetSegmentGenerator.prototype.createSquare=function(t){this.segList.addPt(new jsts.geom.Coordinate(t.x+distance,t.y+distance)),this.segList.addPt(new jsts.geom.Coordinate(t.x+distance,t.y-distance)),this.segList.addPt(new jsts.geom.Coordinate(t.x-distance,t.y-distance)),this.segList.addPt(new jsts.geom.Coordinate(t.x-distance,t.y+distance)),this.segList.closeRing()},jsts.operation.overlay.MaximalEdgeRing=function(t,e){jsts.geomgraph.EdgeRing.call(this,t,e)},jsts.operation.overlay.MaximalEdgeRing.prototype=new jsts.geomgraph.EdgeRing,jsts.operation.overlay.MaximalEdgeRing.constructor=jsts.operation.overlay.MaximalEdgeRing,jsts.operation.overlay.MaximalEdgeRing.prototype.getNext=function(t){return t.getNext()},jsts.operation.overlay.MaximalEdgeRing.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},jsts.operation.overlay.MaximalEdgeRing.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this.startDe;do{var e=t.getNode();e.getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!=this.startDe)},jsts.operation.overlay.MaximalEdgeRing.prototype.buildMinimalRings=function(){var t=[],e=this.startDe;do{if(null===e.getMinEdgeRing()){var n=new jsts.operation.overlay.MinimalEdgeRing(e,this.geometryFactory);t.push(n)}e=e.getNext()}while(e!=this.startDe);return t},jsts.algorithm.CentroidPoint=function(){this.centSum=new jsts.geom.Coordinate},jsts.algorithm.CentroidPoint.prototype.ptCount=0,jsts.algorithm.CentroidPoint.prototype.centSum=null,jsts.algorithm.CentroidPoint.prototype.add=function(t){if(t instanceof jsts.geom.Point)this.add2(t.getCoordinate());else if(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))},jsts.algorithm.CentroidPoint.prototype.add2=function(t){this.ptCount+=1,this.centSum.x+=t.x,this.centSum.y+=t.y},jsts.algorithm.CentroidPoint.prototype.getCentroid=function(){var t=new jsts.geom.Coordinate;return t.x=this.centSum.x/this.ptCount,t.y=this.centSum.y/this.ptCount,t},jsts.operation.distance.ConnectedElementLocationFilter=function(t){this.locations=t},jsts.operation.distance.ConnectedElementLocationFilter.prototype=new jsts.geom.GeometryFilter,jsts.operation.distance.ConnectedElementLocationFilter.prototype.locations=null,jsts.operation.distance.ConnectedElementLocationFilter.getLocations=function(t){var e=[];return t.apply(new jsts.operation.distance.ConnectedElementLocationFilter(e)),e},jsts.operation.distance.ConnectedElementLocationFilter.prototype.filter=function(t){(t instanceof jsts.geom.Point||t instanceof jsts.geom.LineString||t instanceof jsts.geom.Polygon)&&this.locations.push(new jsts.operation.distance.GeometryLocation(t,0,t.getCoordinate()))},jsts.geomgraph.index.MonotoneChainEdge=function(t){this.e=t,this.pts=t.getCoordinates();var e=new jsts.geomgraph.index.MonotoneChainIndexer;this.startIndex=e.getChainStartIndices(this.pts)},jsts.geomgraph.index.MonotoneChainEdge.prototype.e=null,jsts.geomgraph.index.MonotoneChainEdge.prototype.pts=null,jsts.geomgraph.index.MonotoneChainEdge.prototype.startIndex=null,jsts.geomgraph.index.MonotoneChainEdge.prototype.env1=new jsts.geom.Envelope,jsts.geomgraph.index.MonotoneChainEdge.prototype.env2=new jsts.geom.Envelope,jsts.geomgraph.index.MonotoneChainEdge.prototype.getCoordinates=function(){return this.pts},jsts.geomgraph.index.MonotoneChainEdge.prototype.getStartIndexes=function(){return this.startIndex},jsts.geomgraph.index.MonotoneChainEdge.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},jsts.geomgraph.index.MonotoneChainEdge.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain=function(t,e,n,i){this.computeIntersectsForChain2(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)},jsts.geomgraph.index.MonotoneChainEdge.prototype.computeIntersectsForChain2=function(t,e,n,i,o,r){var s=this.pts[t],a=this.pts[e],l=n.pts[i],d=n.pts[o];if(e-t==1&&o-i==1)return void r.addIntersections(this.e,t,n.e,i);if(this.env1.init(s,a),this.env2.init(l,d),this.env1.intersects(this.env2)){var c=Math.floor((t+e)/2),h=Math.floor((i+o)/2);t<c&&(i<h&&this.computeIntersectsForChain2(t,c,n,i,h,r),h<o&&this.computeIntersectsForChain2(t,c,n,h,o,r)),c<e&&(i<h&&this.computeIntersectsForChain2(c,e,n,i,h,r),h<o&&this.computeIntersectsForChain2(c,e,n,h,o,r))}},function(){var t=javascript.util.ArrayList;jsts.operation.relate.EdgeEndBuilder=function(){},jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds=function(e){if(2==arguments.length)return void this.computeEdgeEnds2.apply(this,arguments);for(var n=new t,i=e;i.hasNext();){var o=i.next();this.computeEdgeEnds2(o,n)}return n},jsts.operation.relate.EdgeEndBuilder.prototype.computeEdgeEnds2=function(t,e){var n=t.getEdgeIntersectionList();n.addEndpoints();var i=n.iterator(),o=null,r=null;if(i.hasNext()){var s=i.next();do o=r,r=s,s=null,i.hasNext()&&(s=i.next()),null!==r&&(this.createEdgeEndForPrev(t,e,r,o),this.createEdgeEndForNext(t,e,r,s));while(null!==r)}},jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForPrev=function(t,e,n,i){var o=n.segmentIndex;if(0===n.dist){if(0===o)return;o--}var r=t.getCoordinate(o);null!==i&&i.segmentIndex>=o&&(r=i.coord);var s=new jsts.geomgraph.Label(t.getLabel());s.flip();var a=new jsts.geomgraph.EdgeEnd(t,n.coord,r,s);e.add(a)},jsts.operation.relate.EdgeEndBuilder.prototype.createEdgeEndForNext=function(t,e,n,i){var o=n.segmentIndex+1;if(!(o>=t.getNumPoints()&&null===i)){var r=t.getCoordinate(o);null!==i&&i.segmentIndex===n.segmentIndex&&(r=i.coord);var s=new jsts.geomgraph.EdgeEnd(t,n.coord,r,new jsts.geomgraph.Label(t.getLabel()));e.add(s)}}}(),jsts.operation.linemerge.LineMergeGraph=function(){jsts.planargraph.PlanarGraph.call(this)},jsts.operation.linemerge.LineMergeGraph.prototype=new jsts.planargraph.PlanarGraph,jsts.operation.linemerge.LineMergeGraph.constructor=jsts.operation.linemerge.LineMergeGraph,jsts.operation.linemerge.LineMergeGraph.prototype.addEdge=function(t){if(!t.isEmpty()){var e=jsts.geom.CoordinateArrays.removeRepeatedPoints(t.getCoordinates());if(!(e.length<=1)){var n=e[0],i=e[e.length-1],o=this.getNode(n),r=this.getNode(i),s=new jsts.operation.linemerge.LineMergeDirectedEdge(o,r,e[1],(!0)),a=new jsts.operation.linemerge.LineMergeDirectedEdge(r,o,e[e.length-2],(!1)),l=new jsts.operation.linemerge.LineMergeEdge(t);l.setDirectedEdges(s,a),this.add(l)}}},jsts.operation.linemerge.LineMergeGraph.prototype.getNode=function(t){var e=this.findNode(t);return null==e&&(e=new jsts.planargraph.Node(t),this.add(e)),e},function(){var t=javascript.util.ArrayList,e=javascript.util.TreeSet,n=jsts.geom.CoordinateFilter;jsts.util.UniqueCoordinateArrayFilter=function(){this.treeSet=new e,this.list=new t},jsts.util.UniqueCoordinateArrayFilter.prototype=new n,jsts.util.UniqueCoordinateArrayFilter.prototype.treeSet=null,jsts.util.UniqueCoordinateArrayFilter.prototype.list=null,jsts.util.UniqueCoordinateArrayFilter.prototype.getCoordinates=function(){return this.list.toArray()},jsts.util.UniqueCoordinateArrayFilter.prototype.filter=function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))}}(),function(){var t=jsts.algorithm.CGAlgorithms,e=jsts.util.UniqueCoordinateArrayFilter,n=jsts.util.Assert,i=javascript.util.Stack,o=javascript.util.ArrayList,r=javascript.util.Arrays,s=function(t){this.origin=t};s.prototype.origin=null,s.prototype.compare=function(t,e){var n=t,i=e;return s.polarCompare(this.origin,n,i)},s.polarCompare=function(e,n,i){var o=n.x-e.x,r=n.y-e.y,s=i.x-e.x,a=i.y-e.y,l=t.computeOrientation(e,n,i);if(l==t.COUNTERCLOCKWISE)return 1;if(l==t.CLOCKWISE)return-1;var d=o*o+r*r,c=s*s+a*a;return d<c?-1:d>c?1:0},jsts.algorithm.ConvexHull=function(){if(1===arguments.length){var t=arguments[0];this.inputPts=jsts.algorithm.ConvexHull.extractCoordinates(t),this.geomFactory=t.getFactory()}else this.pts=arguments[0],this.geomFactory=arguments[1]},jsts.algorithm.ConvexHull.prototype.geomFactory=null,jsts.algorithm.ConvexHull.prototype.inputPts=null,jsts.algorithm.ConvexHull.extractCoordinates=function(t){var n=new e;return t.apply(n),n.getCoordinates()},jsts.algorithm.ConvexHull.prototype.getConvexHull=function(){if(0==this.inputPts.length)return this.geomFactory.createGeometryCollection(null);if(1==this.inputPts.length)return this.geomFactory.createPoint(this.inputPts[0]);if(2==this.inputPts.length)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var e=this.preSort(t),n=this.grahamScan(e),i=n.toArray();return this.lineOrPolygon(i)},jsts.algorithm.ConvexHull.prototype.reduce=function(e){var n=this.computeOctRing(e);if(null==n)return this.inputPts;for(var i=new javascript.util.TreeSet,o=0;o<n.length;o++)i.add(n[o]);for(var o=0;o<e.length;o++)t.isPointInRing(e[o],n)||i.add(e[o]);var r=i.toArray();return r.length<3?this.padArray3(r):r},jsts.algorithm.ConvexHull.prototype.padArray3=function(t){for(var e=[],n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e},jsts.algorithm.ConvexHull.prototype.preSort=function(t){for(var e,n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y==t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return r.sort(t,1,t.length,new s(t[0])),t},jsts.algorithm.ConvexHull.prototype.grahamScan=function(e){var n,o=new i;n=o.push(e[0]),n=o.push(e[1]),n=o.push(e[2]);for(var r=3;r<e.length;r++){for(n=o.pop();!o.empty()&&t.computeOrientation(o.peek(),n,e[r])>0;)n=o.pop();n=o.push(n),n=o.push(e[r])}return n=o.push(e[0]),o},jsts.algorithm.ConvexHull.prototype.isBetween=function(e,n,i){if(0!==t.computeOrientation(e,n,i))return!1;if(e.x!=i.x){if(e.x<=n.x&&n.x<=i.x)return!0;if(i.x<=n.x&&n.x<=e.x)return!0}if(e.y!=i.y){if(e.y<=n.y&&n.y<=i.y)return!0;if(i.y<=n.y&&n.y<=e.y)return!0}return!1},jsts.algorithm.ConvexHull.prototype.computeOctRing=function(t){var e=this.computeOctPts(t),n=new jsts.geom.CoordinateList;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())},jsts.algorithm.ConvexHull.prototype.computeOctPts=function(t){for(var e=[],n=0;n<8;n++)e[n]=t[0];for(var i=1;i<t.length;i++)t[i].x<e[0].x&&(e[0]=t[i]),t[i].x-t[i].y<e[1].x-e[1].y&&(e[1]=t[i]),t[i].y>e[2].y&&(e[2]=t[i]),t[i].x+t[i].y>e[3].x+e[3].y&&(e[3]=t[i]),t[i].x>e[4].x&&(e[4]=t[i]),t[i].x-t[i].y>e[5].x-e[5].y&&(e[5]=t[i]),t[i].y<e[6].y&&(e[6]=t[i]),t[i].x+t[i].y<e[7].x+e[7].y&&(e[7]=t[i]);return e},jsts.algorithm.ConvexHull.prototype.lineOrPolygon=function(t){if(t=this.cleanRing(t),3==t.length)return this.geomFactory.createLineString([t[0],t[1]]);var e=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(e,null)},jsts.algorithm.ConvexHull.prototype.cleanRing=function(t){n.equals(t[0],t[t.length-1]);for(var e=new o,i=null,r=0;r<=t.length-2;r++){var s=t[r],a=t[r+1];s.equals(a)||null!=i&&this.isBetween(i,s,a)||(e.add(s),i=s)}e.add(t[t.length-1]);var l=[];return e.toArray(l)}}(),jsts.algorithm.MinimumDiameter=function(t,e){this.convexHullPts=null,this.minBaseSeg=new jsts.geom.LineSegment,this.minWidthPt=null,this.minPtIndex=0,this.minWidth=0,jsts.algorithm.MinimumDiameter.inputGeom=t,jsts.algorithm.MinimumDiameter.isConvex=e||!1},jsts.algorithm.MinimumDiameter.inputGeom=null,jsts.algorithm.MinimumDiameter.isConvex=!1,jsts.algorithm.MinimumDiameter.nextIndex=function(t,e){return e++,e>=t.length&&(e=0),e},jsts.algorithm.MinimumDiameter.computeC=function(t,e,n){return t*n.y-e*n.x},jsts.algorithm.MinimumDiameter.computeSegmentForLine=function(t,e,n){var i,o;return Math.abs(e)>Math.abs(t)?(i=new jsts.geom.Coordinate(0,n/e),o=new jsts.geom.Coordinate(1,n/e-t/e)):(i=new jsts.geom.Coordinate(n/t,0),o=new jsts.geom.Coordinate(n/t-e/t,1)),new jsts.geom.LineSegment(i,o)},jsts.algorithm.MinimumDiameter.prototype.getLength=function(){return this.computeMinimumDiameter(),this.minWidth},jsts.algorithm.MinimumDiameter.prototype.getWidthCoordinate=function(){return this.computeMinimumDiameter(),this.minWidthPt},jsts.algorithm.MinimumDiameter.prototype.getSupportingSegment=function(){this.computeMinimumDiameter();var t=[this.minBaseSeg.p0,this.minBaseSeg.p1];return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(t)},jsts.algorithm.MinimumDiameter.prototype.getDiameter=function(){if(this.computeMinimumDiameter(),null===this.minWidthPt)return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString(null);var t=this.minBaseSeg.project(this.minWidthPt);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLineString([t,this.minWidthPt])},jsts.algorithm.MinimumDiameter.prototype.computeMinimumDiameter=function(){if(null===this.minWidthPt)if(jsts.algorithm.MinimumDiameter.isConvex)this.computeWidthConvex(jsts.algorithm.MinimumDiameter.inputGeom);else{var t=new jsts.algorithm.ConvexHull(jsts.algorithm.MinimumDiameter.inputGeom).getConvexHull();this.computeWidthConvex(t)}},jsts.algorithm.MinimumDiameter.prototype.computeWidthConvex=function(t){t instanceof jsts.geom.Polygon?this.convexHullPts=t.getExteriorRing().getCoordinates():this.convexHullPts=t.getCoordinates(),0===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=null,this.minBaseSeg=null):1===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[0]):2===this.convexHullPts.length||3===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[1]):this.computeConvexRingMinDiameter(this.convexHullPts)},jsts.algorithm.MinimumDiameter.prototype.computeConvexRingMinDiameter=function(t){this.minWidth=Number.MAX_VALUE;for(var e=1,n=new jsts.geom.LineSegment,i=0;i<t.length-1;i++)n.p0=t[i],n.p1=t[i+1],e=this.findMaxPerpDistance(t,n,e)},jsts.algorithm.MinimumDiameter.prototype.findMaxPerpDistance=function(t,e,n){for(var i=e.distancePerpendicular(t[n]),o=i,r=n,s=r;o>=i;)i=o,r=s,s=jsts.algorithm.MinimumDiameter.nextIndex(t,r),o=e.distancePerpendicular(t[s]);return i<this.minWidth&&(this.minPtIndex=r,this.minWidth=i,this.minWidthPt=t[this.minPtIndex],this.minBaseSeg=new jsts.geom.LineSegment(e)),r},jsts.algorithm.MinimumDiameter.prototype.getMinimumRectangle=function(){if(this.computeMinimumDiameter(),0===this.minWidth)return this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)?jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPoint(this.minBaseSeg.p0):this.minBaseSeg.toGeometry(jsts.algorithm.MinimumDiameter.inputGeom.getFactory());for(var t=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x,e=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y,n=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=Number.MAX_VALUE,r=-Number.MAX_VALUE,s=0;s<this.convexHullPts.length;s++){var a=jsts.algorithm.MinimumDiameter.computeC(t,e,this.convexHullPts[s]);a>i&&(i=a),a<n&&(n=a);var l=jsts.algorithm.MinimumDiameter.computeC(-e,t,this.convexHullPts[s]);l>r&&(r=l),l<o&&(o=l)}var d=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-t,-e,r),c=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-t,-e,o),h=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-e,t,i),u=jsts.algorithm.MinimumDiameter.computeSegmentForLine(-e,t,n),p=h.lineIntersection(d),g=u.lineIntersection(d),m=u.lineIntersection(c),f=h.lineIntersection(c),y=jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createLinearRing([p,g,m,f,p]);return jsts.algorithm.MinimumDiameter.inputGeom.getFactory().createPolygon(y,null)},function(){jsts.io.GeoJSONParser=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.geometryTypes=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"]},jsts.io.GeoJSONParser.prototype.read=function(t){var e;e="string"==typeof t?JSON.parse(t):t;var n=e.type;if(!this.parse[n])throw new Error("Unknown GeoJSON type: "+e.type);return this.geometryTypes.indexOf(n)!=-1?this.parse[n].apply(this,[e.coordinates]):"GeometryCollection"===n?this.parse[n].apply(this,[e.geometries]):this.parse[n].apply(this,[e])},jsts.io.GeoJSONParser.prototype.parse={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!this.parse[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new jsts.geom.Coordinate(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new jsts.geom.Coordinate(t[0],t[1]),new jsts.geom.Coordinate(t[2],t[1]),new jsts.geom.Coordinate(t[2],t[3]),new jsts.geom.Coordinate(t[0],t[3]),new jsts.geom.Coordinate(t[0],t[1])])},Point:function(t){var e=new jsts.geom.Coordinate(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(this.parse.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=this.parse.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(this.parse.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=this.parse.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],o=1;o<t.length;++o){var r=t[o],s=this.parse.coordinates.apply(this,[r]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.parse.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},jsts.io.GeoJSONParser.prototype.write=function(t){var e=t.CLASS_NAME.slice(10);if(!this.extract[e])throw new Error("Geometry is not supported");return this.extract[e].apply(this,[t])},jsts.io.GeoJSONParser.prototype.extract={coordinate:function(t){return[t.x,t.y]},Point:function(t){var e=this.extract.coordinate.apply(this,[t.coordinate]);return{type:"Point",coordinates:e}},MultiPoint:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],o=this.extract.Point.apply(this,[i]);e.push(o.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=0;n<t.points.length;++n){var i=t.points[n];e.push(this.extract.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],o=this.extract.LineString.apply(this,[i]);e.push(o.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=this.extract.LineString.apply(this,[t.shell]);e.push(n.coordinates);for(var i=0;i<t.holes.length;++i){var o=t.holes[i],r=this.extract.LineString.apply(this,[o]);e.push(r.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],o=this.extract.Polygon.apply(this,[i]);e.push(o.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],o=i.CLASS_NAME.slice(10);e.push(this.extract[o].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}}}(),jsts.triangulate.quadedge.Vertex=function(){1===arguments.length?this.initFromCoordinate(arguments[0]):this.initFromXY(arguments[0],arguments[1])},jsts.triangulate.quadedge.Vertex.LEFT=0,jsts.triangulate.quadedge.Vertex.RIGHT=1,jsts.triangulate.quadedge.Vertex.BEYOND=2,jsts.triangulate.quadedge.Vertex.BEHIND=3,jsts.triangulate.quadedge.Vertex.BETWEEN=4,jsts.triangulate.quadedge.Vertex.ORIGIN=5,jsts.triangulate.quadedge.Vertex.DESTINATION=6,jsts.triangulate.quadedge.Vertex.prototype.initFromXY=function(t,e){this.p=new jsts.geom.Coordinate(t,e)},jsts.triangulate.quadedge.Vertex.prototype.initFromCoordinate=function(t){this.p=new jsts.geom.Coordinate(t)},jsts.triangulate.quadedge.Vertex.prototype.getX=function(){return this.p.x},jsts.triangulate.quadedge.Vertex.prototype.getY=function(){return this.p.y},jsts.triangulate.quadedge.Vertex.prototype.getZ=function(){return this.p.z},jsts.triangulate.quadedge.Vertex.prototype.setZ=function(t){this.p.z=t},jsts.triangulate.quadedge.Vertex.prototype.getCoordinate=function(){return this.p},jsts.triangulate.quadedge.Vertex.prototype.toString=function(){return"POINT ("+this.p.x+" "+this.p.y+")"},jsts.triangulate.quadedge.Vertex.prototype.equals=function(){return 1===arguments.length?this.equalsExact(arguments[0]):this.equalsWithTolerance(arguments[0],arguments[1])},jsts.triangulate.quadedge.Vertex.prototype.equalsExact=function(t){return this.p.x===t.getX()&&this.p.y===t.getY()},jsts.triangulate.quadedge.Vertex.prototype.equalsWithTolerance=function(t,e){return this.p.distance(t.getCoordinate())<e},jsts.triangulate.quadedge.Vertex.prototype.classify=function(t,e){var n,i,o,r;return n=this,i=e.sub(t),o=n.sub(t),r=i.crossProduct(o),r>0?jsts.triangulate.quadedge.Vertex.LEFT:r<0?jsts.triangulate.quadedge.Vertex.RIGHT:i.getX()*o.getX()<0||i.getY()*o.getY()<0?jsts.triangulate.quadedge.Vertex.BEHIND:i.magn()<o.magn()?jsts.triangulate.quadedge.Vertex.BEYOND:t.equals(n)?jsts.triangulate.quadedge.Vertex.ORIGIN:e.equals(n)?jsts.triangulate.quadedge.Vertex.DESTINATION:jsts.triangulate.quadedge.Vertex.BETWEEN},jsts.triangulate.quadedge.Vertex.prototype.crossProduct=function(t){return this.p.x*t.getY()-this.p.y*t.getX()},jsts.triangulate.quadedge.Vertex.prototype.dot=function(t){return this.p.x*t.getX()+this.p.y*t.getY()},jsts.triangulate.quadedge.Vertex.prototype.times=function(t){return new jsts.triangulate.quadedge.Vertex(t*this.p.x,t*this.p.y)},jsts.triangulate.quadedge.Vertex.prototype.sum=function(t){return new jsts.triangulate.quadedge.Vertex(this.p.x+t.getX(),this.p.y+t.getY())},jsts.triangulate.quadedge.Vertex.prototype.sub=function(t){return new jsts.triangulate.quadedge.Vertex(this.p.x-t.getX(),this.p.y-t.getY())},jsts.triangulate.quadedge.Vertex.prototype.magn=function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},jsts.triangulate.quadedge.Vertex.prototype.cross=function(){return new Vertex(this.p.y,(-this.p.x))},jsts.triangulate.quadedge.Vertex.prototype.isInCircle=function(t,e,n){return jsts.triangulate.quadedge.TrianglePredicate.isInCircleRobust(t.p,e.p,n.p,this.p)},jsts.triangulate.quadedge.Vertex.prototype.isCCW=function(t,e){return(t.p.x-this.p.x)*(e.p.y-this.p.y)-(t.p.y-this.p.y)*(e.p.x-this.p.x)>0},jsts.triangulate.quadedge.Vertex.prototype.rightOf=function(t){return this.isCCW(t.dest(),t.orig())},jsts.triangulate.quadedge.Vertex.prototype.leftOf=function(t){return this.isCCW(t.orig(),t.dest())},jsts.triangulate.quadedge.Vertex.prototype.bisector=function(t,e){var n,i,o,r;return n=e.getX()-t.getX(),i=e.getY()-t.getY(),o=new jsts.algorithm.HCoordinate(t.getX()+n/2,t.getY()+i/2,1),r=new jsts.algorithm.HCoordinate(t.getX()-i+n/2,t.getY()+n+i/2,1),new jsts.algorithm.HCoordinate(o,r)},jsts.triangulate.quadedge.Vertex.prototype.distance=function(t,e){return t.p.distance(e.p)},jsts.triangulate.quadedge.Vertex.prototype.circumRadiusRatio=function(t,e){var n,i,o,r;return n=this.circleCenter(t,e),i=this.distance(n,t),o=this.distance(this,t),r=this.distance(t,e),r<o&&(o=r),r=this.distance(e,this),r<o&&(o=r),i/o},jsts.triangulate.quadedge.Vertex.prototype.midPoint=function(t){var e,n;return e=(this.p.x+t.getX())/2,n=(this.p.y+t.getY())/2,new jsts.triangulate.quadedge.Vertex(e,n)},jsts.triangulate.quadedge.Vertex.prototype.circleCenter=function(t,e){var n,i,o,r,s;n=new jsts.triangulate.quadedge.Vertex(this.getX(),this.getY()),i=this.bisector(n,t),o=this.bisector(t,e),r=new jsts.algorithm.HCoordinate(i,o),s=null;try{s=new jsts.triangulate.quadedge.Vertex(r.getX(),r.getY())}catch(t){}return s},jsts.operation.valid.IsValidOp=function(t){this.parentGeometry=t,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null},jsts.operation.valid.IsValidOp.isValid=function(t){if(arguments[0]instanceof jsts.geom.Coordinate)return!isNaN(t.x)&&(!(!isFinite(t.x)&&!isNaN(t.x))&&(!isNaN(t.y)&&!(!isFinite(t.y)&&!isNaN(t.y))));var e=new jsts.operation.valid.IsValidOp(t);return e.isValid()},jsts.operation.valid.IsValidOp.findPtNotNode=function(t,e,n){for(var i=n.findEdge(e),o=i.getEdgeIntersectionList(),r=0;r<t.length;r++){var s=t[r];if(!o.isIntersection(s))return s}return null},jsts.operation.valid.IsValidOp.prototype.setSelfTouchingRingFormingHoleValid=function(t){this.isSelfTouchingRingFormingHoleValid=t},jsts.operation.valid.IsValidOp.prototype.isValid=function(){return this.checkValid(this.parentGeometry),null==this.validErr},jsts.operation.valid.IsValidOp.prototype.getValidationError=function(){return this.checkValid(this.parentGeometry),this.validErr},jsts.operation.valid.IsValidOp.prototype.checkValid=function(t){if(this.validErr=null,!t.isEmpty())if(t instanceof jsts.geom.Point)this.checkValidPoint(t);else if(t instanceof jsts.geom.MultiPoint)this.checkValidMultiPoint(t);else if(t instanceof jsts.geom.LinearRing)this.checkValidLinearRing(t);else if(t instanceof jsts.geom.LineString)this.checkValidLineString(t);else if(t instanceof jsts.geom.Polygon)this.checkValidPolygon(t);else if(t instanceof jsts.geom.MultiPolygon)this.checkValidMultiPolygon(t);else{if(!(t instanceof jsts.geom.GeometryCollection))throw t.constructor;this.checkValidGeometryCollection(t)}},jsts.operation.valid.IsValidOp.prototype.checkValidPoint=function(t){this.checkInvalidCoordinates(t.getCoordinates())},jsts.operation.valid.IsValidOp.prototype.checkValidMultiPoint=function(t){this.checkInvalidCoordinates(t.getCoordinates())},jsts.operation.valid.IsValidOp.prototype.checkValidLineString=function(t){if(this.checkInvalidCoordinates(t.getCoordinates()),null==this.validErr){var e=new jsts.geomgraph.GeometryGraph(0,t);this.checkTooFewPoints(e)}},jsts.operation.valid.IsValidOp.prototype.checkValidLinearRing=function(t){if(this.checkInvalidCoordinates(t.getCoordinates()),null==this.validErr&&(this.checkClosedRing(t),null==this.validErr)){var e=new jsts.geomgraph.GeometryGraph(0,t);if(this.checkTooFewPoints(e),null==this.validErr){var n=new jsts.algorithm.RobustLineIntersector;e.computeSelfNodes(n,!0),this.checkNoSelfIntersectingRings(e)}}},jsts.operation.valid.IsValidOp.prototype.checkValidPolygon=function(t){if(this.checkInvalidCoordinates(t),null==this.validErr&&(this.checkClosedRings(t),null==this.validErr)){var e=new jsts.geomgraph.GeometryGraph(0,t);this.checkTooFewPoints(e),null==this.validErr&&(this.checkConsistentArea(e),null==this.validErr&&(this.isSelfTouchingRingFormingHoleValid||(this.checkNoSelfIntersectingRings(e),null==this.validErr))&&(this.checkHolesInShell(t,e),null==this.validErr&&(this.checkHolesNotNested(t,e),
null==this.validErr&&this.checkConnectedInteriors(e))))}},jsts.operation.valid.IsValidOp.prototype.checkValidMultiPolygon=function(t){for(var e=t.getNumGeometries(),n=0;n<e;n++){var i=t.getGeometryN(n);if(this.checkInvalidCoordinates(i),null!=this.validErr)return;if(this.checkClosedRings(i),null!=this.validErr)return}var o=new jsts.geomgraph.GeometryGraph(0,t);if(this.checkTooFewPoints(o),null==this.validErr&&(this.checkConsistentArea(o),null==this.validErr&&(this.isSelfTouchingRingFormingHoleValid||(this.checkNoSelfIntersectingRings(o),null==this.validErr)))){for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);if(this.checkHolesInShell(i,o),null!=this.validErr)return}for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);if(this.checkHolesNotNested(i,o),null!=this.validErr)return}this.checkShellsNotNested(t,o),null==this.validErr&&this.checkConnectedInteriors(o)}},jsts.operation.valid.IsValidOp.prototype.checkValidGeometryCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(this.checkValid(n),null!=this.validErr)return}},jsts.operation.valid.IsValidOp.prototype.checkInvalidCoordinates=function(t){if(t instanceof jsts.geom.Polygon){var e=t;if(this.checkInvalidCoordinates(e.getExteriorRing().getCoordinates()),null!=this.validErr)return;for(var n=0;n<e.getNumInteriorRing();n++)if(this.checkInvalidCoordinates(e.getInteriorRingN(n).getCoordinates()),null!=this.validErr)return}else for(var i=t,n=0;n<i.length;n++)if(!jsts.operation.valid.IsValidOp.isValid(i[n]))return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.INVALID_COORDINATE,i[n]))},jsts.operation.valid.IsValidOp.prototype.checkClosedRings=function(t){if(this.checkClosedRing(t.getExteriorRing()),null==this.validErr)for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!=this.validErr)return},jsts.operation.valid.IsValidOp.prototype.checkClosedRing=function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_NOT_CLOSED,e)}},jsts.operation.valid.IsValidOp.prototype.checkTooFewPoints=function(t){if(t.hasTooFewPoints)return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.TOO_FEW_POINTS,t.getInvalidPoint()))},jsts.operation.valid.IsValidOp.prototype.checkConsistentArea=function(t){var e=new jsts.operation.valid.ConsistentAreaTester(t),n=e.isNodeConsistentArea();return n?void(e.hasDuplicateRings()&&(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DUPLICATE_RINGS,e.getInvalidPoint()))):void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.SELF_INTERSECTION,e.getInvalidPoint()))},jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRings=function(t){for(var e=t.getEdgeIterator();e.hasNext();){var n=e.next();if(this.checkNoSelfIntersectingRing(n.getEdgeIntersectionList()),null!=this.validErr)return}},jsts.operation.valid.IsValidOp.prototype.checkNoSelfIntersectingRing=function(t){for(var e=[],n=!0,i=t.iterator();i.hasNext();){var o=i.next();if(n)n=!1;else{if(e.indexOf(o.coord)>=0)return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.RING_SELF_INTERSECTION,o.coord));e.push(o.coord)}}},jsts.operation.valid.IsValidOp.prototype.checkHolesInShell=function(t,e){for(var n=t.getExteriorRing(),i=new jsts.algorithm.MCPointInRing(n),o=0;o<t.getNumInteriorRing();o++){var r=t.getInteriorRingN(o),s=jsts.operation.valid.IsValidOp.findPtNotNode(r.getCoordinates(),n,e);if(null==s)return;var a=!i.isInside(s);if(a)return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.HOLE_OUTSIDE_SHELL,s))}},jsts.operation.valid.IsValidOp.prototype.checkHolesNotNested=function(t,e){for(var n=new jsts.operation.valid.IndexedNestedRingTester(e),i=0;i<t.getNumInteriorRing();i++){var o=t.getInteriorRingN(i);n.add(o)}var r=n.isNonNested();r||(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_HOLES,n.getNestedPoint()))},jsts.operation.valid.IsValidOp.prototype.checkShellsNotNested=function(t,e){for(var n=0;n<t.getNumGeometries();n++)for(var i=t.getGeometryN(n),o=i.getExteriorRing(),r=0;r<t.getNumGeometries();r++)if(n!=r){var s=t.getGeometryN(r);if(this.checkShellNotNested(o,s,e),null!=this.validErr)return}};jsts.operation.valid.IsValidOp.prototype.checkShellNotNested=function(t,e,n){var i=t.getCoordinates(),o=e.getExteriorRing(),r=o.getCoordinates(),s=jsts.operation.valid.IsValidOp.findPtNotNode(i,o,n);if(null!=s){var a=jsts.algorithm.CGAlgorithms.isPointInRing(s,r);if(a){if(e.getNumInteriorRing()<=0)return void(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,s));for(var l=null,d=0;d<e.getNumInteriorRing();d++){var c=e.getInteriorRingN(d);if(l=this.checkShellInsideHole(t,c,n),null==l)return}this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.NESTED_SHELLS,l)}}};jsts.operation.valid.IsValidOp.prototype.checkShellInsideHole=function(t,e,n){var i=t.getCoordinates(),o=e.getCoordinates(),r=jsts.operation.valid.IsValidOp.findPtNotNode(i,e,n);if(null!=r){var s=jsts.algorithm.CGAlgorithms.isPointInRing(r,o);if(!s)return r}var a=jsts.operation.valid.IsValidOp.findPtNotNode(o,t,n);if(null!=a){var l=jsts.algorithm.CGAlgorithms.isPointInRing(a,i);return l?a:null}return jsts.util.Assert.shouldNeverReachHere("points in shell and hole appear to be equal"),null},jsts.operation.valid.IsValidOp.prototype.checkConnectedInteriors=function(t){var e=new jsts.operation.valid.ConnectedInteriorTester(t);e.isInteriorsConnected()||(this.validErr=new jsts.operation.valid.TopologyValidationError(jsts.operation.valid.TopologyValidationError.DISCONNECTED_INTERIOR,e.getCoordinate()))},jsts.algorithm.RobustDeterminant=function(){},jsts.algorithm.RobustDeterminant.signOfDet2x2=function(t,e,n,i){var o,r,s,a;if(a=0,o=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-o:o:n>0?o:-o;if(0===e||0===n)return i>0?t>0?o:-o:t>0?-o:o;if(0<e?0<i?e>i&&(o=-o,r=t,t=n,n=r,r=e,e=i,i=r):e<=-i?(o=-o,n=-n,i=-i):(r=t,t=-n,n=r,r=e,e=-i,i=r):0<i?-e<=i?(o=-o,t=-t,e=-e):(r=-t,t=n,n=r,r=-e,e=i,i=r):e>=i?(t=-t,e=-e,n=-n,i=-i):(o=-o,r=-t,t=-n,n=r,r=-e,e=-i,i=r),0<t){if(!(0<n))return o;if(t>n)return o}else{if(0<n)return-o;if(!(t>=n))return-o;o=-o,t=-t,n=-n}for(;;){if(a+=1,s=Math.floor(n/t),n-=s*t,i-=s*e,i<0)return-o;if(i>e)return o;if(t>n+n){if(e<i+i)return o}else{if(e>i+i)return-o;n=t-n,i=e-i,o=-o}if(0===i)return 0===n?0:-o;if(0===n)return o;if(s=Math.floor(t/n),t-=s*n,e-=s*i,e<0)return o;if(e>i)return-o;if(n>t+t){if(i<e+e)return-o}else{if(i>e+e)return o;t=n-t,e=i-e,o=-o}if(0===e)return 0===t?0:o;if(0===t)return-o}},jsts.algorithm.RobustDeterminant.orientationIndex=function(t,e,n){var i=e.x-t.x,o=e.y-t.y,r=n.x-e.x,s=n.y-e.y;return jsts.algorithm.RobustDeterminant.signOfDet2x2(i,o,r,s)},jsts.index.quadtree.NodeBase=function(){this.subnode=new Array(4),this.subnode[0]=null,this.subnode[1]=null,this.subnode[2]=null,this.subnode[3]=null,this.items=[]},jsts.index.quadtree.NodeBase.prototype.getSubnodeIndex=function(t,e){var n=-1;return t.getMinX()>=e.x&&(t.getMinY()>=e.y&&(n=3),t.getMaxY()<=e.y&&(n=1)),t.getMaxX()<=e.x&&(t.getMinY()>=e.y&&(n=2),t.getMaxY()<=e.y&&(n=0)),n},jsts.index.quadtree.NodeBase.prototype.getItems=function(){return this.items},jsts.index.quadtree.NodeBase.prototype.hasItems=function(){return this.items.length>0},jsts.index.quadtree.NodeBase.prototype.add=function(t){this.items.push(t)},jsts.index.quadtree.NodeBase.prototype.remove=function(t,e){if(!this.isSearchMatch(t))return!1;var n=!1,i=0;for(i;i<4;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}if(n)return n;if(this.items.indexOf(e)!==-1){for(var i=this.items.length-1;i>=0;i--)this.items[i]===e&&this.items.splice(i,1);n=!0}return n},jsts.index.quadtree.NodeBase.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems())},jsts.index.quadtree.NodeBase.prototype.hasChildren=function(){var t=0;for(t;t<4;t++)if(null!==this.subnode[t])return!0;return!1},jsts.index.quadtree.NodeBase.prototype.isEmpty=function(){var t=!0;this.items.length>0&&(t=!1);var e=0;for(e;e<4;e++)null!==this.subnode[e]&&(this.subnode[e].isEmpty()||(t=!1));return t},jsts.index.quadtree.NodeBase.prototype.addAllItems=function(t){t=t.concat(this.items);var e=0;for(e;e<4;e++)null!==this.subnode[e]&&(t=this.subnode[e].addAllItems(t));return t},jsts.index.quadtree.NodeBase.prototype.addAllItemsFromOverlapping=function(t,e){if(this.isSearchMatch(t)){e=e.concat(this.items);var n=0;for(n;n<4;n++)null!==this.subnode[n]&&(e=this.subnode[n].addAllItemsFromOverlapping(t,e))}},jsts.index.quadtree.NodeBase.prototype.visit=function(t,e){if(this.isSearchMatch(t)){this.visitItems(t,e);var n=0;for(n;n<4;n++)null!==this.subnode[n]&&this.subnode[n].visit(t,e)}},jsts.index.quadtree.NodeBase.prototype.visitItems=function(t,e){var n=0,i=this.items.length;for(n;n<i;n++)e.visitItem(this.items[n])},jsts.index.quadtree.NodeBase.prototype.depth=function(){var t,e=0,n=0;for(n;n<4;n++)null!==this.subnode[n]&&(t=this.subnode[n].depth(),t>e&&(e=t));return e+1},jsts.index.quadtree.NodeBase.prototype.size=function(){var t=0,e=0;for(e;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.length},jsts.index.quadtree.NodeBase.prototype.getNodeCount=function(){var t=0,e=0;for(e;e<4;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+1},jsts.index.quadtree.Node=function(t,e){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments),this.env=t,this.level=e,this.centre=new jsts.geom.Coordinate,this.centre.x=(t.getMinX()+t.getMaxX())/2,this.centre.y=(t.getMinY()+t.getMaxY())/2},jsts.index.quadtree.Node.prototype=new jsts.index.quadtree.NodeBase,jsts.index.quadtree.Node.createNode=function(t){var e,n;return e=new jsts.index.quadtree.Key(t),n=new jsts.index.quadtree.Node(e.getEnvelope(),e.getLevel())},jsts.index.quadtree.Node.createExpanded=function(t,e){var n,i=new jsts.geom.Envelope(e);return null!==t&&i.expandToInclude(t.env),n=jsts.index.quadtree.Node.createNode(i),null!==t&&n.insertNode(t),n},jsts.index.quadtree.Node.prototype.getEnvelope=function(){return this.env},jsts.index.quadtree.Node.prototype.isSearchMatch=function(t){return this.env.intersects(t)},jsts.index.quadtree.Node.prototype.getNode=function(t){var e,n=this.getSubnodeIndex(t,this.centre);return n!==-1?(e=this.getSubnode(n),e.getNode(t)):this},jsts.index.quadtree.Node.prototype.find=function(t){var e,n=this.getSubnodeIndex(t,this.centre);return n===-1?this:null!==this.subnode[n]?(e=this.subnode[n],e.find(t)):this},jsts.index.quadtree.Node.prototype.insertNode=function(t){var e,n=this.getSubnodeIndex(t.env,this.centre);t.level===this.level-1?this.subnode[n]=t:(e=this.createSubnode(n),e.insertNode(t),this.subnode[n]=e)},jsts.index.quadtree.Node.prototype.getSubnode=function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},jsts.index.quadtree.Node.prototype.createSubnode=function(t){var e,n,i=0,o=0,r=0,s=0;switch(t){case 0:i=this.env.getMinX(),o=this.centre.x,r=this.env.getMinY(),s=this.centre.y;break;case 1:i=this.centre.x,o=this.env.getMaxX(),r=this.env.getMinY(),s=this.centre.y;break;case 2:i=this.env.getMinX(),o=this.centre.x,r=this.centre.y,s=this.env.getMaxY();break;case 3:i=this.centre.x,o=this.env.getMaxX(),r=this.centre.y,s=this.env.getMaxY()}return e=new jsts.geom.Envelope(i,o,r,s),n=new jsts.index.quadtree.Node(e,this.level-1)},function(){jsts.triangulate.quadedge.QuadEdge=function(){this.rot=null,this.vertex=null,this.next=null,this.data=null};var t=jsts.triangulate.quadedge.QuadEdge;jsts.triangulate.quadedge.QuadEdge.makeEdge=function(e,n){var i,o,r,s,a;return i=new t,o=new t,r=new t,s=new t,i.rot=o,o.rot=r,r.rot=s,s.rot=i,i.setNext(i),o.setNext(s),r.setNext(r),s.setNext(o),a=i,a.setOrig(e),a.setDest(n),a},jsts.triangulate.quadedge.QuadEdge.connect=function(e,n){var i=t.makeEdge(e.dest(),n.orig());return t.splice(i,e.lNext()),t.splice(i.sym(),n),i},jsts.triangulate.quadedge.QuadEdge.splice=function(t,e){var n,i,o,r,s,a;n=t.oNext().rot,i=e.oNext().rot,o=e.oNext(),r=t.oNext(),s=i.oNext(),a=n.oNext(),t.setNext(o),e.setNext(r),n.setNext(s),i.setNext(a)},jsts.triangulate.quadedge.QuadEdge.swap=function(e){var n,i;n=e.oPrev(),i=e.sym().oPrev(),t.splice(e,n),t.splice(e.sym(),i),t.splice(e,n.lNext()),t.splice(e.sym(),i.lNext()),e.setOrig(n.dest()),e.setDest(i.dest())},jsts.triangulate.quadedge.QuadEdge.prototype.getPrimary=function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},jsts.triangulate.quadedge.QuadEdge.prototype.setData=function(t){this.data=t},jsts.triangulate.quadedge.QuadEdge.prototype.getData=function(){return this.data},jsts.triangulate.quadedge.QuadEdge.prototype.delete_jsts=function(){this.rot=null},jsts.triangulate.quadedge.QuadEdge.prototype.isLive=function(){return null!==this.rot},jsts.triangulate.quadedge.QuadEdge.prototype.setNext=function(t){this.next=t},jsts.triangulate.quadedge.QuadEdge.prototype.invRot=function(){return this.rot.sym()},jsts.triangulate.quadedge.QuadEdge.prototype.sym=function(){return this.rot.rot},jsts.triangulate.quadedge.QuadEdge.prototype.oNext=function(){return this.next},jsts.triangulate.quadedge.QuadEdge.prototype.oPrev=function(){return this.rot.next.rot},jsts.triangulate.quadedge.QuadEdge.prototype.dNext=function(){return this.sym().oNext().sym()},jsts.triangulate.quadedge.QuadEdge.prototype.dPrev=function(){return this.invRot().oNext().invRot()},jsts.triangulate.quadedge.QuadEdge.prototype.lNext=function(){return this.invRot().oNext().rot},jsts.triangulate.quadedge.QuadEdge.prototype.lPrev=function(){return this.next.sym()},jsts.triangulate.quadedge.QuadEdge.prototype.rNext=function(){return this.rot.next.invRot()},jsts.triangulate.quadedge.QuadEdge.prototype.rPrev=function(){return this.sym().oNext()},jsts.triangulate.quadedge.QuadEdge.prototype.setOrig=function(t){this.vertex=t},jsts.triangulate.quadedge.QuadEdge.prototype.setDest=function(t){this.sym().setOrig(t)},jsts.triangulate.quadedge.QuadEdge.prototype.orig=function(){return this.vertex},jsts.triangulate.quadedge.QuadEdge.prototype.dest=function(){return this.sym().orig()},jsts.triangulate.quadedge.QuadEdge.prototype.getLength=function(){return this.orig().getCoordinate().distance(dest().getCoordinate())},jsts.triangulate.quadedge.QuadEdge.prototype.equalsNonOriented=function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())},jsts.triangulate.quadedge.QuadEdge.prototype.equalsOriented=function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},jsts.triangulate.quadedge.QuadEdge.prototype.toLineSegment=function(){return new jsts.geom.LineSegment(this.vertex.getCoordinate(),this.dest().getCoordinate())},jsts.triangulate.quadedge.QuadEdge.prototype.toString=function(){var t,e;return t=this.vertex.getCoordinate(),e=this.dest().getCoordinate(),jsts.io.WKTWriter.toLineString(t,e)}}(),function(){var t=jsts.util.Assert;jsts.geomgraph.EdgeEnd=function(t,e,n,i){this.edge=t,e&&n&&this.init(e,n),i&&(this.label=i||null)},jsts.geomgraph.EdgeEnd.prototype.edge=null,jsts.geomgraph.EdgeEnd.prototype.label=null,jsts.geomgraph.EdgeEnd.prototype.node=null,jsts.geomgraph.EdgeEnd.prototype.p0=null,jsts.geomgraph.EdgeEnd.prototype.p1=null,jsts.geomgraph.EdgeEnd.prototype.dx=null,jsts.geomgraph.EdgeEnd.prototype.dy=null,jsts.geomgraph.EdgeEnd.prototype.quadrant=null,jsts.geomgraph.EdgeEnd.prototype.init=function(e,n){this.p0=e,this.p1=n,this.dx=n.x-e.x,this.dy=n.y-e.y,this.quadrant=jsts.geomgraph.Quadrant.quadrant(this.dx,this.dy),t.isTrue(!(0===this.dx&&0===this.dy),"EdgeEnd with identical endpoints found")},jsts.geomgraph.EdgeEnd.prototype.getEdge=function(){return this.edge},jsts.geomgraph.EdgeEnd.prototype.getLabel=function(){return this.label},jsts.geomgraph.EdgeEnd.prototype.getCoordinate=function(){return this.p0},jsts.geomgraph.EdgeEnd.prototype.getDirectedCoordinate=function(){return this.p1},jsts.geomgraph.EdgeEnd.prototype.getQuadrant=function(){return this.quadrant},jsts.geomgraph.EdgeEnd.prototype.getDx=function(){return this.dx},jsts.geomgraph.EdgeEnd.prototype.getDy=function(){return this.dy},jsts.geomgraph.EdgeEnd.prototype.setNode=function(t){this.node=t},jsts.geomgraph.EdgeEnd.prototype.getNode=function(){return this.node},jsts.geomgraph.EdgeEnd.prototype.compareTo=function(t){return this.compareDirection(t)},jsts.geomgraph.EdgeEnd.prototype.compareDirection=function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:jsts.algorithm.CGAlgorithms.computeOrientation(t.p0,t.p1,this.p1)},jsts.geomgraph.EdgeEnd.prototype.computeLabel=function(t){}}(),jsts.operation.buffer.RightmostEdgeFinder=function(){},jsts.operation.buffer.RightmostEdgeFinder.prototype.minIndex=-1,jsts.operation.buffer.RightmostEdgeFinder.prototype.minCoord=null,jsts.operation.buffer.RightmostEdgeFinder.prototype.minDe=null,jsts.operation.buffer.RightmostEdgeFinder.prototype.orientedDe=null,jsts.operation.buffer.RightmostEdgeFinder.prototype.getEdge=function(){return this.orientedDe},jsts.operation.buffer.RightmostEdgeFinder.prototype.getCoordinate=function(){return this.minCoord},jsts.operation.buffer.RightmostEdgeFinder.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}jsts.util.Assert.isTrue(0!==this.minIndex||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this.minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe;var i=this.getRightmostSide(this.minDe,this.minIndex);i==jsts.geomgraph.Position.LEFT&&(this.orientedDe=this.minDe.getSym())},jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtNode=function(){var t=this.minDe.getNode(),e=t.getEdges();this.minDe=e.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},jsts.operation.buffer.RightmostEdgeFinder.prototype.findRightmostEdgeAtVertex=function(){var t=this.minDe.getEdge().getCoordinates();jsts.util.Assert.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this.minIndex-1],n=t[this.minIndex+1],i=jsts.algorithm.CGAlgorithms.computeOrientation(this.minCoord,n,e),o=!1;e.y<this.minCoord.y&&n.y<this.minCoord.y&&i===jsts.algorithm.CGAlgorithms.COUNTERCLOCKWISE?o=!0:e.y>this.minCoord.y&&n.y>this.minCoord.y&&i===jsts.algorithm.CGAlgorithms.CLOCKWISE&&(o=!0),o&&(this.minIndex=this.minIndex-1)},jsts.operation.buffer.RightmostEdgeFinder.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this.minCoord||e[n].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=n,this.minCoord=e[n])},jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),n},jsts.operation.buffer.RightmostEdgeFinder.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge(),i=n.getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y==i[e+1].y)return-1;var o=jsts.geomgraph.Position.LEFT;return i[e].y<i[e+1].y&&(o=jsts.geomgraph.Position.RIGHT),o},function(){jsts.triangulate.IncrementalDelaunayTriangulator=function(t){this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0},jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSites=function(t){var e,n=0,i=t.length;for(n;n<i;n++)e=t[n],this.insertSite(e)},jsts.triangulate.IncrementalDelaunayTriangulator.prototype.insertSite=function(t){var e,n,i,o;if(e=this.subdiv.locate(t),this.subdiv.isVertexOfEdge(e,t))return e;this.subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this.subdiv.delete_jsts(e.oNext())),n=this.subdiv.makeEdge(e.orig(),t),jsts.triangulate.quadedge.QuadEdge.splice(n,e),i=n;do n=this.subdiv.connect(e,n.sym()),e=n.oPrev();while(e.lNext()!=i);for(;;)if(o=e.oPrev(),o.dest().rightOf(e)&&t.isInCircle(e.orig(),o.dest(),e.dest()))jsts.triangulate.quadedge.QuadEdge.swap(e),e=e.oPrev();else{if(e.oNext()==i)return n;e=e.oNext().lPrev()}}}(),jsts.algorithm.CentroidArea=function(){this.basePt=null,this.triangleCent3=new jsts.geom.Coordinate,this.centSum=new jsts.geom.Coordinate,this.cg3=new jsts.geom.Coordinate},jsts.algorithm.CentroidArea.prototype.basePt=null,jsts.algorithm.CentroidArea.prototype.triangleCent3=null,jsts.algorithm.CentroidArea.prototype.areasum2=0,jsts.algorithm.CentroidArea.prototype.cg3=null,jsts.algorithm.CentroidArea.prototype.centSum=null,jsts.algorithm.CentroidArea.prototype.totalLength=0,jsts.algorithm.CentroidArea.prototype.add=function(t){if(t instanceof jsts.geom.Polygon){var e=t;this.setBasePoint(e.getExteriorRing().getCoordinateN(0)),this.add3(e)}else if(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPolygon)for(var n=t,i=0;i<n.getNumGeometries();i++)this.add(n.getGeometryN(i));else t instanceof Array&&this.add2(t)},jsts.algorithm.CentroidArea.prototype.add2=function(t){this.setBasePoint(t[0]),this.addShell(t)},jsts.algorithm.CentroidArea.prototype.getCentroid=function(){var t=new jsts.geom.Coordinate;return Math.abs(this.areasum2)>0?(t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2):(t.x=this.centSum.x/this.totalLength,t.y=this.centSum.y/this.totalLength),t},jsts.algorithm.CentroidArea.prototype.setBasePoint=function(t){null==this.basePt&&(this.basePt=t)},jsts.algorithm.CentroidArea.prototype.add3=function(t){this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())},jsts.algorithm.CentroidArea.prototype.addShell=function(t){for(var e=!jsts.algorithm.CGAlgorithms.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.basePt,t[n],t[n+1],e);this.addLinearSegments(t)},jsts.algorithm.CentroidArea.prototype.addHole=function(t){for(var e=jsts.algorithm.CGAlgorithms.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.basePt,t[n],t[n+1],e);this.addLinearSegments(t)},jsts.algorithm.CentroidArea.prototype.addTriangle=function(t,e,n,i){var o=i?1:-1;jsts.algorithm.CentroidArea.centroid3(t,e,n,this.triangleCent3);var r=jsts.algorithm.CentroidArea.area2(t,e,n);this.cg3.x+=o*r*this.triangleCent3.x,this.cg3.y+=o*r*this.triangleCent3.y,this.areasum2+=o*r},jsts.algorithm.CentroidArea.centroid3=function(t,e,n,i){i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y},jsts.algorithm.CentroidArea.area2=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},jsts.algorithm.CentroidArea.prototype.addLinearSegments=function(t){for(var e=0;e<t.length-1;e++){var n=t[e].distance(t[e+1]);this.totalLength+=n;var i=(t[e].x+t[e+1].x)/2;this.centSum.x+=n*i;var o=(t[e].y+t[e+1].y)/2;this.centSum.y+=n*o}},jsts.geomgraph.index.SweepLineSegment=function(t,e){this.edge=t,this.ptIndex=e,this.pts=t.getCoordinates()},jsts.geomgraph.index.SweepLineSegment.prototype.edge=null,jsts.geomgraph.index.SweepLineSegment.prototype.pts=null,jsts.geomgraph.index.SweepLineSegment.prototype.ptIndex=null,jsts.geomgraph.index.SweepLineSegment.prototype.getMinX=function(){var t=this.pts[this.ptIndex].x,e=this.pts[this.ptIndex+1].x;return t<e?t:e},jsts.geomgraph.index.SweepLineSegment.prototype.getMaxX=function(){var t=this.pts[this.ptIndex].x,e=this.pts[this.ptIndex+1].x;return t>e?t:e},jsts.geomgraph.index.SweepLineSegment.prototype.computeIntersections=function(t,e){e.addIntersections(this.edge,this.ptIndex,t.edge,t.ptIndex)},jsts.index.quadtree.Root=function(){jsts.index.quadtree.NodeBase.prototype.constructor.apply(this,arguments),this.origin=new jsts.geom.Coordinate(0,0)},jsts.index.quadtree.Root.prototype=new jsts.index.quadtree.NodeBase,jsts.index.quadtree.Root.prototype.insert=function(t,e){var n=this.getSubnodeIndex(t,this.origin);if(n===-1)return void this.add(e);var i=this.subnode[n];if(null===i||!i.getEnvelope().contains(t)){var o=jsts.index.quadtree.Node.createExpanded(i,t);this.subnode[n]=o}this.insertContained(this.subnode[n],t,e)},jsts.index.quadtree.Root.prototype.insertContained=function(t,e,n){var i,o,r;i=jsts.index.IntervalSize.isZeroWidth(e.getMinX(),e.getMaxX()),o=jsts.index.IntervalSize.isZeroWidth(e.getMinY(),e.getMaxY()),r=i||o?t.find(e):t.getNode(e),r.add(n)},jsts.index.quadtree.Root.prototype.isSearchMatch=function(t){return!0},jsts.geomgraph.index.MonotoneChainIndexer=function(){},jsts.geomgraph.index.MonotoneChainIndexer.toIntArray=function(t){for(var e=[],n=t.iterator();n.hasNext();){var i=n.next();e.push(i)}return e},jsts.geomgraph.index.MonotoneChainIndexer.prototype.getChainStartIndices=function(t){var e=0,n=new javascript.util.ArrayList;n.add(e);do{var i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);var o=jsts.geomgraph.index.MonotoneChainIndexer.toIntArray(n);return o},jsts.geomgraph.index.MonotoneChainIndexer.prototype.findChainEnd=function(t,e){for(var n=jsts.geomgraph.Quadrant.quadrant(t[e],t[e+1]),i=e+1;i<t.length;){var o=jsts.geomgraph.Quadrant.quadrant(t[i-1],t[i]);if(o!=n)break;i++}return i-1},jsts.noding.IntersectionAdder=function(t){this.li=t},jsts.noding.IntersectionAdder.prototype=new jsts.noding.SegmentIntersector,jsts.noding.IntersectionAdder.constructor=jsts.noding.IntersectionAdder,jsts.noding.IntersectionAdder.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},jsts.noding.IntersectionAdder.prototype._hasIntersection=!1,jsts.noding.IntersectionAdder.prototype.hasProper=!1,jsts.noding.IntersectionAdder.prototype.hasProperInterior=!1,jsts.noding.IntersectionAdder.prototype.hasInterior=!1,jsts.noding.IntersectionAdder.prototype.properIntersectionPoint=null,jsts.noding.IntersectionAdder.prototype.li=null,jsts.noding.IntersectionAdder.prototype.isSelfIntersection=null,jsts.noding.IntersectionAdder.prototype.numIntersections=0,jsts.noding.IntersectionAdder.prototype.numInteriorIntersections=0,jsts.noding.IntersectionAdder.prototype.numProperIntersections=0,jsts.noding.IntersectionAdder.prototype.numTests=0,jsts.noding.IntersectionAdder.prototype.getLineIntersector=function(){return this.li},jsts.noding.IntersectionAdder.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint},jsts.noding.IntersectionAdder.prototype.hasIntersection=function(){return this._hasIntersection},jsts.noding.IntersectionAdder.prototype.hasProperIntersection=function(){return this.hasProper},jsts.noding.IntersectionAdder.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior},jsts.noding.IntersectionAdder.prototype.hasInteriorIntersection=function(){return this.hasInterior},jsts.noding.IntersectionAdder.prototype.isTrivialIntersection=function(t,e,n,i){if(t==n&&1==this.li.getIntersectionNum()){if(jsts.noding.IntersectionAdder.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var o=t.size()-1;if(0===e&&i===o||0===i&&e===o)return!0}}return!1},jsts.noding.IntersectionAdder.prototype.processIntersections=function(t,e,n,i){if(t!==n||e!==i){this.numTests++;var o=t.getCoordinates()[e],r=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(o,r,s,a),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))}},jsts.noding.IntersectionAdder.prototype.isDone=function(){return!1},jsts.operation.union.CascadedPolygonUnion=function(t){this.inputPolys=t},jsts.operation.union.CascadedPolygonUnion.union=function(t){var e=new jsts.operation.union.CascadedPolygonUnion(t);return e.union()},jsts.operation.union.CascadedPolygonUnion.prototype.inputPolys,jsts.operation.union.CascadedPolygonUnion.prototype.geomFactory=null,jsts.operation.union.CascadedPolygonUnion.prototype.STRTREE_NODE_CAPACITY=4,jsts.operation.union.CascadedPolygonUnion.prototype.union=function(){if(0===this.inputPolys.length)return null;this.geomFactory=this.inputPolys[0].getFactory();for(var t=new jsts.index.strtree.STRtree(this.STRTREE_NODE_CAPACITY),e=0,n=this.inputPolys.length;e<n;e++){var i=this.inputPolys[e];t.insert(i.getEnvelopeInternal(),i)}var o=t.itemsTree(),r=this.unionTree(o);return r},jsts.operation.union.CascadedPolygonUnion.prototype.unionTree=function(t){var e=this.reduceToGeometries(t),n=this.binaryUnion(e);return n},jsts.operation.union.CascadedPolygonUnion.prototype.binaryUnion=function(t,e,n){if(e=e||0,n=n||t.length,n-e<=1){var i=this.getGeometry(t,e);return this.unionSafe(i,null)}if(n-e===2)return this.unionSafe(this.getGeometry(t,e),this.getGeometry(t,e+1));var o=parseInt((n+e)/2),i=this.binaryUnion(t,e,o),r=this.binaryUnion(t,o,n);return this.unionSafe(i,r)},jsts.operation.union.CascadedPolygonUnion.prototype.getGeometry=function(t,e){return e>=t.length?null:t[e]},jsts.operation.union.CascadedPolygonUnion.prototype.reduceToGeometries=function(t){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n],r=null;o instanceof Array?r=this.unionTree(o):o instanceof jsts.geom.Geometry&&(r=o),e.push(r)}return e},jsts.operation.union.CascadedPolygonUnion.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.clone():null===e?t.clone():this.unionOptimized(t,e)},jsts.operation.union.CascadedPolygonUnion.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i)){var o=jsts.geom.util.GeometryCombiner.combine(t,e);return o}if(t.getNumGeometries<=1&&e.getNumGeometries<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},jsts.operation.union.CascadedPolygonUnion.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new javascript.util.ArrayList,o=this.extractByEnvelope(n,t,i),r=this.extractByEnvelope(n,e,i),s=this.unionActual(o,r);i.add(s);var a=jsts.geom.util.GeometryCombiner.combine(i);return a},jsts.operation.union.CascadedPolygonUnion.prototype.extractByEnvelope=function(t,e,n){for(var i=new javascript.util.ArrayList,o=0;o<e.getNumGeometries();o++){var r=e.getGeometryN(o);r.getEnvelopeInternal().intersects(t)?i.add(r):n.add(r)}return this.geomFactory.buildGeometry(i)},jsts.operation.union.CascadedPolygonUnion.prototype.unionActual=function(t,e){return t.union(e)},function(){jsts.geom.MultiPoint=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.MultiPoint.prototype=new jsts.geom.GeometryCollection,jsts.geom.MultiPoint.constructor=jsts.geom.MultiPoint,jsts.geom.MultiPoint.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},jsts.geom.MultiPoint.prototype.getGeometryN=function(t){return this.geometries[t]},jsts.geom.MultiPoint.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&jsts.geom.GeometryCollection.prototype.equalsExact.call(this,t,e)},jsts.geom.MultiPoint.prototype.CLASS_NAME="jsts.geom.MultiPoint"}(),jsts.operation.buffer.OffsetCurveBuilder=function(t,e){this.precisionModel=t,this.bufParams=e},jsts.operation.buffer.OffsetCurveBuilder.prototype.distance=0,jsts.operation.buffer.OffsetCurveBuilder.prototype.precisionModel=null,jsts.operation.buffer.OffsetCurveBuilder.prototype.bufParams=null,jsts.operation.buffer.OffsetCurveBuilder.prototype.getBufferParameters=function(){
return this.bufParams},jsts.operation.buffer.OffsetCurveBuilder.prototype.getLineCurve=function(t,e){if(this.distance=e,this.distance<0&&!this.bufParams.isSingleSided())return null;if(0==this.distance)return null;var n=Math.abs(this.distance),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this.bufParams.isSingleSided()){var o=e<0;this.computeSingleSidedBufferCurve(t,o,i)}else this.computeLineBufferCurve(t,i);var r=i.getCoordinates();return r},jsts.operation.buffer.OffsetCurveBuilder.prototype.getRingCurve=function(t,e,n){if(this.distance=n,t.length<=2)return this.getLineCurve(t,n);if(0==this.distance)return jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates(t);var i=this.getSegGen(this.distance);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},jsts.operation.buffer.OffsetCurveBuilder.prototype.getOffsetCurve=function(t,e){if(this.distance=e,0===this.distance)return null;var n=this.distance<0,i=Math.abs(this.distance),o=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],o):this.computeOffsetCurve(t,n,o);var r=o.getCoordinates();return n&&r.reverse(),r},jsts.operation.buffer.OffsetCurveBuilder.copyCoordinates=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].clone());return e},jsts.operation.buffer.OffsetCurveBuilder.prototype.getSegGen=function(t){return new jsts.operation.buffer.OffsetSegmentGenerator(this.precisionModel,this.bufParams,t)},jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR=100,jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance=function(t){return t/jsts.operation.buffer.OffsetCurveBuilder.SIMPLIFY_FACTOR},jsts.operation.buffer.OffsetCurveBuilder.prototype.computePointCurve=function(t,e){switch(this.bufParams.getEndCapStyle()){case jsts.operation.buffer.BufferParameters.CAP_ROUND:e.createCircle(t);break;case jsts.operation.buffer.BufferParameters.CAP_SQUARE:e.createSquare(t)}},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeLineBufferCurve=function(t,e){var n=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance),i=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,n),o=i.length-1;e.initSideSegments(i[0],i[1],jsts.geomgraph.Position.LEFT);for(var r=2;r<=o;r++)e.addNextSegment(i[r],!0);e.addLastSegment(),e.addLineEndCap(i[o-1],i[o]);var s=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],jsts.geomgraph.Position.LEFT);for(var r=a-2;r>=0;r--)e.addNextSegment(s[r],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(e){n.addSegments(t,!0);var o=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,-i),r=o.length-1;n.initSideSegments(o[r],o[r-1],jsts.geomgraph.Position.LEFT),n.addFirstSegment();for(var s=r-2;s>=0;s--)n.addNextSegment(o[s],!0)}else{n.addSegments(t,!1);var a=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],jsts.geomgraph.Position.LEFT),n.addFirstSegment();for(var s=2;s<=l;s++)n.addNextSegment(a[s],!0)}n.addLastSegment(),n.closeRing()},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeOffsetCurve=function(t,e,n){var i=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);if(e){var o=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,-i),r=o.length-1;n.initSideSegments(o[r],o[r-1],jsts.geomgraph.Position.LEFT),n.addFirstSegment();for(var s=r-2;s>=0;s--)n.addNextSegment(o[s],!0)}else{var a=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],jsts.geomgraph.Position.LEFT),n.addFirstSegment();for(var s=2;s<=l;s++)n.addNextSegment(a[s],!0)}n.addLastSegment()},jsts.operation.buffer.OffsetCurveBuilder.prototype.computeRingBufferCurve=function(t,e,n){var i=jsts.operation.buffer.OffsetCurveBuilder.simplifyTolerance(this.distance);e===jsts.geomgraph.Position.RIGHT&&(i=-i);var o=jsts.operation.buffer.BufferInputLineSimplifier.simplify(t,i),r=o.length-1;n.initSideSegments(o[r-1],o[0],e);for(var s=1;s<=r;s++){var a=1!==s;n.addNextSegment(o[s],a)}n.closeRing()},function(){var t=function(t,e,n){this.hotPixel=t,this.parentEdge=e,this.vertexIndex=n};t.prototype=new jsts.index.chain.MonotoneChainSelectAction,t.constructor=t,t.prototype.hotPixel=null,t.prototype.parentEdge=null,t.prototype.vertexIndex=null,t.prototype._isNodeAdded=!1,t.prototype.isNodeAdded=function(){return this._isNodeAdded},t.prototype.select=function(t,e){var n=t.getContext();null!==this.parentEdge&&n===this.parentEdge&&e===this.vertexIndex||(this._isNodeAdded=this.hotPixel.addSnappedNode(n,e))},jsts.noding.snapround.MCIndexPointSnapper=function(t){this.index=t},jsts.noding.snapround.MCIndexPointSnapper.prototype.index=null,jsts.noding.snapround.MCIndexPointSnapper.prototype.snap=function(e,n,i){if(1===arguments.length)return void this.snap2.apply(this,arguments);var o=e.getSafeEnvelope(),r=new t(e,n,i);return this.index.query(o,{visitItem:function(t){t.select(o,r)}}),r.isNodeAdded()},jsts.noding.snapround.MCIndexPointSnapper.prototype.snap2=function(t){return this.snap(t,null,-1)}}(),function(){var t=function(){this.items=new javascript.util.ArrayList,this.subnode=[null,null]};t.getSubnodeIndex=function(t,e){var n=-1;return t.min>=e&&(n=1),t.max<=e&&(n=0),n},t.prototype.getItems=function(){return this.items},t.prototype.add=function(t){this.items.add(t)},t.prototype.addAllItems=function(t){t.addAll(this.items);var e=0,n=2;for(e;e<n;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},t.prototype.addAllItemsFromOverlapping=function(t,e){(null===t||this.isSearchMatch(t))&&(e.addAll(this.items),null!==this.subnode[0]&&this.subnode[0].addAllItemsFromOverlapping(t,e),null!==this.subnode[1]&&this.subnode[1].addAllItemsFromOverlapping(t,e))},t.prototype.remove=function(t,e){if(!this.isSearchMatch(t))return!1;var n=!1,i=0,o=2;for(i;i<o;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n?n:n=this.items.remove(e)},t.prototype.isPrunable=function(){return!(this.hasChildren()||this.hasItems())},t.prototype.hasChildren=function(){var t=0,e=2;for(t;t<e;t++)if(null!==this.subnode[t])return!0;return!1},t.prototype.hasItems=function(){return!this.items.isEmpty()},t.prototype.depth=function(){var t,e=0,n=0,i=2;for(n;n<i;n++)null!==this.subnode[n]&&(t=this.subnode[n].depth(),t>e&&(e=t));return e+1},t.prototype.size=function(){var t=0,e=0,n=2;for(e;e<n;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},t.prototype.nodeSize=function(){var t=0,e=0,n=2;for(e;e<n;e++)null!==this.subnode[e]&&(t+=this.subnode[e].nodeSize());return t+1},jsts.index.bintree.NodeBase=t}(),function(){var t=jsts.index.bintree.NodeBase,e=jsts.index.bintree.Key,n=jsts.index.bintree.Interval,i=function(t,e){this.items=new javascript.util.ArrayList,this.subnode=[null,null],this.interval=t,this.level=e,this.centre=(t.getMin()+t.getMax())/2};i.prototype=new t,i.constructor=i,i.createNode=function(t){var n,o;return n=new e(t),o=new i(n.getInterval(),n.getLevel())},i.createExpanded=function(t,e){var o,r;return o=new n(e),null!==t&&o.expandToInclude(t.interval),r=i.createNode(o),null!==t&&r.insert(t),r},i.prototype.getInterval=function(){return this.interval},i.prototype.isSearchMatch=function(t){return t.overlaps(this.interval)},i.prototype.getNode=function(e){var n,i=t.getSubnodeIndex(e,this.centre);return i!=-1?(n=this.getSubnode(i),n.getNode(e)):this},i.prototype.find=function(e){var n,i=t.getSubnodeIndex(e,this.centre);return i===-1?this:null!==this.subnode[i]?(n=this.subnode[i],n.find(e)):this},i.prototype.insert=function(e){var n,i=t.getSubnodeIndex(e.interval,this.centre);e.level===this.level-1?this.subnode[i]=e:(n=this.createSubnode(i),n.insert(e),this.subnode[i]=n)},i.prototype.getSubnode=function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},i.prototype.createSubnode=function(t){var e,o,r,s;switch(e=0,o=0,t){case 0:e=this.interval.getMin(),o=this.centre;break;case 1:e=this.centre,o=this.interval.getMax()}return r=new n(e,o),s=new i(r,this.level-1)},jsts.index.bintree.Node=i}(),function(){var t=jsts.index.bintree.Node,e=jsts.index.bintree.NodeBase,n=function(){this.subnode=[null,null],this.items=new javascript.util.ArrayList};n.prototype=new jsts.index.bintree.NodeBase,n.constructor=n,n.origin=0,n.prototype.insert=function(i,o){var r,s,a=e.getSubnodeIndex(i,n.origin);return a===-1?void this.add(o):(r=this.subnode[a],null!==r&&r.getInterval().contains(i)||(s=t.createExpanded(r,i),this.subnode[a]=s),void this.insertContained(this.subnode[a],i,o))},n.prototype.insertContained=function(t,e,n){var i,o;i=jsts.index.IntervalSize.isZeroWidth(e.getMin(),e.getMax()),o=i?t.find(e):t.getNode(e),o.add(n)},n.prototype.isSearchMatch=function(t){return!0},jsts.index.bintree.Root=n}(),jsts.noding.snapround.MCIndexSnapRounder=function(t){this.pm=t,this.li=new jsts.algorithm.RobustLineIntersector,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()},jsts.noding.snapround.MCIndexSnapRounder.prototype=new jsts.noding.Noder,jsts.noding.snapround.MCIndexSnapRounder.constructor=jsts.noding.snapround.MCIndexSnapRounder,jsts.noding.snapround.MCIndexSnapRounder.prototype.pm=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.li=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.scaleFactor=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.noder=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.pointSnapper=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.nodedSegStrings=null,jsts.noding.snapround.MCIndexSnapRounder.prototype.getNodedSubstrings=function(){return jsts.noding.NodedSegmentString.getNodedSubstrings(this.nodedSegStrings)},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeNodes=function(t){this.nodedSegStrings=t,this.noder=new jsts.noding.MCIndexNoder,this.pointSnapper=new jsts.noding.snapround.MCIndexPointSnapper(this.noder.getIndex()),this.snapRound(t,this.li)},jsts.noding.snapround.MCIndexSnapRounder.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},jsts.noding.snapround.MCIndexSnapRounder.prototype.findInteriorIntersections=function(t,e){var n=new jsts.noding.IntersectionFinderAdder(e);return this.noder.setSegmentIntersector(n),this.noder.computeNodes(t),n.getInteriorIntersections()},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new jsts.noding.snapround.HotPixel(n,this.scaleFactor,this.li);this.pointSnapper.snap(i)}},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps=function(t){if(t instanceof jsts.noding.NodedSegmentString)return void this.computeVertexSnaps2.apply(this,arguments);for(var e=t.iterator();e.hasNext();){var n=e.next();this.computeVertexSnaps(n)}},jsts.noding.snapround.MCIndexSnapRounder.prototype.computeVertexSnaps2=function(t){for(var e=t.getCoordinates(),n=0;n<e.length-1;n++){var i=new jsts.noding.snapround.HotPixel(e[n],this.scaleFactor,this.li),o=this.pointSnapper.snap(i,t,n);o&&t.addIntersection(e[n],n)}},jsts.geomgraph.Quadrant=function(){},jsts.geomgraph.Quadrant.NE=0,jsts.geomgraph.Quadrant.NW=1,jsts.geomgraph.Quadrant.SW=2,jsts.geomgraph.Quadrant.SE=3,jsts.geomgraph.Quadrant.quadrant=function(t,e){if(t instanceof jsts.geom.Coordinate)return jsts.geomgraph.Quadrant.quadrant2.apply(this,arguments);if(0===t&&0===e)throw new jsts.error.IllegalArgumentError("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?jsts.geomgraph.Quadrant.NE:jsts.geomgraph.Quadrant.SE:e>=0?jsts.geomgraph.Quadrant.NW:jsts.geomgraph.Quadrant.SW},jsts.geomgraph.Quadrant.quadrant2=function(t,e){if(e.x===t.x&&e.y===t.y)throw new jsts.error.IllegalArgumentError("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?jsts.geomgraph.Quadrant.NE:jsts.geomgraph.Quadrant.SE:e.y>=t.y?jsts.geomgraph.Quadrant.NW:jsts.geomgraph.Quadrant.SW},jsts.geomgraph.Quadrant.isOpposite=function(t,e){if(t===e)return!1;var n=(t-e+4)%4;return 2===n},jsts.geomgraph.Quadrant.commonHalfPlane=function(t,e){if(t===e)return t;var n=(t-e+4)%4;if(2===n)return-1;var i=t<e?t:e,o=t>e?t:e;return 0===i&&3===o?3:i},jsts.geomgraph.Quadrant.isInHalfPlane=function(t,e){return e===jsts.geomgraph.Quadrant.SE?t===jsts.geomgraph.Quadrant.SE||t===jsts.geomgraph.Quadrant.SW:t===e||t===e+1},jsts.geomgraph.Quadrant.isNorthern=function(t){return t===jsts.geomgraph.Quadrant.NE||t===jsts.geomgraph.Quadrant.NW},jsts.operation.valid.ConsistentAreaTester=function(t){this.geomGraph=t,this.li=new jsts.algorithm.RobustLineIntersector,this.nodeGraph=new jsts.operation.relate.RelateNodeGraph,this.invalidPoint=null},jsts.operation.valid.ConsistentAreaTester.prototype.getInvalidPoint=function(){return this.invalidPoint},jsts.operation.valid.ConsistentAreaTester.prototype.isNodeConsistentArea=function(){var t=this.geomGraph.computeSelfNodes(this.li,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},jsts.operation.valid.ConsistentAreaTester.prototype.isNodeEdgeAreaLabelsConsistent=function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=e.getCoordinate().clone(),!1}return!0},jsts.operation.valid.ConsistentAreaTester.prototype.hasDuplicateRings=function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next(),n=e.getEdges().iterator();n.hasNext();){var i=n.next();if(i.getEdgeEnds().length>1)return invalidPoint=i.getEdge().getCoordinate(0),!0}return!1},jsts.precision.CommonBits=function(){this.isFirst=!0,this.commonMantissaBitsCount=53,this.commonBits=0,this.commonSignExp},jsts.precision.CommonBits.signExpBits=function(t){return t>>52},jsts.precision.CommonBits.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(jsts.precision.CommonBits.getBit(t,i)!=jsts.precision.CommonBits.getBit(e,i))return n;n++}return 52},jsts.precision.CommonBits.zeroLowerBits=function(t,e){var n=(1<<e)-1,i=~n,o=t&i;return o},jsts.precision.CommonBits.getBit=function(t,e){var n=1<<e;return 0!==(t&n)?1:0},jsts.precision.CommonBits.prototype.add=function(t){if(this.isFirst)return this.commonBits=t,this.commonSignExp=jsts.precision.CommonBits.signExpBits(this.commonBits),void(this.isFirst=!1);var e=jsts.precision.CommonBits.signExpBits(t);return e!==this.commonSignExp?void(this.commonBits=0):(this.commonMantissaBitsCount=jsts.precision.CommonBits.numCommonMostSigMantissaBits(this.commonBits,t),void(this.commonBits=jsts.precision.CommonBits.zeroLowerBits(this.commonBits,64-(12+this.commonMantissaBitsCount))))},jsts.precision.CommonBits.prototype.getCommon=function(){return this.commonBits},jsts.precision.CommonBits.prototype.toString=function(t){var e=t,n=(t>>>0).toString(2),i="0000000000000000000000000000000000000000000000000000000000000000"+n,o=i.substring(i.length-64),r=o.substring(0,1)+"  "+o.substring(1,12)+"(exp) "+o.substring(12)+" [ "+e+" ]";return r},jsts.precision.CommonBitsRemover=function(){this.commonCoord,this.ccFilter=new jsts.precision.CommonCoordinateFilter},jsts.precision.CommonBitsRemover.prototype.add=function(t){t.apply(this.ccFilter),this.commonCoord=this.ccFilter.getCommonCoordinate()},jsts.precision.CommonBitsRemover.prototype.getCommonCoordinate=function(){return this.commonCoord},jsts.precision.CommonBitsRemover.prototype.removeCommonBits=function(t){if(0===this.commonCoord.x&&0===this.commonCoord.y)return t;var e=new jsts.geom.Coordinate(this.commonCoord);e.x=-e.x,e.y=-e.y;var n=new jsts.precision.Translater(e);return t.apply(n),t},jsts.precision.CommonBitsRemover.prototype.addCommonBits=function(t){var e=new jsts.precision.Translater(this.commonCoord);t.apply(e)},jsts.precision.CommonCoordinateFilter=function(){this.commonBitsX=new jsts.precision.CommonBits,this.commonBitsY=new jsts.precision.CommonBits},jsts.precision.CommonCoordinateFilter.prototype=new jsts.geom.CoordinateFilter,jsts.precision.CommonCoordinateFilter.constructor=jsts.precision.CommonCoordinateFilter,jsts.precision.CommonCoordinateFilter.prototype.filter=function(t){this.commonBitsX.add(t.x),this.commonBitsY.add(t.y)},jsts.precision.CommonCoordinateFilter.prototype.getCommonCoordinate=function(){return new jsts.geom.Coordinate(this.commonBitsX.getCommon(),this.commonBitsY.getCommon())},jsts.precision.Translater=function(t){this.trans=t},jsts.precision.Translater.prototype=new jsts.geom.CoordinateFilter,jsts.precision.Translater.constructor=jsts.precision.Translater,jsts.precision.Translater.prototype.filter=function(t){t.x+=this.trans.x,t.y+=this.trans.y},jsts.precision.CommonBitsOp=function(t){this.returnToOriginalPrecision,this.cbr,this.returnToOriginalPrecision=void 0===t||t},jsts.precision.CommonBitsOp.prototype.intersection=function(t,e){var n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].intersection(n[1]))},jsts.precision.CommonBitsOp.prototype.union=function(t,e){var n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].union(n[1]))};jsts.precision.CommonBitsOp.prototype.difference=function(t,e){var n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].difference(n[1]))};jsts.precision.CommonBitsOp.prototype.symDifference=function(t,e){var n=this.removeCommonBits(t,e);return this.computeResultPrecision(n[0].symDifference(n[1]))},jsts.precision.CommonBitsOp.prototype.buffer=function(t,e){var n=this.removeCommonBits(t);return this.computeResultPrecision(n.buffer(e))},jsts.precision.CommonBitsOp.prototype.computeResultPrecision=function(t){return this.returnToOriginalPrecision&&this.cbr.addCommonBits(t),t},jsts.precision.CommonBitsOp.prototype.removeCommonBits=function(){if(1===arguments.length)return this.removeCommonBits1(arguments[0]);if(2===arguments.length)return this.removeCommonBits2(arguments[0],arguments[1]);throw"Wrong argument count!"},jsts.precision.CommonBitsOp.prototype.removeCommonBits1=function(t){this.cbr=new jsts.precision.CommonBitsRemover,this.cbr.add(t);var e=this.cbr.removeCommonBits(t.clone());return e},jsts.precision.CommonBitsOp.prototype.removeCommonBits2=function(t,e){this.cbr=new jsts.precision.CommonBitsRemover,this.cbr.add(t),this.cbr.add(e);var n=[this.cbr.removeCommonBits(t.clone()),this.cbr.removeCommonBits(e.clone())];return n},jsts.precision.EnhancedPrecisionOp=function(){},jsts.precision.EnhancedPrecisionOp.intersection=function(t,e){var n;try{var i=t.intersection(e);return i}catch(t){n=t}try{var o=new jsts.precision.CommonBitsOp((!0)),r=o.intersection(t,e);if(!r.isValid())throw n;return r}catch(t){throw n}},jsts.precision.EnhancedPrecisionOp.union=function(t,e){var n;try{var i=t.union(e);return i}catch(t){n=t}try{var o=new jsts.precision.CommonBitsOp((!0)),r=o.union(t,e);if(!r.isValid())throw n;return r}catch(t){throw n}},jsts.precision.EnhancedPrecisionOp.difference=function(t,e){var n;try{var i=t.difference(e);return i}catch(t){n=t}try{var o=new jsts.precision.CommonBitsOp((!0)),r=o.difference(t,e);if(!r.isValid())throw n;return r}catch(t){throw n}},jsts.precision.EnhancedPrecisionOp.symDifference=function(t,e){var n;try{var i=t.symDifference(e);return i}catch(t){n=t}try{var o=new jsts.precision.CommonBitsOp((!0)),r=o.symDifference(t,e);if(!r.isValid())throw n;return r}catch(t){throw n}},jsts.precision.EnhancedPrecisionOp.buffer=function(t,e){var n;try{var i=t.buffer(e);return i}catch(t){n=t}try{var o=new jsts.precision.CommonBitsOp((!0)),r=o.buffer(t,e);if(!r.isValid())throw n;return r}catch(t){throw n}},jsts.operation.relate.RelateNode=function(t,e){jsts.geomgraph.Node.apply(this,arguments)},jsts.operation.relate.RelateNode.prototype=new jsts.geomgraph.Node,jsts.operation.relate.RelateNode.prototype.computeIM=function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},jsts.operation.relate.RelateNode.prototype.updateIMFromEdges=function(t){this.edges.updateIM(t)},function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position,n=jsts.geomgraph.EdgeEnd;jsts.geomgraph.DirectedEdge=function(t,e){if(n.call(this,t),this.depth=[0,-999,-999],this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var i=t.getNumPoints()-1;this.init(t.getCoordinate(i),t.getCoordinate(i-1))}this.computeDirectedLabel()},jsts.geomgraph.DirectedEdge.prototype=new n,jsts.geomgraph.DirectedEdge.constructor=jsts.geomgraph.DirectedEdge,jsts.geomgraph.DirectedEdge.depthFactor=function(e,n){return e===t.EXTERIOR&&n===t.INTERIOR?1:e===t.INTERIOR&&n===t.EXTERIOR?-1:0},jsts.geomgraph.DirectedEdge.prototype._isForward=null,jsts.geomgraph.DirectedEdge.prototype._isInResult=!1,jsts.geomgraph.DirectedEdge.prototype._isVisited=!1,jsts.geomgraph.DirectedEdge.prototype.sym=null,jsts.geomgraph.DirectedEdge.prototype.next=null,jsts.geomgraph.DirectedEdge.prototype.nextMin=null,jsts.geomgraph.DirectedEdge.prototype.edgeRing=null,jsts.geomgraph.DirectedEdge.prototype.minEdgeRing=null,jsts.geomgraph.DirectedEdge.prototype.depth=null,jsts.geomgraph.DirectedEdge.prototype.getEdge=function(){return this.edge},jsts.geomgraph.DirectedEdge.prototype.setInResult=function(t){this._isInResult=t},jsts.geomgraph.DirectedEdge.prototype.isInResult=function(){return this._isInResult},jsts.geomgraph.DirectedEdge.prototype.isVisited=function(){return this._isVisited},jsts.geomgraph.DirectedEdge.prototype.setVisited=function(t){this._isVisited=t},jsts.geomgraph.DirectedEdge.prototype.setEdgeRing=function(t){this.edgeRing=t},jsts.geomgraph.DirectedEdge.prototype.getEdgeRing=function(){return this.edgeRing},jsts.geomgraph.DirectedEdge.prototype.setMinEdgeRing=function(t){this.minEdgeRing=t},jsts.geomgraph.DirectedEdge.prototype.getMinEdgeRing=function(){return this.minEdgeRing},jsts.geomgraph.DirectedEdge.prototype.getDepth=function(t){return this.depth[t]},jsts.geomgraph.DirectedEdge.prototype.setDepth=function(t,e){if(this.depth[t]!==-999&&this.depth[t]!==e)throw new jsts.error.TopologyError("assigned depths do not match",this.getCoordinate());this.depth[t]=e},jsts.geomgraph.DirectedEdge.prototype.getDepthDelta=function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},jsts.geomgraph.DirectedEdge.prototype.setVisitedEdge=function(t){this.setVisited(t),this.sym.setVisited(t)},jsts.geomgraph.DirectedEdge.prototype.getSym=function(){return this.sym},jsts.geomgraph.DirectedEdge.prototype.isForward=function(){return this._isForward},jsts.geomgraph.DirectedEdge.prototype.setSym=function(t){this.sym=t},jsts.geomgraph.DirectedEdge.prototype.getNext=function(){return this.next},jsts.geomgraph.DirectedEdge.prototype.setNext=function(t){this.next=t},jsts.geomgraph.DirectedEdge.prototype.getNextMin=function(){return this.nextMin},jsts.geomgraph.DirectedEdge.prototype.setNextMin=function(t){this.nextMin=t},jsts.geomgraph.DirectedEdge.prototype.isLineEdge=function(){var e=this.label.isLine(0)||this.label.isLine(1),n=!this.label.isArea(0)||this.label.allPositionsEqual(0,t.EXTERIOR),i=!this.label.isArea(1)||this.label.allPositionsEqual(1,t.EXTERIOR);return e&&n&&i},jsts.geomgraph.DirectedEdge.prototype.isInteriorAreaEdge=function(){for(var n=!0,i=0;i<2;i++)this.label.isArea(i)&&this.label.getLocation(i,e.LEFT)===t.INTERIOR&&this.label.getLocation(i,e.RIGHT)===t.INTERIOR||(n=!1);return n},jsts.geomgraph.DirectedEdge.prototype.computeDirectedLabel=function(){this.label=new jsts.geomgraph.Label(this.edge.getLabel()),this._isForward||this.label.flip()},jsts.geomgraph.DirectedEdge.prototype.setEdgeDepths=function(t,n){var i=this.getEdge().getDepthDelta();this._isForward||(i=-i);var o=1;t===e.LEFT&&(o=-1);var r=e.opposite(t),s=i*o,a=n+s;this.setDepth(t,n),this.setDepth(r,a)}}(),jsts.operation.distance.DistanceOp=function(t,e,n){this.ptLocator=new jsts.algorithm.PointLocator,this.geom=[],this.geom[0]=t,this.geom[1]=e,this.terminateDistance=n},jsts.operation.distance.DistanceOp.prototype.geom=null,jsts.operation.distance.DistanceOp.prototype.terminateDistance=0,jsts.operation.distance.DistanceOp.prototype.ptLocator=null,jsts.operation.distance.DistanceOp.prototype.minDistanceLocation=null,jsts.operation.distance.DistanceOp.prototype.minDistance=Number.MAX_VALUE,jsts.operation.distance.DistanceOp.distance=function(t,e){var n=new jsts.operation.distance.DistanceOp(t,e,0);return n.distance()},jsts.operation.distance.DistanceOp.isWithinDistance=function(t,e,n){var i=new jsts.operation.distance.DistanceOp(t,e,n);return i.distance()<=n},jsts.operation.distance.DistanceOp.nearestPoints=function(t,e){var n=new jsts.operation.distance.DistanceOp(t,e,0);return n.nearestPoints()},jsts.operation.distance.DistanceOp.prototype.distance=function(){if(null===this.geom[0]||null===this.geom[1])throw new jsts.error.IllegalArgumentError("null geometries are not supported");return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},jsts.operation.distance.DistanceOp.prototype.nearestPoints=function(){this.computeMinDistance();var t=[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()];return t},jsts.operation.distance.DistanceOp.prototype.nearestLocations=function(){return this.computeMinDistance(),this.minDistanceLocation},jsts.operation.distance.DistanceOp.prototype.updateMinDistance=function(t,e){null!==t[0]&&(e?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1]))},jsts.operation.distance.DistanceOp.prototype.computeMinDistance=function(){return arguments.length>0?void this.computeMinDistance2.apply(this,arguments):void(null===this.minDistanceLocation&&(this.minDistanceLocation=[],this.computeContainmentDistance(),this.minDistance<=this.terminateDistance||this.computeFacetDistance()))},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance=function(){if(2===arguments.length)return void this.computeContainmentDistance2.apply(this,arguments);if(3===arguments.length&&!arguments[0]instanceof jsts.operation.distance.GeometryLocation)return void this.computeContainmentDistance3.apply(this,arguments);if(3===arguments.length)return void this.computeContainmentDistance4.apply(this,arguments);var t=[];this.computeContainmentDistance2(0,t),this.minDistance<=this.terminateDistance||this.computeContainmentDistance2(1,t)},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance2=function(t,e){var n=1-t,i=jsts.geom.util.PolygonExtracter.getPolygons(this.geom[t]);if(i.length>0){var o=jsts.operation.distance.ConnectedElementLocationFilter.getLocations(this.geom[n]);if(this.computeContainmentDistance3(o,i,e),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[n]=e[0],void(this.minDistanceLocation[t]=e[1])}},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance3=function(t,e,n){for(var i=0;i<t.length;i++)for(var o=t[i],r=0;r<e.length;r++)if(this.computeContainmentDistance4(o,e[r],n),this.minDistance<=this.terminateDistance)return},jsts.operation.distance.DistanceOp.prototype.computeContainmentDistance4=function(t,e,n){var i=t.getCoordinate();if(jsts.geom.Location.EXTERIOR!==this.ptLocator.locate(i,e))return this.minDistance=0,n[0]=t,void(n[1]=new jsts.operation.distance.GeometryLocation(e,i))},jsts.operation.distance.DistanceOp.prototype.computeFacetDistance=function(){var t=[],e=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[0]),n=jsts.geom.util.LinearComponentExtracter.getLines(this.geom[1]),i=jsts.geom.util.PointExtracter.getPoints(this.geom[0]),o=jsts.geom.util.PointExtracter.getPoints(this.geom[1]);this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,o,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance||(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,o,t),this.updateMinDistance(t,!1))))},jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.length;i++)for(var o=t[i],r=0;r<e.length;r++){var s=e[r];if(this.computeMinDistance(o,s,n),this.minDistance<=this.terminateDistance)return}},jsts.operation.distance.DistanceOp.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.length;i++)for(var o=t[i],r=0;r<e.length;r++){var s=e[r],a=o.getCoordinate().distance(s.getCoordinate());if(a<this.minDistance&&(this.minDistance=a,n[0]=new jsts.operation.distance.GeometryLocation(o,0,o.getCoordinate()),n[1]=new jsts.operation.distance.GeometryLocation(s,0,s.getCoordinate())),this.minDistance<=this.terminateDistance)return}},jsts.operation.distance.DistanceOp.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.length;i++)for(var o=t[i],r=0;r<e.length;r++){var s=e[r];if(this.computeMinDistance(o,s,n),this.minDistance<=this.terminateDistance)return}},jsts.operation.distance.DistanceOp.prototype.computeMinDistance2=function(t,e,n){if(e instanceof jsts.geom.Point)return void this.computeMinDistance3(t,e,n);if(!(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance))for(var i=t.getCoordinates(),o=e.getCoordinates(),r=0;r<i.length-1;r++)for(var s=0;s<o.length-1;s++){var a=jsts.algorithm.CGAlgorithms.distanceLineLine(i[r],i[r+1],o[s],o[s+1]);if(a<this.minDistance){this.minDistance=a;var l=new jsts.geom.LineSegment(i[r],i[r+1]),d=new jsts.geom.LineSegment(o[s],o[s+1]),c=l.closestPoints(d);n[0]=new jsts.operation.distance.GeometryLocation(t,r,c[0]),n[1]=new jsts.operation.distance.GeometryLocation(e,s,c[1])}if(this.minDistance<=this.terminateDistance)return}},jsts.operation.distance.DistanceOp.prototype.computeMinDistance3=function(t,e,n){if(!(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance))for(var i=t.getCoordinates(),o=e.getCoordinate(),r=0;r<i.length-1;r++){var s=jsts.algorithm.CGAlgorithms.distancePointLine(o,i[r],i[r+1]);if(s<this.minDistance){this.minDistance=s;var a=new jsts.geom.LineSegment(i[r],i[r+1]),l=a.closestPoint(o);n[0]=new jsts.operation.distance.GeometryLocation(t,r,l),n[1]=new jsts.operation.distance.GeometryLocation(e,0,o)}if(this.minDistance<=this.terminateDistance)return}},jsts.index.strtree.SIRtree=function(t){t=t||10,jsts.index.strtree.AbstractSTRtree.call(this,t)},jsts.index.strtree.SIRtree.prototype=new jsts.index.strtree.AbstractSTRtree,jsts.index.strtree.SIRtree.constructor=jsts.index.strtree.SIRtree,jsts.index.strtree.SIRtree.prototype.comperator={compare:function(t,e){return t.getBounds().getCentre()-e.getBounds().getCentre()}},jsts.index.strtree.SIRtree.prototype.intersectionOp={intersects:function(t,e){return t.intersects(e)}},jsts.index.strtree.SIRtree.prototype.createNode=function(t){var e=function(t){jsts.index.strtree.AbstractNode.apply(this,arguments)};return e.prototype=new jsts.index.strtree.AbstractNode,e.constructor=e,e.prototype.computeBounds=function(){for(var t,e=null,n=this.getChildBoundables(),i=0,o=n.length;i<o;i++)t=n[i],null===e?e=new jsts.index.strtree.Interval(t.getBounds()):e.expandToInclude(t.getBounds());return e},e},jsts.index.strtree.SIRtree.prototype.insert=function(t,e,n){jsts.index.strtree.AbstractSTRtree.prototype.insert(new jsts.index.strtree.Interval(Math.min(t,e),Math.max(t,e)),n)},jsts.index.strtree.SIRtree.prototype.query=function(t,e){e=e||t,jsts.index.strtree.AbstractSTRtree.prototype.query(new jsts.index.strtree.Interval(Math.min(t,e),Math.max(t,e)))},jsts.index.strtree.SIRtree.prototype.getIntersectsOp=function(){return this.intersectionOp},jsts.index.strtree.SIRtree.prototype.getComparator=function(){
return this.comperator},jsts.simplify.DouglasPeuckerSimplifier=function(t){this.inputGeom=t,this.isEnsureValidTopology=!0},jsts.simplify.DouglasPeuckerSimplifier.prototype.inputGeom=null,jsts.simplify.DouglasPeuckerSimplifier.prototype.distanceTolerance=null,jsts.simplify.DouglasPeuckerSimplifier.prototype.isEnsureValidTopology=null,jsts.simplify.DouglasPeuckerSimplifier.simplify=function(t,e){var n=new jsts.simplify.DouglasPeuckerSimplifier(t);return n.setDistanceTolerance(e),n.getResultGeometry()},jsts.simplify.DouglasPeuckerSimplifier.prototype.setDistanceTolerance=function(t){if(t<0)throw"Tolerance must be non-negative";this.distanceTolerance=t},jsts.simplify.DouglasPeuckerSimplifier.prototype.setEnsureValid=function(t){this.isEnsureValidTopology=t},jsts.simplify.DouglasPeuckerSimplifier.prototype.getResultGeometry=function(){return this.inputGeom.isEmpty()?this.inputGeom.clone():new jsts.simplify.DPTransformer(this.distanceTolerance,this.isEnsureValidTopology).transform(this.inputGeom)},function(){jsts.operation.predicate.RectangleContains=function(t){this.rectEnv=t.getEnvelopeInternal()},jsts.operation.predicate.RectangleContains.contains=function(t,e){var n=new jsts.operation.predicate.RectangleContains(t);return n.contains(e)},jsts.operation.predicate.RectangleContains.prototype.rectEnv=null,jsts.operation.predicate.RectangleContains.prototype.contains=function(t){return!!this.rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)},jsts.operation.predicate.RectangleContains.prototype.isContainedInBoundary=function(t){if(t instanceof jsts.geom.Polygon)return!1;if(t instanceof jsts.geom.Point)return this.isPointContainedInBoundary(t.getCoordinate());if(t instanceof jsts.geom.LineString)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0},jsts.operation.predicate.RectangleContains.prototype.isPointContainedInBoundary=function(t){return t.x==this.rectEnv.getMinX()||t.x==this.rectEnv.getMaxX()||t.y==this.rectEnv.getMinY()||t.y==this.rectEnv.getMaxY()},jsts.operation.predicate.RectangleContains.prototype.isLineStringContainedInBoundary=function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.length-1;n++){var i=e[n],o=e[n+1];if(!this.isLineSegmentContainedInBoundary(i,o))return!1}return!0},jsts.operation.predicate.RectangleContains.prototype.isLineSegmentContainedInBoundary=function(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x==e.x){if(t.x==this.rectEnv.getMinX()||t.x==this.rectEnv.getMaxX())return!0}else if(t.y==e.y&&(t.y==this.rectEnv.getMinY()||t.y==this.rectEnv.getMaxY()))return!0;return!1}}(),function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position;jsts.geomgraph.Depth=function(){this.depth=[[],[]];for(var t=0;t<2;t++)for(var e=0;e<3;e++)this.depth[t][e]=jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.NULL_VALUE=-1,jsts.geomgraph.Depth.depthAtLocation=function(e){return e===t.EXTERIOR?0:e===t.INTERIOR?1:jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.prototype.depth=null,jsts.geomgraph.Depth.prototype.getDepth=function(t,e){return this.depth[t][e]},jsts.geomgraph.Depth.prototype.setDepth=function(t,e,n){this.depth[t][e]=n},jsts.geomgraph.Depth.prototype.getLocation=function(e,n){return this.depth[e][n]<=0?t.EXTERIOR:t.INTERIOR},jsts.geomgraph.Depth.prototype.add=function(e,n,i){i===t.INTERIOR&&this.depth[e][n]++},jsts.geomgraph.Depth.prototype.isNull=function(){if(arguments.length>0)return this.isNull2.apply(this,arguments);for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this.depth[t][e]!==jsts.geomgraph.Depth.NULL_VALUE)return!1;return!0},jsts.geomgraph.Depth.prototype.isNull2=function(t){return arguments.length>1?this.isNull3.apply(this,arguments):this.depth[t][1]==jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.prototype.isNull3=function(t,e){return this.depth[t][e]==jsts.geomgraph.Depth.NULL_VALUE},jsts.geomgraph.Depth.prototype.add=function(e){for(var n=0;n<2;n++)for(var i=1;i<3;i++){var o=e.getLocation(n,i);o!==t.EXTERIOR&&o!==t.INTERIOR||(this.isNull(n,i)?this.depth[n][i]=jsts.geomgraph.Depth.depthAtLocation(o):this.depth[n][i]+=jsts.geomgraph.Depth.depthAtLocation(o))}},jsts.geomgraph.Depth.prototype.getDelta=function(t){return this.depth[t][e.RIGHT]-this.depth[t][e.LEFT]},jsts.geomgraph.Depth.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this.depth[t][1];this.depth[t][2]<e&&(e=this.depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this.depth[t][n]>e&&(i=1),this.depth[t][n]=i}}},jsts.geomgraph.Depth.prototype.toString=function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]}}(),jsts.algorithm.BoundaryNodeRule=function(){},jsts.algorithm.BoundaryNodeRule.prototype.isInBoundary=function(t){throw new jsts.error.AbstractMethodInvocationError},jsts.algorithm.Mod2BoundaryNodeRule=function(){},jsts.algorithm.Mod2BoundaryNodeRule.prototype=new jsts.algorithm.BoundaryNodeRule,jsts.algorithm.Mod2BoundaryNodeRule.prototype.isInBoundary=function(t){return t%2===1},jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE=new jsts.algorithm.Mod2BoundaryNodeRule,jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE=jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE,jsts.operation.distance.GeometryLocation=function(t,e,n){this.component=t,this.segIndex=e,this.pt=n},jsts.operation.distance.GeometryLocation.INSIDE_AREA=-1,jsts.operation.distance.GeometryLocation.prototype.component=null,jsts.operation.distance.GeometryLocation.prototype.segIndex=null,jsts.operation.distance.GeometryLocation.prototype.pt=null,jsts.operation.distance.GeometryLocation.prototype.getGeometryComponent=function(){return this.component},jsts.operation.distance.GeometryLocation.prototype.getSegmentIndex=function(){return this.segIndex},jsts.operation.distance.GeometryLocation.prototype.getCoordinate=function(){return this.pt},jsts.operation.distance.GeometryLocation.prototype.isInsideArea=function(){return this.segIndex===jsts.operation.distance.GeometryLocation.INSIDE_AREA},jsts.geom.util.PointExtracter=function(t){this.pts=t},jsts.geom.util.PointExtracter.prototype=new jsts.geom.GeometryFilter,jsts.geom.util.PointExtracter.prototype.pts=null,jsts.geom.util.PointExtracter.getPoints=function(t,e){return void 0===e&&(e=[]),t instanceof jsts.geom.Point?e.push(t):(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)&&t.apply(new jsts.geom.util.PointExtracter(e)),e},jsts.geom.util.PointExtracter.prototype.filter=function(t){t instanceof jsts.geom.Point&&this.pts.push(t)},function(){var t=jsts.geom.Location;jsts.operation.relate.RelateNodeGraph=function(){this.nodes=new jsts.geomgraph.NodeMap(new jsts.operation.relate.RelateNodeFactory)},jsts.operation.relate.RelateNodeGraph.prototype.nodes=null,jsts.operation.relate.RelateNodeGraph.prototype.build=function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=new jsts.operation.relate.EdgeEndBuilder,n=e.computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(n)},jsts.operation.relate.RelateNodeGraph.prototype.computeIntersectionNodes=function(e,n){for(var i=e.getEdgeIterator();i.hasNext();)for(var o=i.next(),r=o.getLabel().getLocation(n),s=o.getEdgeIntersectionList().iterator();s.hasNext();){var a=s.next(),l=this.nodes.addNode(a.coord);r===t.BOUNDARY?l.setLabelBoundary(n):l.getLabel().isNull(n)&&l.setLabel(n,t.INTERIOR)}},jsts.operation.relate.RelateNodeGraph.prototype.copyNodesAndLabels=function(t,e){for(var n=t.getNodeIterator();n.hasNext();){var i=n.next(),o=this.nodes.addNode(i.getCoordinate());o.setLabel(e,i.getLabel().getLocation(e))}},jsts.operation.relate.RelateNodeGraph.prototype.insertEdgeEnds=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},jsts.operation.relate.RelateNodeGraph.prototype.getNodeIterator=function(){return this.nodes.iterator()}}(),jsts.operation.linemerge.EdgeString=function(t){this.factory=t,this.directedEdges=[],this.coordinates=null},jsts.operation.linemerge.EdgeString.prototype.add=function(t){this.directedEdges.push(t)},jsts.operation.linemerge.EdgeString.prototype.getCoordinates=function(){if(null===this.coordinates){for(var t=0,e=0,n=new jsts.geom.CoordinateList,i=0;i<this.directedEdges.length;++i){var o=this.directedEdges[i];o.getEdgeDirection()?t++:e++,n.add(o.getEdge().getLine().getCoordinates(),!1,o.getEdgeDirection())}this.coordinates=n.toCoordinateArray(),e>t&&(this.coordinates=this.coordinates.reverse())}return this.coordinates},jsts.operation.linemerge.EdgeString.prototype.toLineString=function(){return this.factory.createLineString(this.getCoordinates())},jsts.geomgraph.index.SimpleSweepLineIntersector=function(){},jsts.geomgraph.index.SimpleSweepLineIntersector.prototype=new jsts.geomgraph.index.EdgeSetIntersector,jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.events=[],jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.nOverlaps=null,jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections=function(t,e,n){return e instanceof javascript.util.List?void this.computeIntersections2.apply(this,arguments):(n?this.add(t,null):this.add(t),void this.computeIntersections3(e))},jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections2=function(t,e,n){this.add(t,t),this.add(e,e),this.computeIntersections3(n)},jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add=function(t,e){if(t instanceof javascript.util.List)return void this.add2.apply(this,arguments);for(var n=t.getCoordinates(),i=0;i<n.length-1;i++){var o=new jsts.geomgraph.index.SweepLineSegment(t,i),r=new jsts.geomgraph.index.SweepLineEvent(o.getMinX(),o,e);this.events.push(r),this.events.push(new jsts.geomgraph.index.SweepLineEvent(o.getMaxX(),r))}},jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.add2=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();e?this.add(i,e):this.add(i,i)}},jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.prepareEvents=function(){this.events.sort(function(t,e){return t.compareTo(e)});for(var t=0;t<this.events.length;t++){var e=this.events[t];e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.computeIntersections3=function(t){this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.length;e++){var n=this.events[e];n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t)}},jsts.geomgraph.index.SimpleSweepLineIntersector.prototype.processOverlaps=function(t,e,n,i){for(var o=n.getObject(),r=t;r<e;r++){var s=this.events[r];if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(o.computeIntersections(a,i),this.nOverlaps++)}}},jsts.triangulate.VoronoiDiagramBuilder=function(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null},jsts.triangulate.VoronoiDiagramBuilder.prototype.setSites=function(){var t=arguments[0];t instanceof jsts.geom.Geometry||t instanceof jsts.geom.Coordinate||t instanceof jsts.geom.Point||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.LineString||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.LinearRing||t instanceof jsts.geom.Polygon||t instanceof jsts.geom.MultiPolygon?this.setSitesByGeometry(t):this.setSitesByArray(t)},jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByGeometry=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(t)},jsts.triangulate.VoronoiDiagramBuilder.prototype.setSitesByArray=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(t)},jsts.triangulate.VoronoiDiagramBuilder.prototype.setClipEnvelope=function(t){this.clipEnv=t},jsts.triangulate.VoronoiDiagramBuilder.prototype.setTolerance=function(t){this.tolerance=t},jsts.triangulate.VoronoiDiagramBuilder.prototype.create=function(){if(null===this.subdiv){var t,e,n,i;t=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords),this.diagramEnv=t,e=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight()),this.diagramEnv.expandBy(e),null!==this.clipEnv&&this.diagramEnv.expandToInclude(this.clipEnv),n=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords),this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(t,this.tolerance),i=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv),i.insertSites(n)}},jsts.triangulate.VoronoiDiagramBuilder.prototype.getSubdivision=function(){return this.create(),this.subdiv},jsts.triangulate.VoronoiDiagramBuilder.prototype.getDiagram=function(t){this.create();var e=this.subdiv.getVoronoiDiagram(t);return this.clipGeometryCollection(e,this.diagramEnv)},jsts.triangulate.VoronoiDiagramBuilder.prototype.clipGeometryCollection=function(t,e){var n,i,o,r,s,a;for(n=t.getFactory().toGeometry(e),i=[],o=0,r=t.getNumGeometries(),o;o<r;o++)s=t.getGeometryN(o),a=null,e.contains(s.getEnvelopeInternal())?a=s:e.intersects(s.getEnvelopeInternal())&&(a=n.intersection(s)),null===a||a.isEmpty()||i.push(a);return t.getFactory().createGeometryCollection(i)},jsts.operation.valid.IndexedNestedRingTester=function(t){this.graph=t,this.rings=new javascript.util.ArrayList,this.totalEnv=new jsts.geom.Envelope,this.index=null,this.nestedPt=null},jsts.operation.valid.IndexedNestedRingTester.prototype.getNestedPoint=function(){return this.nestedPt},jsts.operation.valid.IndexedNestedRingTester.prototype.add=function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},jsts.operation.valid.IndexedNestedRingTester.prototype.isNonNested=function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var e=this.rings.get(t),n=e.getCoordinates(),i=this.index.query(e.getEnvelopeInternal()),o=0;o<i.length;o++){var r=i[o],s=r.getCoordinates();if(e!=r&&e.getEnvelopeInternal().intersects(r.getEnvelopeInternal())){var a=jsts.operation.valid.IsValidOp.findPtNotNode(n,r,this.graph);if(null!=a){var l=jsts.algorithm.CGAlgorithms.isPointInRing(a,s);if(l)return this.nestedPt=a,!1}}}return!0},jsts.operation.valid.IndexedNestedRingTester.prototype.buildIndex=function(){this.index=new jsts.index.strtree.STRtree;for(var t=0;t<this.rings.size();t++){var e=this.rings.get(t),n=e.getEnvelopeInternal();this.index.insert(n,e)}},jsts.geomgraph.index.MonotoneChain=function(t,e){this.mce=t,this.chainIndex=e},jsts.geomgraph.index.MonotoneChain.prototype.mce=null,jsts.geomgraph.index.MonotoneChain.prototype.chainIndex=null,jsts.geomgraph.index.MonotoneChain.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},jsts.noding.SegmentNode=function(t,e,n,i){this.segString=t,this.coord=new jsts.geom.Coordinate(e),this.segmentIndex=n,this.segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))},jsts.noding.SegmentNode.prototype.segString=null,jsts.noding.SegmentNode.prototype.coord=null,jsts.noding.SegmentNode.prototype.segmentIndex=null,jsts.noding.SegmentNode.prototype.segmentOctant=null,jsts.noding.SegmentNode.prototype._isInterior=null,jsts.noding.SegmentNode.prototype.getCoordinate=function(){return this.coord},jsts.noding.SegmentNode.prototype.isInterior=function(){return this._isInterior},jsts.noding.SegmentNode.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===this.maxSegmentIndex},jsts.noding.SegmentNode.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:jsts.noding.SegmentPointComparator.compare(this.segmentOctant,this.coord,e.coord)},function(){jsts.io.GeoJSONWriter=function(){this.parser=new jsts.io.GeoJSONParser(this.geometryFactory)},jsts.io.GeoJSONWriter.prototype.write=function(t){var e=this.parser.write(t);return e}}(),jsts.io.OpenLayersParser=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory},jsts.io.OpenLayersParser.prototype.read=function(t){return"OpenLayers.Geometry.Point"===t.CLASS_NAME?this.convertFromPoint(t):"OpenLayers.Geometry.LineString"===t.CLASS_NAME?this.convertFromLineString(t):"OpenLayers.Geometry.LinearRing"===t.CLASS_NAME?this.convertFromLinearRing(t):"OpenLayers.Geometry.Polygon"===t.CLASS_NAME?this.convertFromPolygon(t):"OpenLayers.Geometry.MultiPoint"===t.CLASS_NAME?this.convertFromMultiPoint(t):"OpenLayers.Geometry.MultiLineString"===t.CLASS_NAME?this.convertFromMultiLineString(t):"OpenLayers.Geometry.MultiPolygon"===t.CLASS_NAME?this.convertFromMultiPolygon(t):"OpenLayers.Geometry.Collection"===t.CLASS_NAME?this.convertFromCollection(t):void 0},jsts.io.OpenLayersParser.prototype.convertFromPoint=function(t){return this.geometryFactory.createPoint(new jsts.geom.Coordinate(t.x,t.y))},jsts.io.OpenLayersParser.prototype.convertFromLineString=function(t){var e,n=[];for(e=0;e<t.components.length;e++)n.push(new jsts.geom.Coordinate(t.components[e].x,t.components[e].y));return this.geometryFactory.createLineString(n)},jsts.io.OpenLayersParser.prototype.convertFromLinearRing=function(t){var e,n=[];for(e=0;e<t.components.length;e++)n.push(new jsts.geom.Coordinate(t.components[e].x,t.components[e].y));return this.geometryFactory.createLinearRing(n)},jsts.io.OpenLayersParser.prototype.convertFromPolygon=function(t){var e,n=null,i=[];for(e=0;e<t.components.length;e++){var o=this.convertFromLinearRing(t.components[e]);0===e?n=o:i.push(o)}return this.geometryFactory.createPolygon(n,i)},jsts.io.OpenLayersParser.prototype.convertFromMultiPoint=function(t){var e,n=[];for(e=0;e<t.components.length;e++)n.push(this.convertFromPoint(t.components[e]));return this.geometryFactory.createMultiPoint(n)},jsts.io.OpenLayersParser.prototype.convertFromMultiLineString=function(t){var e,n=[];for(e=0;e<t.components.length;e++)n.push(this.convertFromLineString(t.components[e]));return this.geometryFactory.createMultiLineString(n)},jsts.io.OpenLayersParser.prototype.convertFromMultiPolygon=function(t){var e,n=[];for(e=0;e<t.components.length;e++)n.push(this.convertFromPolygon(t.components[e]));return this.geometryFactory.createMultiPolygon(n)},jsts.io.OpenLayersParser.prototype.convertFromCollection=function(t){var e,n=[];for(e=0;e<t.components.length;e++)n.push(this.read(t.components[e]));return this.geometryFactory.createGeometryCollection(n)},jsts.io.OpenLayersParser.prototype.write=function(t){return"jsts.geom.Point"===t.CLASS_NAME?this.convertToPoint(t.coordinate):"jsts.geom.LineString"===t.CLASS_NAME?this.convertToLineString(t):"jsts.geom.LinearRing"===t.CLASS_NAME?this.convertToLinearRing(t):"jsts.geom.Polygon"===t.CLASS_NAME?this.convertToPolygon(t):"jsts.geom.MultiPoint"===t.CLASS_NAME?this.convertToMultiPoint(t):"jsts.geom.MultiLineString"===t.CLASS_NAME?this.convertToMultiLineString(t):"jsts.geom.MultiPolygon"===t.CLASS_NAME?this.convertToMultiPolygon(t):"jsts.geom.GeometryCollection"===t.CLASS_NAME?this.convertToCollection(t):void 0},jsts.io.OpenLayersParser.prototype.convertToPoint=function(t){return new OpenLayers.Geometry.Point(t.x,t.y)},jsts.io.OpenLayersParser.prototype.convertToLineString=function(t){var e,n=[];for(e=0;e<t.points.length;e++){var i=t.points[e];n.push(this.convertToPoint(i))}return new OpenLayers.Geometry.LineString(n)},jsts.io.OpenLayersParser.prototype.convertToLinearRing=function(t){var e,n=[];for(e=0;e<t.points.length;e++){var i=t.points[e];n.push(this.convertToPoint(i))}return new OpenLayers.Geometry.LinearRing(n)},jsts.io.OpenLayersParser.prototype.convertToPolygon=function(t){var e,n=[];for(n.push(this.convertToLinearRing(t.shell)),e=0;e<t.holes.length;e++){var i=t.holes[e];n.push(this.convertToLinearRing(i))}return new OpenLayers.Geometry.Polygon(n)},jsts.io.OpenLayersParser.prototype.convertToMultiPoint=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++){var i=t.geometries[e].coordinate;n.push(new OpenLayers.Geometry.Point(i.x,i.y))}return new OpenLayers.Geometry.MultiPoint(n)},jsts.io.OpenLayersParser.prototype.convertToMultiLineString=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++)n.push(this.convertToLineString(t.geometries[e]));return new OpenLayers.Geometry.MultiLineString(n)},jsts.io.OpenLayersParser.prototype.convertToMultiPolygon=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++)n.push(this.convertToPolygon(t.geometries[e]));return new OpenLayers.Geometry.MultiPolygon(n)},jsts.io.OpenLayersParser.prototype.convertToCollection=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++){var i=t.geometries[e],o=this.write(i);n.push(o)}return new OpenLayers.Geometry.Collection(n)},jsts.index.quadtree.Quadtree=function(){this.root=new jsts.index.quadtree.Root,this.minExtent=1},jsts.index.quadtree.Quadtree.ensureExtent=function(t,e){var n,i,o,r;return n=t.getMinX(),i=t.getMaxX(),o=t.getMinY(),r=t.getMaxY(),n!==i&&o!==r?t:(n===i&&(n-=e/2,i=n+e/2),o===r&&(o-=e/2,r=o+e/2),new jsts.geom.Envelope(n,i,o,r))},jsts.index.quadtree.Quadtree.prototype.depth=function(){return this.root.depth()},jsts.index.quadtree.Quadtree.prototype.size=function(){return this.root.size()},jsts.index.quadtree.Quadtree.prototype.insert=function(t,e){this.collectStats(t);var n=jsts.index.quadtree.Quadtree.ensureExtent(t,this.minExtent);this.root.insert(n,e)},jsts.index.quadtree.Quadtree.prototype.remove=function(t,e){var n=jsts.index.quadtree.Quadtree.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},jsts.index.quadtree.Quadtree.prototype.query=function(){return 1===arguments.length?jsts.index.quadtree.Quadtree.prototype.queryByEnvelope.apply(this,arguments):void jsts.index.quadtree.Quadtree.prototype.queryWithVisitor.apply(this,arguments)},jsts.index.quadtree.Quadtree.prototype.queryByEnvelope=function(t){var e=new jsts.index.ArrayListVisitor;return this.query(t,e),e.getItems()},jsts.index.quadtree.Quadtree.prototype.queryWithVisitor=function(t,e){this.root.visit(t,e)},jsts.index.quadtree.Quadtree.prototype.queryAll=function(){var t=[];return t=this.root.addAllItems(t)},jsts.index.quadtree.Quadtree.prototype.collectStats=function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e);var n=t.getHeight();n<this.minExtent&&n>0&&(this.minExtent=n)},jsts.operation.relate.RelateNodeFactory=function(){},jsts.operation.relate.RelateNodeFactory.prototype=new jsts.geomgraph.NodeFactory,jsts.operation.relate.RelateNodeFactory.prototype.createNode=function(t){return new jsts.operation.relate.RelateNode(t,new jsts.operation.relate.EdgeEndBundleStar)},jsts.index.quadtree.Key=function(t){this.pt=new jsts.geom.Coordinate,this.level=0,this.env=null,this.computeKey(t)},jsts.index.quadtree.Key.computeQuadLevel=function(t){var e,n,i,o;return e=t.getWidth(),n=t.getHeight(),i=e>n?e:n,o=jsts.index.DoubleBits.exponent(i)+1},jsts.index.quadtree.Key.prototype.getPoint=function(){return this.pt},jsts.index.quadtree.Key.prototype.getLevel=function(){return this.level},jsts.index.quadtree.Key.prototype.getEnvelope=function(){return this.env},jsts.index.quadtree.Key.prototype.getCentre=function(){var t,e;return t=(this.env.getMinX()+this.env.getMaxX())/2,e=(this.env.getMinY()+this.env.getMaxY())/2,new jsts.geom.Coordinate(t,e)},jsts.index.quadtree.Key.prototype.computeKey=function(){arguments[0]instanceof jsts.geom.Envelope?this.computeKeyFromEnvelope(arguments[0]):this.computeKeyFromLevel(arguments[0],arguments[1])},jsts.index.quadtree.Key.prototype.computeKeyFromEnvelope=function(t){for(this.level=jsts.index.quadtree.Key.computeQuadLevel(t),this.env=new jsts.geom.Envelope,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)},jsts.index.quadtree.Key.prototype.computeKeyFromLevel=function(t,e){var n=jsts.index.DoubleBits.powerOf2(t);this.pt.x=Math.floor(e.getMinX()/n)*n,this.pt.y=Math.floor(e.getMinY()/n)*n,this.env.init(this.pt.x,this.pt.x+n,this.pt.y,this.pt.y+n)},jsts.geom.CoordinateArrays=function(){throw new jsts.error.AbstractMethodInvocationError},jsts.geom.CoordinateArrays.copyDeep=function(){return 1===arguments.length?jsts.geom.CoordinateArrays.copyDeep1(arguments[0]):void(5===arguments.length&&jsts.geom.CoordinateArrays.copyDeep2(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]))},jsts.geom.CoordinateArrays.copyDeep1=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=new jsts.geom.Coordinate(t[n]);return e},jsts.geom.CoordinateArrays.copyDeep2=function(t,e,n,i,o){for(var r=0;r<o;r++)n[i+r]=new jsts.geom.Coordinate(t[e+r])},jsts.geom.CoordinateArrays.removeRepeatedPoints=function(t){var e;return this.hasRepeatedPoints(t)?(e=new jsts.geom.CoordinateList(t,(!1)),e.toCoordinateArray()):t},jsts.geom.CoordinateArrays.hasRepeatedPoints=function(t){var e;for(e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},jsts.geom.CoordinateArrays.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(jsts.geom.CoordinateArrays.indexOf(i,e)<0)return i}return null},jsts.geom.CoordinateArrays.increasingDirection=function(t){for(var e=0;e<parseInt(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!=i)return i}return 1},jsts.geom.CoordinateArrays.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},jsts.geom.CoordinateArrays.scroll=function(t,e){var n=jsts.geom.CoordinateArrays.indexOf(e,t);if(!(n<0)){var i=t.slice(n).concat(t.slice(0,n));for(n=0;n<i.length;n++)t[n]=i[n]}},jsts.geom.CoordinateArrays.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},jsts.operation.overlay.MinimalEdgeRing=function(t,e){jsts.geomgraph.EdgeRing.call(this,t,e)},jsts.operation.overlay.MinimalEdgeRing.prototype=new jsts.geomgraph.EdgeRing,jsts.operation.overlay.MinimalEdgeRing.constructor=jsts.operation.overlay.MinimalEdgeRing,jsts.operation.overlay.MinimalEdgeRing.prototype.getNext=function(t){return t.getNextMin()},jsts.operation.overlay.MinimalEdgeRing.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},jsts.triangulate.DelaunayTriangulationBuilder=function(){this.siteCoords=null,this.tolerance=0,this.subdiv=null},jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates=function(t){if(void 0===t||null===t)return new jsts.geom.CoordinateList([],(!1)).toArray();var e=t.getCoordinates();return jsts.triangulate.DelaunayTriangulationBuilder.unique(e)},jsts.triangulate.DelaunayTriangulationBuilder.unique=function(t){t.sort(function(t,e){return t.compareTo(e)});var e=new jsts.geom.CoordinateList(t,(!1));return e.toArray()},jsts.triangulate.DelaunayTriangulationBuilder.toVertices=function(t){var e,n=new Array(t.length),i=0,o=t.length;for(i;i<o;i++)e=t[i],n[i]=new jsts.triangulate.quadedge.Vertex(e);return n},jsts.triangulate.DelaunayTriangulationBuilder.envelope=function(t){var e=new jsts.geom.Envelope,n=0,i=t.length;for(n;n<i;n++)e.expandToInclude(t[n]);return e},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSites=function(){var t=arguments[0];t instanceof jsts.geom.Geometry||t instanceof jsts.geom.Coordinate||t instanceof jsts.geom.Point||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.LineString||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.LinearRing||t instanceof jsts.geom.Polygon||t instanceof jsts.geom.MultiPolygon?this.setSitesFromGeometry(t):this.setSitesFromCollection(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromGeometry=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.extractUniqueCoordinates(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setSitesFromCollection=function(t){this.siteCoords=jsts.triangulate.DelaunayTriangulationBuilder.unique(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.setTolerance=function(t){this.tolerance=t},jsts.triangulate.DelaunayTriangulationBuilder.prototype.create=function(){if(null===this.subdiv){var t,e,n;t=jsts.triangulate.DelaunayTriangulationBuilder.envelope(this.siteCoords),e=jsts.triangulate.DelaunayTriangulationBuilder.toVertices(this.siteCoords),this.subdiv=new jsts.triangulate.quadedge.QuadEdgeSubdivision(t,this.tolerance),n=new jsts.triangulate.IncrementalDelaunayTriangulator(this.subdiv),n.insertSites(e)}},jsts.triangulate.DelaunayTriangulationBuilder.prototype.getSubdivision=function(){return this.create(),this.subdiv},jsts.triangulate.DelaunayTriangulationBuilder.prototype.getEdges=function(t){return this.create(),this.subdiv.getEdges(t)},jsts.triangulate.DelaunayTriangulationBuilder.prototype.getTriangles=function(t){return this.create(),this.subdiv.getTriangles(t)},jsts.algorithm.RayCrossingCounter=function(t){this.p=t};jsts.algorithm.RayCrossingCounter.locatePointInRing=function(t,e){for(var n=new jsts.algorithm.RayCrossingCounter(t),i=1;i<e.length;i++){var o=e[i],r=e[i-1];if(n.countSegment(o,r),n.isOnSegment())return n.getLocation()}return n.getLocation()};jsts.algorithm.RayCrossingCounter.prototype.p=null,jsts.algorithm.RayCrossingCounter.prototype.crossingCount=0,jsts.algorithm.RayCrossingCounter.prototype.isPointOnSegment=!1,jsts.algorithm.RayCrossingCounter.prototype.countSegment=function(t,e){if(!(t.x<this.p.x&&e.x<this.p.x)){if(this.p.x==e.x&&this.p.y===e.y)return void(this.isPointOnSegment=!0);if(t.y===this.p.y&&e.y===this.p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),void(this.p.x>=n&&this.p.x<=i&&(this.isPointOnSegment=!0))}if(t.y>this.p.y&&e.y<=this.p.y||e.y>this.p.y&&t.y<=this.p.y){var o=t.x-this.p.x,r=t.y-this.p.y,s=e.x-this.p.x,a=e.y-this.p.y,l=jsts.algorithm.RobustDeterminant.signOfDet2x2(o,r,s,a);if(0===l)return void(this.isPointOnSegment=!0);a<r&&(l=-l),l>0&&this.crossingCount++}}},jsts.algorithm.RayCrossingCounter.prototype.isOnSegment=function(){return jsts.geom.isPointOnSegment},jsts.algorithm.RayCrossingCounter.prototype.getLocation=function(){return this.isPointOnSegment?jsts.geom.Location.BOUNDARY:this.crossingCount%2===1?jsts.geom.Location.INTERIOR:jsts.geom.Location.EXTERIOR},jsts.algorithm.RayCrossingCounter.prototype.isPointInPolygon=function(){return this.getLocation()!==jsts.geom.Location.EXTERIOR},jsts.operation.BoundaryOp=function(t,e){this.geom=t,this.geomFact=t.getFactory(),this.bnRule=e||jsts.algorithm.BoundaryNodeRule.MOD2_BOUNDARY_RULE},jsts.operation.BoundaryOp.prototype.geom=null,jsts.operation.BoundaryOp.prototype.geomFact=null,jsts.operation.BoundaryOp.prototype.bnRule=null,jsts.operation.BoundaryOp.prototype.getBoundary=function(){return this.geom instanceof jsts.geom.LineString?this.boundaryLineString(this.geom):this.geom instanceof jsts.geom.MultiLineString?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},jsts.operation.BoundaryOp.prototype.getEmptyMultiPoint=function(){return this.geomFact.createMultiPoint(null)},jsts.operation.BoundaryOp.prototype.boundaryMultiLineString=function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1==e.length?this.geomFact.createPoint(e[0]):this.geomFact.createMultiPoint(e)},jsts.operation.BoundaryOp.prototype.endpoints=null,jsts.operation.BoundaryOp.prototype.computeBoundaryCoordinates=function(t){var e,n,i,o=[];for(this.endpoints=[],e=0;e<t.getNumGeometries();e++)n=t.getGeometryN(e),0!=n.getNumPoints()&&(this.addEndpoint(n.getCoordinateN(0)),this.addEndpoint(n.getCoordinateN(n.getNumPoints()-1)));for(e=0;e<this.endpoints.length;e++)i=this.endpoints[e],this.bnRule.isInBoundary(i.count)&&o.push(i.coordinate);return o},jsts.operation.BoundaryOp.prototype.addEndpoint=function(t){var e,n,i=!1;for(e=0;e<this.endpoints.length;e++)if(n=this.endpoints[e],n.coordinate.equals(t)){i=!0;break}i||(n={},n.coordinate=t,n.count=0,this.endpoints.push(n)),n.count++},jsts.operation.BoundaryOp.prototype.boundaryLineString=function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();if(t.isClosed()){var e=this.bnRule.isInBoundary(2);return e?t.getStartPoint():this.geomFact.createMultiPoint(null)}return this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()]);
},jsts.operation.buffer.OffsetCurveSetBuilder=function(t,e,n){this.inputGeom=t,this.distance=e,this.curveBuilder=n,this.curveList=new javascript.util.ArrayList},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.inputGeom=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.distance=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveBuilder=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.curveList=null,jsts.operation.buffer.OffsetCurveSetBuilder.prototype.getCurves=function(){return this.add(this.inputGeom),this.curveList},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCurve=function(t,e,n){if(!(null==t||t.length<2)){var i=new jsts.noding.NodedSegmentString(t,new jsts.geomgraph.Label(0,jsts.geom.Location.BOUNDARY,e,n));this.curveList.add(i)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.add=function(t){if(!t.isEmpty())if(t instanceof jsts.geom.Polygon)this.addPolygon(t);else if(t instanceof jsts.geom.LineString)this.addLineString(t);else if(t instanceof jsts.geom.Point)this.addPoint(t);else if(t instanceof jsts.geom.MultiPoint)this.addCollection(t);else if(t instanceof jsts.geom.MultiLineString)this.addCollection(t);else if(t instanceof jsts.geom.MultiPolygon)this.addCollection(t);else{if(!(t instanceof jsts.geom.GeometryCollection))throw new jsts.error.IllegalArgumentError;this.addCollection(t)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPoint=function(t){if(!(this.distance<=0)){var e=t.getCoordinates(),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addLineString=function(t){if(!(this.distance<=0)||this.curveBuilder.getBufferParameters().isSingleSided()){var e=jsts.geom.CoordinateArrays.removeRepeatedPoints(t.getCoordinates()),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygon=function(t){var e=this.distance,n=jsts.geomgraph.Position.LEFT;this.distance<0&&(e=-this.distance,n=jsts.geomgraph.Position.RIGHT);var i=t.getExteriorRing(),o=jsts.geom.CoordinateArrays.removeRepeatedPoints(i.getCoordinates());if(!(this.distance<0&&this.isErodedCompletely(i,this.distance)||this.distance<=0&&o.length<3)){this.addPolygonRing(o,e,n,jsts.geom.Location.EXTERIOR,jsts.geom.Location.INTERIOR);for(var r=0;r<t.getNumInteriorRing();r++){var s=t.getInteriorRingN(r),a=jsts.geom.CoordinateArrays.removeRepeatedPoints(s.getCoordinates());this.distance>0&&this.isErodedCompletely(s,-this.distance)||this.addPolygonRing(a,e,jsts.geomgraph.Position.opposite(n),jsts.geom.Location.INTERIOR,jsts.geom.Location.EXTERIOR)}}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.addPolygonRing=function(t,e,n,i,o){if(!(0==e&&t.length<jsts.geom.LinearRing.MINIMUM_VALID_SIZE)){var r=i,s=o;t.length>=jsts.geom.LinearRing.MINIMUM_VALID_SIZE&&jsts.algorithm.CGAlgorithms.isCCW(t)&&(r=o,s=i,n=jsts.geomgraph.Position.opposite(n));var a=this.curveBuilder.getRingCurve(t,n,e);this.addCurve(a,r,s)}},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4==n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),o=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>o},jsts.operation.buffer.OffsetCurveSetBuilder.prototype.isTriangleErodedCompletely=function(t,e){var n=new jsts.geom.Triangle(t[0],t[1],t[2]),i=n.inCentre(),o=jsts.algorithm.CGAlgorithms.distancePointLine(i,n.p0,n.p1);return o<Math.abs(e)},jsts.operation.buffer.BufferSubgraph=function(){this.dirEdgeList=new javascript.util.ArrayList,this.nodes=new javascript.util.ArrayList,this.finder=new jsts.operation.buffer.RightmostEdgeFinder},jsts.operation.buffer.BufferSubgraph.prototype.finder=null,jsts.operation.buffer.BufferSubgraph.prototype.dirEdgeList=null,jsts.operation.buffer.BufferSubgraph.prototype.nodes=null,jsts.operation.buffer.BufferSubgraph.prototype.rightMostCoord=null,jsts.operation.buffer.BufferSubgraph.prototype.env=null,jsts.operation.buffer.BufferSubgraph.prototype.getDirectedEdges=function(){return this.dirEdgeList},jsts.operation.buffer.BufferSubgraph.prototype.getNodes=function(){return this.nodes},jsts.operation.buffer.BufferSubgraph.prototype.getEnvelope=function(){if(null===this.env){for(var t=new jsts.geom.Envelope,e=this.dirEdgeList.iterator();e.hasNext();)for(var n=e.next(),i=n.getEdge().getCoordinates(),o=0;o<i.length-1;o++)t.expandToInclude(i[o]);this.env=t}return this.env},jsts.operation.buffer.BufferSubgraph.prototype.getRightmostCoordinate=function(){return this.rightMostCoord},jsts.operation.buffer.BufferSubgraph.prototype.create=function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},jsts.operation.buffer.BufferSubgraph.prototype.addReachable=function(t){var e=[];for(e.push(t);0!==e.length;){var n=e.pop();this.add(n,e)}},jsts.operation.buffer.BufferSubgraph.prototype.add=function(t,e){t.setVisited(!0),this.nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this.dirEdgeList.add(i);var o=i.getSym(),r=o.getNode();r.isVisited()||e.push(r)}},jsts.operation.buffer.BufferSubgraph.prototype.clearVisitedEdges=function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.setVisited(!1)}},jsts.operation.buffer.BufferSubgraph.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this.finder.getEdge();e.getNode(),e.getLabel();e.setEdgeDepths(jsts.geomgraph.Position.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},jsts.operation.buffer.BufferSubgraph.prototype.computeDepths=function(t){var e=[],n=[],i=t.getNode();for(n.push(i),e.push(i),t.setVisited(!0);0!==n.length;){var o=n.shift();e.push(o),this.computeNodeDepth(o);for(var r=o.getEdges().iterator();r.hasNext();){var s=r.next(),a=s.getSym();if(!a.isVisited()){var l=a.getNode();e.indexOf(l)===-1&&(n.push(l),e.push(l))}}}},jsts.operation.buffer.BufferSubgraph.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null==e)throw new jsts.error.TopologyError("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();i.setVisited(!0),this.copySymDepths(i)}},jsts.operation.buffer.BufferSubgraph.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(jsts.geomgraph.Position.LEFT,t.getDepth(jsts.geomgraph.Position.RIGHT)),e.setDepth(jsts.geomgraph.Position.RIGHT,t.getDepth(jsts.geomgraph.Position.LEFT))},jsts.operation.buffer.BufferSubgraph.prototype.findResultEdges=function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(jsts.geomgraph.Position.RIGHT)>=1&&e.getDepth(jsts.geomgraph.Position.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},jsts.operation.buffer.BufferSubgraph.prototype.compareTo=function(t){var e=t;return this.rightMostCoord.x<e.rightMostCoord.x?-1:this.rightMostCoord.x>e.rightMostCoord.x?1:0},jsts.simplify.DPTransformer=function(t,e){this.distanceTolerance=t,this.isEnsureValidTopology=e},jsts.simplify.DPTransformer.prototype=new jsts.geom.util.GeometryTransformer,jsts.simplify.DPTransformer.prototype.distanceTolerance=null,jsts.simplify.DPTransformer.prototype.isEnsureValidTopology=null,jsts.simplify.DPTransformer.prototype.transformCoordinates=function(t,e){var n=t,i=null;return i=0==n.length?[]:jsts.simplify.DouglasPeuckerLineSimplifier.simplify(n,this.distanceTolerance)},jsts.simplify.DPTransformer.prototype.transformPolygon=function(t,e){if(t.isEmpty())return null;var n=jsts.geom.util.GeometryTransformer.prototype.transformPolygon.apply(this,arguments);return e instanceof jsts.geom.MultiPolygon?n:this.createValidArea(n)},jsts.simplify.DPTransformer.prototype.transformLinearRing=function(t,e){var n=e instanceof jsts.geom.Polygon,i=jsts.geom.util.GeometryTransformer.prototype.transformLinearRing.apply(this,arguments);return!n||i instanceof jsts.geom.LinearRing?i:null},jsts.simplify.DPTransformer.prototype.transformMultiPolygon=function(t,e){var n=jsts.geom.util.GeometryTransformer.prototype.transformMultiPolygon.apply(this,arguments);return this.createValidArea(n)},jsts.simplify.DPTransformer.prototype.createValidArea=function(t){return this.isEnsureValidTopology?t.buffer(0):t},jsts.geom.util.GeometryExtracter=function(t,e){this.clz=t,this.comps=e},jsts.geom.util.GeometryExtracter.prototype=new jsts.geom.GeometryFilter,jsts.geom.util.GeometryExtracter.prototype.clz=null,jsts.geom.util.GeometryExtracter.prototype.comps=null,jsts.geom.util.GeometryExtracter.extract=function(t,e,n){return n=n||new javascript.util.ArrayList,t instanceof e?n.add(t):(t instanceof jsts.geom.GeometryCollection||t instanceof jsts.geom.MultiPoint||t instanceof jsts.geom.MultiLineString||t instanceof jsts.geom.MultiPolygon)&&t.apply(new jsts.geom.util.GeometryExtracter(e,n)),n},jsts.geom.util.GeometryExtracter.prototype.filter=function(t){(null===this.clz||t instanceof this.clz)&&this.comps.add(t)},function(){var t=jsts.operation.overlay.OverlayOp,e=jsts.operation.overlay.snap.SnapOverlayOp,n=function(t,e){this.geom=[],this.geom[0]=t,this.geom[1]=e};n.overlayOp=function(t,e,i){var o=new n(t,e);return o.getResultGeometry(i)},n.intersection=function(e,n){return overlayOp(e,n,t.INTERSECTION)},n.union=function(e,n){return overlayOp(e,n,t.UNION)},n.difference=function(e,n){return overlayOp(e,n,t.DIFFERENCE)},n.symDifference=function(e,n){return overlayOp(e,n,t.SYMDIFFERENCE)},n.prototype.geom=null,n.prototype.getResultGeometry=function(n){var i=null,o=!1,r=null;try{i=t.overlayOp(this.geom[0],this.geom[1],n);var s=!0;s&&(o=!0)}catch(t){r=t}if(!o)try{i=e.overlayOp(this.geom[0],this.geom[1],n)}catch(t){throw r}return i},jsts.operation.overlay.snap.SnapIfNeededOverlayOp=n}(),function(){var t=jsts.geom.util.GeometryExtracter,e=jsts.operation.union.CascadedPolygonUnion,n=jsts.operation.union.PointGeometryUnion,i=jsts.operation.overlay.OverlayOp,o=jsts.operation.overlay.snap.SnapIfNeededOverlayOp,r=javascript.util.ArrayList;jsts.operation.union.UnaryUnionOp=function(t,e){this.polygons=new r,this.lines=new r,this.points=new r,e&&(this.geomFact=e),this.extract(t)},jsts.operation.union.UnaryUnionOp.union=function(t,e){var n=new jsts.operation.union.UnaryUnionOp(t,e);return n.union()},jsts.operation.union.UnaryUnionOp.prototype.polygons=null,jsts.operation.union.UnaryUnionOp.prototype.lines=null,jsts.operation.union.UnaryUnionOp.prototype.points=null,jsts.operation.union.UnaryUnionOp.prototype.geomFact=null,jsts.operation.union.UnaryUnionOp.prototype.extract=function(e){if(e instanceof r)for(var n=e.iterator();n.hasNext();){var i=n.next();this.extract(i)}else null===this.geomFact&&(this.geomFact=e.getFactory()),t.extract(e,jsts.geom.Polygon,this.polygons),t.extract(e,jsts.geom.LineString,this.lines),t.extract(e,jsts.geom.Point,this.points)},jsts.operation.union.UnaryUnionOp.prototype.union=function(){if(null===this.geomFact)return null;var t=null;if(this.points.size()>0){var i=this.geomFact.buildGeometry(this.points);t=this.unionNoOpt(i)}var o=null;if(this.lines.size()>0){var r=this.geomFact.buildGeometry(this.lines);o=this.unionNoOpt(r)}var s=null;this.polygons.size()>0&&(s=e.union(this.polygons));var a=this.unionWithNull(o,s),l=null;return l=null===t?a:null===a?t:n(t,a),null===l?this.geomFact.createGeometryCollection(null):l},jsts.operation.union.UnaryUnionOp.prototype.unionWithNull=function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)},jsts.operation.union.UnaryUnionOp.prototype.unionNoOpt=function(t){var e=this.geomFact.createPoint(null);return o.overlayOp(t,e,i.UNION)}}(),jsts.index.kdtree.KdNode=function(){this.left=null,this.right=null,this.count=1,2===arguments.length?this.initializeFromCoordinate.apply(this,arguments[0],arguments[1]):3===arguments.length&&this.initializeFromXY.apply(this,arguments[0],arguments[1],arguments[2])},jsts.index.kdtree.KdNode.prototype.initializeFromXY=function(t,e,n){this.p=new jsts.geom.Coordinate(t,e),this.data=n},jsts.index.kdtree.KdNode.prototype.initializeFromCoordinate=function(t,e){this.p=t,this.data=e},jsts.index.kdtree.KdNode.prototype.getX=function(){return this.p.x},jsts.index.kdtree.KdNode.prototype.getY=function(){return this.p.y},jsts.index.kdtree.KdNode.prototype.getCoordinate=function(){return this.p},jsts.index.kdtree.KdNode.prototype.getData=function(){return this.data},jsts.index.kdtree.KdNode.prototype.getLeft=function(){return this.left},jsts.index.kdtree.KdNode.prototype.getRight=function(){return this.right},jsts.index.kdtree.KdNode.prototype.increment=function(){this.count+=1},jsts.index.kdtree.KdNode.prototype.getCount=function(){return this.count},jsts.index.kdtree.KdNode.prototype.isRepeated=function(){return count>1},jsts.index.kdtree.KdNode.prototype.setLeft=function(t){this.left=t},jsts.index.kdtree.KdNode.prototype.setRight=function(t){this.right=t},jsts.algorithm.InteriorPointPoint=function(t){this.minDistance=Number.MAX_VALUE,this.interiorPoint=null,this.centroid=t.getCentroid().getCoordinate(),this.add(t)},jsts.algorithm.InteriorPointPoint.prototype.add=function(t){if(t instanceof jsts.geom.Point)this.addPoint(t.getCoordinate());else if(t instanceof jsts.geom.GeometryCollection)for(var e=0;e<t.getNumGeometries();e++)this.add(t.getGeometryN(e))},jsts.algorithm.InteriorPointPoint.prototype.addPoint=function(t){var e=t.distance(this.centroid);e<this.minDistance&&(this.interiorPoint=new jsts.geom.Coordinate(t),this.minDistance=e)},jsts.algorithm.InteriorPointPoint.prototype.getInteriorPoint=function(){return this.interiorPoint},function(){jsts.geom.MultiLineString=function(t,e){this.geometries=t||[],this.factory=e},jsts.geom.MultiLineString.prototype=new jsts.geom.GeometryCollection,jsts.geom.MultiLineString.constructor=jsts.geom.MultiLineString,jsts.geom.MultiLineString.prototype.getBoundary=function(){return new jsts.operation.BoundaryOp(this).getBoundary()},jsts.geom.MultiLineString.prototype.equalsExact=function(t,e){return!!this.isEquivalentClass(t)&&jsts.geom.GeometryCollection.prototype.equalsExact.call(this,t,e)},jsts.geom.MultiLineString.prototype.CLASS_NAME="jsts.geom.MultiLineString"}(),jsts.io.olParser=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory},jsts.io.olParser.prototype.read=function(t){return t instanceof ol.geom.Point?this.convertFromPoint(t):t instanceof ol.geom.LineString?this.convertFromLineString(t):t instanceof ol.geom.LinearRing?this.convertFromLinearRing(t):t instanceof ol.geom.Polygon?this.convertFromPolygon(t):t instanceof ol.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof ol.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof ol.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof ol.geom.GeometryCollection?this.convertFromCollection(t):void 0},jsts.io.olParser.prototype.convertFromPoint=function(t){var e=t.getCoordinates();return this.geometryFactory.createPoint(new jsts.geom.Coordinate(e[0],e[1]))},jsts.io.olParser.prototype.convertFromLineString=function(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(t){return new jsts.geom.Coordinate(t[0],t[1])}))},jsts.io.olParser.prototype.convertFromLinearRing=function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(t){return new jsts.geom.Coordinate(t[0],t[1])}))},jsts.io.olParser.prototype.convertFromPolygon=function(t){var e,n=t.getLinearRings(),i=null,o=[];for(e=0;e<n.length;e++){var r=this.convertFromLinearRing(n[e]);0===e?i=r:o.push(r)}return this.geometryFactory.createPolygon(i,o)},jsts.io.olParser.prototype.convertFromMultiPoint=function(t){var e=t.getPoints().map(function(t){return this.convertFromPoint(t)},this);return this.geometryFactory.createMultiPoint(e)},jsts.io.olParser.prototype.convertFromMultiLineString=function(t){var e=t.getLineStrings().map(function(t){return this.convertFromLineString(t)},this);return this.geometryFactory.createMultiLineString(e)},jsts.io.olParser.prototype.convertFromMultiPolygon=function(t){var e=t.getPolygons().map(function(t){return this.convertFromPolygon(t)},this);return this.geometryFactory.createMultiPolygon(e)},jsts.io.olParser.prototype.convertFromCollection=function(t){var e=t.getGeometries().map(function(t){return this.read(t)},this);return this.geometryFactory.createGeometryCollection(e)},jsts.io.olParser.prototype.write=function(t){return"jsts.geom.Point"===t.CLASS_NAME?this.convertToPoint(t.coordinate):"jsts.geom.LineString"===t.CLASS_NAME?this.convertToLineString(t):"jsts.geom.LinearRing"===t.CLASS_NAME?this.convertToLinearRing(t):"jsts.geom.Polygon"===t.CLASS_NAME?this.convertToPolygon(t):"jsts.geom.MultiPoint"===t.CLASS_NAME?this.convertToMultiPoint(t):"jsts.geom.MultiLineString"===t.CLASS_NAME?this.convertToMultiLineString(t):"jsts.geom.MultiPolygon"===t.CLASS_NAME?this.convertToMultiPolygon(t):"jsts.geom.GeometryCollection"===t.CLASS_NAME?this.convertToCollection(t):void 0},jsts.io.olParser.prototype.convertToPoint=function(t){return new ol.geom.Point([t.x,t.y])},jsts.io.olParser.prototype.convertToLineString=function(t){var e=t.points.map(function(t){return[t.x,t.y]},this);return new ol.geom.LineString(e)},jsts.io.olParser.prototype.convertToLinearRing=function(t){var e=t.points.map(function(t){return[t.x,t.y]},this);return new ol.geom.LinearRing(e)},jsts.io.olParser.prototype.convertToPolygon=function(t){var e,n=[];for(n.push(t.shell.points.map(function(t){return[t.x,t.y]},this)),e=0;e<t.holes.length;e++)n.push(t.holes[e].points.map(function(t){return[t.x,t.y]},this));return new ol.geom.Polygon(n)},jsts.io.olParser.prototype.convertToMultiPoint=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++)n.push(this.convertToPoint(t.geometries[e]).getCoordinates());return new ol.geom.MultiPoint(n)},jsts.io.olParser.prototype.convertToMultiLineString=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++)n.push(this.convertToLineString(t.geometries[e]).getCoordinates());return new ol.geom.MultiLineString(n)},jsts.io.olParser.prototype.convertToMultiPolygon=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++)n.push(this.convertToPolygon(t.geometries[e]).getCoordinates());return new ol.geom.MultiPolygon(n)},jsts.io.olParser.prototype.convertToCollection=function(t){var e,n=[];for(e=0;e<t.geometries.length;e++){var i=t.geometries[e];n.push(this.write(i))}return new ol.geom.GeometryCollection(n)},function(){var t=jsts.index.bintree.Interval,e=jsts.index.bintree.Root,n=function(){this.root=new e,this.minExtent=1};n.ensureExtent=function(e,n){var i,o;return i=e.getMin(),o=e.getMax(),i!==o?e:(i===o&&(i-=n/2,o=i+n/2),new t(i,o))},n.prototype.depth=function(){return null!==this.root?this.root.depth():0},n.prototype.size=function(){return null!==this.root?this.root.size():0},n.prototype.nodeSize=function(){return null!==this.root?this.root.nodeSize():0},n.prototype.insert=function(t,e){this.collectStats(t);var i=n.ensureExtent(t,this.minExtent);this.root.insert(i,e)},n.prototype.remove=function(t,e){var i=n.ensureExtent(t,this.minExtent);return this.root.remove(i,e)},n.prototype.iterator=function(){var t=new javascript.util.ArrayList;return this.root.addAllItems(t),t.iterator()},n.prototype.query=function(){if(2!==arguments.length){var e=arguments[0];return!e instanceof t&&(e=new t(e,e)),this.queryInterval(e)}this.queryAndAdd(arguments[0],arguments[1])},n.prototype.queryInterval=function(t){var e=new javascript.util.ArrayList;return this.query(t,e),e},n.prototype.queryAndAdd=function(t,e){this.root.addAllItemsFromOverlapping(t,e)},n.prototype.collectStats=function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e)},jsts.index.bintree.Bintree=n}(),jsts.algorithm.InteriorPointArea=function(t){this.factory,this.interiorPoint=null,this.maxWidth=0,this.factory=t.getFactory(),this.add(t)},jsts.algorithm.InteriorPointArea.avg=function(t,e){return(t+e)/2},jsts.algorithm.InteriorPointArea.prototype.getInteriorPoint=function(){return this.interiorPoint},jsts.algorithm.InteriorPointArea.prototype.add=function(t){if(t instanceof jsts.geom.Polygon)this.addPolygon(t);else if(t instanceof jsts.geom.GeometryCollection)for(var e=0;e<t.getNumGeometries();e++)this.add(t.getGeometryN(e))},jsts.algorithm.InteriorPointArea.prototype.addPolygon=function(t){if(!t.isEmpty()){var e,n=0,i=this.horizontalBisector(t);if(0==i.getLength())n=0,e=i.getCoordinate();else{var o=i.intersection(t),r=this.widestGeometry(o);n=r.getEnvelopeInternal().getWidth(),e=this.centre(r.getEnvelopeInternal())}(null==this.interiorPoint||n>this.maxWidth)&&(this.interiorPoint=e,this.maxWidth=n)}},jsts.algorithm.InteriorPointArea.prototype.widestGeometry=function(t){if(t instanceof jsts.geom.GeometryCollection){var e=t;if(e.isEmpty())return e;for(var n=e.getGeometryN(0),i=1;i<e.getNumGeometries();i++)e.getGeometryN(i).getEnvelopeInternal().getWidth()>n.getEnvelopeInternal().getWidth()&&(n=e.getGeometryN(i));return n}if(t instanceof jsts.geom.Geometry)return t},jsts.algorithm.InteriorPointArea.prototype.horizontalBisector=function(t){var e=t.getEnvelopeInternal(),n=jsts.algorithm.SafeBisectorFinder.getBisectorY(t);return this.factory.createLineString([new jsts.geom.Coordinate(e.getMinX(),n),new jsts.geom.Coordinate(e.getMaxX(),n)])},jsts.algorithm.InteriorPointArea.prototype.centre=function(t){return new jsts.geom.Coordinate(jsts.algorithm.InteriorPointArea.avg(t.getMinX(),t.getMaxX()),jsts.algorithm.InteriorPointArea.avg(t.getMinY(),t.getMaxY()))},jsts.algorithm.SafeBisectorFinder=function(t){this.poly,this.centreY,this.hiY=Number.MAX_VALUE,this.loY=-Number.MAX_VALUE,this.poly=t,this.hiY=t.getEnvelopeInternal().getMaxY(),this.loY=t.getEnvelopeInternal().getMinY(),this.centreY=jsts.algorithm.InteriorPointArea.avg(this.loY,this.hiY)},jsts.algorithm.SafeBisectorFinder.getBisectorY=function(t){var e=new jsts.algorithm.SafeBisectorFinder(t);return e.getBisectorY()},jsts.algorithm.SafeBisectorFinder.prototype.getBisectorY=function(){this.process(this.poly.getExteriorRing());for(var t=0;t<this.poly.getNumInteriorRing();t++)this.process(this.poly.getInteriorRingN(t));var e=jsts.algorithm.InteriorPointArea.avg(this.hiY,this.loY);return e},jsts.algorithm.SafeBisectorFinder.prototype.process=function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.length;n++){var i=e[n].y;this.updateInterval(i)}},jsts.algorithm.SafeBisectorFinder.prototype.updateInterval=function(t){t<=this.centreY?t>this.loY&&(this.loY=t):t>this.centreY&&t<this.hiY&&(this.hiY=t)},jsts.operation.buffer.BufferParameters=function(t,e,n,i){t&&this.setQuadrantSegments(t),e&&this.setEndCapStyle(e),n&&this.setJoinStyle(n),i&&this.setMitreLimit(i)},jsts.operation.buffer.BufferParameters.CAP_ROUND=1,jsts.operation.buffer.BufferParameters.CAP_FLAT=2,jsts.operation.buffer.BufferParameters.CAP_SQUARE=3,jsts.operation.buffer.BufferParameters.JOIN_ROUND=1,jsts.operation.buffer.BufferParameters.JOIN_MITRE=2,jsts.operation.buffer.BufferParameters.JOIN_BEVEL=3,jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS=8,jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT=5,jsts.operation.buffer.BufferParameters.prototype.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS,jsts.operation.buffer.BufferParameters.prototype.endCapStyle=jsts.operation.buffer.BufferParameters.CAP_ROUND,jsts.operation.buffer.BufferParameters.prototype.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_ROUND,jsts.operation.buffer.BufferParameters.prototype.mitreLimit=jsts.operation.buffer.BufferParameters.DEFAULT_MITRE_LIMIT,jsts.operation.buffer.BufferParameters.prototype._isSingleSided=!1,jsts.operation.buffer.BufferParameters.prototype.getQuadrantSegments=function(){return this.quadrantSegments},jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(t){this.quadrantSegments=t},jsts.operation.buffer.BufferParameters.prototype.setQuadrantSegments=function(t){this.quadrantSegments=t,0===this.quadrantSegments&&(this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=jsts.operation.buffer.BufferParameters.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),t<=0&&(this.quadrantSegments=1),this.joinStyle!==jsts.operation.buffer.BufferParameters.JOIN_ROUND&&(this.quadrantSegments=jsts.operation.buffer.BufferParameters.DEFAULT_QUADRANT_SEGMENTS)},jsts.operation.buffer.BufferParameters.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},jsts.operation.buffer.BufferParameters.prototype.getEndCapStyle=function(){return this.endCapStyle},jsts.operation.buffer.BufferParameters.prototype.setEndCapStyle=function(t){this.endCapStyle=t},jsts.operation.buffer.BufferParameters.prototype.getJoinStyle=function(){return this.joinStyle},jsts.operation.buffer.BufferParameters.prototype.setJoinStyle=function(t){this.joinStyle=t},jsts.operation.buffer.BufferParameters.prototype.getMitreLimit=function(){return this.mitreLimit},jsts.operation.buffer.BufferParameters.prototype.setMitreLimit=function(t){this.mitreLimit=t},jsts.operation.buffer.BufferParameters.prototype.setSingleSided=function(t){this._isSingleSided=t},jsts.operation.buffer.BufferParameters.prototype.isSingleSided=function(){return this._isSingleSided},function(){jsts.geom.util.ShortCircuitedGeometryVisitor=function(){},jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone_=!1,jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.applyTo=function(t){for(var e=0;e<t.getNumGeometries()&&!this.isDone_;e++){var n=t.getGeometryN(e);if(n instanceof jsts.geom.GeometryCollection)this.applyTo(n);else if(this.visit(n),this.isDone())return void(this.isDone_=!0)}},jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.visit=function(t){},jsts.geom.util.ShortCircuitedGeometryVisitor.prototype.isDone=function(){}}(),function(){var t=jsts.geom.util.LinearComponentExtracter,e=jsts.algorithm.RectangleLineIntersector,n=jsts.algorithm.locate.SimplePointInAreaLocator,i=function(t){this.rectEnv=t};i.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor,i.constructor=i,i.prototype.rectEnv=null,i.prototype.intersects_=!1,i.prototype.intersects=function(){return this.intersects_},i.prototype.visit=function(t){var e=t.getEnvelopeInternal();if(this.rectEnv.intersects(e))return this.rectEnv.contains(e)?void(this.intersects_=!0):e.getMinX()>=this.rectEnv.getMinX()&&e.getMaxX()<=this.rectEnv.getMaxX()?void(this.intersects_=!0):e.getMinY()>=this.rectEnv.getMinY()&&e.getMaxY()<=this.rectEnv.getMaxY()?void(this.intersects_=!0):void 0},i.prototype.isDone=function(){return 1==this.intersects_};var o=function(t){this.rectSeq=t.getExteriorRing().getCoordinateSequence(),this.rectEnv=t.getEnvelopeInternal()};o.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor,o.constructor=o,o.prototype.rectSeq=null,o.prototype.rectEnv=null,o.prototype.containsPoint=!1,o.prototype.containsPoint=function(){return this.containsPoint_},o.prototype.visit=function(t){if(t instanceof jsts.geom.Polygon){var e=t.getEnvelopeInternal();if(this.rectEnv.intersects(e))for(var i=new jsts.geom.Coordinate,o=0;o<4;o++){var i=this.rectSeq[o];if(e.contains(i)&&n.containsPointInPolygon(i,t))return void(this.containsPoint_=!0)}}},o.prototype.isDone=function(){return 1==this.containsPoint_};var r=function(t){this.rectEnv=t.getEnvelopeInternal(),this.rectIntersector=new e(this.rectEnv)};r.prototype=new jsts.geom.util.ShortCircuitedGeometryVisitor,r.constructor=r,r.prototype.rectEnv=null,r.prototype.rectIntersector=null,r.prototype.hasIntersection=!1,r.prototype.p0=null,r.prototype.p1=null,r.prototype.intersects=function(){return this.hasIntersection},r.prototype.visit=function(e){var n=e.getEnvelopeInternal();if(this.rectEnv.intersects(n)){var i=t.getLines(e);this.checkIntersectionWithLineStrings(i)}},r.prototype.checkIntersectionWithLineStrings=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(this.checkIntersectionWithSegments(n),this.hasIntersection)return}},r.prototype.checkIntersectionWithSegments=function(t){for(var e=t.getCoordinateSequence(),n=1;n<e.length;n++)if(this.p0=e[n-1],this.p1=e[n],this.rectIntersector.intersects(this.p0,this.p1))return void(this.hasIntersection=!0)},r.prototype.isDone=function(){return 1==this.hasIntersection},jsts.operation.predicate.RectangleIntersects=function(t){this.rectangle=t,this.rectEnv=t.getEnvelopeInternal()},jsts.operation.predicate.RectangleIntersects.intersects=function(t,e){var n=new jsts.operation.predicate.RectangleIntersects(t);return n.intersects(e)},jsts.operation.predicate.RectangleIntersects.prototype.rectangle=null,jsts.operation.predicate.RectangleIntersects.prototype.rectEnv=null,jsts.operation.predicate.RectangleIntersects.prototype.intersects=function(t){if(!this.rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new i(this.rectEnv);if(e.applyTo(t),e.intersects())return!0;var n=new o(this.rectangle);if(n.applyTo(t),n.containsPoint())return!0;var s=new r(this.rectangle);return s.applyTo(t),!!s.intersects()}}(),jsts.operation.buffer.BufferBuilder=function(t){this.bufParams=t,this.edgeList=new jsts.geomgraph.EdgeList},jsts.operation.buffer.BufferBuilder.depthDelta=function(t){var e=t.getLocation(0,jsts.geomgraph.Position.LEFT),n=t.getLocation(0,jsts.geomgraph.Position.RIGHT);return e===jsts.geom.Location.INTERIOR&&n===jsts.geom.Location.EXTERIOR?1:e===jsts.geom.Location.EXTERIOR&&n===jsts.geom.Location.INTERIOR?-1:0},jsts.operation.buffer.BufferBuilder.prototype.bufParams=null,jsts.operation.buffer.BufferBuilder.prototype.workingPrecisionModel=null,jsts.operation.buffer.BufferBuilder.prototype.workingNoder=null,jsts.operation.buffer.BufferBuilder.prototype.geomFact=null,jsts.operation.buffer.BufferBuilder.prototype.graph=null,jsts.operation.buffer.BufferBuilder.prototype.edgeList=null,jsts.operation.buffer.BufferBuilder.prototype.setWorkingPrecisionModel=function(t){this.workingPrecisionModel=t},jsts.operation.buffer.BufferBuilder.prototype.setNoder=function(t){this.workingNoder=t},jsts.operation.buffer.BufferBuilder.prototype.buffer=function(t,e){var n=this.workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this.geomFact=t.getFactory();var i=new jsts.operation.buffer.OffsetCurveBuilder(n,this.bufParams),o=new jsts.operation.buffer.OffsetCurveSetBuilder(t,e,i),r=o.getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this.graph=new jsts.geomgraph.PlanarGraph(new jsts.operation.overlay.OverlayNodeFactory),this.graph.addEdges(this.edgeList.getEdges());var s=this.createSubgraphs(this.graph),a=new jsts.operation.overlay.PolygonBuilder(this.geomFact);this.buildSubgraphs(s,a);var l=a.getPolygons();if(l.size()<=0)return this.createEmptyResultGeometry();var d=this.geomFact.buildGeometry(l);return d},jsts.operation.buffer.BufferBuilder.prototype.getNoder=function(t){if(null!==this.workingNoder)return this.workingNoder;var e=new jsts.noding.MCIndexNoder,n=new jsts.algorithm.RobustLineIntersector;return n.setPrecisionModel(t),e.setSegmentIntersector(new jsts.noding.IntersectionAdder(n)),e},jsts.operation.buffer.BufferBuilder.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings(),o=i.iterator();o.hasNext();){var r=o.next(),s=r.getData(),a=new jsts.geomgraph.Edge(r.getCoordinates(),new jsts.geomgraph.Label(s));this.insertUniqueEdge(a)}},jsts.operation.buffer.BufferBuilder.prototype.insertUniqueEdge=function(t){var e=this.edgeList.findEqualEdge(t);if(null!=e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new jsts.geomgraph.Label(t.getLabel()),i.flip()),
n.merge(i);var o=jsts.operation.buffer.BufferBuilder.depthDelta(i),r=e.getDepthDelta(),s=r+o;e.setDepthDelta(s)}else this.edgeList.add(t),t.setDepthDelta(jsts.operation.buffer.BufferBuilder.depthDelta(t.getLabel()))},jsts.operation.buffer.BufferBuilder.prototype.createSubgraphs=function(t){for(var e=[],n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var o=new jsts.operation.buffer.BufferSubgraph;o.create(i),e.push(o)}}var r=function(t,e){return t.compareTo(e)};return e.sort(r),e.reverse(),e},jsts.operation.buffer.BufferBuilder.prototype.buildSubgraphs=function(t,e){for(var n=[],i=0;i<t.length;i++){var o=t[i],r=o.getRightmostCoordinate(),s=new jsts.operation.buffer.SubgraphDepthLocater(n),a=s.getDepth(r);o.computeDepth(a),o.findResultEdges(),n.push(o),e.add(o.getDirectedEdges(),o.getNodes())}},jsts.operation.buffer.BufferBuilder.convertSegStrings=function(t){for(var e=new jsts.geom.GeometryFactory,n=new javascript.util.ArrayList;t.hasNext();){var i=t.next(),o=e.createLineString(i.getCoordinates());n.add(o)}return e.buildGeometry(n)},jsts.operation.buffer.BufferBuilder.prototype.createEmptyResultGeometry=function(){var t=this.geomFact.createPolygon(null,null);return t},jsts.noding.SegmentPointComparator=function(){},jsts.noding.SegmentPointComparator.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=jsts.noding.SegmentPointComparator.relativeSign(e.x,n.x),o=jsts.noding.SegmentPointComparator.relativeSign(e.y,n.y);switch(t){case 0:return jsts.noding.SegmentPointComparator.compareValue(i,o);case 1:return jsts.noding.SegmentPointComparator.compareValue(o,i);case 2:return jsts.noding.SegmentPointComparator.compareValue(o,-i);case 3:return jsts.noding.SegmentPointComparator.compareValue(-i,o);case 4:return jsts.noding.SegmentPointComparator.compareValue(-i,-o);case 5:return jsts.noding.SegmentPointComparator.compareValue(-o,-i);case 6:return jsts.noding.SegmentPointComparator.compareValue(-o,i);case 7:return jsts.noding.SegmentPointComparator.compareValue(i,-o)}return 0},jsts.noding.SegmentPointComparator.relativeSign=function(t,e){return t<e?-1:t>e?1:0},jsts.noding.SegmentPointComparator.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0},jsts.operation.relate.RelateOp=function(){jsts.operation.GeometryGraphOperation.apply(this,arguments),this._relate=new jsts.operation.relate.RelateComputer(this.arg)},jsts.operation.relate.RelateOp.prototype=new jsts.operation.GeometryGraphOperation,jsts.operation.relate.RelateOp.relate=function(t,e,n){var i=new jsts.operation.relate.RelateOp(t,e,n),o=i.getIntersectionMatrix();return o},jsts.operation.relate.RelateOp.prototype._relate=null,jsts.operation.relate.RelateOp.prototype.getIntersectionMatrix=function(){return this._relate.computeIM()},jsts.index.chain.MonotoneChain=function(t,e,n,i){this.pts=t,this.start=e,this.end=n,this.context=i},jsts.index.chain.MonotoneChain.prototype.pts=null,jsts.index.chain.MonotoneChain.prototype.start=null,jsts.index.chain.MonotoneChain.prototype.end=null,jsts.index.chain.MonotoneChain.prototype.env=null,jsts.index.chain.MonotoneChain.prototype.context=null,jsts.index.chain.MonotoneChain.prototype.id=null,jsts.index.chain.MonotoneChain.prototype.setId=function(t){this.id=t},jsts.index.chain.MonotoneChain.prototype.getId=function(){return this.id},jsts.index.chain.MonotoneChain.prototype.getContext=function(){return this.context},jsts.index.chain.MonotoneChain.prototype.getEnvelope=function(){if(null==this.env){var t=this.pts[this.start],e=this.pts[this.end];this.env=new jsts.geom.Envelope(t,e)}return this.env},jsts.index.chain.MonotoneChain.prototype.getStartIndex=function(){return this.start},jsts.index.chain.MonotoneChain.prototype.getEndIndex=function(){return this.end},jsts.index.chain.MonotoneChain.prototype.getLineSegment=function(t,e){e.p0=this.pts[t],e.p1=this.pts[t+1]},jsts.index.chain.MonotoneChain.prototype.getCoordinates=function(){for(var t=[],e=0,n=this.start;n<=this.end;n++)t[e++]=this.pts[n];return t},jsts.index.chain.MonotoneChain.prototype.select=function(t,e){this.computeSelect2(t,this.start,this.end,e)},jsts.index.chain.MonotoneChain.prototype.computeSelect2=function(t,e,n,i){var o=this.pts[e],r=this.pts[n];if(i.tempEnv1.init(o,r),n-e===1)return void i.select(this,e);if(t.intersects(i.tempEnv1)){var s=parseInt((e+n)/2);e<s&&this.computeSelect2(t,e,s,i),s<n&&this.computeSelect2(t,s,n,i)}},jsts.index.chain.MonotoneChain.prototype.computeOverlaps=function(t,e){return 6===arguments.length?this.computeOverlaps2.apply(this,arguments):void this.computeOverlaps2(this.start,this.end,t,t.start,t.end,e)},jsts.index.chain.MonotoneChain.prototype.computeOverlaps2=function(t,e,n,i,o,r){var s=this.pts[t],a=this.pts[e],l=n.pts[i],d=n.pts[o];if(e-t===1&&o-i===1)return void r.overlap(this,t,n,i);if(r.tempEnv1.init(s,a),r.tempEnv2.init(l,d),r.tempEnv1.intersects(r.tempEnv2)){var c=parseInt((t+e)/2),h=parseInt((i+o)/2);t<c&&(i<h&&this.computeOverlaps2(t,c,n,i,h,r),h<o&&this.computeOverlaps2(t,c,n,h,o,r)),c<e&&(i<h&&this.computeOverlaps2(c,e,n,i,h,r),h<o&&this.computeOverlaps2(c,e,n,h,o,r))}},function(){var t=jsts.geom.Location,e=jsts.geom.Dimension;jsts.geom.IntersectionMatrix=function(n){var i=n;void 0===n||null===n?(this.matrix=[[],[],[]],this.setAll(e.FALSE)):"string"==typeof n?this.set(n):i instanceof jsts.geom.IntersectionMatrix&&(this.matrix[t.INTERIOR][t.INTERIOR]=i.matrix[t.INTERIOR][t.INTERIOR],this.matrix[t.INTERIOR][t.BOUNDARY]=i.matrix[t.INTERIOR][t.BOUNDARY],this.matrix[t.INTERIOR][t.EXTERIOR]=i.matrix[t.INTERIOR][t.EXTERIOR],this.matrix[t.BOUNDARY][t.INTERIOR]=i.matrix[t.BOUNDARY][t.INTERIOR],this.matrix[t.BOUNDARY][t.BOUNDARY]=i.matrix[t.BOUNDARY][t.BOUNDARY],this.matrix[t.BOUNDARY][t.EXTERIOR]=i.matrix[t.BOUNDARY][t.EXTERIOR],this.matrix[t.EXTERIOR][t.INTERIOR]=i.matrix[t.EXTERIOR][t.INTERIOR],this.matrix[t.EXTERIOR][t.BOUNDARY]=i.matrix[t.EXTERIOR][t.BOUNDARY],this.matrix[t.EXTERIOR][t.EXTERIOR]=i.matrix[t.EXTERIOR][t.EXTERIOR])},jsts.geom.IntersectionMatrix.prototype.matrix=null,jsts.geom.IntersectionMatrix.prototype.add=function(t){var e,n;for(e=0;e<3;e++)for(n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))},jsts.geom.IntersectionMatrix.matches=function(t,n){return"string"==typeof t?jsts.geom.IntersectionMatrix.matches2.call(this,arguments):"*"===n||("T"===n&&(t>=0||t===e.TRUE)||("F"===n&&t===e.FALSE||("0"===n&&t===e.P||("1"===n&&t===e.L||"2"===n&&t===e.A))))},jsts.geom.IntersectionMatrix.matches2=function(t,e){var n=new jsts.geom.IntersectionMatrix(t);return n.matches(e)},jsts.geom.IntersectionMatrix.prototype.set=function(t,e,n){return"string"==typeof t?void this.set2(t):void(this.matrix[t][e]=n)},jsts.geom.IntersectionMatrix.prototype.set2=function(t){this.matrix=[[],[],[]],this.setAll(e.FALSE);for(var n=0;n<t.length;n++){var i=n%3,o=Math.floor(n/3);this.matrix[o][i]=e.toDimensionValue(t.charAt(n))}},jsts.geom.IntersectionMatrix.prototype.setAtLeast=function(t,e,n){return 1===arguments.length?void this.setAtLeast2(arguments[0]):void(this.matrix[t][e]<n&&(this.matrix[t][e]=n))},jsts.geom.IntersectionMatrix.prototype.setAtLeastIfValid=function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)},jsts.geom.IntersectionMatrix.prototype.setAtLeast2=function(t){var n;for(n=0;n<t.length;n++){var i=parseInt(n/3),o=parseInt(n%3);this.setAtLeast(i,o,e.toDimensionValue(t.charAt(n)))}},jsts.geom.IntersectionMatrix.prototype.setAll=function(t){var e,n;for(e=0;e<3;e++)for(n=0;n<3;n++)this.matrix[e][n]=t},jsts.geom.IntersectionMatrix.prototype.get=function(t,e){return this.matrix[t][e]},jsts.geom.IntersectionMatrix.prototype.isDisjoint=function(){return this.matrix[t.INTERIOR][t.INTERIOR]===e.FALSE&&this.matrix[t.INTERIOR][t.BOUNDARY]===e.FALSE&&this.matrix[t.BOUNDARY][t.INTERIOR]===e.FALSE&&this.matrix[t.BOUNDARY][t.BOUNDARY]===e.FALSE},jsts.geom.IntersectionMatrix.prototype.isIntersects=function(){return!this.isDisjoint()},jsts.geom.IntersectionMatrix.prototype.isTouches=function(n,i){return n>i?this.isTouches(i,n):(n==e.A&&i==e.A||n==e.L&&i==e.L||n==e.L&&i==e.A||n==e.P&&i==e.A||n==e.P&&i==e.L)&&(this.matrix[t.INTERIOR][t.INTERIOR]===e.FALSE&&(jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.BOUNDARY],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.BOUNDARY],"T")))},jsts.geom.IntersectionMatrix.prototype.isCrosses=function(n,i){return n==e.P&&i==e.L||n==e.P&&i==e.A||n==e.L&&i==e.A?jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.EXTERIOR],"T"):n==e.L&&i==e.P||n==e.A&&i==e.P||n==e.A&&i==e.L?jsts.geom.IntersectionMatrix.matches(matrix[t.INTERIOR][t.INTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.EXTERIOR][t.INTERIOR],"T"):n===e.L&&i===e.L&&0===this.matrix[t.INTERIOR][t.INTERIOR]},jsts.geom.IntersectionMatrix.prototype.isWithin=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&this.matrix[t.INTERIOR][t.EXTERIOR]==e.FALSE&&this.matrix[t.BOUNDARY][t.EXTERIOR]==e.FALSE},jsts.geom.IntersectionMatrix.prototype.isContains=function(){return jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&this.matrix[t.EXTERIOR][t.INTERIOR]==e.FALSE&&this.matrix[t.EXTERIOR][t.BOUNDARY]==e.FALSE},jsts.geom.IntersectionMatrix.prototype.isCovers=function(){var n=jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.BOUNDARY],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.BOUNDARY],"T");return n&&this.matrix[t.EXTERIOR][t.INTERIOR]==e.FALSE&&this.matrix[t.EXTERIOR][t.BOUNDARY]==e.FALSE},jsts.geom.IntersectionMatrix.prototype.isCoveredBy=function(){var n=jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.BOUNDARY],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.INTERIOR],"T")||jsts.geom.IntersectionMatrix.matches(this.matrix[t.BOUNDARY][t.BOUNDARY],"T");return n&&this.matrix[t.INTERIOR][t.EXTERIOR]===e.FALSE&&this.matrix[t.BOUNDARY][t.EXTERIOR]===e.FALSE},jsts.geom.IntersectionMatrix.prototype.isEquals=function(n,i){return n===i&&(jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&this.matrix[t.EXTERIOR][t.INTERIOR]===e.FALSE&&this.matrix[t.INTERIOR][t.EXTERIOR]===e.FALSE&&this.matrix[t.EXTERIOR][t.BOUNDARY]===e.FALSE&&this.matrix[t.BOUNDARY][t.EXTERIOR]===e.FALSE)},jsts.geom.IntersectionMatrix.prototype.isOverlaps=function(n,i){return n==e.P&&i===e.P||n==e.A&&i===e.A?jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.INTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.EXTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.EXTERIOR][t.INTERIOR],"T"):n===e.L&&i===e.L&&(1==this.matrix[t.INTERIOR][t.INTERIOR]&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.INTERIOR][t.EXTERIOR],"T")&&jsts.geom.IntersectionMatrix.matches(this.matrix[t.EXTERIOR][t.INTERIOR],"T"))},jsts.geom.IntersectionMatrix.prototype.matches=function(t){if(9!=t.length)throw new jsts.error.IllegalArgumentException("Should be length 9: "+t);for(var e=0;e<3;e++)for(var n=0;n<3;n++)if(!jsts.geom.IntersectionMatrix.matches(this.matrix[e][n],t.charAt(3*e+n)))return!1;return!0},jsts.geom.IntersectionMatrix.prototype.transpose=function(){var t=matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},jsts.geom.IntersectionMatrix.prototype.toString=function(){var t,n,i="";for(t=0;t<3;t++)for(n=0;n<3;n++)i+=e.toDimensionSymbol(this.matrix[t][n]);return i}}(),jsts.triangulate.quadedge.LastFoundQuadEdgeLocator=function(t){this.subdiv=t,this.lastEdge=null,this.init()},jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.init=function(){this.lastEdge=this.findEdge()},jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.findEdge=function(){var t=this.subdiv.getEdges();return t[0]};jsts.triangulate.quadedge.LastFoundQuadEdgeLocator.prototype.locate=function(t){this.lastEdge.isLive()||this.init();var e=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=e,e};jsts.noding.SegmentNodeList=function(t){this.nodeMap=new javascript.util.TreeMap,this.edge=t},jsts.noding.SegmentNodeList.prototype.nodeMap=null,jsts.noding.SegmentNodeList.prototype.iterator=function(){return this.nodeMap.values().iterator()},jsts.noding.SegmentNodeList.prototype.edge=null,jsts.noding.SegmentNodeList.prototype.getEdge=function(){return this.edge},jsts.noding.SegmentNodeList.prototype.add=function(t,e){var n=new jsts.noding.SegmentNode(this.edge,t,e,this.edge.getSegmentOctant(e)),i=this.nodeMap.get(n);return null!==i?(jsts.util.Assert.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this.nodeMap.put(n,n),n)},jsts.noding.SegmentNodeList.prototype.addEndpoints=function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},jsts.noding.SegmentNodeList.prototype.addCollapsedNodes=function(){var t=[];this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=0;e<t.length;e++){var n=t[e];this.add(this.edge.getCoordinate(n),n)}},jsts.noding.SegmentNodeList.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this.edge.size()-2;e++){var n=this.edge.getCoordinate(e),i=(this.edge.getCoordinate(e+1),this.edge.getCoordinate(e+2));n.equals2D(i)&&t.push(e+1)}},jsts.noding.SegmentNodeList.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=[null],n=this.iterator(),i=n.next();n.hasNext();){var o=n.next(),r=this.findCollapseIndex(i,o,e);r&&t.push(e[0]),i=o}},jsts.noding.SegmentNodeList.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},jsts.noding.SegmentNodeList.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),o=this.createSplitEdge(n,i);t.add(o),n=i}},jsts.noding.SegmentNodeList.prototype.checkSplitEdgesCorrectness=function(t){var e=edge.getCoordinates(),n=t[0],i=n.getCoordinate(0);if(!i.equals2D(e[0]))throw new Error("bad split edge start point at "+i);var o=t[t.length-1],r=o.getCoordinates(),s=r[r.length-1];if(!s.equals2D(e[e.length-1]))throw new Error("bad split edge end point at "+s)},jsts.noding.SegmentNodeList.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.getCoordinate(e.segmentIndex),o=e.isInterior()||!e.coord.equals2D(i);o||n--;var r=[],s=0;r[s++]=new jsts.geom.Coordinate(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)r[s++]=this.edge.getCoordinate(a);return o&&(r[s]=e.coord),new jsts.noding.NodedSegmentString(r,this.edge.getData())},jsts.io.WKTWriter=function(){this.parser=new jsts.io.WKTParser(this.geometryFactory)},jsts.io.WKTWriter.prototype.write=function(t){var e=this.parser.write(t);return e},jsts.io.WKTWriter.toLineString=function(t,e){if(2!==arguments.length)throw new jsts.error.NotImplementedError;return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"},jsts.operation.linemerge.LineMerger=function(){this.graph=new jsts.operation.linemerge.LineMergeGraph,this.mergedLineStrings=null,this.factory=null,this.edgeStrings=null},jsts.operation.linemerge.LineMerger.prototype.addGeometry=function(t){var e=this,n=new jsts.geom.GeometryComponentFilter;n.filter=function(t){t instanceof jsts.geom.LineString&&e.addLineString(t)},t.apply(n)},jsts.operation.linemerge.LineMerger.prototype.addCollection=function(t){this.mergedLineStrings=null;for(var e=0;e<t.getNumGeometries();++e){var n=t.getGeometryN(e);this.addGeometry(n)}},jsts.operation.linemerge.LineMerger.prototype.addLineString=function(t){null==this.factory&&(this.factory=t.getFactory()),this.graph.addEdge(t)},jsts.operation.linemerge.LineMerger.prototype.merge=function(){if(null==this.mergedLineStrings){jsts.planargraph.GraphComponent.setMarked(this.graph.nodeIterator(),!1),jsts.planargraph.GraphComponent.setMarked(this.graph.edgeIterator(),!1),this.edgeStrings=[],this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this.mergedLineStrings=[];for(var t=0;t<this.edgeStrings.length;++t){var e=this.edgeStrings[t];this.mergedLineStrings.push(e.toLineString())}}},jsts.operation.linemerge.LineMerger.prototype.buildEdgeStringsForObviousStartNodes=function(){this.buildEdgeStringsForNonDegree2Nodes()},jsts.operation.linemerge.LineMerger.prototype.buildEdgeStringsForIsolatedLoops=function(){this.buildEdgeStringsForUnprocessedNodes()},jsts.operation.linemerge.LineMerger.prototype.buildEdgeStringsForUnprocessedNodes=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(jsts.util.Assert.isTrue(2==e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},jsts.operation.linemerge.LineMerger.prototype.buildEdgeStringsForNonDegree2Nodes=function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();2!=e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},jsts.operation.linemerge.LineMerger.prototype.buildEdgeStringsStartingAt=function(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var n=e.next();n.getEdge().isMarked()||this.edgeStrings.push(this.buildEdgeStringStartingWith(n))}},jsts.operation.linemerge.LineMerger.prototype.buildEdgeStringStartingWith=function(t){var e=new jsts.operation.linemerge.EdgeString(this.factory),n=t;do e.add(n),n.getEdge().setMarked(!0),n=n.getNext();while(null!=n&&n!=t);return e},jsts.operation.linemerge.LineMerger.prototype.getMergedLineStrings=function(){return this.merge(),this.mergedLineStrings},jsts.io.WKTReader=function(t){this.geometryFactory=t||new jsts.geom.GeometryFactory,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new jsts.io.WKTParser(this.geometryFactory)},jsts.io.WKTReader.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===jsts.geom.PrecisionModel.FIXED&&this.reducePrecision(e),e},jsts.io.WKTReader.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])},jsts.triangulate.quadedge.QuadEdgeSubdivision=function(t,e){this.tolerance=e,this.edgeCoincidenceTolerance=e/jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR,this.visitedKey=0,this.quadEdges=[],this.startingEdge,this.tolerance,this.edgeCoincidenceTolerance,this.frameEnv,this.locator=null,this.seg=new jsts.geom.LineSegment,this.triEdges=new Array(3),this.frameVertex=new Array(3),this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new jsts.triangulate.quadedge.LastFoundQuadEdgeLocator(this)},jsts.triangulate.quadedge.QuadEdgeSubdivision.EDGE_COINCIDENCE_TOL_FACTOR=1e3,jsts.triangulate.quadedge.QuadEdgeSubdivision.getTriangleEdges=function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!=e[0])throw new jsts.IllegalArgumentError("Edges do not form a triangle")},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.createFrame=function(t){var e,n,i;e=t.getWidth(),n=t.getHeight(),i=0,i=e>n?10*e:10*n,this.frameVertex[0]=new jsts.triangulate.quadedge.Vertex((t.getMaxX()+t.getMinX())/2,t.getMaxY()+i),this.frameVertex[1]=new jsts.triangulate.quadedge.Vertex(t.getMinX()-i,t.getMinY()-i),this.frameVertex[2]=new jsts.triangulate.quadedge.Vertex(t.getMaxX()+i,t.getMinY()-i),this.frameEnv=new jsts.geom.Envelope(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.initSubdiv=function(){var t,e,n;return t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),e=this.makeEdge(this.frameVertex[1],this.frameVertex[2]),jsts.triangulate.quadedge.QuadEdge.splice(t.sym(),e),n=this.makeEdge(this.frameVertex[2],this.frameVertex[0]),jsts.triangulate.quadedge.QuadEdge.splice(e.sym(),n),jsts.triangulate.quadedge.QuadEdge.splice(n.sym(),t),t},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTolerance=function(){return this.tolerance},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEnvelope=function(){return new jsts.geom.Envelope(this.frameEnv)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdges=function(){return arguments.length>0?this.getEdgesByFactory(arguments[0]):this.quadEdges},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.setLocator=function(t){this.locator=t},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.makeEdge=function(t,e){var n=jsts.triangulate.quadedge.QuadEdge.makeEdge(t,e);return this.quadEdges.push(n),n},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.connect=function(t,e){var n=jsts.triangulate.quadedge.QuadEdge.connect(t,e);return this.quadEdges.push(n),n},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.delete_jsts=function(t){jsts.triangulate.quadedge.QuadEdge.splice(t,t.oPrev()),jsts.triangulate.quadedge.QuadEdge.splice(t.sym(),t.sym().oPrev());var e,n,i;t.eSym=t.sym(),n=t.rot,i=t.rot.sym();var o=this.quadEdges.indexOf(t);o!==-1&&this.quadEdges.splice(o,1),o=this.quadEdges.indexOf(e),o!==-1&&this.quadEdges.splice(o,1),o=this.quadEdges.indexOf(n),o!==-1&&this.quadEdges.splice(o,1),o=this.quadEdges.indexOf(i),o!==-1&&this.quadEdges.splice(o,1),t.delete_jsts(),e.delete_jsts(),n.delete_jsts(),i.delete_jsts()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateFromEdge=function(t,e){var n,i=0,o=this.quadEdges.length;for(n=e;;){if(i++,i>o)throw new jsts.error.LocateFailureError(n.toLineSegment());if(t.equals(n.orig())||t.equals(n.dest()))break;if(t.rightOf(n))n=n.sym();else if(t.rightOf(n.oNext())){if(t.rightOf(n.dPrev()))break;n=n.dPrev()}else n=n.oNext()}return n},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locate=function(){return 1===arguments.length?arguments[0]instanceof jsts.triangulate.quadedge.Vertex?this.locateByVertex(arguments[0]):this.locateByCoordinate(arguments[0]):this.locateByCoordinates(arguments[0],arguments[1])},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByVertex=function(t){return this.locator.locate(t)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinate=function(t){return this.locator.locate(new jsts.triangulate.quadedge.Vertex(t))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.locateByCoordinates=function(t,e){var n,i,o,n=this.locator.locate(new jsts.triangulate.quadedge.Vertex(t));if(null===n)return null;i=n,n.dest().getCoordinate().equals2D(t)&&(i=n.sym()),o=i;do{if(o.dest().getCoordinate().equals2D(e))return o;o=o.oNext()}while(o!=i);return null},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.insertSite=function(t){var e,n,i;if(e=this.locate(t),t.equals(e.orig(),this.tolerance)||t.equals(e.dest(),this.tolerance))return e;n=this.makeEdge(e.orig(),t),jsts.triangulate.quadedge.QuadEdge.splice(n,e),i=n;do n=this.connect(e,n.sym()),e=n.oPrev();while(e.lNext()!=i);return i},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameEdge=function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameBorderEdge=function(t){var e,n,i,o;return e=new Array(3),this.getTriangleEdges(t,e),n=new Array(3),this.getTriangleEdges(t.sym(),n),i=t.lNext().dest(),!!this.isFrameVertex(i)||(o=t.sym().lNext().dest(),!!this.isFrameVertex(o))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isFrameVertex=function(t){return!!t.equals(this.frameVertex[0])||(!!t.equals(this.frameVertex[1])||!!t.equals(this.frameVertex[2]))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isOnEdge=function(t,e){this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate());var n=this.seg.distance(e);return n<this.edgeCoincidenceTolerance},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.isVertexOfEdge=function(t,e){return!(!e.equals(t.orig(),this.tolerance)&&!e.equals(t.dest(),this.tolerance))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertices=function(t){var e,n,i,o,r,s=[];for(e=0,n=this.quadEdges.length,e;e<n;e++)i=this.quadEdges[e],o=i.orig(),!t&&this.isFrameVertex(o)||s.push(o),r=i.dest(),!t&&this.isFrameVertex(r)||s.push(r);return s},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVertexUniqueEdges=function(t){var e,n,i,o,r,s,a,l;for(e=[],n=[],i=0,o=this.quadEdges.length,i;i<o;i++)r=this.quadEdges[i],s=r.orig(),n.indexOf(s)===-1&&(n.push(s),!t&&this.isFrameVertex(s)||e.push(r)),a=r.sym(),l=a.orig(),n.indexOf(l)===-1&&(n.push(l),!t&&this.isFrameVertex(l)||e.push(a));return e},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getPrimaryEdges=function(t){this.visitedKey++;var e,n,i,o,r;for(e=[],n=[],n.push(this.startingEdge),i=[];n.length>0;)o=n.pop(),i.indexOf(o)===-1&&(r=o.getPrimary(),!t&&this.isFrameEdge(r)||e.push(r),n.push(o.oNext()),n.push(o.sym().oNext()),i.push(o),i.push(o.sym()));return e},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.visitTriangles=function(t,e){this.visitedKey++;var n,i,o,r;for(n=[],n.push(this.startingEdge),i=[];n.length>0;)o=n.pop(),i.indexOf(o)===-1&&(r=this.fetchTriangleToVisit(o,n,e,i),null!==r&&t.visit(r))},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.fetchTriangleToVisit=function(t,e,n,i){var o,r,s,a;o=t,r=0,s=!1;do this.triEdges[r]=o,this.isFrameEdge(o)&&(s=!0),a=o.sym(),i.indexOf(a)===-1&&e.push(a),i.push(o),r++,o=o.lNext();while(o!==t);return s&&!n?null:this.triEdges},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleEdges=function(t){var e=new jsts.triangulate.quadedge.TriangleEdgesListVisitor;return this.visitTriangles(e,t),e.getTriangleEdges()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleVertices=function(t){var e=new TriangleVertexListVisitor;return this.visitTriangles(e,t),e.getTriangleVertices()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangleCoordinates=function(t){var e=new jsts.triangulate.quadedge.TriangleCoordinatesVisitor;return this.visitTriangles(e,t),e.getTriangles()},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getEdgesByFactory=function(t){var e,n,i,o,r,s;for(e=this.getPrimaryEdges(!1),n=[],i=0,o=e.length,i;i<o;i++)r=e[i],s=[],s[0]=r.orig().getCoordinate(),s[1]=r.dest().getCoordinate(),n[i]=t.createLineString(s);return t.createMultiLineString(n)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getTriangles=function(t){var e,n,i,o,r;for(e=this.getTriangleCoordinates(!1),n=new Array(e.length),o=0,r=e.length,o;o<r;o++)i=e[o],n[o]=t.createPolygon(t.createLinearRing(i,null));return t.createGeometryCollection(n)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiDiagram=function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(e)},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygons=function(t){this.visitTriangles(new jsts.triangulate.quadedge.TriangleCircumcentreVisitor,!0);var e,n,i,o,r;for(e=[],n=this.getVertexUniqueEdges(!1),i=0,o=n.length,i;i<o;i++)r=n[i],e.push(this.getVoronoiCellPolygon(r,t));return e},jsts.triangulate.quadedge.QuadEdgeSubdivision.prototype.getVoronoiCellPolygon=function(t,e){var n,i,o,r,s;n=[],startQE=t;do i=t.rot.orig().getCoordinate(),n.push(i),t=t.oPrev();while(t!==startQE);return o=new jsts.geom.CoordinateList([],(!1)),o.add(n,!1),o.closeRing(),o.size()<4&&o.add(o.get(o.size()-1),!0),r=e.createPolygon(e.createLinearRing(o.toArray()),null),s=startQE.orig(),r},jsts.triangulate.quadedge.TriangleCircumcentreVisitor=function(){},jsts.triangulate.quadedge.TriangleCircumcentreVisitor.prototype.visit=function(t){var e,n,i,o,r,s;for(e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),i=t[2].orig().getCoordinate(),o=jsts.geom.Triangle.circumcentre(e,n,i),r=new jsts.triangulate.quadedge.Vertex(o),s=0;s<3;s++)t[s].rot.setOrig(r)},jsts.triangulate.quadedge.TriangleEdgesListVisitor=function(){this.triList=[]},jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.visit=function(t){var e=t.concat();this.triList.push(e)},jsts.triangulate.quadedge.TriangleEdgesListVisitor.prototype.getTriangleEdges=function(){return this.triList},jsts.triangulate.quadedge.TriangleVertexListVisitor=function(){this.triList=[]},jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.visit=function(t){var e=[];e.push(trieEdges[0].orig()),e.push(trieEdges[1].orig()),e.push(trieEdges[2].orig()),this.triList.push(e)},jsts.triangulate.quadedge.TriangleVertexListVisitor.prototype.getTriangleVertices=function(){return this.triList},jsts.triangulate.quadedge.TriangleCoordinatesVisitor=function(){this.coordList=new jsts.geom.CoordinateList([],(!1)),this.triCoords=[]},jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.visit=function(t){this.coordList=new jsts.geom.CoordinateList([],(!1));var e,n,i=0;for(i;i<3;i++)e=t[i].orig(),this.coordList.add(e.getCoordinate());if(this.coordList.size()>0){if(this.coordList.closeRing(),n=this.coordList.toArray(),4!==n.length)return;this.triCoords.push(n)}},jsts.triangulate.quadedge.TriangleCoordinatesVisitor.prototype.getTriangles=function(){return this.triCoords},jsts.operation.relate.EdgeEndBundle=function(){this.edgeEnds=[];var t=arguments[0]instanceof jsts.geomgraph.EdgeEnd?arguments[0]:arguments[1],e=t.getEdge(),n=t.getCoordinate(),i=t.getDirectedCoordinate(),o=new jsts.geomgraph.Label(t.getLabel());jsts.geomgraph.EdgeEnd.call(this,e,n,i,o),this.insert(t)},jsts.operation.relate.EdgeEndBundle.prototype=new jsts.geomgraph.EdgeEnd,jsts.operation.relate.EdgeEndBundle.prototype.edgeEnds=null,jsts.operation.relate.EdgeEndBundle.prototype.getLabel=function(){return this.label},jsts.operation.relate.EdgeEndBundle.prototype.getEdgeEnds=function(){return this.edgeEnds},jsts.operation.relate.EdgeEndBundle.prototype.insert=function(t){this.edgeEnds.push(t)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabel=function(t){for(var e=!1,n=0;n<this.edgeEnds.length;n++){var i=this.edgeEnds[n];i.getLabel().isArea()&&(e=!0)}e?this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE,jsts.geom.Location.NONE,jsts.geom.Location.NONE):this.label=new jsts.geomgraph.Label(jsts.geom.Location.NONE);for(var n=0;n<2;n++)this.computeLabelOn(n,t),e&&this.computeLabelSides(n)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabelOn=function(t,e){for(var n=0,i=!1,o=0;o<this.edgeEnds.length;o++){var r=this.edgeEnds[o],s=r.getLabel().getLocation(t);s==jsts.geom.Location.BOUNDARY&&n++,s==jsts.geom.Location.INTERIOR&&(i=!0)}var s=jsts.geom.Location.NONE;i&&(s=jsts.geom.Location.INTERIOR),n>0&&(s=jsts.geomgraph.GeometryGraph.determineBoundary(e,n)),this.label.setLocation(t,s)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSides=function(t){this.computeLabelSide(t,jsts.geomgraph.Position.LEFT),this.computeLabelSide(t,jsts.geomgraph.Position.RIGHT)},jsts.operation.relate.EdgeEndBundle.prototype.computeLabelSide=function(t,e){for(var n=0;n<this.edgeEnds.length;n++){var i=this.edgeEnds[n];if(i.getLabel().isArea()){var o=i.getLabel().getLocation(t,e);if(o===jsts.geom.Location.INTERIOR)return void this.label.setLocation(t,e,jsts.geom.Location.INTERIOR);o===jsts.geom.Location.EXTERIOR&&this.label.setLocation(t,e,jsts.geom.Location.EXTERIOR)}}},jsts.operation.relate.EdgeEndBundle.prototype.updateIM=function(t){jsts.geomgraph.Edge.updateIM(this.label,t);
},jsts.index.kdtree.KdTree=function(t){var e=0;void 0!==t&&(e=t),this.root=null,this.last=null,this.numberOfNodes=0,this.tolerance=e},jsts.index.kdtree.KdTree.prototype.insert=function(){return 1===arguments.length?this.insertCoordinate.apply(this,arguments[0]):this.insertWithData.apply(this,arguments[0],arguments[1])},jsts.index.kdtree.KdTree.prototype.insertCoordinate=function(t){return this.insertWithData(t,null)},jsts.index.kdtree.KdTree.prototype.insertWithData=function(t,e){if(null===this.root)return this.root=new jsts.index.kdtree.KdNode(t,e),this.root;for(var n=this.root,i=this.root,o=!0,r=!0;n!==last;){if(r=o?t.x<n.getX():t.y<n.getY(),i=n,n=r?n.getLeft():n.getRight(),null!==n){var s=t.distance(n.getCoordinate())<=this.tolerance;if(s)return n.increment(),n}o=!o}this.numberOfNodes=numberOfNodes+1;var a=new jsts.index.kdtree.KdNode(t,e);return a.setLeft(this.last),a.setRight(this.last),r?i.setLeft(a):i.setRight(a),a},jsts.index.kdtree.KdTree.prototype.queryNode=function(t,e,n,i,o){if(t!==e){var r,s,a;i?(r=n.getMinX(),s=n.getMaxX(),a=t.getX()):(r=n.getMinY(),s=n.getMaxY(),a=t.getY());var l=r<a,d=a<=s;l&&this.queryNode(t.getLeft(),e,n,!i,o),n.contains(t.getCoordinate())&&o.add(t),d&&this.queryNode(t.getRight(),e,n,!i,o)}},jsts.index.kdtree.KdTree.prototype.query=function(){return 1===arguments.length?this.queryByEnvelope.apply(this,arguments[0]):this.queryWithArray.apply(this,arguments[0],arguments[1])},jsts.index.kdtree.KdTree.prototype.queryByEnvelope=function(t){var e=[];return this.queryNode(this.root,this.last,t,!0,e),e},jsts.index.kdtree.KdTree.prototype.queryWithArray=function(t,e){this.queryNode(this.root,this.last,t,!0,e)},jsts.geom.Triangle=function(t,e,n){this.p0=t,this.p1=e,this.p2=n},jsts.geom.Triangle.isAcute=function(t,e,n){return!!jsts.algorithm.Angle.isAcute(t,e,n)&&(!!jsts.algorithm.Angle.isAcute(e,n,t)&&!!jsts.algorithm.Angle.isAcute(n,t,e))},jsts.geom.Triangle.perpendicularBisector=function(t,e){var n,i,o,r;return n=e.x-t.x,i=e.y-t.y,o=new jsts.algorithm.HCoordinate(t.x+n/2,t.y+i/2,1),r=new jsts.algorithm.HCoordinate(t.x-i+n/2,t.y+n+i/2,1),new jsts.algorithm.HCoordinate(o,r)},jsts.geom.Triangle.circumcentre=function(t,e,n){var i,o,r,s,a,l,d,c,h,u,p;return i=n.x,o=n.y,r=t.x-i,s=t.y-o,a=e.x-i,l=e.y-o,d=2*jsts.geom.Triangle.det(r,s,a,l),c=jsts.geom.Triangle.det(s,r*r+s*s,l,a*a+l*l),h=jsts.geom.Triangle.det(r,r*r+s*s,a,a*a+l*l),u=i-c/d,p=o+h/d,new jsts.geom.Coordinate(u,p)},jsts.geom.Triangle.det=function(t,e,n,i){return t*i-e*n},jsts.geom.Triangle.inCentre=function(t,e,n){var i,o,r,s,a,l;return i=e.distance(n),o=t.distance(n),r=t.distance(e),s=i+o+r,a=(i*t.x+o*e.x+r*n.x)/s,l=(i*t.y+o*e.y+r*n.y)/s,new jsts.geom.Coordinate(a,l)},jsts.geom.Triangle.centroid=function(t,e,n){var i,o;return i=(t.x+e.x+n.x)/3,o=(t.y+e.y+n.y)/3,new jsts.geom.Coordinate(i,o)},jsts.geom.Triangle.longestSideLength=function(t,e,n){var i,o,r,s;return i=t.distance(e),o=e.distance(n),r=n.distance(t),s=i,o>s&&(s=o),r>s&&(s=r),s},jsts.geom.Triangle.angleBisector=function(t,e,n){var i,o,r,s,a,l;return i=e.distance(t),o=e.distance(n),r=i/(i+o),s=n.x-t.x,a=n.y-t.y,l=new jsts.geom.Coordinate(t.x+r*s,t.y+r*a)},jsts.geom.Triangle.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},jsts.geom.Triangle.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},jsts.geom.Triangle.prototype.inCentre=function(){return jsts.geom.Triangle.inCentre(this.p0,this.p1,this.p2)},jsts.noding.OrientedCoordinateArray=function(t){this.pts=t,this._orientation=jsts.noding.OrientedCoordinateArray.orientation(t)},jsts.noding.OrientedCoordinateArray.prototype.pts=null,jsts.noding.OrientedCoordinateArray.prototype._orientation=void 0,jsts.noding.OrientedCoordinateArray.orientation=function(t){return 1===jsts.geom.CoordinateArrays.increasingDirection(t)},jsts.noding.OrientedCoordinateArray.prototype.compareTo=function(t){var e=t,n=jsts.noding.OrientedCoordinateArray.compareOriented(this.pts,this._orientation,e.pts,e._orientation);return n},jsts.noding.OrientedCoordinateArray.compareOriented=function(t,e,n,i){for(var o=e?1:-1,r=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,l=e?0:t.length-1,d=i?0:n.length-1;;){var c=t[l].compareTo(n[d]);if(0!==c)return c;l+=o,d+=r;var h=l===s,u=d===a;if(h&&!u)return-1;if(!h&&u)return 1;if(h&&u)return 0}},jsts.algorithm.CentralEndpointIntersector=function(t,e,n,i){this.pts=[t,e,n,i],this.compute()},jsts.algorithm.CentralEndpointIntersector.getIntersection=function(t,e,n,i){var o=new jsts.algorithm.CentralEndpointIntersector(t,e,n,i);return o.getIntersection()},jsts.algorithm.CentralEndpointIntersector.prototype.pts=null,jsts.algorithm.CentralEndpointIntersector.prototype.intPt=null,jsts.algorithm.CentralEndpointIntersector.prototype.compute=function(){var t=jsts.algorithm.CentralEndpointIntersector.average(this.pts);this.intPt=this.findNearestPoint(t,this.pts)},jsts.algorithm.CentralEndpointIntersector.prototype.getIntersection=function(){return this.intPt},jsts.algorithm.CentralEndpointIntersector.average=function(t){var e,n=new jsts.geom.Coordinate,i=t.length;for(e=0;e<i;e++)n.x+=t[e].x,n.y+=t[e].y;return i>0&&(n.x/=i,n.y/=i),n},jsts.algorithm.CentralEndpointIntersector.prototype.findNearestPoint=function(t,e){var n,i,o=Number.MAX_VALUE,r=null;for(n=0;n<e.length;n++)i=t.distance(e[n]),i<o&&(o=i,r=e[n]);return r},jsts.operation.buffer.BufferOp=function(t,e){this.argGeom=t,this.bufParams=e?e:new jsts.operation.buffer.BufferParameters},jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS=12,jsts.operation.buffer.BufferOp.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),o=Math.max(i.getHeight(),i.getWidth()),r=e>0?e:0,s=o+2*r,a=Math.log(s)/Math.log(10)+1,l=a-n,d=Math.pow(10,-l);return d},jsts.operation.buffer.BufferOp.bufferOp=function(t,e){if(arguments.length>2)return jsts.operation.buffer.BufferOp.bufferOp2.apply(this,arguments);var n=new jsts.operation.buffer.BufferOp(t),i=n.getResultGeometry(e);return i},jsts.operation.buffer.BufferOp.bufferOp2=function(t,e,n){if(arguments.length>3)return jsts.operation.buffer.BufferOp.bufferOp3.apply(this,arguments);var i=new jsts.operation.buffer.BufferOp(t,n),o=i.getResultGeometry(e);return o},jsts.operation.buffer.BufferOp.bufferOp3=function(t,e,n){if(arguments.length>4)return jsts.operation.buffer.BufferOp.bufferOp4.apply(this,arguments);var i=new jsts.operation.buffer.BufferOp(t);i.setQuadrantSegments(n);var o=i.getResultGeometry(e);return o},jsts.operation.buffer.BufferOp.bufferOp4=function(t,e,n,i){var o=new jsts.operation.buffer.BufferOp(t);o.setQuadrantSegments(n),o.setEndCapStyle(i);var r=o.getResultGeometry(e);return r},jsts.operation.buffer.BufferOp.prototype.argGeom=null,jsts.operation.buffer.BufferOp.prototype.distance=null,jsts.operation.buffer.BufferOp.prototype.bufParams=null,jsts.operation.buffer.BufferOp.prototype.resultGeometry=null,jsts.operation.buffer.BufferOp.prototype.setEndCapStyle=function(t){this.bufParams.setEndCapStyle(t)},jsts.operation.buffer.BufferOp.prototype.setQuadrantSegments=function(t){this.bufParams.setQuadrantSegments(t)},jsts.operation.buffer.BufferOp.prototype.getResultGeometry=function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},jsts.operation.buffer.BufferOp.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null===this.resultGeometry){var t=this.argGeom.getPrecisionModel();t.getType()===jsts.geom.PrecisionModel.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision=function(){var t,e=null;for(t=jsts.operation.buffer.BufferOp.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision2(t)}catch(t){e=t}if(null!==this.resultGeometry)return}throw e},jsts.operation.buffer.BufferOp.prototype.bufferOriginalPrecision=function(){try{var t=new jsts.operation.buffer.BufferBuilder(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(t){}},jsts.operation.buffer.BufferOp.prototype.bufferReducedPrecision2=function(t){var e=jsts.operation.buffer.BufferOp.precisionScaleFactor(this.argGeom,this.distance,t),n=new jsts.geom.PrecisionModel(e);this.bufferFixedPrecision(n)},jsts.operation.buffer.BufferOp.prototype.bufferFixedPrecision=function(t){var e=new jsts.noding.ScaledNoder(new jsts.noding.snapround.MCIndexSnapRounder(new jsts.geom.PrecisionModel(1)),t.getScale()),n=new jsts.operation.buffer.BufferBuilder(this.bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this.resultGeometry=n.buffer(this.argGeom,this.distance)},function(){var t=jsts.geom.Location,e=jsts.geomgraph.Position,n=jsts.util.Assert;jsts.geomgraph.GeometryGraph=function(t,e,n){jsts.geomgraph.PlanarGraph.call(this),this.lineEdgeMap=new javascript.util.HashMap,this.ptLocator=new jsts.algorithm.PointLocator,this.argIndex=t,this.parentGeom=e,this.boundaryNodeRule=n||jsts.algorithm.BoundaryNodeRule.OGC_SFS_BOUNDARY_RULE,null!==e&&this.add(e)},jsts.geomgraph.GeometryGraph.prototype=new jsts.geomgraph.PlanarGraph,jsts.geomgraph.GeometryGraph.constructor=jsts.geomgraph.GeometryGraph,jsts.geomgraph.GeometryGraph.prototype.createEdgeSetIntersector=function(){return new jsts.geomgraph.index.SimpleMCSweepLineIntersector},jsts.geomgraph.GeometryGraph.determineBoundary=function(e,n){return e.isInBoundary(n)?t.BOUNDARY:t.INTERIOR},jsts.geomgraph.GeometryGraph.prototype.parentGeom=null,jsts.geomgraph.GeometryGraph.prototype.lineEdgeMap=null,jsts.geomgraph.GeometryGraph.prototype.boundaryNodeRule=null,jsts.geomgraph.GeometryGraph.prototype.useBoundaryDeterminationRule=!0,jsts.geomgraph.GeometryGraph.prototype.argIndex=null,jsts.geomgraph.GeometryGraph.prototype.boundaryNodes=null,jsts.geomgraph.GeometryGraph.prototype.hasTooFewPoints=!1,jsts.geomgraph.GeometryGraph.prototype.invalidPoint=null,jsts.geomgraph.GeometryGraph.prototype.areaPtLocator=null,jsts.geomgraph.GeometryGraph.prototype.ptLocator=null,jsts.geomgraph.GeometryGraph.prototype.getGeometry=function(){return this.parentGeom},jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodes=function(){return null===this.boundaryNodes&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},jsts.geomgraph.GeometryGraph.prototype.getBoundaryNodeRule=function(){return this.boundaryNodeRule},jsts.geomgraph.GeometryGraph.prototype.findEdge=function(t){return this.lineEdgeMap.get(t)},jsts.geomgraph.GeometryGraph.prototype.computeSplitEdges=function(t){for(var e=this.edges.iterator();e.hasNext();){var n=e.next();n.eiList.addSplitEdges(t)}},jsts.geomgraph.GeometryGraph.prototype.add=function(t){if(!t.isEmpty())if(t instanceof jsts.geom.MultiPolygon&&(this.useBoundaryDeterminationRule=!1),t instanceof jsts.geom.Polygon)this.addPolygon(t);else if(t instanceof jsts.geom.LineString)this.addLineString(t);else if(t instanceof jsts.geom.Point)this.addPoint(t);else if(t instanceof jsts.geom.MultiPoint)this.addCollection(t);else if(t instanceof jsts.geom.MultiLineString)this.addCollection(t);else if(t instanceof jsts.geom.MultiPolygon)this.addCollection(t);else{if(!(t instanceof jsts.geom.GeometryCollection))throw new jsts.error.IllegalArgumentError("Geometry type not supported.");this.addCollection(t)}},jsts.geomgraph.GeometryGraph.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},jsts.geomgraph.GeometryGraph.prototype.addEdge=function(e){this.insertEdge(e);var n=e.getCoordinates();this.insertPoint(this.argIndex,n[0],t.BOUNDARY),this.insertPoint(this.argIndex,n[n.length-1],t.BOUNDARY)},jsts.geomgraph.GeometryGraph.prototype.addPoint=function(e){var n=e.getCoordinate();this.insertPoint(this.argIndex,n,t.INTERIOR)},jsts.geomgraph.GeometryGraph.prototype.addLineString=function(e){var i=jsts.geom.CoordinateArrays.removeRepeatedPoints(e.getCoordinates());if(i.length<2)return this.hasTooFewPoints=!0,void(this.invalidPoint=i[0]);var o=new jsts.geomgraph.Edge(i,new jsts.geomgraph.Label(this.argIndex,t.INTERIOR));this.lineEdgeMap.put(e,o),this.insertEdge(o),n.isTrue(i.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,i[0]),this.insertBoundaryPoint(this.argIndex,i[i.length-1])},jsts.geomgraph.GeometryGraph.prototype.addPolygonRing=function(e,n,i){if(!e.isEmpty()){var o=jsts.geom.CoordinateArrays.removeRepeatedPoints(e.getCoordinates());if(o.length<4)return this.hasTooFewPoints=!0,void(this.invalidPoint=o[0]);var r=n,s=i;jsts.algorithm.CGAlgorithms.isCCW(o)&&(r=i,s=n);var a=new jsts.geomgraph.Edge(o,new jsts.geomgraph.Label(this.argIndex,t.BOUNDARY,r,s));this.lineEdgeMap.put(e,a),this.insertEdge(a),this.insertPoint(this.argIndex,o[0],t.BOUNDARY)}},jsts.geomgraph.GeometryGraph.prototype.addPolygon=function(e){this.addPolygonRing(e.getExteriorRing(),t.EXTERIOR,t.INTERIOR);for(var n=0;n<e.getNumInteriorRing();n++){var i=e.getInteriorRingN(n);this.addPolygonRing(i,t.INTERIOR,t.EXTERIOR)}},jsts.geomgraph.GeometryGraph.prototype.computeEdgeIntersections=function(t,e,n){var i=new jsts.geomgraph.index.SegmentIntersector(e,n,(!0));i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes());var o=this.createEdgeSetIntersector();return o.computeIntersections(this.edges,t.edges,i),i},jsts.geomgraph.GeometryGraph.prototype.computeSelfNodes=function(t,e){var n=new jsts.geomgraph.index.SegmentIntersector(t,(!0),(!1)),i=this.createEdgeSetIntersector();return!e&&(this.parentGeom instanceof jsts.geom.LinearRing||this.parentGeom instanceof jsts.geom.Polygon||this.parentGeom instanceof jsts.geom.MultiPolygon)?i.computeIntersections(this.edges,n,!1):i.computeIntersections(this.edges,n,!0),this.addSelfIntersectionNodes(this.argIndex),n},jsts.geomgraph.GeometryGraph.prototype.insertPoint=function(t,e,n){var i=this.nodes.addNode(e),o=i.getLabel();null==o?i.label=new jsts.geomgraph.Label(t,n):o.setLocation(t,n)},jsts.geomgraph.GeometryGraph.prototype.insertBoundaryPoint=function(n,i){var o=this.nodes.addNode(i),r=o.getLabel(),s=1,a=t.NONE;null!==r&&(a=r.getLocation(n,e.ON)),a===t.BOUNDARY&&s++;var l=jsts.geomgraph.GeometryGraph.determineBoundary(this.boundaryNodeRule,s);r.setLocation(n,l)},jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNodes=function(t){for(var e=this.edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),o=n.eiList.iterator();o.hasNext();){var r=o.next();this.addSelfIntersectionNode(t,r.coord,i)}},jsts.geomgraph.GeometryGraph.prototype.addSelfIntersectionNode=function(e,n,i){this.isBoundaryNode(e,n)||(i===t.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(e,n):this.insertPoint(e,n,i))},jsts.geomgraph.GeometryGraph.prototype.getInvalidPoint=function(){return this.invalidPoint}}(),jsts.operation.buffer.OffsetSegmentString=function(){this.ptList=[]},jsts.operation.buffer.OffsetSegmentString.prototype.ptList=null,jsts.operation.buffer.OffsetSegmentString.prototype.precisionModel=null,jsts.operation.buffer.OffsetSegmentString.prototype.minimimVertexDistance=0,jsts.operation.buffer.OffsetSegmentString.prototype.setPrecisionModel=function(t){this.precisionModel=t},jsts.operation.buffer.OffsetSegmentString.prototype.setMinimumVertexDistance=function(t){this.minimimVertexDistance=t},jsts.operation.buffer.OffsetSegmentString.prototype.addPt=function(t){var e=new jsts.geom.Coordinate(t);this.precisionModel.makePrecise(e),this.isRedundant(e)||this.ptList.push(e)},jsts.operation.buffer.OffsetSegmentString.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var n=t.length-1;n>=0;n--)this.addPt(t[n])},jsts.operation.buffer.OffsetSegmentString.prototype.isRedundant=function(t){if(this.ptList.length<1)return!1;var e=this.ptList[this.ptList.length-1],n=t.distance(e);return n<this.minimimVertexDistance},jsts.operation.buffer.OffsetSegmentString.prototype.closeRing=function(){if(!(this.ptList.length<1)){var t=new jsts.geom.Coordinate(this.ptList[0]),e=this.ptList[this.ptList.length-1],n=null;this.ptList.length>=2&&(n=this.ptList[this.ptList.length-2]),t.equals(e)||this.ptList.push(t)}},jsts.operation.buffer.OffsetSegmentString.prototype.reverse=function(){},jsts.operation.buffer.OffsetSegmentString.prototype.getCoordinates=function(){return this.ptList},jsts.operation.linemerge.LineMergeEdge=function(t){jsts.planargraph.Edge.call(this),this.line=t},jsts.operation.linemerge.LineMergeEdge.prototype=new jsts.planargraph.Edge,jsts.operation.linemerge.LineMergeEdge.constructor=jsts.operation.linemerge.LineMergeEdge,jsts.operation.linemerge.LineMergeEdge.prototype.getLine=function(){return this.line},jsts.algorithm.distance.PointPairDistance=function(){this.pt=[new jsts.geom.Coordinate,new jsts.geom.Coordinate]},jsts.algorithm.distance.PointPairDistance.prototype.pt=null,jsts.algorithm.distance.PointPairDistance.prototype.distance=NaN,jsts.algorithm.distance.PointPairDistance.prototype.isNull=!0,jsts.algorithm.distance.PointPairDistance.prototype.initialize=function(t,e,n){return void 0===t?void(this.isNull=!0):(this.pt[0].setCoordinate(t),this.pt[1].setCoordinate(e),this.distance=void 0!==n?n:t.distance(e),void(this.isNull=!1))},jsts.algorithm.distance.PointPairDistance.prototype.getDistance=function(){return this.distance},jsts.algorithm.distance.PointPairDistance.prototype.getCoordinates=function(){return this.pt},jsts.algorithm.distance.PointPairDistance.prototype.getCoordinate=function(t){return this.pt[t]},jsts.algorithm.distance.PointPairDistance.prototype.setMaximum=function(t){return 2===arguments.length?void this.setMaximum2.apply(this,arguments):void this.setMaximum(t.pt[0],t.pt[1])},jsts.algorithm.distance.PointPairDistance.prototype.setMaximum2=function(t,e){if(this.isNull)return void this.initialize(t,e);var n=t.distance(e);n>this.distance&&this.initialize(t,e,n)},jsts.algorithm.distance.PointPairDistance.prototype.setMinimum=function(t){return 2===arguments.length?void this.setMinimum2.apply(this,arguments):void this.setMinimum(t.pt[0],t.pt[1])},jsts.algorithm.distance.PointPairDistance.prototype.setMinimum2=function(t,e){if(this.isNull)return void this.initialize(t,e);var n=t.distance(e);n<this.distance&&this.initialize(t,e,n)},function(){var t=jsts.algorithm.distance.PointPairDistance,e=jsts.algorithm.distance.DistanceToPoint,n=function(n){this.maxPtDist=new t,this.minPtDist=new t,this.euclideanDist=new e,this.geom=n};n.prototype=new jsts.geom.CoordinateFilter,n.prototype.maxPtDist=new t,n.prototype.minPtDist=new t,n.prototype.euclideanDist=new e,n.prototype.geom,n.prototype.filter=function(t){this.minPtDist.initialize(),e.computeDistance(this.geom,t,this.minPtDist),this.maxPtDist.setMaximum(this.minPtDist)},n.prototype.getMaxPointDistance=function(){return this.maxPtDist};var i=function(e,n){this.maxPtDist=new t,this.minPtDist=new t,this.geom=e,this.numSubSegs=Math.round(1/n)};i.prototype=new jsts.geom.CoordinateSequenceFilter,i.prototype.maxPtDist=new t,i.prototype.minPtDist=new t,i.prototype.geom,i.prototype.numSubSegs=0,i.prototype.filter=function(t,n){if(0!=n)for(var i=t[n-1],o=t[n],r=(o.x-i.x)/this.numSubSegs,s=(o.y-i.y)/this.numSubSegs,a=0;a<this.numSubSegs;a++){var l=i.x+a*r,d=i.y+a*s,c=new jsts.geom.Coordinate(l,d);this.minPtDist.initialize(),e.computeDistance(this.geom,c,this.minPtDist),this.maxPtDist.setMaximum(this.minPtDist)}},i.prototype.isGeometryChanged=function(){return!1},i.prototype.isDone=function(){return!1},i.prototype.getMaxPointDistance=function(){return this.maxPtDist},jsts.algorithm.distance.DiscreteHausdorffDistance=function(t,e){this.g0=t,this.g1=e,this.ptDist=new jsts.algorithm.distance.PointPairDistance},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g0=null,jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.g1=null,jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.ptDist=null,jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.densifyFrac=0,jsts.algorithm.distance.DiscreteHausdorffDistance.distance=function(t,e,n){var i=new jsts.algorithm.distance.DiscreteHausdorffDistance(t,e);return void 0!==n&&i.setDensifyFraction(n),i.distance()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new jsts.error.IllegalArgumentError("Fraction is not in range (0.0 - 1.0]");this.densifyFrac=t},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.distance=function(){return this.compute(this.g0,this.g1),ptDist.getDistance()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.orientedDistance=function(){return this.computeOrientedDistance(this.g0,this.g1,this.ptDist),this.ptDist.getDistance()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.getCoordinates=function(){return ptDist.getCoordinates()},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this.ptDist),this.computeOrientedDistance(e,t,this.ptDist)},jsts.algorithm.distance.DiscreteHausdorffDistance.prototype.computeOrientedDistance=function(t,e,o){var r=new n(e);if(t.apply(r),o.setMaximum(r.getMaxPointDistance()),this.densifyFrac>0){var s=new i(e,this.densifyFrac);t.apply(s),o.setMaximum(s.getMaxPointDistance())}}}(),jsts.algorithm.MinimumBoundingCircle=function(t){this.input=null,this.extremalPts=null,this.centre=null,this.radius=0,this.input=t},jsts.algorithm.MinimumBoundingCircle.prototype.getCircle=function(){if(this.compute(),null===this.centre)return this.input.getFactory().createPolygon(null,null);var t=this.input.getFactory().createPoint(this.centre);return 0===this.radius?t:t.buffer(this.radius)},jsts.algorithm.MinimumBoundingCircle.prototype.getExtremalPoints=function(){return this.compute(),this.extremalPts},jsts.algorithm.MinimumBoundingCircle.prototype.getCentre=function(){return this.compute(),this.centre},jsts.algorithm.MinimumBoundingCircle.prototype.getRadius=function(){return this.compute(),this.radius},jsts.algorithm.MinimumBoundingCircle.prototype.computeCentre=function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new jsts.geom.Coordinate((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=jsts.geom.Triangle.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2])}},jsts.algorithm.MinimumBoundingCircle.prototype.compute=function(){null===this.extremalPts&&(this.computeCirclePoints(),this.computeCentre(),null!==this.centre&&(this.radius=this.centre.distance(this.extremalPts[0])))},jsts.algorithm.MinimumBoundingCircle.prototype.computeCirclePoints=function(){if(this.input.isEmpty())return void(this.extremalPts=[]);var t;if(1===this.input.getNumPoints())return t=this.input.getCoordinates(),void(this.extremalPts=[new jsts.geom.Coordinate(t[0])]);var e=this.input.convexHull(),n=e.getCoordinates();if(t=n,n[0].equals2D(n[n.length-1])&&(t=[],jsts.geom.CoordinateArrays.copyDeep(n,0,t,0,n.length-1)),t.length<=2)return void(this.extremalPts=jsts.geom.CoordinateArrays.copyDeep(t));for(var i=jsts.algorithm.MinimumBoundingCircle.lowestPoint(t),o=jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX(t,i),r=0;r<t.length;r++){var s=jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment(t,i,o);if(jsts.algorithm.Angle.isObtuse(i,s,o))return void(this.extremalPts=[new jsts.geom.Coordinate(i),new jsts.geom.Coordinate(o)]);if(jsts.algorithm.Angle.isObtuse(s,i,o))i=s;else{if(!jsts.algorithm.Angle.isObtuse(s,o,i))return void(this.extremalPts=[new jsts.geom.Coordinate(i),new jsts.geom.Coordinate(o),new jsts.geom.Coordinate(s)]);o=s}}throw new Error("Logic failure in Minimum Bounding Circle algorithm!")},jsts.algorithm.MinimumBoundingCircle.lowestPoint=function(t){for(var e=t[0],n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e},jsts.algorithm.MinimumBoundingCircle.pointWitMinAngleWithX=function(t,e){for(var n=Number.MAX_VALUE,i=null,o=0;o<t.length;o++){var r=t[o];if(r!==e){var s=r.x-e.x,a=r.y-e.y;a<0&&(a=-a);var l=Math.sqrt(s*s+a*a),d=a/l;d<n&&(n=d,i=r)}}return i},jsts.algorithm.MinimumBoundingCircle.pointWithMinAngleWithSegment=function(t,e,n){for(var i=Number.MAX_VALUE,o=null,r=0;r<t.length;r++){var s=t[r];if(s!==e&&s!==n){var a=jsts.algorithm.Angle.angleBetween(e,s,n);a<i&&(i=a,o=s)}}return o},jsts.noding.ScaledNoder=function(t,e,n,i){this.offsetX=n?n:0,this.offsetY=i?i:0,this.noder=t,this.scaleFactor=e,this.isScaled=!this.isIntegerPrecision()},jsts.noding.ScaledNoder.prototype=new jsts.noding.Noder,jsts.noding.ScaledNoder.constructor=jsts.noding.ScaledNoder,jsts.noding.ScaledNoder.prototype.noder=null,jsts.noding.ScaledNoder.prototype.scaleFactor=void 0,jsts.noding.ScaledNoder.prototype.offsetX=void 0,jsts.noding.ScaledNoder.prototype.offsetY=void 0,jsts.noding.ScaledNoder.prototype.isScaled=!1,jsts.noding.ScaledNoder.prototype.isIntegerPrecision=function(){return 1===this.scaleFactor},jsts.noding.ScaledNoder.prototype.getNodedSubstrings=function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},jsts.noding.ScaledNoder.prototype.computeNodes=function(t){var e=t;this.isScaled&&(e=this.scale(t)),this.noder.computeNodes(e)},jsts.noding.ScaledNoder.prototype.scale=function(t){if(t instanceof Array)return this.scale2(t);for(var e=new javascript.util.ArrayList,n=t.iterator();n.hasNext();){var i=n.next();e.add(new jsts.noding.NodedSegmentString(this.scale(i.getCoordinates()),i.getData()))}return e},jsts.noding.ScaledNoder.prototype.scale2=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=new jsts.geom.Coordinate(Math.round((t[n].x-this.offsetX)*this.scaleFactor),Math.round((t[n].y-this.offsetY)*this.scaleFactor));var i=jsts.geom.CoordinateArrays.removeRepeatedPoints(e);return i},jsts.noding.ScaledNoder.prototype.rescale=function(t){if(t instanceof Array)return void this.rescale2(t);for(var e=t.iterator();e.hasNext();){var n=e.next();this.rescale(n.getCoordinates())}},jsts.noding.ScaledNoder.prototype.rescale2=function(t){for(var e=0;e<t.length;e++)t[e].x=t[e].x/this.scaleFactor+this.offsetX,t[e].y=t[e].y/this.scaleFactor+this.offsetY},function(){javascript.util.ArrayList;jsts.geomgraph.index.SegmentIntersector=function(t,e,n){this.li=t,this.includeProper=e,this.recordIsolated=n},jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},jsts.geomgraph.index.SegmentIntersector.prototype._hasIntersection=!1,jsts.geomgraph.index.SegmentIntersector.prototype.hasProper=!1,jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInterior=!1,jsts.geomgraph.index.SegmentIntersector.prototype.properIntersectionPoint=null,jsts.geomgraph.index.SegmentIntersector.prototype.li=null,jsts.geomgraph.index.SegmentIntersector.prototype.includeProper=null,jsts.geomgraph.index.SegmentIntersector.prototype.recordIsolated=null,jsts.geomgraph.index.SegmentIntersector.prototype.isSelfIntersection=null,jsts.geomgraph.index.SegmentIntersector.prototype.numIntersections=0,jsts.geomgraph.index.SegmentIntersector.prototype.numTests=0,jsts.geomgraph.index.SegmentIntersector.prototype.bdyNodes=null,jsts.geomgraph.index.SegmentIntersector.prototype.setBoundaryNodes=function(t,e){this.bdyNodes=[],this.bdyNodes[0]=t,this.bdyNodes[1]=e},jsts.geomgraph.index.SegmentIntersector.prototype.getProperIntersectionPoint=function(){return this.properIntersectionPoint},jsts.geomgraph.index.SegmentIntersector.prototype.hasIntersection=function(){return this._hasIntersection},jsts.geomgraph.index.SegmentIntersector.prototype.hasProperIntersection=function(){return this.hasProper},jsts.geomgraph.index.SegmentIntersector.prototype.hasProperInteriorIntersection=function(){return this.hasProperInterior},jsts.geomgraph.index.SegmentIntersector.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(jsts.geomgraph.index.SegmentIntersector.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var o=t.getNumPoints()-1;if(0===e&&i===o||0===i&&e===o)return!0}}return!1},jsts.geomgraph.index.SegmentIntersector.prototype.addIntersections=function(t,e,n,i){if(t!==n||e!==i){this.numTests++;var o=t.getCoordinates()[e],r=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(o,r,s,a),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).clone(),this.hasProper=!0,this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))}},jsts.geomgraph.index.SegmentIntersector.prototype.isBoundaryPoint=function(t,e){if(null===e)return!1;if(e instanceof Array)return!!this.isBoundaryPoint(t,e[0])||!!this.isBoundaryPoint(t,e[1]);for(var n=e.iterator();n.hasNext();){var i=n.next(),o=i.getCoordinate();if(t.isIntersection(o))return!0}return!1}}();!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t,e){"use strict";if(!t.jstree){var n=0,i=!1,o=!1,r=!1,s=[],a=t("script:last").attr("src"),l=window.document;t.jstree={version:"3.3.5",defaults:{plugins:[]},plugins:{},path:a&&-1!==a.indexOf("/")?a.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},t.jstree.create=function(e,i){var o=new t.jstree.core((++n)),r=i;return i=t.extend(!0,{},t.jstree.defaults,i),r&&r.plugins&&(i.plugins=r.plugins),t.each(i.plugins,function(t,e){"core"!==t&&(o=o.plugin(e,i[e]))}),t(e).data("jstree",o),o.init(e,i),o},t.jstree.destroy=function(){t(".jstree:jstree").jstree("destroy"),t(l).off(".jstree")},t.jstree.core=function(t){this._id=t,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},t.jstree.reference=function(e){var n=null,i=null;if(!e||!e.id||e.tagName&&e.nodeType||(e=e.id),!i||!i.length)try{i=t(e)}catch(t){}if(!i||!i.length)try{i=t("#"+e.replace(t.jstree.idregex,"\\$&"))}catch(t){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?n=i:t(".jstree").each(function(){var i=t(this).data("jstree");return i&&i._model.data[e]?(n=i,!1):void 0}),n},t.fn.jstree=function(n){var i="string"==typeof n,o=Array.prototype.slice.call(arguments,1),r=null;return!(n===!0&&!this.length)&&(this.each(function(){var s=t.jstree.reference(this),a=i&&s?s[n]:null;return r=i&&a?a.apply(s,o):null,s||i||n!==e&&!t.isPlainObject(n)||t.jstree.create(this,n),(s&&!i||n===!0)&&(r=s||!1),(null===r||r===e)&&void 0}),null!==r&&r!==e?r:this)},t.expr.pseudos.jstree=t.expr.createPseudo(function(n){return function(n){return t(n).hasClass("jstree")&&t(n).data("jstree")!==e}}),t.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:t.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,keyboard:{"ctrl-space":function(e){e.type="click",t(e.currentTarget).trigger(e)},enter:function(e){e.type="click",t(e.currentTarget).trigger(e)},left:function(e){if(e.preventDefault(),this.is_open(e.currentTarget))this.close_node(e.currentTarget);else{var n=this.get_parent(e.currentTarget);n&&n.id!==t.jstree.root&&this.get_node(n,!0).children(".jstree-anchor").focus()}},up:function(t){t.preventDefault();var e=this.get_prev_dom(t.currentTarget);e&&e.length&&e.children(".jstree-anchor").focus()},right:function(e){if(e.preventDefault(),this.is_closed(e.currentTarget))this.open_node(e.currentTarget,function(t){this.get_node(t,!0).children(".jstree-anchor").focus()});else if(this.is_open(e.currentTarget)){var n=this.get_node(e.currentTarget,!0).children(".jstree-children")[0];n&&t(this._firstChild(n)).children(".jstree-anchor").focus()}},down:function(t){
t.preventDefault();var e=this.get_next_dom(t.currentTarget);e&&e.length&&e.children(".jstree-anchor").focus()},"*":function(t){this.open_all()},home:function(e){e.preventDefault();var n=this._firstChild(this.get_container_ul()[0]);n&&t(n).children(".jstree-anchor").filter(":visible").focus()},end:function(t){t.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(t){t.preventDefault(),this.edit(t.currentTarget)}}},t.jstree.core.prototype={plugin:function(e,n){var i=t.jstree.plugins[e];return i?(this._data[e]={},i.prototype=this,new i(n,this)):this},init:function(e,n){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[t.jstree.root]={id:t.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=t(e).addClass("jstree jstree-"+this._id),this.settings=n,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(t.jstree.root)},destroy:function(t){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(t){}t||this.element.empty(),this.teardown()},_create_prototype_node:function(){var t,e,n=l.createElement("LI");return n.setAttribute("role","treeitem"),t=l.createElement("I"),t.className="jstree-icon jstree-ocl",t.setAttribute("role","presentation"),n.appendChild(t),t=l.createElement("A"),t.className="jstree-anchor",t.setAttribute("href","#"),t.setAttribute("tabindex","-1"),e=l.createElement("I"),e.className="jstree-icon jstree-themeicon",e.setAttribute("role","presentation"),t.appendChild(e),n.appendChild(t),t=e=null,n},_kbevent_to_func:function(t){var e={8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"},n=[];t.ctrlKey&&n.push("ctrl"),t.altKey&&n.push("alt"),t.shiftKey&&n.push("shift"),n.push(e[t.which]||t.which),n=n.sort().join("-").toLowerCase();var i,o,r=this.settings.core.keyboard;for(i in r)if(r.hasOwnProperty(i)&&(o=i,"-"!==o&&"+"!==o&&(o=o.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS"),o=o.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),o===n))return r[i];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var e="",n=null,i=0;this.element.on("dblclick.jstree",function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;if(l.selection&&l.selection.empty)l.selection.empty();else if(window.getSelection){var e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(t){}}}).on("mousedown.jstree",t.proxy(function(t){t.target===this.element[0]&&(t.preventDefault(),i=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(t){t.preventDefault()}).on("click.jstree",".jstree-ocl",t.proxy(function(t){this.toggle_node(t.target)},this)).on("dblclick.jstree",".jstree-anchor",t.proxy(function(t){return!(!t.target.tagName||"input"!==t.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(t.target))},this)).on("click.jstree",".jstree-anchor",t.proxy(function(e){e.preventDefault(),e.currentTarget!==l.activeElement&&t(e.currentTarget).focus(),this.activate_node(e.currentTarget,e)},this)).on("keydown.jstree",".jstree-anchor",t.proxy(function(t){if(t.target.tagName&&"input"===t.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===t.which?t.which=39:39===t.which&&(t.which=37));var e=this._kbevent_to_func(t);if(e){var n=e.call(this,t);if(n===!1||n===!0)return n}},this)).on("load_node.jstree",t.proxy(function(e,n){n.status&&(n.node.id!==t.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(t.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var e,n,i=[];for(e=0,n=this._data.core.selected.length;n>e;e++)i=i.concat(this._model.data[this._data.core.selected[e]].parents);for(i=t.vakata.array_unique(i),e=0,n=i.length;n>e;e++)this.open_node(i[e],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",t.proxy(function(i){if(i.target.tagName&&"input"===i.target.tagName.toLowerCase())return!0;n&&clearTimeout(n),n=setTimeout(function(){e=""},500);var o=String.fromCharCode(i.which).toLowerCase(),r=this.element.find(".jstree-anchor").filter(":visible"),s=r.index(l.activeElement)||0,a=!1;if(e+=o,e.length>1){if(r.slice(s).each(t.proxy(function(n,i){return 0===t(i).text().toLowerCase().indexOf(e)?(t(i).focus(),a=!0,!1):void 0},this)),a)return;if(r.slice(0,s).each(t.proxy(function(n,i){return 0===t(i).text().toLowerCase().indexOf(e)?(t(i).focus(),a=!0,!1):void 0},this)),a)return}if(new RegExp("^"+o.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(e)){if(r.slice(s+1).each(t.proxy(function(e,n){return t(n).text().toLowerCase().charAt(0)===o?(t(n).focus(),a=!0,!1):void 0},this)),a)return;if(r.slice(0,s+1).each(t.proxy(function(e,n){return t(n).text().toLowerCase().charAt(0)===o?(t(n).focus(),a=!0,!1):void 0},this)),a)return}},this)).on("init.jstree",t.proxy(function(){var t=this.settings.core.themes;this._data.core.themes.dots=t.dots,this._data.core.themes.stripes=t.stripes,this._data.core.themes.icons=t.icons,this._data.core.themes.ellipsis=t.ellipsis,this.set_theme(t.name||"default",t.url),this.set_theme_variant(t.variant)},this)).on("loading.jstree",t.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",t.proxy(function(e){this._data.core.focused=null,t(e.currentTarget).filter(".jstree-hovered").mouseleave(),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",t.proxy(function(e){var n=this.get_node(e.currentTarget);n&&n.id&&(this._data.core.focused=n.id),this.element.find(".jstree-hovered").not(e.currentTarget).mouseleave(),t(e.currentTarget).mouseenter(),this.element.attr("tabindex","-1")},this)).on("focus.jstree",t.proxy(function(){if(+new Date-i>500&&!this._data.core.focused&&this.settings.core.restore_focus){i=0;var t=this.get_node(this.element.attr("aria-activedescendant"),!0);t&&t.find("> .jstree-anchor").focus()}},this)).on("mouseenter.jstree",".jstree-anchor",t.proxy(function(t){this.hover_node(t.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",t.proxy(function(t){this.dehover_node(t.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),t(l).off(".jstree-"+this._id)},trigger:function(t,e){e||(e={}),e.instance=this,this.element.triggerHandler(t.replace(".jstree","")+".jstree",e)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(e){var n=this.settings.core.strings;return t.isFunction(n)?n.call(this,e):n&&n[e]?n[e]:e},_firstChild:function(t){for(t=t?t.firstChild:null;null!==t&&1!==t.nodeType;)t=t.nextSibling;return t},_nextSibling:function(t){for(t=t?t.nextSibling:null;null!==t&&1!==t.nodeType;)t=t.nextSibling;return t},_previousSibling:function(t){for(t=t?t.previousSibling:null;null!==t&&1!==t.nodeType;)t=t.previousSibling;return t},get_node:function(e,n){e&&e.id&&(e=e.id);var i;try{if(this._model.data[e])e=this._model.data[e];else if("string"==typeof e&&this._model.data[e.replace(/^#/,"")])e=this._model.data[e.replace(/^#/,"")];else if("string"==typeof e&&(i=t("#"+e.replace(t.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=t(e,this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])e=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=t(e,this.element)).length||!i.hasClass("jstree"))return!1;e=this._model.data[t.jstree.root]}return n&&(e=e.id===t.jstree.root?this.element:t("#"+e.id.replace(t.jstree.idregex,"\\$&"),this.element)),e}catch(t){return!1}},get_path:function(e,n,i){if(e=e.parents?e:this.get_node(e),!e||e.id===t.jstree.root||!e.parents)return!1;var o,r,s=[];for(s.push(i?e.id:e.text),o=0,r=e.parents.length;r>o;o++)s.push(i?e.parents[o]:this.get_text(e.parents[o]));return s=s.reverse().slice(1),n?s.join(n):s},get_next_dom:function(e,n){var i;if(e=this.get_node(e,!0),e[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&t(i)}if(!e||!e.length)return!1;if(n){i=e[0];do i=this._nextSibling(i);while(i&&0===i.offsetHeight);return!!i&&t(i)}if(e.hasClass("jstree-open")){for(i=this._firstChild(e.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return t(i)}i=e[0];do i=this._nextSibling(i);while(i&&0===i.offsetHeight);return null!==i?t(i):e.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(e,n){var i;if(e=this.get_node(e,!0),e[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&t(i)}if(!e||!e.length)return!1;if(n){i=e[0];do i=this._previousSibling(i);while(i&&0===i.offsetHeight);return!!i&&t(i)}i=e[0];do i=this._previousSibling(i);while(i&&0===i.offsetHeight);if(null!==i){for(e=t(i);e.hasClass("jstree-open");)e=e.children(".jstree-children").first().children(".jstree-node:visible:last");return e}return i=e[0].parentNode.parentNode,!(!i||!i.className||-1===i.className.indexOf("jstree-node"))&&t(i)},get_parent:function(e){return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&e.parent},get_children_dom:function(t){return t=this.get_node(t,!0),t[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!t||!t.length)&&t.children(".jstree-children").children(".jstree-node")},is_parent:function(t){return t=this.get_node(t),t&&(t.state.loaded===!1||t.children.length>0)},is_loaded:function(t){return t=this.get_node(t),t&&t.state.loaded},is_loading:function(t){return t=this.get_node(t),t&&t.state&&t.state.loading},is_open:function(t){return t=this.get_node(t),t&&t.state.opened},is_closed:function(t){return t=this.get_node(t),t&&this.is_parent(t)&&!t.state.opened},is_leaf:function(t){return!this.is_parent(t)},load_node:function(e,n){var i,o,r,s,a;if(t.isArray(e))return this._load_nodes(e.slice(),n),!0;if(e=this.get_node(e),!e)return n&&n.call(this,e,!1),!1;if(e.state.loaded){for(e.state.loaded=!1,r=0,s=e.parents.length;s>r;r++)this._model.data[e.parents[r]].children_d=t.vakata.array_filter(this._model.data[e.parents[r]].children_d,function(n){return-1===t.inArray(n,e.children_d)});for(i=0,o=e.children_d.length;o>i;i++)this._model.data[e.children_d[i]].state.selected&&(a=!0),delete this._model.data[e.children_d[i]];a&&(this._data.core.selected=t.vakata.array_filter(this._data.core.selected,function(n){return-1===t.inArray(n,e.children_d)})),e.children=[],e.children_d=[],a&&this.trigger("changed",{action:"load_node",node:e,selected:this._data.core.selected})}return e.state.failed=!1,e.state.loading=!0,this.get_node(e,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(e,t.proxy(function(t){e=this._model.data[e.id],e.state.loading=!1,e.state.loaded=t,e.state.failed=!e.state.loaded;var i=this.get_node(e,!0),o=0,r=0,s=this._model.data,a=!1;for(o=0,r=e.children.length;r>o;o++)if(s[e.children[o]]&&!s[e.children[o]].state.hidden){a=!0;break}e.state.loaded&&i&&i.length&&(i.removeClass("jstree-closed jstree-open jstree-leaf"),a?"#"!==e.id&&i.addClass(e.state.opened?"jstree-open":"jstree-closed"):i.addClass("jstree-leaf")),i.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:e,status:t}),n&&n.call(this,e,t)},this)),!0},_load_nodes:function(t,e,n,i){var o,r,s=!0,a=function(){this._load_nodes(t,e,!0)},l=this._model.data,d=[];for(o=0,r=t.length;r>o;o++)l[t[o]]&&(!l[t[o]].state.loaded&&!l[t[o]].state.failed||!n&&i)&&(this.is_loading(t[o])||this.load_node(t[o],a),s=!1);if(s){for(o=0,r=t.length;r>o;o++)l[t[o]]&&l[t[o]].state.loaded&&d.push(t[o]);e&&!e.done&&(e.call(this,d),e.done=!0)}},load_all:function(e,n){if(e||(e=t.jstree.root),e=this.get_node(e),!e)return!1;var i,o,r=[],s=this._model.data,a=s[e.id].children_d;for(e.state&&!e.state.loaded&&r.push(e.id),i=0,o=a.length;o>i;i++)s[a[i]]&&s[a[i]].state&&!s[a[i]].state.loaded&&r.push(a[i]);r.length?this._load_nodes(r,function(){this.load_all(e,n)}):(n&&n.call(this,e),this.trigger("load_all",{node:e}))},_load_node:function(e,n){var i,o=this.settings.core.data,r=function(){return 3!==this.nodeType&&8!==this.nodeType};return o?t.isFunction(o)?o.call(this,e,t.proxy(function(i){i===!1?n.call(this,!1):this["string"==typeof i?"_append_html_data":"_append_json_data"](e,"string"==typeof i?t(t.parseHTML(i)).filter(r):i,function(t){n.call(this,t)})},this)):"object"==typeof o?o.url?(o=t.extend(!0,{},o),t.isFunction(o.url)&&(o.url=o.url.call(this,e)),t.isFunction(o.data)&&(o.data=o.data.call(this,e)),t.ajax(o).done(t.proxy(function(i,o,s){var a=s.getResponseHeader("Content-Type");return a&&-1!==a.indexOf("json")||"object"==typeof i?this._append_json_data(e,i,function(t){n.call(this,t)}):a&&-1!==a.indexOf("html")||"string"==typeof i?this._append_html_data(e,t(t.parseHTML(i)).filter(r),function(t){n.call(this,t)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:e.id,xhr:s})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))},this)).fail(t.proxy(function(t){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:e.id,xhr:t})},n.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(i=t.isArray(o)?t.extend(!0,[],o):t.isPlainObject(o)?t.extend(!0,{},o):o,e.id===t.jstree.root?this._append_json_data(e,i,function(t){n.call(this,t)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:e.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1))):"string"==typeof o?e.id===t.jstree.root?this._append_html_data(e,t(t.parseHTML(o)).filter(r),function(t){n.call(this,t)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:e.id})},this.settings.core.error.call(this,this._data.core.last_error),n.call(this,!1)):n.call(this,!1):e.id===t.jstree.root?this._append_html_data(e,this._data.core.original_container_html.clone(!0),function(t){n.call(this,t)}):n.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&-1===t.inArray(e.id,this._model.changed)&&this._model.changed.push(e.id)},_append_html_data:function(e,n,i){e=this.get_node(e),e.children=[],e.children_d=[];var o,r,s,a=n.is("ul")?n.children():n,l=e.id,d=[],c=[],h=this._model.data,u=h[l],p=this._data.core.selected.length;for(a.each(t.proxy(function(e,n){o=this._parse_model_from_html(t(n),l,u.parents.concat()),o&&(d.push(o),c.push(o),h[o].children_d.length&&(c=c.concat(h[o].children_d)))},this)),u.children=d,u.children_d=c,r=0,s=u.parents.length;s>r;r++)h[u.parents[r]].children_d=h[u.parents[r]].children_d.concat(c);this.trigger("model",{nodes:c,parent:l}),l!==t.jstree.root?(this._node_changed(l),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==p&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(e,n,i,o){if(null!==this.element){e=this.get_node(e),e.children=[],e.children_d=[],n.d&&(n=n.d,"string"==typeof n&&(n=JSON.parse(n))),t.isArray(n)||(n=[n]);var r=null,s={df:this._model.default_state,dat:n,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},a=function(t,e){t.data&&(t=t.data);var n,i,o,r,s=t.dat,a=t.par,l=[],d=[],c=[],h=t.df,u=t.t_id,p=t.t_cnt,g=t.m,m=g[a],f=t.sel,y=function(t,n,i){i=i?i.concat():[],n&&i.unshift(n);var o,r,s,a,l=t.id.toString(),d={id:l,text:t.text||"",icon:t.icon===e||t.icon,parent:n,parents:i,children:t.children||[],children_d:t.children_d||[],data:t.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in h)h.hasOwnProperty(o)&&(d.state[o]=h[o]);if(t&&t.data&&t.data.jstree&&t.data.jstree.icon&&(d.icon=t.data.jstree.icon),(d.icon===e||null===d.icon||""===d.icon)&&(d.icon=!0),t&&t.data&&(d.data=t.data,t.data.jstree))for(o in t.data.jstree)t.data.jstree.hasOwnProperty(o)&&(d.state[o]=t.data.jstree[o]);if(t&&"object"==typeof t.state)for(o in t.state)t.state.hasOwnProperty(o)&&(d.state[o]=t.state[o]);if(t&&"object"==typeof t.li_attr)for(o in t.li_attr)t.li_attr.hasOwnProperty(o)&&(d.li_attr[o]=t.li_attr[o]);if(d.li_attr.id||(d.li_attr.id=l),t&&"object"==typeof t.a_attr)for(o in t.a_attr)t.a_attr.hasOwnProperty(o)&&(d.a_attr[o]=t.a_attr[o]);for(t&&t.children&&t.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),g[d.id]=d,o=0,r=d.children.length;r>o;o++)s=y(g[d.children[o]],d.id,i),a=g[s],d.children_d.push(s),a.children_d.length&&(d.children_d=d.children_d.concat(a.children_d));return delete t.data,delete t.children,g[d.id].original=t,d.state.selected&&c.push(d.id),d.id},v=function(t,n,i){i=i?i.concat():[],n&&i.unshift(n);var o,r,s,a,l,d=!1;do d="j"+u+"_"+ ++p;while(g[d]);l={id:!1,text:"string"==typeof t?t:"",icon:"object"!=typeof t||t.icon===e||t.icon,parent:n,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in h)h.hasOwnProperty(o)&&(l.state[o]=h[o]);if(t&&t.id&&(l.id=t.id.toString()),t&&t.text&&(l.text=t.text),t&&t.data&&t.data.jstree&&t.data.jstree.icon&&(l.icon=t.data.jstree.icon),(l.icon===e||null===l.icon||""===l.icon)&&(l.icon=!0),t&&t.data&&(l.data=t.data,t.data.jstree))for(o in t.data.jstree)t.data.jstree.hasOwnProperty(o)&&(l.state[o]=t.data.jstree[o]);if(t&&"object"==typeof t.state)for(o in t.state)t.state.hasOwnProperty(o)&&(l.state[o]=t.state[o]);if(t&&"object"==typeof t.li_attr)for(o in t.li_attr)t.li_attr.hasOwnProperty(o)&&(l.li_attr[o]=t.li_attr[o]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=d),l.li_attr.id||(l.li_attr.id=l.id),t&&"object"==typeof t.a_attr)for(o in t.a_attr)t.a_attr.hasOwnProperty(o)&&(l.a_attr[o]=t.a_attr[o]);if(t&&t.children&&t.children.length){for(o=0,r=t.children.length;r>o;o++)s=v(t.children[o],l.id,i),a=g[s],l.children.push(s),a.children_d.length&&(l.children_d=l.children_d.concat(a.children_d));l.children_d=l.children_d.concat(l.children)}return t&&t.children&&t.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete t.data,delete t.children,l.original=t,g[l.id]=l,l.state.selected&&c.push(l.id),l.id};if(s.length&&s[0].id!==e&&s[0].parent!==e){for(i=0,o=s.length;o>i;i++)s[i].children||(s[i].children=[]),s[i].state||(s[i].state={}),g[s[i].id.toString()]=s[i];for(i=0,o=s.length;o>i;i++)g[s[i].parent.toString()]?(g[s[i].parent.toString()].children.push(s[i].id.toString()),m.children_d.push(s[i].id.toString())):(this._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:s[i].id.toString(),parent:s[i].parent.toString()})},this.settings.core.error.call(this,this._data.core.last_error));for(i=0,o=m.children.length;o>i;i++)n=y(g[m.children[i]],a,m.parents.concat()),d.push(n),g[n].children_d.length&&(d=d.concat(g[n].children_d));for(i=0,o=m.parents.length;o>i;i++)g[m.parents[i]].children_d=g[m.parents[i]].children_d.concat(d);r={cnt:p,mod:g,sel:f,par:a,dpc:d,add:c}}else{for(i=0,o=s.length;o>i;i++)n=v(s[i],a,m.parents.concat()),n&&(l.push(n),d.push(n),g[n].children_d.length&&(d=d.concat(g[n].children_d)));for(m.children=l,m.children_d=d,i=0,o=m.parents.length;o>i;i++)g[m.parents[i]].children_d=g[m.parents[i]].children_d.concat(d);r={cnt:p,mod:g,sel:f,par:a,dpc:d,add:c}}return"undefined"!=typeof window&&"undefined"!=typeof window.document?r:void postMessage(r)},l=function(e,n){if(null!==this.element){this._cnt=e.cnt;var o,r=this._model.data;for(o in r)r.hasOwnProperty(o)&&r[o].state&&r[o].state.loading&&e.mod[o]&&(e.mod[o].state.loading=!0);if(this._model.data=e.mod,n){var s,a=e.add,l=e.sel,d=this._data.core.selected.slice();if(r=this._model.data,l.length!==d.length||t.vakata.array_unique(l.concat(d)).length!==l.length){for(o=0,s=l.length;s>o;o++)-1===t.inArray(l[o],a)&&-1===t.inArray(l[o],d)&&(r[l[o]].state.selected=!1);for(o=0,s=d.length;s>o;o++)-1===t.inArray(d[o],l)&&(r[d[o]].state.selected=!0)}}e.add.length&&(this._data.core.selected=this._data.core.selected.concat(e.add)),this.trigger("model",{nodes:e.dpc,parent:e.par}),e.par!==t.jstree.root?(this._node_changed(e.par),this.redraw()):this.redraw(!0),e.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+a.toString()],{type:"text/javascript"}))),!this._data.core.working||o?(this._data.core.working=!0,r=new window.Worker(this._wrk),r.onmessage=t.proxy(function(t){l.call(this,t.data,!0);try{r.terminate(),r=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),s.par?r.postMessage(s):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([e,n,i,!0])}catch(t){l.call(this,a(s),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else l.call(this,a(s),!1)}},_parse_model_from_html:function(n,i,o){o=o?[].concat(o):[],i&&o.unshift(i);var r,s,a,l,d,c=this._model.data,h={id:!1,text:!1,icon:!0,parent:i,parents:o,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in this._model.default_state)this._model.default_state.hasOwnProperty(a)&&(h.state[a]=this._model.default_state[a]);if(l=t.vakata.attributes(n,!0),t.each(l,function(e,n){return n=t.trim(n),!n.length||(h.li_attr[e]=n,void("id"===e&&(h.id=n.toString())))}),l=n.children("a").first(),l.length&&(l=t.vakata.attributes(l,!0),t.each(l,function(e,n){n=t.trim(n),n.length&&(h.a_attr[e]=n)})),l=n.children("a").first().length?n.children("a").first().clone():n.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=t("<div />").html(l),h.text=this.settings.core.force_text?l.text():l.html(),l=n.data(),h.data=l?t.extend(!0,{},l):null,h.state.opened=n.hasClass("jstree-open"),h.state.selected=n.children("a").hasClass("jstree-clicked"),h.state.disabled=n.children("a").hasClass("jstree-disabled"),h.data&&h.data.jstree)for(a in h.data.jstree)h.data.jstree.hasOwnProperty(a)&&(h.state[a]=h.data.jstree[a]);l=n.children("a").children(".jstree-themeicon"),l.length&&(h.icon=!l.hasClass("jstree-themeicon-hidden")&&l.attr("rel")),h.state.icon!==e&&(h.icon=h.state.icon),(h.icon===e||null===h.icon||""===h.icon)&&(h.icon=!0),l=n.children("ul").children("li");do d="j"+this._id+"_"+ ++this._cnt;while(c[d]);return h.id=h.li_attr.id?h.li_attr.id.toString():d,l.length?(l.each(t.proxy(function(e,n){r=this._parse_model_from_html(t(n),h.id,o),s=this._model.data[r],h.children.push(r),s.children_d.length&&(h.children_d=h.children_d.concat(s.children_d))},this)),h.children_d=h.children_d.concat(h.children)):n.hasClass("jstree-closed")&&(h.state.loaded=!1),h.li_attr.class&&(h.li_attr.class=h.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),h.a_attr.class&&(h.a_attr.class=h.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),c[h.id]=h,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_flat_json:function(t,n,i){i=i?i.concat():[],n&&i.unshift(n);var o,r,s,a,l=t.id.toString(),d=this._model.data,c=this._model.default_state,h={id:l,text:t.text||"",icon:t.icon===e||t.icon,parent:n,parents:i,children:t.children||[],children_d:t.children_d||[],data:t.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in c)c.hasOwnProperty(o)&&(h.state[o]=c[o]);if(t&&t.data&&t.data.jstree&&t.data.jstree.icon&&(h.icon=t.data.jstree.icon),(h.icon===e||null===h.icon||""===h.icon)&&(h.icon=!0),t&&t.data&&(h.data=t.data,t.data.jstree))for(o in t.data.jstree)t.data.jstree.hasOwnProperty(o)&&(h.state[o]=t.data.jstree[o]);if(t&&"object"==typeof t.state)for(o in t.state)t.state.hasOwnProperty(o)&&(h.state[o]=t.state[o]);if(t&&"object"==typeof t.li_attr)for(o in t.li_attr)t.li_attr.hasOwnProperty(o)&&(h.li_attr[o]=t.li_attr[o]);if(h.li_attr.id||(h.li_attr.id=l),t&&"object"==typeof t.a_attr)for(o in t.a_attr)t.a_attr.hasOwnProperty(o)&&(h.a_attr[o]=t.a_attr[o]);for(t&&t.children&&t.children===!0&&(h.state.loaded=!1,h.children=[],h.children_d=[]),d[h.id]=h,o=0,r=h.children.length;r>o;o++)s=this._parse_model_from_flat_json(d[h.children[o]],h.id,i),a=d[s],h.children_d.push(s),a.children_d.length&&(h.children_d=h.children_d.concat(a.children_d));return delete t.data,delete t.children,d[h.id].original=t,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(t,n,i){i=i?i.concat():[],n&&i.unshift(n);var o,r,s,a,l,d=!1,c=this._model.data,h=this._model.default_state;do d="j"+this._id+"_"+ ++this._cnt;while(c[d]);l={id:!1,text:"string"==typeof t?t:"",icon:"object"!=typeof t||t.icon===e||t.icon,parent:n,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in h)h.hasOwnProperty(o)&&(l.state[o]=h[o]);if(t&&t.id&&(l.id=t.id.toString()),t&&t.text&&(l.text=t.text),t&&t.data&&t.data.jstree&&t.data.jstree.icon&&(l.icon=t.data.jstree.icon),(l.icon===e||null===l.icon||""===l.icon)&&(l.icon=!0),t&&t.data&&(l.data=t.data,t.data.jstree))for(o in t.data.jstree)t.data.jstree.hasOwnProperty(o)&&(l.state[o]=t.data.jstree[o]);if(t&&"object"==typeof t.state)for(o in t.state)t.state.hasOwnProperty(o)&&(l.state[o]=t.state[o]);if(t&&"object"==typeof t.li_attr)for(o in t.li_attr)t.li_attr.hasOwnProperty(o)&&(l.li_attr[o]=t.li_attr[o]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=d),l.li_attr.id||(l.li_attr.id=l.id),t&&"object"==typeof t.a_attr)for(o in t.a_attr)t.a_attr.hasOwnProperty(o)&&(l.a_attr[o]=t.a_attr[o]);if(t&&t.children&&t.children.length){for(o=0,r=t.children.length;r>o;o++)s=this._parse_model_from_json(t.children[o],l.id,i),a=c[s],l.children.push(s),a.children_d.length&&(l.children_d=l.children_d.concat(a.children_d));l.children_d=l.children_d.concat(l.children)}return t&&t.children&&t.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete t.data,delete t.children,l.original=t,c[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var e,n,i,o=this._model.force_full_redraw?this._model.data[t.jstree.root].children.concat([]):this._model.changed.concat([]),r=l.createElement("UL"),s=this._data.core.focused;for(n=0,i=o.length;i>n;n++)e=this.redraw_node(o[n],!0,this._model.force_full_redraw),e&&this._model.force_full_redraw&&r.appendChild(e);this._model.force_full_redraw&&(r.className=this.get_container_ul()[0].className,r.setAttribute("role","group"),this.element.empty().append(r)),null!==s&&(e=this.get_node(s,!0),e&&e.length&&e.children(".jstree-anchor")[0]!==l.activeElement?e.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:o})},redraw:function(t){t&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(e){var n=this.get_node(e),i=!1,o=!1,r=!1,s=l;if(!n)return!1;if(n.id===t.jstree.root)return this.redraw(!0);if(e=this.get_node(e,!0),!e||!e.length)return!1;if(e.children(".jstree-children").remove(),e=e[0],n.children.length&&n.state.loaded){for(r=s.createElement("UL"),r.setAttribute("role","group"),r.className="jstree-children",i=0,o=n.children.length;o>i;i++)r.appendChild(this.redraw_node(n.children[i],!0,!0));e.appendChild(r)}},redraw_node:function(e,n,i,o){var r=this.get_node(e),s=!1,a=!1,d=!1,c=!1,h=!1,u=!1,p="",g=l,m=this._model.data,f=!1,y=null,v=0,j=0,x=!1,_=!1;if(!r)return!1;if(r.id===t.jstree.root)return this.redraw(!0);if(n=n||0===r.children.length,e=l.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(r.id[0])?"\\3"+r.id[0]+" "+r.id.substr(1).replace(t.jstree.idregex,"\\$&"):r.id.replace(t.jstree.idregex,"\\$&"))):l.getElementById(r.id))e=t(e),i||(s=e.parent().parent()[0],s===this.element[0]&&(s=null),a=e.index()),n||!r.children.length||e.children(".jstree-children").length||(n=!0),n||(d=e.children(".jstree-children")[0]),f=e.children(".jstree-anchor")[0]===l.activeElement,e.remove();else if(n=!0,!i){if(s=r.parent!==t.jstree.root?t("#"+r.parent.replace(t.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===s||s&&m[r.parent].state.opened))return!1;a=t.inArray(r.id,null===s?m[t.jstree.root].children:m[r.parent].children)}e=this._data.core.node.cloneNode(!0),p="jstree-node ";for(c in r.li_attr)if(r.li_attr.hasOwnProperty(c)){if("id"===c)continue;"class"!==c?e.setAttribute(c,r.li_attr[c]):p+=r.li_attr[c]}for(r.a_attr.id||(r.a_attr.id=r.id+"_anchor"),e.setAttribute("aria-selected",!!r.state.selected),e.setAttribute("aria-level",r.parents.length),
e.setAttribute("aria-labelledby",r.a_attr.id),r.state.disabled&&e.setAttribute("aria-disabled",!0),c=0,h=r.children.length;h>c;c++)if(!m[r.children[c]].state.hidden){x=!0;break}if(null!==r.parent&&m[r.parent]&&!r.state.hidden&&(c=t.inArray(r.id,m[r.parent].children),_=r.id,-1!==c))for(c++,h=m[r.parent].children.length;h>c&&(m[m[r.parent].children[c]].state.hidden||(_=m[r.parent].children[c]),_===r.id);c++);r.state.hidden&&(p+=" jstree-hidden"),r.state.loading&&(p+=" jstree-loading"),r.state.loaded&&!x?p+=" jstree-leaf":(p+=r.state.opened&&r.state.loaded?" jstree-open":" jstree-closed",e.setAttribute("aria-expanded",r.state.opened&&r.state.loaded)),_===r.id&&(p+=" jstree-last"),e.id=r.id,e.className=p,p=(r.state.selected?" jstree-clicked":"")+(r.state.disabled?" jstree-disabled":"");for(h in r.a_attr)if(r.a_attr.hasOwnProperty(h)){if("href"===h&&"#"===r.a_attr[h])continue;"class"!==h?e.childNodes[1].setAttribute(h,r.a_attr[h]):p+=" "+r.a_attr[h]}if(p.length&&(e.childNodes[1].className="jstree-anchor "+p),(r.icon&&r.icon!==!0||r.icon===!1)&&(r.icon===!1?e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===r.icon.indexOf("/")&&-1===r.icon.indexOf(".")?e.childNodes[1].childNodes[0].className+=" "+r.icon+" jstree-themeicon-custom":(e.childNodes[1].childNodes[0].style.backgroundImage='url("'+r.icon+'")',e.childNodes[1].childNodes[0].style.backgroundPosition="center center",e.childNodes[1].childNodes[0].style.backgroundSize="auto",e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?e.childNodes[1].appendChild(g.createTextNode(r.text)):e.childNodes[1].innerHTML+=r.text,n&&r.children.length&&(r.state.opened||o)&&r.state.loaded){for(u=g.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",c=0,h=r.children.length;h>c;c++)u.appendChild(this.redraw_node(r.children[c],n,!0));e.appendChild(u)}if(d&&e.appendChild(d),!i){for(s||(s=this.element[0]),c=0,h=s.childNodes.length;h>c;c++)if(s.childNodes[c]&&s.childNodes[c].className&&-1!==s.childNodes[c].className.indexOf("jstree-children")){y=s.childNodes[c];break}y||(y=g.createElement("UL"),y.setAttribute("role","group"),y.className="jstree-children",s.appendChild(y)),s=y,a<s.childNodes.length?s.insertBefore(e,s.childNodes[a]):s.appendChild(e),f&&(v=this.element[0].scrollTop,j=this.element[0].scrollLeft,e.childNodes[1].focus(),this.element[0].scrollTop=v,this.element[0].scrollLeft=j)}return r.state.opened&&!r.state.loaded&&(r.state.opened=!1,setTimeout(t.proxy(function(){this.open_node(r.id,!1,0)},this),0)),e},open_node:function(n,i,o){var r,s,a,l;if(t.isArray(n)){for(n=n.slice(),r=0,s=n.length;s>r;r++)this.open_node(n[r],i,o);return!0}return n=this.get_node(n),!(!n||n.id===t.jstree.root)&&(o=o===e?this.settings.core.animation:o,this.is_closed(n)?this.is_loaded(n)?(a=this.get_node(n,!0),l=this,a.length&&(o&&a.children(".jstree-children").length&&a.children(".jstree-children").stop(!0,!0),n.children.length&&!this._firstChild(a.children(".jstree-children")[0])&&this.draw_children(n),o?(this.trigger("before_open",{node:n}),a.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(o,function(){this.style.display="",l.element&&l.trigger("after_open",{node:n})})):(this.trigger("before_open",{node:n}),a[0].className=a[0].className.replace("jstree-closed","jstree-open"),a[0].setAttribute("aria-expanded",!0))),n.state.opened=!0,i&&i.call(this,n,!0),a.length||this.trigger("before_open",{node:n}),this.trigger("open_node",{node:n}),o&&a.length||this.trigger("after_open",{node:n}),!0):this.is_loading(n)?setTimeout(t.proxy(function(){this.open_node(n,i,o)},this),500):void this.load_node(n,function(t,e){return e?this.open_node(t,i,o):!!i&&i.call(this,t,!1)}):(i&&i.call(this,n,!1),!1))},_open_to:function(e){if(e=this.get_node(e),!e||e.id===t.jstree.root)return!1;var n,i,o=e.parents;for(n=0,i=o.length;i>n;n+=1)n!==t.jstree.root&&this.open_node(o[n],!1,0);return t("#"+e.id.replace(t.jstree.idregex,"\\$&"),this.element)},close_node:function(n,i){var o,r,s,a;if(t.isArray(n)){for(n=n.slice(),o=0,r=n.length;r>o;o++)this.close_node(n[o],i);return!0}return n=this.get_node(n),!(!n||n.id===t.jstree.root)&&(!this.is_closed(n)&&(i=i===e?this.settings.core.animation:i,s=this,a=this.get_node(n,!0),n.state.opened=!1,this.trigger("close_node",{node:n}),void(a.length?i?a.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",a.children(".jstree-children").remove(),s.element&&s.trigger("after_close",{node:n})}):(a[0].className=a[0].className.replace("jstree-open","jstree-closed"),a.attr("aria-expanded",!1).children(".jstree-children").remove(),this.trigger("after_close",{node:n})):this.trigger("after_close",{node:n}))))},toggle_node:function(e){var n,i;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.toggle_node(e[n]);return!0}return this.is_closed(e)?this.open_node(e):this.is_open(e)?this.close_node(e):void 0},open_all:function(e,n,i){if(e||(e=t.jstree.root),e=this.get_node(e),!e)return!1;var o,r,s,a=e.id===t.jstree.root?this.get_container_ul():this.get_node(e,!0);if(!a.length){for(o=0,r=e.children_d.length;r>o;o++)this.is_closed(this._model.data[e.children_d[o]])&&(this._model.data[e.children_d[o]].state.opened=!0);return this.trigger("open_all",{node:e})}i=i||a,s=this,a=this.is_closed(e)?a.find(".jstree-closed").addBack():a.find(".jstree-closed"),a.each(function(){s.open_node(this,function(t,e){e&&this.is_parent(t)&&this.open_all(t,n,i)},n||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(e,n){if(e||(e=t.jstree.root),e=this.get_node(e),!e)return!1;var i,o,r=e.id===t.jstree.root?this.get_container_ul():this.get_node(e,!0),s=this;for(r.length&&(r=this.is_open(e)?r.find(".jstree-open").addBack():r.find(".jstree-open"),t(r.get().reverse()).each(function(){s.close_node(this,n||0)})),i=0,o=e.children_d.length;o>i;i++)this._model.data[e.children_d[i]].state.opened=!1;this.trigger("close_all",{node:e})},is_disabled:function(t){return t=this.get_node(t),t&&t.state&&t.state.disabled},enable_node:function(e){var n,i;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.enable_node(e[n]);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(e.state.disabled=!1,this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:e}))},disable_node:function(e){var n,i;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.disable_node(e[n]);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(e.state.disabled=!0,this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:e}))},is_hidden:function(t){return t=this.get_node(t),t.state.hidden===!0},hide_node:function(e,n){var i,o;if(t.isArray(e)){for(e=e.slice(),i=0,o=e.length;o>i;i++)this.hide_node(e[i],!0);return n||this.redraw(),!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&void(e.state.hidden||(e.state.hidden=!0,this._node_changed(e.parent),n||this.redraw(),this.trigger("hide_node",{node:e})))},show_node:function(e,n){var i,o;if(t.isArray(e)){for(e=e.slice(),i=0,o=e.length;o>i;i++)this.show_node(e[i],!0);return n||this.redraw(),!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&void(e.state.hidden&&(e.state.hidden=!1,this._node_changed(e.parent),n||this.redraw(),this.trigger("show_node",{node:e})))},hide_all:function(e){var n,i=this._model.data,o=[];for(n in i)i.hasOwnProperty(n)&&n!==t.jstree.root&&!i[n].state.hidden&&(i[n].state.hidden=!0,o.push(n));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("hide_all",{nodes:o}),o},show_all:function(e){var n,i=this._model.data,o=[];for(n in i)i.hasOwnProperty(n)&&n!==t.jstree.root&&i[n].state.hidden&&(i[n].state.hidden=!1,o.push(n));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("show_all",{nodes:o}),o},activate_node:function(t,n){if(this.is_disabled(t))return!1;if(n&&"object"==typeof n||(n={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==e?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&(!n.shiftKey||this._data.core.last_clicked&&this.get_parent(t)&&this.get_parent(t)===this._data.core.last_clicked.parent))if(n.shiftKey){var i,o,r=this.get_node(t).id,s=this._data.core.last_clicked.id,a=this.get_node(this._data.core.last_clicked.parent).children,l=!1;for(i=0,o=a.length;o>i;i+=1)a[i]===r&&(l=!l),a[i]===s&&(l=!l),this.is_disabled(a[i])||!l&&a[i]!==r&&a[i]!==s?this.deselect_node(a[i],!0,n):this.is_hidden(a[i])||this.select_node(a[i],!0,!1,n);this.trigger("changed",{action:"select_node",node:this.get_node(t),selected:this._data.core.selected,event:n})}else this.is_selected(t)?this.deselect_node(t,!1,n):this.select_node(t,!1,!1,n);else!this.settings.core.multiple&&(n.metaKey||n.ctrlKey||n.shiftKey)&&this.is_selected(t)?this.deselect_node(t,!1,n):(this.deselect_all(!0),this.select_node(t,!1,!1,n),this._data.core.last_clicked=this.get_node(t));this.trigger("activate_node",{node:this.get_node(t),event:n})},hover_node:function(t){if(t=this.get_node(t,!0),!t||!t.length||t.children(".jstree-hovered").length)return!1;var e=this.element.find(".jstree-hovered"),n=this.element;e&&e.length&&this.dehover_node(e),t.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(t)}),setTimeout(function(){n.attr("aria-activedescendant",t[0].id)},0)},dehover_node:function(t){return t=this.get_node(t,!0),!!(t&&t.length&&t.children(".jstree-hovered").length)&&(t.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(t)}))},select_node:function(e,n,i,o){var r,s,a;if(t.isArray(e)){for(e=e.slice(),s=0,a=e.length;a>s;s++)this.select_node(e[s],n,i,o);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(r=this.get_node(e,!0),void(e.state.selected||(e.state.selected=!0,this._data.core.selected.push(e.id),i||(r=this._open_to(e)),r&&r.length&&r.attr("aria-selected",!0).children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:e,selected:this._data.core.selected,event:o}),n||this.trigger("changed",{action:"select_node",node:e,selected:this._data.core.selected,event:o}))))},deselect_node:function(e,n,i){var o,r,s;if(t.isArray(e)){for(e=e.slice(),o=0,r=e.length;r>o;o++)this.deselect_node(e[o],n,i);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(s=this.get_node(e,!0),void(e.state.selected&&(e.state.selected=!1,this._data.core.selected=t.vakata.array_remove_item(this._data.core.selected,e.id),s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:e,selected:this._data.core.selected,event:i}),n||this.trigger("changed",{action:"deselect_node",node:e,selected:this._data.core.selected,event:i}))))},select_all:function(e){var n,i,o=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[t.jstree.root].children_d.concat(),n=0,i=this._data.core.selected.length;i>n;n++)this._model.data[this._data.core.selected[n]]&&(this._model.data[this._data.core.selected[n]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:o})},deselect_all:function(t){var e,n,i=this._data.core.selected.concat([]);for(e=0,n=this._data.core.selected.length;n>e;e++)this._model.data[this._data.core.selected[e]]&&(this._model.data[this._data.core.selected[e]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").parent().attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:i}),t||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(e){return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&e.state.selected},get_selected:function(e){return e?t.map(this._data.core.selected,t.proxy(function(t){return this.get_node(t)},this)):this._data.core.selected.slice()},get_top_selected:function(e){var n,i,o,r,s=this.get_selected(!0),a={};for(n=0,i=s.length;i>n;n++)a[s[n].id]=s[n];for(n=0,i=s.length;i>n;n++)for(o=0,r=s[n].children_d.length;r>o;o++)a[s[n].children_d[o]]&&delete a[s[n].children_d[o]];s=[];for(n in a)a.hasOwnProperty(n)&&s.push(n);return e?t.map(s,t.proxy(function(t){return this.get_node(t)},this)):s},get_bottom_selected:function(e){var n,i,o=this.get_selected(!0),r=[];for(n=0,i=o.length;i>n;n++)o[n].children.length||r.push(o[n].id);return e?t.map(r,t.proxy(function(t){return this.get_node(t)},this)):r},get_state:function(){var e,n={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(e in this._model.data)this._model.data.hasOwnProperty(e)&&e!==t.jstree.root&&(this._model.data[e].state.loaded&&this.settings.core.loaded_state&&n.core.loaded.push(e),this._model.data[e].state.opened&&n.core.open.push(e),this._model.data[e].state.selected&&n.core.selected.push(e));return n},set_state:function(n,i){if(n){if(n.core&&n.core.selected&&n.core.initial_selection===e&&(n.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),n.core){var o,r;if(n.core.loaded)return this.settings.core.loaded_state&&t.isArray(n.core.loaded)&&n.core.loaded.length?this._load_nodes(n.core.loaded,function(t){delete n.core.loaded,this.set_state(n,i)}):(delete n.core.loaded,this.set_state(n,i)),!1;if(n.core.open)return t.isArray(n.core.open)&&n.core.open.length?this._load_nodes(n.core.open,function(t){this.open_node(t,!1,0),delete n.core.open,this.set_state(n,i)}):(delete n.core.open,this.set_state(n,i)),!1;if(n.core.scroll)return n.core.scroll&&n.core.scroll.left!==e&&this.element.scrollLeft(n.core.scroll.left),n.core.scroll&&n.core.scroll.top!==e&&this.element.scrollTop(n.core.scroll.top),delete n.core.scroll,this.set_state(n,i),!1;if(n.core.selected)return o=this,(n.core.initial_selection===e||n.core.initial_selection===this._data.core.selected.concat([]).sort().join(","))&&(this.deselect_all(),t.each(n.core.selected,function(t,e){o.select_node(e,!1,!0)})),delete n.core.initial_selection,delete n.core.selected,this.set_state(n,i),!1;for(r in n)n.hasOwnProperty(r)&&"core"!==r&&-1===t.inArray(r,this.settings.plugins)&&delete n[r];if(t.isEmptyObject(n.core))return delete n.core,this.set_state(n,i),!1}return!t.isEmptyObject(n)||(n=null,i&&i.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(e,n){this._data.core.state=n===!0?{}:this.get_state(),n&&t.isFunction(n)&&(this._data.core.state=n.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[t.jstree.root]={id:t.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;e||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(t.jstree.root,function(e,n){n&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(t.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(e){if(e=this.get_node(e),!e||e.id===t.jstree.root)return!1;var n=[],i=[],o=this._data.core.selected.concat([]);i.push(e.id),e.state.opened===!0&&n.push(e.id),this.get_node(e,!0).find(".jstree-open").each(function(){i.push(this.id),n.push(this.id)}),this._load_nodes(i,t.proxy(function(t){this.open_node(n,!1,0),this.select_node(o),this.trigger("refresh_node",{node:e,nodes:t})},this),!1,!0)},set_id:function(e,n){if(e=this.get_node(e),!e||e.id===t.jstree.root)return!1;var i,o,r=this._model.data,s=e.id;for(n=n.toString(),r[e.parent].children[t.inArray(e.id,r[e.parent].children)]=n,i=0,o=e.parents.length;o>i;i++)r[e.parents[i]].children_d[t.inArray(e.id,r[e.parents[i]].children_d)]=n;for(i=0,o=e.children.length;o>i;i++)r[e.children[i]].parent=n;for(i=0,o=e.children_d.length;o>i;i++)r[e.children_d[i]].parents[t.inArray(e.id,r[e.children_d[i]].parents)]=n;return i=t.inArray(e.id,this._data.core.selected),-1!==i&&(this._data.core.selected[i]=n),i=this.get_node(e.id,!0),i&&(i.attr("id",n),this.element.attr("aria-activedescendant")===e.id&&this.element.attr("aria-activedescendant",n)),delete r[e.id],e.id=n,e.li_attr.id=n,r[n]=e,this.trigger("set_id",{node:e,new:e.id,old:s}),!0},get_text:function(e){return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&e.text},set_text:function(e,n){var i,o;if(t.isArray(e)){for(e=e.slice(),i=0,o=e.length;o>i;i++)this.set_text(e[i],n);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(e.text=n,this.get_node(e,!0).length&&this.redraw_node(e.id),this.trigger("set_text",{obj:e,text:n}),!0)},get_json:function(e,n,i){if(e=this.get_node(e||t.jstree.root),!e)return!1;n&&n.flat&&!i&&(i=[]);var o,r,s={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:t.extend(!0,{},e.li_attr),a_attr:t.extend(!0,{},e.a_attr),state:{},data:(!n||!n.no_data)&&t.extend(!0,t.isArray(e.data)?[]:{},e.data)};if(n&&n.flat?s.parent=e.parent:s.children=[],n&&n.no_state)delete s.state;else for(o in e.state)e.state.hasOwnProperty(o)&&(s.state[o]=e.state[o]);if(n&&n.no_li_attr&&delete s.li_attr,n&&n.no_a_attr&&delete s.a_attr,n&&n.no_id&&(delete s.id,s.li_attr&&s.li_attr.id&&delete s.li_attr.id,s.a_attr&&s.a_attr.id&&delete s.a_attr.id),n&&n.flat&&e.id!==t.jstree.root&&i.push(s),!n||!n.no_children)for(o=0,r=e.children.length;r>o;o++)n&&n.flat?this.get_json(e.children[o],n,i):s.children.push(this.get_json(e.children[o],n));return n&&n.flat?i:e.id===t.jstree.root?s.children:s},create_node:function(n,i,o,r,s){if(null===n&&(n=t.jstree.root),n=this.get_node(n),!n)return!1;if(o=o===e?"last":o,!o.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(n))return this.load_node(n,function(){this.create_node(n,i,o,r,!0)});i||(i={text:this.get_string("New node")}),i="string"==typeof i?{text:i}:t.extend(!0,{},i),i.text===e&&(i.text=this.get_string("New node"));var a,l,d,c;switch(n.id===t.jstree.root&&("before"===o&&(o="first"),"after"===o&&(o="last")),o){case"before":a=this.get_node(n.parent),o=t.inArray(n.id,a.children),n=a;break;case"after":a=this.get_node(n.parent),o=t.inArray(n.id,a.children)+1,n=a;break;case"inside":case"first":o=0;break;case"last":o=n.children.length;break;default:o||(o=0)}if(o>n.children.length&&(o=n.children.length),i.id||(i.id=!0),!this.check("create_node",i,n,o))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.id===!0&&delete i.id,i=this._parse_model_from_json(i,n.id,n.parents.concat()),!i)return!1;for(a=this.get_node(i),l=[],l.push(i),l=l.concat(a.children_d),this.trigger("model",{nodes:l,parent:n.id}),n.children_d=n.children_d.concat(l),d=0,c=n.parents.length;c>d;d++)this._model.data[n.parents[d]].children_d=this._model.data[n.parents[d]].children_d.concat(l);for(i=a,a=[],d=0,c=n.children.length;c>d;d++)a[d>=o?d+1:d]=n.children[d];return a[o]=i.id,n.children=a,this.redraw_node(n,!0),this.trigger("create_node",{node:this.get_node(i),parent:n.id,position:o}),r&&r.call(this,this.get_node(i)),i.id},rename_node:function(e,n){var i,o,r;if(t.isArray(e)){for(e=e.slice(),i=0,o=e.length;o>i;i++)this.rename_node(e[i],n);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(r=e.text,this.check("rename_node",e,this.get_parent(e),n)?(this.set_text(e,n),this.trigger("rename_node",{node:e,text:n,old:r}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(e){var n,i,o,r,s,a,l,d,c,h,u,p;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.delete_node(e[n]);return!0}if(e=this.get_node(e),!e||e.id===t.jstree.root)return!1;if(o=this.get_node(e.parent),r=t.inArray(e.id,o.children),h=!1,!this.check("delete_node",e,o,r))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==r&&(o.children=t.vakata.array_remove(o.children,r)),s=e.children_d.concat([]),s.push(e.id),a=0,l=e.parents.length;l>a;a++)this._model.data[e.parents[a]].children_d=t.vakata.array_filter(this._model.data[e.parents[a]].children_d,function(e){return-1===t.inArray(e,s)});for(d=0,c=s.length;c>d;d++)if(this._model.data[s[d]].state.selected){h=!0;break}for(h&&(this._data.core.selected=t.vakata.array_filter(this._data.core.selected,function(e){return-1===t.inArray(e,s)})),this.trigger("delete_node",{node:e,parent:o.id}),h&&this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:o.id}),d=0,c=s.length;c>d;d++)delete this._model.data[s[d]];return-1!==t.inArray(this._data.core.focused,s)&&(this._data.core.focused=null,u=this.element[0].scrollTop,p=this.element[0].scrollLeft,o.id===t.jstree.root?this._model.data[t.jstree.root].children[0]&&this.get_node(this._model.data[t.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(o,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=p),this.redraw_node(o,!0),!0},check:function(e,n,i,o,r){n=n&&n.id?n:this.get_node(n),i=i&&i.id?i:this.get_node(i);var s=e.match(/^move_node|copy_node|create_node$/i)?i:n,a=this.settings.core.check_callback;return"move_node"!==e&&"copy_node"!==e||r&&r.is_multi||n.id!==i.id&&("move_node"!==e||t.inArray(n.id,i.children)!==o)&&-1===t.inArray(i.id,n.children_d)?(s&&s.data&&(s=s.data),s&&s.functions&&(s.functions[e]===!1||s.functions[e]===!0)?(s.functions[e]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:o,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})}),s.functions[e]):!(a===!1||t.isFunction(a)&&a.call(this,e,n,i,o,r)===!1||a&&a[e]===!1)||(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:o,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})},!1)):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:o,obj:!(!n||!n.id)&&n.id,par:!(!i||!i.id)&&i.id})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(n,i,o,r,s,a,l){var d,c,h,u,p,g,m,f,y,v,j,x,_,S;if(i=this.get_node(i),o=o===e?0:o,!i)return!1;if(!o.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(n,i,o,r,!0,!1,l)});if(t.isArray(n)){if(1!==n.length){for(d=0,c=n.length;c>d;d++)(y=this.move_node(n[d],i,o,r,s,!1,l))&&(i=y,o="after");return this.redraw(),!0}n=n[0]}if(n=n&&n.id?n:this.get_node(n),!n||n.id===t.jstree.root)return!1;if(h=(n.parent||t.jstree.root).toString(),p=o.toString().match(/^(before|after)$/)&&i.id!==t.jstree.root?this.get_node(i.parent):i,g=l?l:this._model.data[n.id]?this:t.jstree.reference(n.id),m=!g||!g._id||this._id!==g._id,u=g&&g._id&&h&&g._model.data[h]&&g._model.data[h].children?t.inArray(n.id,g._model.data[h].children):-1,g&&g._id&&(n=g._model.data[n.id]),m)return!!(y=this.copy_node(n,i,o,r,s,!1,l))&&(g&&g.delete_node(n),y);switch(i.id===t.jstree.root&&("before"===o&&(o="first"),"after"===o&&(o="last")),o){case"before":o=t.inArray(i.id,p.children);break;case"after":o=t.inArray(i.id,p.children)+1;break;case"inside":case"first":o=0;break;case"last":o=p.children.length;break;default:o||(o=0)}if(o>p.children.length&&(o=p.children.length),!this.check("move_node",n,p,o,{core:!0,origin:l,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(n.parent===p.id){for(f=p.children.concat(),y=t.inArray(n.id,f),-1!==y&&(f=t.vakata.array_remove(f,y),o>y&&o--),y=[],v=0,j=f.length;j>v;v++)y[v>=o?v+1:v]=f[v];y[o]=n.id,p.children=y,this._node_changed(p.id),this.redraw(p.id===t.jstree.root)}else{for(y=n.children_d.concat(),y.push(n.id),v=0,j=n.parents.length;j>v;v++){for(f=[],S=g._model.data[n.parents[v]].children_d,x=0,_=S.length;_>x;x++)-1===t.inArray(S[x],y)&&f.push(S[x]);g._model.data[n.parents[v]].children_d=f}for(g._model.data[h].children=t.vakata.array_remove_item(g._model.data[h].children,n.id),v=0,j=p.parents.length;j>v;v++)this._model.data[p.parents[v]].children_d=this._model.data[p.parents[v]].children_d.concat(y);for(f=[],v=0,j=p.children.length;j>v;v++)f[v>=o?v+1:v]=p.children[v];for(f[o]=n.id,p.children=f,p.children_d.push(n.id),p.children_d=p.children_d.concat(n.children_d),n.parent=p.id,y=p.parents.concat(),y.unshift(p.id),S=n.parents.length,n.parents=y,y=y.concat(),v=0,j=n.children_d.length;j>v;v++)this._model.data[n.children_d[v]].parents=this._model.data[n.children_d[v]].parents.slice(0,-1*S),Array.prototype.push.apply(this._model.data[n.children_d[v]].parents,y);(h===t.jstree.root||p.id===t.jstree.root)&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(p.id)),a||this.redraw()}return r&&r.call(this,n,p,o),this.trigger("move_node",{node:n,parent:p.id,position:o,old_parent:h,old_position:u,is_multi:g&&g._id&&g._id!==this._id,is_foreign:!g||!g._id,old_instance:g,new_instance:this}),n.id},copy_node:function(n,i,o,r,s,a,l){var d,c,h,u,p,g,m,f,y,v,j;if(i=this.get_node(i),o=o===e?0:o,!i)return!1;if(!o.toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(n,i,o,r,!0,!1,l)});if(t.isArray(n)){if(1!==n.length){for(d=0,c=n.length;c>d;d++)(u=this.copy_node(n[d],i,o,r,s,!0,l))&&(i=u,o="after");return this.redraw(),!0}n=n[0]}if(n=n&&n.id?n:this.get_node(n),!n||n.id===t.jstree.root)return!1;switch(f=(n.parent||t.jstree.root).toString(),y=o.toString().match(/^(before|after)$/)&&i.id!==t.jstree.root?this.get_node(i.parent):i,v=l?l:this._model.data[n.id]?this:t.jstree.reference(n.id),j=!v||!v._id||this._id!==v._id,v&&v._id&&(n=v._model.data[n.id]),i.id===t.jstree.root&&("before"===o&&(o="first"),"after"===o&&(o="last")),o){case"before":o=t.inArray(i.id,y.children);break;case"after":o=t.inArray(i.id,y.children)+1;break;case"inside":case"first":o=0;break;case"last":o=y.children.length;break;default:o||(o=0)}if(o>y.children.length&&(o=y.children.length),!this.check("copy_node",n,y,o,{core:!0,origin:l,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(m=v?v.get_json(n,{no_id:!0,no_data:!0,no_state:!0}):n,!m)return!1;if(m.id===!0&&delete m.id,m=this._parse_model_from_json(m,y.id,y.parents.concat()),!m)return!1;for(u=this.get_node(m),n&&n.state&&n.state.loaded===!1&&(u.state.loaded=!1),h=[],h.push(m),h=h.concat(u.children_d),this.trigger("model",{nodes:h,parent:y.id}),p=0,g=y.parents.length;g>p;p++)this._model.data[y.parents[p]].children_d=this._model.data[y.parents[p]].children_d.concat(h);for(h=[],p=0,g=y.children.length;g>p;p++)h[p>=o?p+1:p]=y.children[p];return h[o]=u.id,y.children=h,y.children_d.push(u.id),y.children_d=y.children_d.concat(u.children_d),y.id===t.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(y.id),a||this.redraw(y.id===t.jstree.root),r&&r.call(this,u,y,o),this.trigger("copy_node",{node:u,original:n,parent:y.id,position:o,old_parent:f,old_position:v&&v._id&&f&&v._model.data[f]&&v._model.data[f].children?t.inArray(n.id,v._model.data[f].children):-1,is_multi:v&&v._id&&v._id!==this._id,is_foreign:!v||!v._id,old_instance:v,new_instance:this}),u.id},cut:function(e){if(e||(e=this._data.core.selected.concat()),t.isArray(e)||(e=[e]),!e.length)return!1;var n,s,a,l=[];for(s=0,a=e.length;a>s;s++)n=this.get_node(e[s]),n&&n.id&&n.id!==t.jstree.root&&l.push(n);return!!l.length&&(i=l,r=this,o="move_node",void this.trigger("cut",{node:e}))},copy:function(e){if(e||(e=this._data.core.selected.concat()),t.isArray(e)||(e=[e]),!e.length)return!1;var n,s,a,l=[];for(s=0,a=e.length;a>s;s++)n=this.get_node(e[s]),n&&n.id&&n.id!==t.jstree.root&&l.push(n);return!!l.length&&(i=l,r=this,o="copy_node",void this.trigger("copy",{node:e}))},get_buffer:function(){return{mode:o,node:i,inst:r}},can_paste:function(){return o!==!1&&i!==!1},paste:function(t,e){return t=this.get_node(t),!!(t&&o&&o.match(/^(copy_node|move_node)$/)&&i)&&(this[o](i,t,e,!1,!1,!1,r)&&this.trigger("paste",{parent:t.id,node:i,mode:o}),i=!1,o=!1,void(r=!1))},clear_buffer:function(){i=!1,o=!1,r=!1,this.trigger("clear_buffer")},edit:function(e,n,i){var o,r,s,a,d,c,h,u,p,g=!1;return!!(e=this.get_node(e))&&(this.check("edit",e,this.get_parent(e))?(p=e,n="string"==typeof n?n:e.text,this.set_text(e,""),e=this._open_to(e),p.text=n,o=this._data.core.rtl,r=this.element.width(),this._data.core.focused=p.id,s=e.children(".jstree-anchor").focus(),a=t("<span>"),d=n,c=t("<div />",{css:{position:"absolute",top:"-200px",left:o?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),h=t("<input />",{value:d,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:t.proxy(function(n){n.stopImmediatePropagation(),n.preventDefault();var o,r=a.children(".jstree-rename-input"),l=r.val(),u=this.settings.core.force_text;""===l&&(l=d),c.remove(),a.replaceWith(s),a.remove(),d=u?d:t("<div></div>").append(t.parseHTML(d)).html(),this.set_text(e,d),o=!!this.rename_node(e,u?t("<div></div>").text(l).text():t("<div></div>").append(t.parseHTML(l)).html()),o||this.set_text(e,d),this._data.core.focused=p.id,setTimeout(t.proxy(function(){var t=this.get_node(p.id,!0);t.length&&(this._data.core.focused=p.id,t.children(".jstree-anchor").focus())},this),0),i&&i.call(this,p,o,g),h=null},this),keydown:function(t){var e=t.which;27===e&&(g=!0,this.value=d),(27===e||13===e||37===e||38===e||39===e||40===e||32===e)&&t.stopImmediatePropagation(),(27===e||13===e)&&(t.preventDefault(),this.blur())},click:function(t){t.stopImmediatePropagation()},mousedown:function(t){t.stopImmediatePropagation()},keyup:function(t){h.width(Math.min(c.text("pW"+this.value).width(),r))},keypress:function(t){return 13!==t.which&&void 0}}),u={fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||""},a.attr("class",s.attr("class")).append(s.contents().clone()).append(h),s.replaceWith(a),c.css(u),h.css(u).width(Math.min(c.text("pW"+h[0].value).width(),r))[0].select(),void t(l).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(e){h&&e.target!==h&&t(h).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(e,n){
if(!e)return!1;if(n===!0){var i=this.settings.core.themes.dir;i||(i=t.jstree.path+"/themes"),n=i+"/"+e+"/style.css"}n&&-1===t.inArray(n,s)&&(t("head").append('<link rel="stylesheet" href="'+n+'" type="text/css" />'),s.push(n)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=e,this.element.addClass("jstree-"+e),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive"),this.trigger("set_theme",{theme:e})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(t){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=t,t&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(n,i){var o,r,s,a;if(t.isArray(n)){for(n=n.slice(),o=0,r=n.length;r>o;o++)this.set_icon(n[o],i);return!0}return n=this.get_node(n),!(!n||n.id===t.jstree.root)&&(a=n.icon,n.icon=i===!0||null===i||i===e||""===i||i,s=this.get_node(n,!0).children(".jstree-anchor").children(".jstree-themeicon"),i===!1?(s.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"),this.hide_icon(n)):i===!0||null===i||i===e||""===i?(s.removeClass("jstree-themeicon-custom "+a).css("background","").removeAttr("rel"),a===!1&&this.show_icon(n)):-1===i.indexOf("/")&&-1===i.indexOf(".")?(s.removeClass(a).css("background",""),s.addClass(i+" jstree-themeicon-custom").attr("rel",i),a===!1&&this.show_icon(n)):(s.removeClass(a).css("background",""),s.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i),a===!1&&this.show_icon(n)),!0)},get_icon:function(e){return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&e.icon},hide_icon:function(e){var n,i;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.hide_icon(e[n]);return!0}return e=this.get_node(e),!(!e||e===t.jstree.root)&&(e.icon=!1,this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(e){var n,i,o;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.show_icon(e[n]);return!0}return e=this.get_node(e),!(!e||e===t.jstree.root)&&(o=this.get_node(e,!0),e.icon=!o.length||o.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),e.icon||(e.icon=!0),o.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},t.vakata={},t.vakata.attributes=function(e,n){e=t(e)[0];var i=n?{}:[];return e&&e.attributes&&t.each(e.attributes,function(e,o){-1===t.inArray(o.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==o.value&&""!==t.trim(o.value)&&(n?i[o.name]=o.value:i.push(o.name))}),i},t.vakata.array_unique=function(t){var n,i,o=[],r={};for(n=0,i=t.length;i>n;n++)r[t[n]]===e&&(o.push(t[n]),r[t[n]]=!0);return o},t.vakata.array_remove=function(t,e){return t.splice(e,1),t},t.vakata.array_remove_item=function(e,n){var i=t.inArray(n,e);return-1!==i?t.vakata.array_remove(e,i):e},t.vakata.array_filter=function(t,e,n,i,o){if(t.filter)return t.filter(e,n);i=[];for(o in t)~~o+""==o+""&&o>=0&&e.call(n,t[o],+o,t)&&i.push(t[o]);return i},t.jstree.plugins.changed=function(t,e){var n=[];this.trigger=function(t,i){var o,r;if(i||(i={}),"changed"===t.replace(".jstree","")){i.changed={selected:[],deselected:[]};var s={};for(o=0,r=n.length;r>o;o++)s[n[o]]=1;for(o=0,r=i.selected.length;r>o;o++)s[i.selected[o]]?s[i.selected[o]]=2:i.changed.selected.push(i.selected[o]);for(o=0,r=n.length;r>o;o++)1===s[n[o]]&&i.changed.deselected.push(n[o]);n=i.selected.slice()}e.trigger.call(this,t,i)},this.refresh=function(t,i){return n=[],e.refresh.apply(this,arguments)}};var d=l.createElement("I");d.className="jstree-icon jstree-checkbox",d.setAttribute("role","presentation"),t.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},t.jstree.plugins.checkbox=function(n,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",t.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",t.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",t.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(t.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",t.proxy(function(t,e){var n,i,o=this._model.data,r=(o[e.parent],e.nodes);for(n=0,i=r.length;i>n;n++)o[r[n]].state.checked=o[r[n]].state.checked||o[r[n]].original&&o[r[n]].original.state&&o[r[n]].original.state.checked,o[r[n]].state.checked&&this._data.checkbox.selected.push(r[n])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",t.proxy(function(e,n){var i,o,r,s,a,l,d=this._model.data,c=d[n.parent],h=n.nodes,u=[],p=this.settings.checkbox.cascade,g=this.settings.checkbox.tie_selection;if(-1!==p.indexOf("down"))if(c.state[g?"selected":"checked"]){for(o=0,r=h.length;r>o;o++)d[h[o]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(h)}else for(o=0,r=h.length;r>o;o++)if(d[h[o]].state[g?"selected":"checked"]){for(s=0,a=d[h[o]].children_d.length;a>s;s++)d[d[h[o]].children_d[s]].state[g?"selected":"checked"]=!0;this._data[g?"core":"checkbox"].selected=this._data[g?"core":"checkbox"].selected.concat(d[h[o]].children_d)}if(-1!==p.indexOf("up")){for(o=0,r=c.children_d.length;r>o;o++)d[c.children_d[o]].children.length||u.push(d[c.children_d[o]].parent);for(u=t.vakata.array_unique(u),s=0,a=u.length;a>s;s++)for(c=d[u[s]];c&&c.id!==t.jstree.root;){for(i=0,o=0,r=c.children.length;r>o;o++)i+=d[c.children[o]].state[g?"selected":"checked"];if(i!==r)break;c.state[g?"selected":"checked"]=!0,this._data[g?"core":"checkbox"].selected.push(c.id),l=this.get_node(c,!0),l&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(g?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[g?"core":"checkbox"].selected=t.vakata.array_unique(this._data[g?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",t.proxy(function(e,n){var i,o,r,s,a=n.node,l=this._model.data,d=this.get_node(a.parent),c=this.settings.checkbox.cascade,h=this.settings.checkbox.tie_selection,u={},p=this._data[h?"core":"checkbox"].selected;for(i=0,o=p.length;o>i;i++)u[p[i]]=!0;if(-1!==c.indexOf("down")){var g=this._cascade_new_checked_state(a.id,!0),m=a.children_d.concat(a.id);for(i=0,o=m.length;o>i;i++)g.indexOf(m[i])>-1?u[m[i]]=!0:delete u[m[i]]}if(-1!==c.indexOf("up"))for(;d&&d.id!==t.jstree.root;){for(r=0,i=0,o=d.children.length;o>i;i++)r+=l[d.children[i]].state[h?"selected":"checked"];if(r!==o)break;d.state[h?"selected":"checked"]=!0,u[d.id]=!0,s=this.get_node(d,!0),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(h?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}p=[];for(i in u)u.hasOwnProperty(i)&&p.push(i);this._data[h?"core":"checkbox"].selected=p},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",t.proxy(function(e,n){var i,o,r,s=this.get_node(t.jstree.root),a=this._model.data;for(i=0,o=s.children_d.length;o>i;i++)r=a[s.children_d[i]],r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",t.proxy(function(t,e){var n,i,o,r=e.node,s=(this.get_node(r,!0),this.settings.checkbox.cascade),a=this.settings.checkbox.tie_selection,l=this._data[a?"core":"checkbox"].selected,d=r.children_d.concat(r.id);if(-1!==s.indexOf("down")){var c=this._cascade_new_checked_state(r.id,!1);l=l.filter(function(t){return-1===d.indexOf(t)||c.indexOf(t)>-1})}if(-1!==s.indexOf("up")&&-1===l.indexOf(r.id)){for(n=0,i=r.parents.length;i>n;n++)o=this._model.data[r.parents[n]],o.state[a?"selected":"checked"]=!1,o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1),o=this.get_node(r.parents[n],!0),o&&o.length&&o.attr("aria-selected",!1).children(".jstree-anchor").removeClass(a?"jstree-clicked":"jstree-checked");l=l.filter(function(t){return-1===r.parents.indexOf(t)})}this._data[a?"core":"checkbox"].selected=l},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",t.proxy(function(e,n){for(var i,o,r,s,a=this.get_node(n.parent),l=this._model.data,d=this.settings.checkbox.tie_selection;a&&a.id!==t.jstree.root&&!a.state[d?"selected":"checked"];){for(r=0,i=0,o=a.children.length;o>i;i++)r+=l[a.children[i]].state[d?"selected":"checked"];if(!(o>0&&r===o))break;a.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(a.id),s=this.get_node(a,!0),s&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),a=this.get_node(a.parent)}},this)).on("move_node.jstree",t.proxy(function(e,n){var i,o,r,s,a,l=n.is_multi,d=n.old_parent,c=this.get_node(n.parent),h=this._model.data,u=this.settings.checkbox.tie_selection;if(!l)for(i=this.get_node(d);i&&i.id!==t.jstree.root&&!i.state[u?"selected":"checked"];){for(o=0,r=0,s=i.children.length;s>r;r++)o+=h[i.children[r]].state[u?"selected":"checked"];if(!(s>0&&o===s))break;i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),a=this.get_node(i,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=c;i&&i.id!==t.jstree.root;){for(o=0,r=0,s=i.children.length;s>r;r++)o+=h[i.children[r]].state[u?"selected":"checked"];if(o===s)i.state[u?"selected":"checked"]||(i.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(i.id),a=this.get_node(i,!0),a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!i.state[u?"selected":"checked"])break;i.state[u?"selected":"checked"]=!1,this._data[u?"core":"checkbox"].selected=t.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,i.id),a=this.get_node(i,!0),a&&a.length&&a.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}},this))},this.get_undetermined=function(n){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];var i,o,r,s,a={},l=this._model.data,d=this.settings.checkbox.tie_selection,c=this._data[d?"core":"checkbox"].selected,h=[],u=this,p=[];for(i=0,o=c.length;o>i;i++)if(l[c[i]]&&l[c[i]].parents)for(r=0,s=l[c[i]].parents.length;s>r&&a[l[c[i]].parents[r]]===e;r++)l[c[i]].parents[r]!==t.jstree.root&&(a[l[c[i]].parents[r]]=!0,h.push(l[c[i]].parents[r]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var n,d=u.get_node(this);if(d)if(d.state.loaded){for(i=0,o=d.children_d.length;o>i;i++)if(n=l[d.children_d[i]],!n.state.loaded&&n.original&&n.original.state&&n.original.state.undetermined&&n.original.state.undetermined===!0)for(a[n.id]===e&&n.id!==t.jstree.root&&(a[n.id]=!0,h.push(n.id)),r=0,s=n.parents.length;s>r;r++)a[n.parents[r]]===e&&n.parents[r]!==t.jstree.root&&(a[n.parents[r]]=!0,h.push(n.parents[r]))}else if(d.original&&d.original.state&&d.original.state.undetermined&&d.original.state.undetermined===!0)for(a[d.id]===e&&d.id!==t.jstree.root&&(a[d.id]=!0,h.push(d.id)),r=0,s=d.parents.length;s>r;r++)a[d.parents[r]]===e&&d.parents[r]!==t.jstree.root&&(a[d.parents[r]]=!0,h.push(d.parents[r]))}),i=0,o=h.length;o>i;i++)l[h[i]].state[d?"selected":"checked"]||p.push(n?l[h[i]]:h[i]);return p},this._undetermined=function(){if(null!==this.element){var t,e,n,i=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),t=0,e=i.length;e>t;t++)n=this.get_node(i[t],!0),n&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(e,n,o,r){if(e=i.redraw_node.apply(this,arguments)){var s,a,l=null,c=null;for(s=0,a=e.childNodes.length;a>s;s++)if(e.childNodes[s]&&e.childNodes[s].className&&-1!==e.childNodes[s].className.indexOf("jstree-anchor")){l=e.childNodes[s];break}l&&(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked&&(l.className+=" jstree-checked"),c=d.cloneNode(!1),this._model.data[e.id].state.checkbox_disabled&&(c.className+=" jstree-checkbox-disabled"),l.insertBefore(c,l.childNodes[0]))}return o||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(t.proxy(this._undetermined,this),50)),e},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(e){e=this.get_node(e);var n,i,o=this.settings.checkbox.cascade,r=this.settings.checkbox.tie_selection,s=this._data[r?"core":"checkbox"].selected,a=this._model.data;if(!e||e.state[r?"selected":"checked"]===!0||-1===o.indexOf("undetermined")||-1===o.indexOf("down")&&-1===o.indexOf("up"))return!1;if(!e.state.loaded&&e.original.state.undetermined===!0)return!0;for(n=0,i=e.children_d.length;i>n;n++)if(-1!==t.inArray(e.children_d[n],s)||!a[e.children_d[n]].state.loaded&&a[e.children_d[n]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(e){var n,i,o;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.disable_checkbox(e[n]);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(o=this.get_node(e,!0),void(e.state.checkbox_disabled||(e.state.checkbox_disabled=!0,o&&o.length&&o.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:e}))))},this.enable_checkbox=function(e){var n,i,o;if(t.isArray(e)){for(e=e.slice(),n=0,i=e.length;i>n;n++)this.enable_checkbox(e[n]);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(o=this.get_node(e,!0),void(e.state.checkbox_disabled&&(e.state.checkbox_disabled=!1,o&&o.length&&o.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:e}))))},this.activate_node=function(e,n){return!t(n.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||t(n.target).hasClass("jstree-checkbox"))&&(n.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!t(n.target).hasClass("jstree-checkbox")?i.activate_node.call(this,e,n):!this.is_disabled(e)&&(this.is_checked(e)?this.uncheck_node(e,n):this.check_node(e,n),void this.trigger("activate_node",{node:this.get_node(e)})))},this._cascade_new_checked_state=function(t,e){var n,i,o,r=this,s=this.settings.checkbox.tie_selection,a=this._model.data[t],l=[],d=[];if(!this.settings.checkbox.cascade_to_disabled&&a.state.disabled||!this.settings.checkbox.cascade_to_hidden&&a.state.hidden)o=this.get_checked_descendants(t),a.state[s?"selected":"checked"]&&o.push(a.id),l=l.concat(o);else{if(a.children)for(n=0,i=a.children.length;i>n;n++){var c=a.children[n];o=r._cascade_new_checked_state(c,e),l=l.concat(o),o.indexOf(c)>-1&&d.push(c)}var h=r.get_node(a,!0),u=d.length>0&&d.length<a.children.length;a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=u),u?(a.state[s?"selected":"checked"]=!1,h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(s?"jstree-clicked":"jstree-checked")):e&&d.length===a.children.length?(a.state[s?"selected":"checked"]=e,l.push(a.id),h.attr("aria-selected",!0).children(".jstree-anchor").addClass(s?"jstree-clicked":"jstree-checked")):(a.state[s?"selected":"checked"]=!1,h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(s?"jstree-clicked":"jstree-checked"))}return l},this.get_checked_descendants=function(t){var e=this,n=e.settings.checkbox.tie_selection,i=e._model.data[t];return i.children_d.filter(function(t){return e._model.data[t].state[n?"selected":"checked"]})},this.check_node=function(e,n){if(this.settings.checkbox.tie_selection)return this.select_node(e,!1,!0,n);var i,o,r;if(t.isArray(e)){for(e=e.slice(),o=0,r=e.length;r>o;o++)this.check_node(e[o],n);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(i=this.get_node(e,!0),void(e.state.checked||(e.state.checked=!0,this._data.checkbox.selected.push(e.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:e,selected:this._data.checkbox.selected,event:n}))))},this.uncheck_node=function(e,n){if(this.settings.checkbox.tie_selection)return this.deselect_node(e,!1,n);var i,o,r;if(t.isArray(e)){for(e=e.slice(),i=0,o=e.length;o>i;i++)this.uncheck_node(e[i],n);return!0}return e=this.get_node(e),!(!e||e.id===t.jstree.root)&&(r=this.get_node(e,!0),void(e.state.checked&&(e.state.checked=!1,this._data.checkbox.selected=t.vakata.array_remove_item(this._data.checkbox.selected,e.id),r.length&&r.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:e,selected:this._data.checkbox.selected,event:n}))))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var e,n;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[t.jstree.root].children_d.concat(),e=0,n=this._data.checkbox.selected.length;n>e;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var t,e,n=this._data.checkbox.selected.concat([]);for(t=0,e=this._data.checkbox.selected.length;e>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:n})},this.is_checked=function(e){return this.settings.checkbox.tie_selection?this.is_selected(e):(e=this.get_node(e),!(!e||e.id===t.jstree.root)&&e.state.checked)},this.get_checked=function(e){return this.settings.checkbox.tie_selection?this.get_selected(e):e?t.map(this._data.checkbox.selected,t.proxy(function(t){return this.get_node(t)},this)):this._data.checkbox.selected},this.get_top_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_top_selected(e);var n,i,o,r,s=this.get_checked(!0),a={};for(n=0,i=s.length;i>n;n++)a[s[n].id]=s[n];for(n=0,i=s.length;i>n;n++)for(o=0,r=s[n].children_d.length;r>o;o++)a[s[n].children_d[o]]&&delete a[s[n].children_d[o]];s=[];for(n in a)a.hasOwnProperty(n)&&s.push(n);return e?t.map(s,t.proxy(function(t){return this.get_node(t)},this)):s},this.get_bottom_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(e);var n,i,o=this.get_checked(!0),r=[];for(n=0,i=o.length;i>n;n++)o[n].children.length||r.push(o[n].id);return e?t.map(r,t.proxy(function(t){return this.get_node(t)},this)):r},this.load_node=function(e,n){var o,r,s,a;if(!t.isArray(e)&&!this.settings.checkbox.tie_selection&&(a=this.get_node(e),a&&a.state.loaded))for(o=0,r=a.children_d.length;r>o;o++)this._model.data[a.children_d[o]].state.checked&&(s=!0,this._data.checkbox.selected=t.vakata.array_remove_item(this._data.checkbox.selected,a.children_d[o]));return i.load_node.apply(this,arguments)},this.get_state=function(){var t=i.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?t:(t.checkbox=this._data.checkbox.selected.slice(),t)},this.set_state=function(e,n){var o=i.set_state.apply(this,arguments);if(o&&e.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var r=this;t.each(e.checkbox,function(t,e){r.check_node(e)})}return delete e.checkbox,this.set_state(e,n),!1}return o},this.refresh=function(t,e){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),i.refresh.apply(this,arguments)}},t.jstree.defaults.conditionalselect=function(){return!0},t.jstree.plugins.conditionalselect=function(t,e){this.activate_node=function(t,n){return this.settings.conditionalselect.call(this,this.get_node(t),n)?e.activate_node.call(this,t,n):void 0}},t.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(e,n){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(e){var n=t.jstree.reference(e.reference),i=n.get_node(e.reference);n.create_node(i,{},"last",function(t){try{n.edit(t)}catch(e){setTimeout(function(){n.edit(t)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(e){var n=t.jstree.reference(e.reference),i=n.get_node(e.reference);n.edit(i)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(e){var n=t.jstree.reference(e.reference),i=n.get_node(e.reference);n.is_selected(i)?n.delete_node(n.get_selected()):n.delete_node(i)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){var n=t.jstree.reference(e.reference),i=n.get_node(e.reference);n.is_selected(i)?n.cut(n.get_top_selected()):n.cut(i)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){var n=t.jstree.reference(e.reference),i=n.get_node(e.reference);n.is_selected(i)?n.copy(n.get_top_selected()):n.copy(i)}},paste:{separator_before:!1,icon:!1,_disabled:function(e){return!t.jstree.reference(e.reference).can_paste()},separator_after:!1,label:"Paste",action:function(e){var n=t.jstree.reference(e.reference),i=n.get_node(e.reference);n.paste(i)}}}}}}},t.jstree.plugins.contextmenu=function(n,i){this.bind=function(){i.bind.call(this);var e,n,o=0,r=null;this.element.on("init.jstree loading.jstree ready.jstree",t.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",t.proxy(function(t,e){"input"!==t.target.tagName.toLowerCase()&&(t.preventDefault(),o=t.ctrlKey?+new Date:0,(e||r)&&(o=+new Date+1e4),r&&clearTimeout(r),this.is_loading(t.currentTarget)||this.show_contextmenu(t.currentTarget,t.pageX,t.pageY,t))},this)).on("click.jstree",".jstree-anchor",t.proxy(function(e){this._data.contextmenu.visible&&(!o||+new Date-o>250)&&t.vakata.context.hide(),o=0},this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(e=i.originalEvent.changedTouches[0].clientX,n=i.originalEvent.changedTouches[0].clientY,r=setTimeout(function(){t(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(i){r&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(Math.abs(e-i.originalEvent.changedTouches[0].clientX)>10||Math.abs(n-i.originalEvent.changedTouches[0].clientY)>10)&&(clearTimeout(r),t.vakata.context.hide())}).on("touchend.vakata.jstree",function(t){r&&clearTimeout(r)}),t(l).on("context_hide.vakata.jstree",t.proxy(function(e,n){this._data.contextmenu.visible=!1,t(n.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&t.vakata.context.hide(),i.teardown.call(this)},this.show_contextmenu=function(n,i,o,r){if(n=this.get_node(n),!n||n.id===t.jstree.root)return!1;var s=this.settings.contextmenu,a=this.get_node(n,!0),l=a.children(".jstree-anchor"),d=!1,c=!1;(s.show_at_node||i===e||o===e)&&(d=l.offset(),i=d.left,o=d.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(n)&&this.activate_node(n,r),c=s.items,t.isFunction(c)&&(c=c.call(this,n,t.proxy(function(t){this._show_contextmenu(n,i,o,t)},this))),t.isPlainObject(c)&&this._show_contextmenu(n,i,o,c)},this._show_contextmenu=function(e,n,i,o){var r=this.get_node(e,!0),s=r.children(".jstree-anchor");t(l).one("context_show.vakata.jstree",t.proxy(function(e,n){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";t(n.element).addClass(i),s.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,t.vakata.context.show(s,{x:n,y:i},o),this.trigger("show_contextmenu",{node:e,x:n,y:i})}},function(t){var e=!1,n={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};t.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(e){t(l).triggerHandler("context_"+e+".vakata",{reference:n.reference,element:n.element,position:{x:n.position_x,y:n.position_y}})},_execute:function(e){return e=n.items[e],!(!e||e._disabled&&(!t.isFunction(e._disabled)||e._disabled({item:e,reference:n.reference,element:n.element}))||!e.action)&&e.action.call(null,{item:e,reference:n.reference,element:n.element,position:{x:n.position_x,y:n.position_y}})},_parse:function(e,i){if(!e)return!1;i||(n.html="",n.items=[]);var o,r="",s=!1;return i&&(r+="<ul>"),t.each(e,function(e,i){return!i||(n.items.push(i),!s&&i.separator_before&&(r+="<li class='vakata-context-separator'><a href='#' "+(t.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),s=!1,r+="<li class='"+(i._class||"")+(i._disabled===!0||t.isFunction(i._disabled)&&i._disabled({item:i,reference:n.reference,element:n.element})?" vakata-contextmenu-disabled ":"")+"' "+(i.shortcut?" data-shortcut='"+i.shortcut+"' ":"")+">",r+="<a href='#' rel='"+(n.items.length-1)+"' "+(i.title?"title='"+i.title+"'":"")+">",t.vakata.context.settings.icons&&(r+="<i ",i.icon&&(r+=-1!==i.icon.indexOf("/")||-1!==i.icon.indexOf(".")?" style='background:url(\""+i.icon+"\") center center no-repeat' ":" class='"+i.icon+"' "),r+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),r+=(t.isFunction(i.label)?i.label({item:e,reference:n.reference,element:n.element}):i.label)+(i.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+i.shortcut+'">'+(i.shortcut_label||"")+"</span>":"")+"</a>",i.submenu&&(o=t.vakata.context._parse(i.submenu,!0),o&&(r+=o)),r+="</li>",void(i.separator_after&&(r+="<li class='vakata-context-separator'><a href='#' "+(t.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",s=!0)))}),r=r.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),i&&(r+="</ul>"),i||(n.html=r,t.vakata.context._trigger("parse")),r.length>10&&r},_show_submenu:function(n){if(n=t(n),n.length&&n.children("ul").length){var i=n.children("ul"),o=n.offset().left,r=o+n.outerWidth(),s=n.offset().top,a=i.width(),l=i.height(),d=t(window).width()+t(window).scrollLeft(),c=t(window).height()+t(window).scrollTop();e?n[r-(a+10+n.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):n[r+a>d&&o>d-r?"addClass":"removeClass"]("vakata-context-right"),s+l+10>c&&i.css("bottom","-1px"),n.hasClass("vakata-context-right")?a>o&&i.css("margin-right",o-a):a>d-r&&i.css("margin-left",d-r-a),i.show()}},show:function(i,o,r){var s,a,l,d,c,h,u,p,g=!0;switch(n.element&&n.element.length&&n.element.width(""),g){case!o&&!i:return!1;case!!o&&!!i:n.reference=i,n.position_x=o.x,n.position_y=o.y;break;case!o&&!!i:n.reference=i,s=i.offset(),n.position_x=s.left+i.outerHeight(),n.position_y=s.top;break;case!!o&&!i:n.position_x=o.x,n.position_y=o.y}i&&!r&&t(i).data("vakata_contextmenu")&&(r=t(i).data("vakata_contextmenu")),t.vakata.context._parse(r)&&n.element.html(n.html),n.items.length&&(n.element.appendTo("body"),a=n.element,l=n.position_x,d=n.position_y,c=a.width(),h=a.height(),u=t(window).width()+t(window).scrollLeft(),p=t(window).height()+t(window).scrollTop(),e&&(l-=a.outerWidth()-t(i).outerWidth(),l<t(window).scrollLeft()+20&&(l=t(window).scrollLeft()+20)),l+c+20>u&&(l=u-(c+20)),d+h+20>p&&(d=p-(h+20)),n.element.css({left:l,top:d}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),n.is_visible=!0,t.vakata.context._trigger("show"))},hide:function(){n.is_visible&&(n.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),n.is_visible=!1,t.vakata.context._trigger("hide"))}},t(function(){e="rtl"===t("body").css("direction");var i=!1;n.element=t("<ul class='vakata-context'></ul>"),n.element.on("mouseenter","li",function(e){e.stopImmediatePropagation(),t.contains(this,e.relatedTarget)||(i&&clearTimeout(i),n.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),t(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),t.vakata.context._show_submenu(this))}).on("mouseleave","li",function(e){t.contains(this,e.relatedTarget)||t(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(e){t(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),t.vakata.context.settings.hide_onmouseleave&&(i=setTimeout(function(e){return function(){t.vakata.context.hide()}}(this),t.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(e){e.preventDefault(),t(this).blur().parent().hasClass("vakata-context-disabled")||t.vakata.context._execute(t(this).attr("rel"))===!1||t.vakata.context.hide();
}).on("keydown","a",function(e){var i=null;switch(e.which){case 13:case 32:e.type="click",e.preventDefault(),t(e.currentTarget).trigger(e);break;case 37:n.is_visible&&(n.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 38:n.is_visible&&(i=n.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),i.length||(i=n.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),i.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 39:n.is_visible&&(n.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 40:n.is_visible&&(i=n.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),i.length||(i=n.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),i.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 27:t.vakata.context.hide(),e.preventDefault()}}).on("keydown",function(t){t.preventDefault();var e=n.element.find(".vakata-contextmenu-shortcut-"+t.which).parent();e.parent().not(".vakata-context-disabled")&&e.click()}),t(l).on("mousedown.vakata.jstree",function(e){n.is_visible&&n.element[0]!==e.target&&!t.contains(n.element[0],e.target)&&t.vakata.context.hide()}).on("context_show.vakata.jstree",function(t,i){n.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),e&&n.element.addClass("vakata-context-rtl").css("direction","rtl"),n.element.find("ul").hide().end()})})}(t),t.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var c,h;t.jstree.plugins.dnd=function(e,n){this.init=function(t,e){n.init.call(this,t,e),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in l.createElement("span")},this.bind=function(){n.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",t.proxy(function(e){if(this.settings.dnd.large_drag_target&&t(e.target).closest(".jstree-node")[0]!==e.currentTarget)return!0;if("touchstart"===e.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!t(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var n=this.get_node(e.target),i=this.is_selected(n)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,o=i>1?i+" "+this.get_string("nodes"):this.get_text(e.currentTarget);if(this.settings.core.force_text&&(o=t.vakata.html.escape(o)),n&&n.id&&n.id!==t.jstree.root&&(1===e.which||"touchstart"===e.type||"dragstart"===e.type)&&(this.settings.dnd.is_draggable===!0||t.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_top_selected(!0):[n],e))){if(c={jstree:!0,origin:this,obj:this.get_node(n,!0),nodes:i>1?this.get_top_selected():[n.id]},h=e.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),t.vakata.dnd.start(e,c,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+o+'<ins class="jstree-copy" style="display:none;">+</ins></div>');t.vakata.dnd._trigger("start",e,{helper:t(),element:h,data:c})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(e){return e.preventDefault(),t.vakata.dnd._trigger("move",e,{helper:t(),element:h,data:c}),!1}).on("drop.jstree",t.proxy(function(e){return e.preventDefault(),t.vakata.dnd._trigger("stop",e,{helper:t(),element:h,data:c}),!1},this))},this.redraw_node=function(t,e,i,o){if(t=n.redraw_node.apply(this,arguments),t&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)t.setAttribute("draggable",!0);else{var r,s,a=null;for(r=0,s=t.childNodes.length;s>r;r++)if(t.childNodes[r]&&t.childNodes[r].className&&-1!==t.childNodes[r].className.indexOf("jstree-anchor")){a=t.childNodes[r];break}a&&a.setAttribute("draggable",!0)}return t}},t(function(){var n=!1,i=!1,o=!1,r=!1,s=t('<div id="jstree-marker">&#160;</div>').hide();t(l).on("dnd_start.vakata.jstree",function(t,e){n=!1,o=!1,e&&e.data&&e.data.jstree&&s.appendTo("body")}).on("dnd_move.vakata.jstree",function(a,l){var d=l.event.target!==o.target;if(r&&(!l.event||"dragover"!==l.event.type||d)&&clearTimeout(r),l&&l.data&&l.data.jstree&&(!l.event.target.id||"jstree-marker"!==l.event.target.id)){o=l.event;var c,h,u,p,g,m,f,y,v,j,x,_,S,b,E,C,I=t.jstree.reference(l.event.target),w=!1,L=!1,P=!1;if(I&&I._data&&I._data.dnd)if(s.attr("class","jstree-"+I.get_theme()+(I.settings.core.themes.responsive?" jstree-dnd-responsive":"")),E=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey)),l.helper.children().attr("class","jstree-"+I.get_theme()+" jstree-"+I.get_theme()+"-"+I.get_theme_variant()+" "+(I.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[E?"show":"hide"](),l.event.target!==I.element[0]&&l.event.target!==I.get_container_ul()[0]||0!==I.get_container_ul().children().length){if(w=I.settings.dnd.large_drop_target?t(l.event.target).closest(".jstree-node").children(".jstree-anchor"):t(l.event.target).closest(".jstree-anchor"),w&&w.length&&w.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(L=w.offset(),P=(l.event.pageY!==e?l.event.pageY:l.event.originalEvent.pageY)-L.top,u=w.outerHeight(),m=u/3>P?["b","i","a"]:P>u-u/3?["a","i","b"]:P>u/2?["i","a","b"]:["i","b","a"],t.each(m,function(e,o){switch(o){case"b":c=L.left-6,h=L.top,p=I.get_parent(w),g=w.parent().index();break;case"i":S=I.settings.dnd.inside_pos,b=I.get_node(w.parent()),c=L.left-2,h=L.top+u/2+1,p=b.id,g="first"===S?0:"last"===S?b.children.length:Math.min(S,b.children.length);break;case"a":c=L.left-6,h=L.top+u,p=I.get_parent(w),g=w.parent().index()+1}for(f=!0,y=0,v=l.data.nodes.length;v>y;y++)if(j=l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",x=g,"move_node"===j&&"a"===o&&l.data.origin&&l.data.origin===I&&p===I.get_parent(l.data.nodes[y])&&(_=I.get_node(p),x>t.inArray(l.data.nodes[y],_.children)&&(x-=1)),f=f&&(I&&I.settings&&I.settings.dnd&&I.settings.dnd.check_while_dragging===!1||I.check(j,l.data.origin&&l.data.origin!==I?l.data.origin.get_node(l.data.nodes[y]):l.data.nodes[y],p,x,{dnd:!0,ref:I.get_node(w.parent()),pos:o,origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==I,is_foreign:!l.data.origin})),!f){I&&I.last_error&&(i=I.last_error());break}return"i"===o&&w.parent().is(".jstree-closed")&&I.settings.dnd.open_timeout&&(!l.event||"dragover"!==l.event.type||d)&&(r&&clearTimeout(r),r=setTimeout(function(t,e){return function(){t.open_node(e)}}(I,w),I.settings.dnd.open_timeout)),f?(C=I.get_node(p,!0),C.hasClass(".jstree-dnd-parent")||(t(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),C.addClass("jstree-dnd-parent")),n={ins:I,par:p,pos:"i"!==o||"last"!==S||0!==g||I.is_loaded(b)?g:"last"},s.css({left:c+"px",top:h+"px"}).show(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=E?"copy":"move"),i={},m=!0,!1):void 0}),m===!0))return}else{for(f=!0,y=0,v=l.data.nodes.length;v>y&&(f=f&&I.check(l.data.origin&&(l.data.origin.settings.dnd.always_copy||l.data.origin.settings.dnd.copy&&(l.event.metaKey||l.event.ctrlKey))?"copy_node":"move_node",l.data.origin&&l.data.origin!==I?l.data.origin.get_node(l.data.nodes[y]):l.data.nodes[y],t.jstree.root,"last",{dnd:!0,ref:I.get_node(t.jstree.root),pos:"i",origin:l.data.origin,is_multi:l.data.origin&&l.data.origin!==I,is_foreign:!l.data.origin}),f);y++);if(f)return n={ins:I,par:t.jstree.root,pos:"last"},s.hide(),l.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect=E?"copy":"move"))}t(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),n=!1,l.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),l.event.originalEvent&&l.event.originalEvent.dataTransfer&&(l.event.originalEvent.dataTransfer.dropEffect="none"),s.hide()}}).on("dnd_scroll.vakata.jstree",function(t,e){e&&e.data&&e.data.jstree&&(s.hide(),n=!1,o=!1,e.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(e,a){if(t(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),r&&clearTimeout(r),a&&a.data&&a.data.jstree){s.hide().detach();var l,d,c=[];if(n){for(l=0,d=a.data.nodes.length;d>l;l++)c[l]=a.data.origin?a.data.origin.get_node(a.data.nodes[l]):a.data.nodes[l];n.ins[a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(a.event.metaKey||a.event.ctrlKey))?"copy_node":"move_node"](c,n.par,n.pos,!1,!1,!1,a.data.origin)}else l=t(a.event.target).closest(".jstree"),l.length&&i&&i.error&&"check"===i.error&&(l=l.jstree(!0),l&&l.settings.core.error.call(this,i));o=!1,n=!1}}).on("keyup.jstree keydown.jstree",function(e,a){a=t.vakata.dnd._get(),a&&a.data&&a.data.jstree&&("keyup"===e.type&&27===e.which?(r&&clearTimeout(r),n=!1,i=!1,o=!1,r=!1,s.hide().detach(),t.vakata.dnd._clean()):(a.helper.find(".jstree-copy").first()[a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(e.metaKey||e.ctrlKey))?"show":"hide"](),o&&(o.metaKey=e.metaKey,o.ctrlKey=e.ctrlKey,t.vakata.dnd._trigger("move",o))))})}),function(t){t.vakata.html={div:t("<div />"),escape:function(e){return t.vakata.html.div.text(e).html()},strip:function(e){return t.vakata.html.div.empty().append(t.parseHTML(e)).text()}};var n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};t.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(n,i,o){o===e&&(o=t.vakata.dnd._get()),o.event=i,t(l).triggerHandler("dnd_"+n+".vakata",o)},_get:function(){return{data:n.data,element:n.element,helper:n.helper}},_clean:function(){n.helper&&n.helper.remove(),n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),n={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},t(l).off("mousemove.vakata.jstree touchmove.vakata.jstree",t.vakata.dnd.drag),t(l).off("mouseup.vakata.jstree touchend.vakata.jstree",t.vakata.dnd.stop)},_scroll:function(e){if(!n.scroll_e||!n.scroll_l&&!n.scroll_t)return n.scroll_i&&(clearInterval(n.scroll_i),n.scroll_i=!1),!1;if(!n.scroll_i)return n.scroll_i=setInterval(t.vakata.dnd._scroll,100),!1;if(e===!0)return!1;var i=n.scroll_e.scrollTop(),o=n.scroll_e.scrollLeft();n.scroll_e.scrollTop(i+n.scroll_t*t.vakata.dnd.settings.scroll_speed),n.scroll_e.scrollLeft(o+n.scroll_l*t.vakata.dnd.settings.scroll_speed),(i!==n.scroll_e.scrollTop()||o!==n.scroll_e.scrollLeft())&&t.vakata.dnd._trigger("scroll",n.scroll_e)},start:function(e,i,o){"touchstart"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=l.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag&&t.vakata.dnd.stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.touchAction="none",e.currentTarget.style.msTouchAction="none",e.currentTarget.style.MozUserSelect="none")}catch(t){}return n.init_x=e.pageX,n.init_y=e.pageY,n.data=i,n.is_down=!0,n.element=e.currentTarget,n.target=e.target,n.is_touch="touchstart"===e.type,o!==!1&&(n.helper=t("<div id='vakata-dnd'></div>").html(o).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),t(l).on("mousemove.vakata.jstree touchmove.vakata.jstree",t.vakata.dnd.drag),t(l).on("mouseup.vakata.jstree touchend.vakata.jstree",t.vakata.dnd.stop),!1},drag:function(e){if("touchmove"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=l.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_down){if(!n.is_drag){if(!(Math.abs(e.pageX-n.init_x)>(n.is_touch?t.vakata.dnd.settings.threshold_touch:t.vakata.dnd.settings.threshold)||Math.abs(e.pageY-n.init_y)>(n.is_touch?t.vakata.dnd.settings.threshold_touch:t.vakata.dnd.settings.threshold)))return;n.helper&&(n.helper.appendTo("body"),n.helper_w=n.helper.outerWidth()),n.is_drag=!0,t(n.target).one("click.vakata",!1),t.vakata.dnd._trigger("start",e)}var i=!1,o=!1,r=!1,s=!1,a=!1,d=!1,c=!1,h=!1,u=!1,p=!1;return n.scroll_t=0,n.scroll_l=0,n.scroll_e=!1,t(t(e.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(t(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var i=t(this),o=i.offset();return this.scrollHeight>this.offsetHeight&&(o.top+i.height()-e.pageY<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),e.pageY-o.top<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(o.left+i.width()-e.pageX<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),e.pageX-o.left<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1)),n.scroll_t||n.scroll_l?(n.scroll_e=t(this),!1):void 0}),n.scroll_e||(i=t(l),o=t(window),r=i.height(),s=o.height(),a=i.width(),d=o.width(),c=i.scrollTop(),h=i.scrollLeft(),r>s&&e.pageY-c<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=-1),r>s&&s-(e.pageY-c)<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_t=1),a>d&&e.pageX-h<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=-1),a>d&&d-(e.pageX-h)<t.vakata.dnd.settings.scroll_proximity&&(n.scroll_l=1),(n.scroll_t||n.scroll_l)&&(n.scroll_e=i)),n.scroll_e&&t.vakata.dnd._scroll(!0),n.helper&&(u=parseInt(e.pageY+t.vakata.dnd.settings.helper_top,10),p=parseInt(e.pageX+t.vakata.dnd.settings.helper_left,10),r&&u+25>r&&(u=r-50),a&&p+n.helper_w>a&&(p=a-(n.helper_w+2)),n.helper.css({left:p+"px",top:u+"px"})),t.vakata.dnd._trigger("move",e),!1}},stop:function(e){if("touchend"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=l.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),n.is_drag)e.target!==n.target&&t(n.target).off("click.vakata"),t.vakata.dnd._trigger("stop",e);else if("touchend"===e.type&&e.target===n.target){var i=setTimeout(function(){t(e.target).click()},100);t(e.target).one("click",function(){i&&clearTimeout(i)})}return t.vakata.dnd._clean(),!1}}}(t),t.jstree.defaults.massload=null,t.jstree.plugins.massload=function(e,n){this.init=function(t,e){this._data.massload={},n.init.call(this,t,e)},this._load_nodes=function(e,i,o,r){var s,a,l,d=this.settings.massload,c=(JSON.stringify(e),[]),h=this._model.data;if(!o){for(s=0,a=e.length;a>s;s++)(!h[e[s]]||!h[e[s]].state.loaded&&!h[e[s]].state.failed||r)&&(c.push(e[s]),l=this.get_node(e[s],!0),l&&l.length&&l.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},c.length){if(t.isFunction(d))return d.call(this,c,t.proxy(function(t){var s,a;if(t)for(s in t)t.hasOwnProperty(s)&&(this._data.massload[s]=t[s]);for(s=0,a=e.length;a>s;s++)l=this.get_node(e[s],!0),l&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);n._load_nodes.call(this,e,i,o,r)},this));if("object"==typeof d&&d&&d.url)return d=t.extend(!0,{},d),t.isFunction(d.url)&&(d.url=d.url.call(this,c)),t.isFunction(d.data)&&(d.data=d.data.call(this,c)),t.ajax(d).done(t.proxy(function(t,s,a){var d,c;if(t)for(d in t)t.hasOwnProperty(d)&&(this._data.massload[d]=t[d]);for(d=0,c=e.length;c>d;d++)l=this.get_node(e[d],!0),l&&l.length&&l.removeClass("jstree-loading").attr("aria-busy",!1);n._load_nodes.call(this,e,i,o,r)},this)).fail(t.proxy(function(t){n._load_nodes.call(this,e,i,o,r)},this))}}return n._load_nodes.call(this,e,i,o,r)},this._load_node=function(e,i){var o,r=this._data.massload[e.id],s=null;return r?(s=this["string"==typeof r?"_append_html_data":"_append_json_data"](e,"string"==typeof r?t(t.parseHTML(r)).filter(function(){return 3!==this.nodeType}):r,function(t){i.call(this,t)}),o=this.get_node(e.id,!0),o&&o.length&&o.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[e.id],s):n._load_node.call(this,e,i)}},t.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},t.jstree.plugins.search=function(n,i){this.bind=function(){i.bind.call(this),this._data.search.str="",this._data.search.dom=t(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",t.proxy(function(e,n){if(this._data.search.som&&n.res.length){var i,o,r,s,a=this._model.data,l=[];for(i=0,o=n.res.length;o>i;i++)if(a[n.res[i]]&&!a[n.res[i]].state.hidden&&(l.push(n.res[i]),l=l.concat(a[n.res[i]].parents),this._data.search.smc))for(r=0,s=a[n.res[i]].children_d.length;s>r;r++)a[a[n.res[i]].children_d[r]]&&!a[a[n.res[i]].children_d[r]].state.hidden&&l.push(a[n.res[i]].children_d[r]);l=t.vakata.array_remove_item(t.vakata.array_unique(l),t.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(l,!0),this.redraw(!0)}},this)).on("clear_search.jstree",t.proxy(function(t,e){this._data.search.som&&e.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(n,i,o,r,s,a){if(n===!1||""===t.trim(n.toString()))return this.clear_search();r=this.get_node(r),r=r&&r.id?r.id:null,n=n.toString();var l,d,c=this.settings.search,h=!!c.ajax&&c.ajax,u=this._model.data,p=null,g=[],m=[];if(this._data.search.res.length&&!s&&this.clear_search(),o===e&&(o=c.show_only_matches),a===e&&(a=c.show_only_matches_children),!i&&h!==!1)return t.isFunction(h)?h.call(this,n,t.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(t.isArray(e)?t.vakata.array_unique(e):[],function(){this.search(n,!0,o,r,s,a)})},this),r):(h=t.extend({},h),h.data||(h.data={}),h.data.str=n,r&&(h.data.inside=r),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=t.ajax(h).fail(t.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(t.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(t.isArray(e)?t.vakata.array_unique(e):[],function(){this.search(n,!0,o,r,s,a)})},this)),this._data.search.lastRequest);if(s||(this._data.search.str=n,this._data.search.dom=t(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=o,this._data.search.smc=a),p=new t.vakata.search(n,(!0),{caseSensitive:c.case_sensitive,fuzzy:c.fuzzy}),t.each(u[r?r:t.jstree.root].children_d,function(t,e){var i=u[e];i.text&&!i.state.hidden&&(!c.search_leaves_only||i.state.loaded&&0===i.children.length)&&(c.search_callback&&c.search_callback.call(this,n,i)||!c.search_callback&&p.search(i.text).isMatch)&&(g.push(e),m=m.concat(i.parents))}),g.length){for(m=t.vakata.array_unique(m),l=0,d=m.length;d>l;l++)m[l]!==t.jstree.root&&u[m[l]]&&this.open_node(m[l],null,0)===!0&&this._data.search.opn.push(m[l]);s?(this._data.search.dom=this._data.search.dom.add(t(this.element[0].querySelectorAll("#"+t.map(g,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(t.jstree.idregex,"\\$&"):e.replace(t.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=t.vakata.array_unique(this._data.search.res.concat(g))):(this._data.search.dom=t(this.element[0].querySelectorAll("#"+t.map(g,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(t.jstree.idregex,"\\$&"):e.replace(t.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=g),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:n,res:this._data.search.res,show_only_matches:o})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=t(this.element[0].querySelectorAll("#"+t.map(this._data.search.res,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(t.jstree.idregex,"\\$&"):e.replace(t.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=t()},this.redraw_node=function(e,n,o,r){if(e=i.redraw_node.apply(this,arguments),e&&-1!==t.inArray(e.id,this._data.search.res)){var s,a,l=null;for(s=0,a=e.childNodes.length;a>s;s++)if(e.childNodes[s]&&e.childNodes[s].className&&-1!==e.childNodes[s].className.indexOf("jstree-anchor")){l=e.childNodes[s];break}l&&(l.className+=" jstree-search")}return e}},function(t){t.vakata.search=function(e,n,i){i=i||{},i=t.extend({},t.vakata.search.defaults,i),i.fuzzy!==!1&&(i.fuzzy=!0),e=i.caseSensitive?e:e.toLowerCase();var o,r,s,a,l=i.location,d=i.distance,c=i.threshold,h=e.length;return h>32&&(i.fuzzy=!1),i.fuzzy&&(o=1<<h-1,r=function(){var t={},n=0;for(n=0;h>n;n++)t[e.charAt(n)]=0;for(n=0;h>n;n++)t[e.charAt(n)]|=1<<h-n-1;return t}(),s=function(t,e){var n=t/h,i=Math.abs(l-e);return d?n+i/d:i?1:n}),a=function(t){if(t=i.caseSensitive?t:t.toLowerCase(),e===t||-1!==t.indexOf(e))return{isMatch:!0,score:0};if(!i.fuzzy)return{isMatch:!1,score:1};var n,a,d,u,p,g,m,f,y,v=t.length,j=c,x=t.indexOf(e,l),_=h+v,S=1,b=[];for(-1!==x&&(j=Math.min(s(0,x),j),x=t.lastIndexOf(e,l+h),-1!==x&&(j=Math.min(s(0,x),j))),x=-1,n=0;h>n;n++){for(d=0,u=_;u>d;)s(n,l+u)<=j?d=u:_=u,u=Math.floor((_-d)/2+d);for(_=u,g=Math.max(1,l-u+1),m=Math.min(l+u,v)+h,f=new Array(m+2),f[m+1]=(1<<n)-1,a=m;a>=g;a--)if(y=r[t.charAt(a-1)],0===n?f[a]=(f[a+1]<<1|1)&y:f[a]=(f[a+1]<<1|1)&y|((p[a+1]|p[a])<<1|1)|p[a+1],f[a]&o&&(S=s(n,a-1),j>=S)){if(j=S,x=a-1,b.push(x),!(x>l))break;g=Math.max(1,2*l-x)}if(s(n+1,l)>j)break;p=f}return{isMatch:x>=0,score:S}},n===!0?{search:a}:a(n)},t.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(t),t.jstree.defaults.sort=function(t,e){return this.get_text(t)>this.get_text(e)?1:-1},t.jstree.plugins.sort=function(e,n){this.bind=function(){n.bind.call(this),this.element.on("model.jstree",t.proxy(function(t,e){this.sort(e.parent,!0)},this)).on("rename_node.jstree create_node.jstree",t.proxy(function(t,e){this.sort(e.parent||e.node.parent,!1),this.redraw_node(e.parent||e.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",t.proxy(function(t,e){this.sort(e.parent,!1),this.redraw_node(e.parent,!0)},this))},this.sort=function(e,n){var i,o;if(e=this.get_node(e),e&&e.children&&e.children.length&&(e.children.sort(t.proxy(this.settings.sort,this)),n))for(i=0,o=e.children_d.length;o>i;i++)this.sort(e.children_d[i],!1)}};var u=!1;t.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},t.jstree.plugins.state=function(e,n){this.bind=function(){n.bind.call(this);var e=t.proxy(function(){this.element.on(this.settings.state.events,t.proxy(function(){u&&clearTimeout(u),u=setTimeout(t.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",t.proxy(function(t,n){this.element.one("restore_state.jstree",e),this.restore_state()||e()},this))},this.save_state=function(){var e=this.get_state();this.settings.state.preserve_loaded||delete e.core.loaded;var n={state:e,ttl:this.settings.state.ttl,sec:+new Date};t.vakata.storage.set(this.settings.state.key,JSON.stringify(n))},this.restore_state=function(){var e=t.vakata.storage.get(this.settings.state.key);if(e)try{e=JSON.parse(e)}catch(t){return!1}return!(e&&e.ttl&&e.sec&&+new Date-e.sec>e.ttl)&&(e&&e.state&&(e=e.state),e&&t.isFunction(this.settings.state.filter)&&(e=this.settings.state.filter.call(this,e)),!!e&&(this.settings.state.preserve_loaded||delete e.core.loaded,this.element.one("set_state.jstree",function(n,i){i.instance.trigger("restore_state",{state:t.extend(!0,{},e)})}),this.set_state(e),!0))},this.clear_state=function(){return t.vakata.storage.del(this.settings.state.key)}},function(t,e){t.vakata.storage={set:function(t,e){return window.localStorage.setItem(t,e)},get:function(t){return window.localStorage.getItem(t)},del:function(t){return window.localStorage.removeItem(t)}}}(t),t.jstree.defaults.types={default:{}},t.jstree.defaults.types[t.jstree.root]={},t.jstree.plugins.types=function(n,i){this.init=function(n,o){var r,s;if(o&&o.types&&o.types.default)for(r in o.types)if("default"!==r&&r!==t.jstree.root&&o.types.hasOwnProperty(r))for(s in o.types.default)o.types.default.hasOwnProperty(s)&&o.types[r][s]===e&&(o.types[r][s]=o.types.default[s]);i.init.call(this,n,o),this._model.data[t.jstree.root].type=t.jstree.root},this.refresh=function(e,n){i.refresh.call(this,e,n),this._model.data[t.jstree.root].type=t.jstree.root},this.bind=function(){this.element.on("model.jstree",t.proxy(function(n,i){var o,r,s,a=this._model.data,l=i.nodes,d=this.settings.types,c="default";for(o=0,r=l.length;r>o;o++){if(c="default",a[l[o]].original&&a[l[o]].original.type&&d[a[l[o]].original.type]&&(c=a[l[o]].original.type),a[l[o]].data&&a[l[o]].data.jstree&&a[l[o]].data.jstree.type&&d[a[l[o]].data.jstree.type]&&(c=a[l[o]].data.jstree.type),a[l[o]].type=c,a[l[o]].icon===!0&&d[c].icon!==e&&(a[l[o]].icon=d[c].icon),d[c].li_attr!==e&&"object"==typeof d[c].li_attr)for(s in d[c].li_attr)if(d[c].li_attr.hasOwnProperty(s)){if("id"===s)continue;a[l[o]].li_attr[s]===e?a[l[o]].li_attr[s]=d[c].li_attr[s]:"class"===s&&(a[l[o]].li_attr.class=d[c].li_attr.class+" "+a[l[o]].li_attr.class)}if(d[c].a_attr!==e&&"object"==typeof d[c].a_attr)for(s in d[c].a_attr)if(d[c].a_attr.hasOwnProperty(s)){if("id"===s)continue;a[l[o]].a_attr[s]===e?a[l[o]].a_attr[s]=d[c].a_attr[s]:"href"===s&&"#"===a[l[o]].a_attr[s]?a[l[o]].a_attr.href=d[c].a_attr.href:"class"===s&&(a[l[o]].a_attr.class=d[c].a_attr.class+" "+a[l[o]].a_attr.class)}}a[t.jstree.root].type=t.jstree.root},this)),i.bind.call(this)},this.get_json=function(e,n,o){var r,s,a=this._model.data,l=n?t.extend(!0,{},n,{no_id:!1}):{},d=i.get_json.call(this,e,l,o);if(d===!1)return!1;if(t.isArray(d))for(r=0,s=d.length;s>r;r++)d[r].type=d[r].id&&a[d[r].id]&&a[d[r].id].type?a[d[r].id].type:"default",n&&n.no_id&&(delete d[r].id,d[r].li_attr&&d[r].li_attr.id&&delete d[r].li_attr.id,d[r].a_attr&&d[r].a_attr.id&&delete d[r].a_attr.id);else d.type=d.id&&a[d.id]&&a[d.id].type?a[d.id].type:"default",n&&n.no_id&&(d=this._delete_ids(d));return d},this._delete_ids=function(e){if(t.isArray(e)){for(var n=0,i=e.length;i>n;n++)e[n]=this._delete_ids(e[n]);return e}return delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id,e.children&&t.isArray(e.children)&&(e.children=this._delete_ids(e.children)),e},this.check=function(n,o,r,s,a){if(i.check.call(this,n,o,r,s,a)===!1)return!1;o=o&&o.id?o:this.get_node(o),r=r&&r.id?r:this.get_node(r);var l,d,c,h,u=o&&o.id?a&&a.origin?a.origin:t.jstree.reference(o.id):null;switch(u=u&&u._model&&u._model.data?u._model.data:null,n){case"create_node":case"move_node":case"copy_node":if("move_node"!==n||-1===t.inArray(o.id,r.children)){if(l=this.get_rules(r),l.max_children!==e&&-1!==l.max_children&&l.max_children===r.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+n,data:JSON.stringify({chk:n,pos:s,obj:!(!o||!o.id)&&o.id,par:!(!r||!r.id)&&r.id})},!1;if(l.valid_children!==e&&-1!==l.valid_children&&-1===t.inArray(o.type||"default",l.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+n,data:JSON.stringify({chk:n,pos:s,obj:!(!o||!o.id)&&o.id,par:!(!r||!r.id)&&r.id})},!1;if(u&&o.children_d&&o.parents){for(d=0,c=0,h=o.children_d.length;h>c;c++)d=Math.max(d,u[o.children_d[c]].parents.length);d=d-o.parents.length+1}(0>=d||d===e)&&(d=1);do{if(l.max_depth!==e&&-1!==l.max_depth&&l.max_depth<d)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+n,data:JSON.stringify({chk:n,pos:s,obj:!(!o||!o.id)&&o.id,par:!(!r||!r.id)&&r.id})},!1;r=this.get_node(r.parent),l=this.get_rules(r),d++}while(r)}}return!0},this.get_rules=function(t){if(t=this.get_node(t),!t)return!1;var n=this.get_type(t,!0);return n.max_depth===e&&(n.max_depth=-1),n.max_children===e&&(n.max_children=-1),n.valid_children===e&&(n.valid_children=-1),n},this.get_type=function(e,n){return e=this.get_node(e),!!e&&(n?t.extend({type:e.type},this.settings.types[e.type]):e.type)},this.set_type=function(n,i){var o,r,s,a,l,d,c,h,u=this._model.data;if(t.isArray(n)){for(n=n.slice(),r=0,s=n.length;s>r;r++)this.set_type(n[r],i);return!0}if(o=this.settings.types,n=this.get_node(n),!o[i]||!n)return!1;if(c=this.get_node(n,!0),c&&c.length&&(h=c.children(".jstree-anchor")),a=n.type,l=this.get_icon(n),n.type=i,(l===!0||!o[a]||o[a].icon!==e&&l===o[a].icon)&&this.set_icon(n,o[i].icon===e||o[i].icon),o[a]&&o[a].li_attr!==e&&"object"==typeof o[a].li_attr)for(d in o[a].li_attr)if(o[a].li_attr.hasOwnProperty(d)){if("id"===d)continue;"class"===d?(u[n.id].li_attr.class=(u[n.id].li_attr.class||"").replace(o[a].li_attr[d],""),c&&c.removeClass(o[a].li_attr[d])):u[n.id].li_attr[d]===o[a].li_attr[d]&&(u[n.id].li_attr[d]=null,c&&c.removeAttr(d))}if(o[a]&&o[a].a_attr!==e&&"object"==typeof o[a].a_attr)for(d in o[a].a_attr)if(o[a].a_attr.hasOwnProperty(d)){if("id"===d)continue;"class"===d?(u[n.id].a_attr.class=(u[n.id].a_attr.class||"").replace(o[a].a_attr[d],""),h&&h.removeClass(o[a].a_attr[d])):u[n.id].a_attr[d]===o[a].a_attr[d]&&("href"===d?(u[n.id].a_attr[d]="#",h&&h.attr("href","#")):(delete u[n.id].a_attr[d],h&&h.removeAttr(d)))}if(o[i].li_attr!==e&&"object"==typeof o[i].li_attr)for(d in o[i].li_attr)if(o[i].li_attr.hasOwnProperty(d)){if("id"===d)continue;u[n.id].li_attr[d]===e?(u[n.id].li_attr[d]=o[i].li_attr[d],c&&("class"===d?c.addClass(o[i].li_attr[d]):c.attr(d,o[i].li_attr[d]))):"class"===d&&(u[n.id].li_attr.class=o[i].li_attr[d]+" "+u[n.id].li_attr.class,
c&&c.addClass(o[i].li_attr[d]))}if(o[i].a_attr!==e&&"object"==typeof o[i].a_attr)for(d in o[i].a_attr)if(o[i].a_attr.hasOwnProperty(d)){if("id"===d)continue;u[n.id].a_attr[d]===e?(u[n.id].a_attr[d]=o[i].a_attr[d],h&&("class"===d?h.addClass(o[i].a_attr[d]):h.attr(d,o[i].a_attr[d]))):"href"===d&&"#"===u[n.id].a_attr[d]?(u[n.id].a_attr.href=o[i].a_attr.href,h&&h.attr("href",o[i].a_attr.href)):"class"===d&&(u[n.id].a_attr.class=o[i].a_attr.class+" "+u[n.id].a_attr.class,h&&h.addClass(o[i].a_attr[d]))}return!0}},t.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(t,e){return t+" ("+e+")"}},t.jstree.plugins.unique=function(n,i){this.check=function(e,n,o,r,s){if(i.check.call(this,e,n,o,r,s)===!1)return!1;if(n=n&&n.id?n:this.get_node(n),o=o&&o.id?o:this.get_node(o),!o||!o.children)return!0;var a,l,d,c="rename_node"===e?r:n.text,h=[],u=this.settings.unique.case_sensitive,p=this.settings.unique.trim_whitespace,g=this._model.data;for(a=0,l=o.children.length;l>a;a++)d=g[o.children[a]].text,u||(d=d.toLowerCase()),p&&(d=d.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),h.push(d);switch(u||(c=c.toLowerCase()),p&&(c=c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),e){case"delete_node":return!0;case"rename_node":return d=n.text||"",u||(d=d.toLowerCase()),p&&(d=d.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),a=-1===t.inArray(c,h)||n.text&&d===c,a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+c+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!o||!o.id)&&o.id})}),a;case"create_node":return a=-1===t.inArray(c,h),a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+c+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!o||!o.id)&&o.id})}),a;case"copy_node":return a=-1===t.inArray(c,h),a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+c+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!o||!o.id)&&o.id})}),a;case"move_node":return a=n.parent===o.id&&(!s||!s.is_multi)||-1===t.inArray(c,h),a||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+c+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:r,obj:!(!n||!n.id)&&n.id,par:!(!o||!o.id)&&o.id})}),a}return!0},this.create_node=function(n,o,r,s,a){if(!o||o.text===e){if(null===n&&(n=t.jstree.root),n=this.get_node(n),!n)return i.create_node.call(this,n,o,r,s,a);if(r=r===e?"last":r,!r.toString().match(/^(before|after)$/)&&!a&&!this.is_loaded(n))return i.create_node.call(this,n,o,r,s,a);o||(o={});var l,d,c,h,u,p,g=this._model.data,m=this.settings.unique.case_sensitive,f=this.settings.unique.trim_whitespace,y=this.settings.unique.duplicate;for(d=l=this.get_string("New node"),c=[],h=0,u=n.children.length;u>h;h++)p=g[n.children[h]].text,m||(p=p.toLowerCase()),f&&(p=p.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),c.push(p);for(h=1,p=d,m||(p=p.toLowerCase()),f&&(p=p.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==t.inArray(p,c);)d=y.call(this,l,++h).toString(),p=d,m||(p=p.toLowerCase()),f&&(p=p.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));o.text=d}return i.create_node.call(this,n,o,r,s,a)}};var p=l.createElement("DIV");if(p.setAttribute("unselectable","on"),p.setAttribute("role","presentation"),p.className="jstree-wholerow",p.innerHTML="&#160;",t.jstree.plugins.wholerow=function(e,n){this.bind=function(){n.bind.call(this),this.element.on("ready.jstree set_state.jstree",t.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",t.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",t.proxy(function(t,e){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",t.proxy(function(t,e){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");var n,i,o=!1;for(n=0,i=e.selected.length;i>n;n++)o=this.get_node(e.selected[n],!0),o&&o.length&&o.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",t.proxy(function(t,e){this.get_node(e.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",t.proxy(function(t,e){"hover_node"===t.type&&this.is_disabled(e.node)||this.get_node(e.node,!0).children(".jstree-wholerow")["hover_node"===t.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",t.proxy(function(e){if(this._data.contextmenu){e.preventDefault();var n=t.Event("contextmenu",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,pageX:e.pageX,pageY:e.pageY});t(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n)}},this)).on("click.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var n=t.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});t(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()}).on("dblclick.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var n=t.Event("dblclick",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});t(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",t.proxy(function(e){e.stopImmediatePropagation();var n=t.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});t(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(n).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",t.proxy(function(t){return t.stopImmediatePropagation(),this.is_disabled(t.currentTarget)||this.hover_node(t.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",t.proxy(function(t){this.dehover_node(t.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),n.teardown.call(this)},this.redraw_node=function(e,i,o,r){if(e=n.redraw_node.apply(this,arguments)){var s=p.cloneNode(!0);-1!==t.inArray(e.id,this._data.core.selected)&&(s.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===e.id&&(s.className+=" jstree-wholerow-hovered"),e.insertBefore(s,e.childNodes[0])}return e}},l.registerElement&&Object&&Object.create){var g=Object.create(HTMLElement.prototype);g.createdCallback=function(){var e,n={core:{},plugins:[]};for(e in t.jstree.plugins)t.jstree.plugins.hasOwnProperty(e)&&this.attributes[e]&&(n.plugins.push(e),this.getAttribute(e)&&JSON.parse(this.getAttribute(e))&&(n[e]=JSON.parse(this.getAttribute(e))));for(e in t.jstree.defaults.core)t.jstree.defaults.core.hasOwnProperty(e)&&this.attributes[e]&&(n.core[e]=JSON.parse(this.getAttribute(e))||this.getAttribute(e));t(this).jstree(n)};try{l.registerElement("vakata-jstree",{prototype:g})}catch(t){}}}});iS3.Main=function(t){this.config=t.config||null,this.init()},iS3.Main.prototype.init=function(){var t=this,e=new iS3.Project({config:t.config}),n=new ol.Map({target:"map",layers:[new ol.layer.Tile({preload:1/0,source:new ol.source.OSM({wrapX:!1}),visible:!0,id:"Local:Local:OpenStreet Map",layertype:iS3.LayerDef.layerType.BASE_MAP}),new ol.layer.Tile({preload:1/0,source:new ol.source.BingMaps({key:"AuZqkxV8gt-r1OwAN_2QnolUWIc5wcL-m3ncZJMD-h9LdGcIBHO7FXnThf1Ct-8z",imagerySet:"Aerial",wrapX:!1}),visible:!1,id:"Local:Local:Bing Map",layertype:iS3.LayerDef.layerType.BASE_MAP}),new ol.layer.Vector({source:new ol.source.Vector({wrapX:!1}),id:"Local:Local:Drawing Layer"})],interactions:ol.interaction.defaults({dragPan:!1}),controls:[new ol.control.MousePosition({coordinateFormat:function(t){var e=t[0].toFixed(3),n=t[1].toFixed(3);return e+", "+n},target:"coordinates"})],view:new ol.View({center:[0,0],zoom:3}),loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0});e.setMap(n);var i=document.getElementById("messageBar")||document.createElement("span"),o=new MutationObserver(function(t){if(t[0].target.textContent){var e=t[0].target.textContent,n=function(){e!==t[0].target.textContent?(e=t[0].target.textContent,setTimeout(n,1e4)):(e="",t[0].target.textContent="")};setTimeout(n,1e4)}});o.observe(i,{childList:!0}),e.setMessage(i);var r=new iS3.layertree.Layertree({parentObj:e,target:"layertree",buttons:["addwms","newlayer","addinput","outputlayer","deletelayer"]});r.createRegistry(n.getLayers().item(0)),r.createRegistry(n.getLayers().item(1)),e.setLayertree(r);var s=new iS3.toolbar.Toolbar({parentObj:e,target:"toolbar",buttons:["zoomGroup","selectGroup","drawGroup","measureGroup","queryGroup"]});e.setToolbar(s),$("button[data-tooltip='Pan']").click();var a=new iS3.datatree.Datatree({parentObj:e,target:"datatree"});e.setDatatree(a);var l=new iS3.data.Data({parentObj:e,target:"data"});e.setData(l)},iS3.domTool=function(){},iS3.domTool.removeContent=function(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t},iS3.domTool.stopPropagationOnEvent=function(t,e){return t.addEventListener(e,function(t){t.stopPropagation()}),t},iS3.domTool.createOption=function(t,e){var n=document.createElement("option");return n.textContent=t,n.value=e?e:t,n},iS3.domTool.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},iS3.domTool.activeTabByComponentName=function(t,e){var n=t.root.contentItems;for(var i in n){var o=n[i].getItemsByType("stack");for(var r in o){var s=o[r].header.tabs;for(var a in s)s[a].contentItem.componentName===e&&o[r].header.setActiveContentItem(s[a].contentItem)}}},iS3.geoRequest=function(){},iS3.geoRequest.queryFeatureFromTile=function(t,e,n){var i=iS3Project.getMap(),o=i.getView().getResolution(),r=i.getView().getProjection(),s=e.getSource().getGetFeatureInfoUrl(t,o,r.getCode(),{INFO_FORMAT:"application/json"}),a=new ol.format.GeoJSON,l=new XMLHttpRequest;l.open("GET",s),l.send(),l.onreadystatechange=function(){if(4===l.readyState&&200===l.status){var t=a.readFeatures(l.responseText,{featureProjection:r});t.length>0&&n(t[0])}}},iS3.geoRequest.bboxFeaturesFromTile=function(t,e,n){var i=iS3Project.getMap(),o=i.getView().getProjection(),r=t.server+"/wfs?service=WFS&version=1.1.0&request=GetFeature&typename="+t.name+"&outputFormat=application/json&srsname="+o.getCode()+"&bbox="+e.join(",")+","+o.getCode(),s=new ol.format.GeoJSON,a=new XMLHttpRequest;a.open("GET",r),a.send(),a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var t=s.readFeatures(a.responseText,{featureProjection:o});n(t)}}},iS3.geoRequest.bboxGeoJsonFromTile=function(t,e,n){var i=iS3Project.getMap(),o=i.getView().getProjection(),r=t.server+"/wfs?service=WFS&version=1.1.0&request=GetFeature&typename="+t.name+"&outputFormat=application/json&srsname="+o.getCode()+"&bbox="+e.join(",")+","+o.getCode(),s=(new ol.format.GeoJSON,new XMLHttpRequest);s.open("GET",r),s.send(),s.onreadystatechange=function(){4===s.readyState&&200===s.status&&n(s.responseText)}},iS3.geoRequest.polygonFeaturesFromTile=function(t,e){var n=$.Deferred,i=n();return iS3.geoRequest.getWFSInfo(t).done(function(n){var o=iS3Project.getMap().getView().getProjection().getCode(),r=(new ol.format.WFS).writeGetFeature({featureNS:n.featureNS,featurePrefix:t.featurePrefix,featureTypes:[n.featureType],srsName:o,outputFormat:"application/json",filter:new ol.format.filter.Intersects("wkb_geometry",e,o)}),s=new XMLSerializer,a=s.serializeToString(r);$.ajax({url:t.server+"/wfs?service=wfs",type:"POST",headers:{"Content-Type":"text/xml"},data:a}).done(function(t){var e=(new ol.format.GeoJSON).readFeatures(t,{featureProjection:o});i.resolve(e)})}),i.promise()},iS3.geoRequest.transactWFS=function(t,e,n){iS3.geoRequest.getWFSInfo(t).done(function(i){console.log(i);var o,r=new ol.format.WFS,s={featureType:i.featureType,featureNS:i.featureNS,gmlOptions:{srsName:iS3Project.getMap().getView().getProjection().getCode()}};switch(n){case"insert":o=r.writeTransaction(e,null,null,s);break;case"update":o=r.writeTransaction(null,e,null,s);break;case"delete":o=r.writeTransaction(null,null,e,s)}var a=new XMLSerializer,l=a.serializeToString(o),d=iS3Project.getConfig().proxy,c=$.Deferred,h=c();return $.post(d+"/proxy/geoserver/transact-wfs",l).done(function(e){var n=iS3Project.getLayertree().getLayerById(t.id);if(n instanceof ol.layer.Tile){var i=n.getSource(),o=i.getParams();o.t=(new Date).getMilliseconds(),i.updateParams(o)}h.resolve()}),h.promise()})},iS3.geoRequest.getWFSInfo=function(t){var e={},n=t.name.split(/:/);e.featureType=n[1];var i=t.server+"/wfs?REQUEST=GetCapabilities&SERVICE=wfs",o=$.Deferred,r=o();return $.ajax({url:i,type:"GET",dataType:"text"}).done(function(i){var o=new RegExp("xmlns:"+n[0]+'=".+?"'),s=i.match(o);e.featureNS=s[0].split(/"/)[1],t.featureType=e.featureType,t.featureNS=e.featureNS,r.resolve(e)}),r.promise()},iS3.geoRequest.getLayerHeader=function(t,e){if(!t.headers&&t.headers.length>0)e(t.headers);else{var n=t.server+"/wfs?SERVICE=WFS&REQUEST=GetFeature&TYPENAME="+t.name+"&VERSION=1.1.0&outputFormat=application%2Fjson&maxFeatures=1",i=new ol.format.GeoJSON,o=new XMLHttpRequest;o.open("GET",n),o.send(),o.onreadystatechange=function(){if(4===o.readyState&&200===o.status){var n=i.readFeatures(o.responseText);if(1===n.length){var r=n[0].getProperties();for(var s in r)iS3.domTool.isNumber(r[s])?t.headers.push({name:s,type:"number"}):t.headers.push({name:s,type:"string"});e(t.headers)}}}}},iS3.geoRequest.geojsonToShp=function(t,e){var n={json:t,outputName:e+".zip"},i=document.createElement("form");i.setAttribute("method","post"),i.setAttribute("action","http://ogre.adc4gis.com/convertJson");for(var o in n)if(n.hasOwnProperty(o)){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",o),r.setAttribute("value",n[o]),i.appendChild(r)}i.submit()},iS3.geoRequest.shapeToGeojson=function(t,e,n){var i=new FormData;i.append("upload",t),i.append("targetSrs",e.targetSrs.getCode()),$.ajax({url:"https://ogre.adc4gis.com/convert",data:i,type:"POST",processData:!1,contentType:!1,success:function(t){n(t)},error:function(t){console.log("Error: "+t)}})},iS3.inherits=function(t,e){function n(){}n.prototype=e.prototype,t.superClass=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.base=function(t,n,i){for(var o=new Array(arguments.length-2),r=2;r<arguments.length;r++)o[r-2]=arguments[r];return e.prototype[n].apply(t,o)}},Mousetrap.bind("f2",function(){$(".ol-dragpan :button").click()}),Mousetrap.bind("ctrl+q",function(){$(".iS3-gisquality :button").click()}),Mousetrap.bind("1",function(){$("#gischeck-mark-isolated").click()}),Mousetrap.bind("2",function(){$("#gischeck-mark-repeated").click()}),Mousetrap.bind("3",function(){$("#gischeck-mark-link").click()}),Mousetrap.bind("4",function(){$("#gischeck-mark-reset").click()}),iS3.style=function(){},iS3.style.componentToHex=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},iS3.style.rgbToHex=function(t,e,n){return"#"+iS3.style.componentToHex(t)+iS3.style.componentToHex(e)+iS3.style.componentToHex(n)},iS3.style.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null};var defaultStyle;iS3.style.getDefault=function(){if(defaultStyle)return defaultStyle;var t=new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),e=new ol.style.Stroke({color:"#3399CC",width:1}),n=new ol.style.Fill({color:"rgba(0,0,0,1.0)"}),i=new ol.style.Stroke({color:"rgba(0,0,0,1.0)",width:.1});return defaultStyle=new ol.style.Style({image:new ol.style.Circle({fill:n,stroke:i,radius:2}),fill:t,stroke:e})};var defaultSelectedStyle;iS3.style.getDefaultSelected=function(){if(defaultSelectedStyle)return defaultSelectedStyle;var t=new ol.style.Fill({color:"rgba(255,255,255,0.4)"}),e=new ol.style.Stroke({color:"#3399CC",width:2}),n=new ol.style.Fill({color:"#1E90FF"}),i=new ol.style.Stroke({color:"rgba(255,255,255,0.4)",width:.1});return defaultSelectedStyle=new ol.style.Style({image:new ol.style.Circle({fill:n,stroke:i,radius:5}),fill:t,stroke:e})};var transparentStyle;iS3.style.getTransparent=function(){return transparentStyle?transparentStyle:transparentStyle=new ol.style.Style},iS3.style.getHighlight=function(t){var e=new ol.style.Fill({color:t}),n=iS3.style.hexToRgb(t),i=new ol.style.Stroke({color:"rgba("+n.r+","+n.g+","+n.b+",0.2)",width:10}),o=new ol.style.Stroke({color:t,width:2});return new ol.style.Style({image:new ol.style.Circle({fill:e,stroke:i,radius:3}),fill:e,stroke:o})},iS3.style.getHighlightSelected=function(t){var e=new ol.style.Fill({color:t}),n=iS3.style.hexToRgb("#FF0000"),i=new ol.style.Stroke({color:"rgba("+n.r+","+n.g+","+n.b+",0.2)",width:10}),o=new ol.style.Stroke({color:"#FF0000",width:2});return new ol.style.Style({image:new ol.style.Circle({fill:e,stroke:i,radius:3}),fill:e,stroke:o})},iS3.style.getFill=function(t){return new ol.style.Fill({color:t})},iS3.style.getStroke=function(t,e){return new ol.style.Stroke({color:t,width:e})},iS3.style.getCircle=function(t,e,n){return new ol.style.Circle({fill:t,stroke:e,radius:n})},iS3.style.getSquare=function(t,e,n){return new ol.style.RegularShape({fill:t,stroke:e,points:4,radius:n,rotation:0,angle:Math.PI/4})},iS3.style.getTriangle=function(t,e,n){return new ol.style.RegularShape({fill:t,stroke:e,points:3,radius:n,rotation:0,angle:0})},iS3.style.getStar=function(t,e,n){return new ol.style.RegularShape({fill:t,stroke:e,points:5,radius:n,radius2:n/2,angle:0})},iS3.style.getHexagon=function(t,e,n){return new ol.style.RegularShape({fill:t,stroke:e,points:6,radius:n,rotation:0,angle:0})},iS3.style.getX=function(t,e,n){return new ol.style.RegularShape({fill:t,stroke:e,points:4,radius:n,radius2:n/5,angle:Math.PI/4})},iS3.style.setTransparent=function(t,e){var n=iS3.style.hexToRgb(t);return"rgba("+n.r+","+n.g+","+n.b+","+e+")"},iS3.topology=function(){},iS3.topology.geometryFactory=new jsts.geom.GeometryFactory,iS3.topology.ParserConstructor=jsts.io.olParser,iS3.topology.parser=new iS3.topology.ParserConstructor,iS3.topology.polyIntersectsPoly=function(t,e){var n=iS3.topology.parser.read(t),i=iS3.topology.parser.read(e);return n.intersects(i)},iS3.topology.trueDist2MapDist=function(t){var e=new ol.geom.LineString([[0,0],[0,t]]);return e.transform(ol.proj.get("EPSG:3857"),window.iS3Project.getMap().getView().getProjection()),e.getLength()},iS3.Config=function(t){var e=t.config||null;if(e)switch(this.server=e.server,this.proxy=e.proxy,this.CODE=e.CODE,e.lang){case"CN":this.lang=new iS3.LangCN;break;case"EN":this.lang=new iS3.LangEN}},iS3.DGObject=function(t){this.id=t.id||null,this.name=t.name||null,this.fullname=t.fullname||null,this.desc=t.desc||null,this.res=t.res||null,this.rawData=t.rawData||null,this.shp=t.shp||null,this.parent=t.parent||null},iS3.DGObjectsDefinition=function(t){this.Type=null,this.Name=null,this.HasGeometry=null,this.GISLayerName=null,this.TableNameSQL=null,this.DefNamesSQL=null,this.ConditionSQL=null,this.OrderSQL=null},iS3.DGObjects=function(t){},iS3.DGObjectsCollection=function(t){},iS3.Domain=function(t){this.parent=null,this.type=null,this.name=null,this.root=null},iS3.Domain.DomainType={Unknown:"unknown",Geology:"geology",Surroundings:"surroundings",Structure:"structure",Design:"design",Construction:"construction",Monitoring:"monitoring",Maintenance:"maintenance",Tdisease:"Tdisease"},iS3.LayerDef=function(t){this.id=t.id||null,this.server=t.server||null,this.featurePrefix=t.featurePrefix||null,this.name=t.name||null,this.projection=t.projection||null,this.extent=t.extent||null,this.layertype=t.layertype||null,this.featureType=t.featureType||null,this.featureNS=t.featureNS||null,this.headers=t.headers||[]},iS3.LayerDef.layerType={BASE_MAP:"basemap",PANOPOINT:"panopoint",PANOTIMEB:"panotimeb",UNKNOWN:"unknown"};var iS3Project=window.iS3Project;iS3.Project=function(t){this._map=t.map||null,this._layertree=t.layertree||null,this._toolbar=t.toolbar||null,this._message=t.message||null,this._datatree=t.datatree||null,this._data=t.data||null,this._layerDefs={};var e=t.config||null;this._config=new iS3.Config({config:e}),iS3Project=this,this.projDef=null,this.domains=null,this.init()},iS3.Project.prototype.init=function(){var t=this;t.domains={}},iS3.Project.prototype.getMap=function(){return this._map},iS3.Project.prototype.setMap=function(t){if(!(t instanceof ol.Map))throw new Error("map must be an instance of ol.Map");this._map=t},iS3.Project.prototype.getLayertree=function(){return this._layertree},iS3.Project.prototype.setLayertree=function(t){if(!(t instanceof iS3.layertree.Layertree))throw new Error("layertree must be an instance of iS3.layertree");this._layertree=t},iS3.Project.prototype.getToolbar=function(){return this._toolbar},iS3.Project.prototype.setToolbar=function(t){if(!(t instanceof iS3.toolbar.Toolbar))throw new Error("toolbar must be an instance of iS3.toolbar");this._toolbar=t},iS3.Project.prototype.getMessage=function(){return this._message},iS3.Project.prototype.setMessage=function(t){this._message=t},iS3.Project.prototype.getDatatree=function(){return this._datatree},iS3.Project.prototype.setDatatree=function(t){this._datatree=t},iS3.Project.prototype.getData=function(){return this._data},iS3.Project.prototype.setData=function(t){this._data=t},iS3.Project.prototype.getLayerDefs=function(){return this._layerDefs},iS3.Project.prototype.getConfig=function(){return this._config},iS3.ProjectDefinition=function(t){this.ID=t.ID||null,this.ProjectTitle=t.ProjectTitle||null,this.DefaultMapID=t.DefaultMapID||null,this.LocalFilePath=t.LocalFilePath||null,this.LocalTilePath=t.LocalTilePath||null,this.LocalDatabaseName=t.LocalDatabaseName||null,this.DataServiceUrl=t.DataServiceUrl||null,this.GeometryServiceUrl=t.GeometryServiceUrl||null},iS3.ToolGroup=function(t){if(!t.hasOwnProperty("id"))throw new Error("Please provide id of a tool group.");this._id=t.id,this._tools=[],this.name=t.name||"unnamed"},iS3.ToolGroup.prototype.add=function(t){if(!t.hasOwnProperty("id"))throw new Error("The added tool should has an id attribute.");if(this.getTools().hasOwnProperty(t.id))throw new Error("The id of added tool is existed.");this.getTools().push(t)},iS3.ToolGroup.prototype.getId=function(){return this._id},iS3.ToolGroup.prototype.getTools=function(){return this._tools},iS3.ToolGroupCollection=function(t){this._groups=[]},iS3.ToolGroupCollection.prototype.add=function(t){if(!t.getId())throw new Error("The added group should has an id attribute.");if(this._groups.hasOwnProperty(t.getId()))throw new Error("The id of added group is existed.");this._groups.push(t)},iS3.ToolGroupCollection.prototype.getAllTools=function(){var t=[];return this._groups.forEach(function(e){e.getTools().forEach(function(e){t.push(e)})}),t},iS3.Tree=function(t){console.log("test"),this.name=t.name||null,this.displayName=t.displayName||null,this.description=t.description||null,this.refDomainName=t.refDomainName||null,this.refObjsName=t.refObjsName||null,this.filter=t.filter||null,this.sort=t.sort||null,this.objectsView=t.objectsView||null,this.refObjs=t.refObjs||null,this.children=t.children||null,this.containerDiv=document.getElementById(t.target),this.init()},iS3.Tree.prototype.init=function(){},iS3.layertree=function(t){},iS3.layertree.Layertree=function(t){"use strict";if(!(this instanceof iS3.layertree.Layertree))throw new Error("layerTree must be constructed with the new keyword.");if("object"!=typeof t||!t.parentObj||!t.target)throw new Error("Invalid parameter(s) provided.");if(!(t.parentObj.getMap()instanceof ol.Map))throw new Error("Please provide a valid OpenLayers 3 map object.");var e=document.getElementById(t.target);if(null===e||1!==e.nodeType)throw console.log(e),new Error("Please provide a valid element id.");if(!t.parentObj.getMessage())throw new Error("message output must be initialed first");var n=document.getElementById(t.target),i=document.createElement("div");i.className="layertreeButtonHolder",n.appendChild(i);var o=document.createElement("div");o.className="ui large basic icon buttons",i.appendChild(o);var r=document.createElement("div");r.className="ui raised segments",n.appendChild(r),this.parentObj=t.parentObj,this.buttons=t.buttons,this.map=t.parentObj.getMap(),this.message=t.parentObj.getMessage(),this.container=n,this.buttonContainer=o,this.layerContainer=r,this.selectedLayer=null,this.init()},iS3.layertree.Layertree.prototype.init=function(){var t=this,e=this.buttons;e.forEach(function(e){t.addButton(e)}),this.selectEventEmitter=new ol.Observable,this.map.getLayers().on("add",function(e){e.element instanceof ol.layer.Vector?this.createRegistry(e.element,!0):this.createRegistry(e.element);var n=t.getDrawingLayer(),i=t.map.getLayers().getArray();i.splice(i.indexOf(n),1),i.splice(i.length,0,n),t.map.render()},this),this.map.getLayers().on("remove",function(t){this.removeRegistry(t.element),this.selectEventEmitter.changed()},this)},iS3.layertree.Layertree.prototype.addButton=function(t){var e=this.buttonContainer,n=iS3Project.getConfig().lang,i=this;switch(t){case"addwms":e.appendChild(new iS3.layertree.WmsButton({parentObj:i,elemName:"addwms",elemTitle:n.addwmsTitle}));break;case"addwfs":e.appendChild(new iS3.layertree.WfsButton({parentObj:i,elemName:"addwfs",elemTitle:n.addwfsTitle}));break;case"newlayer":e.appendChild(new iS3.layertree.NewButton({parentObj:i,elemName:"newlayer",elemTitle:n.newlayerTitle}));break;case"addinput":e.appendChild(new iS3.layertree.InputButton({parentObj:i,elemName:"addinput",elemTitle:n.addInputTitle}));break;case"outputlayer":e.appendChild(new iS3.layertree.OutputButton({parentObj:i,elemName:"outputlayer",elemTitle:n.outputLayerTitle}));break;case"deletelayer":e.appendChild(new iS3.layertree.RemoveButton({parentObj:i,elemName:"deletelayer",elemTitle:n.removeLayerTitle}));break;default:return!1}},iS3.layertree.Layertree.prototype.createRegistry=function(t,e){var n=this,i=this.getLayerDefById(t.get("id"));if(!i){var o=t.get("id").split(":"),r=o[o.length-2]+":"+o[o.length-1],s=t.get("id").substring(0,t.get("id").length-r.length-1);i=new iS3.LayerDef({id:t.get("id"),server:s,featurePrefix:o[o.length-2],name:r,featureType:r.split(":")[1]}),iS3Project.getLayerDefs()[t.get("id")]=i}var a,l=t.get("id").split(/:/g),d=l[l.length-1],c={parentObj:n,id:t.get("id"),buffer:e,title:d,layer:t};a=t.get("layertype")?t.get("layertype"):t.get("id").indexOf("panopoint")!==-1?iS3.LayerDef.layerType.PANOPOINT:t.get("id").indexOf("PANOTIME")!==-1?iS3.LayerDef.layerType.PANOTIMEB:iS3.LayerDef.layerType.UNKNOWN,i.layertype=a;var h;switch(a){case iS3.LayerDef.layerType.BASE_MAP:h=new iS3.layertree.BaseMapContainer(c).init();break;case iS3.LayerDef.layerType.PANOPOINT:h=new iS3.layertree.PanopointContainer(c).init();break;default:h=new iS3.layertree.BasicContainer(c).init()}return this.addSelectEvent(h),this.layerContainer.insertBefore(h,this.layerContainer.firstChild),this},iS3.layertree.Layertree.prototype.removeRegistry=function(t){var e=document.getElementById(t.get("id"));return this.layerContainer.removeChild(e),this},iS3.layertree.Layertree.prototype.addBufferIcon=function(t){t.getSource().on("change",function(e){var n=document.getElementById(t.get("id"));switch(e.target.getState()){case"ready":n.className=n.className.replace(/(?:^|\s)(error|buffering)(?!\S)/g,"");break;case"error":n.className+=" error";break;default:n.className+=" buffering"}})},iS3.layertree.Layertree.prototype.addSelectEvent=function(t,e){var n=this;return t.addEventListener("click",function(t){t.stopPropagation();var i=t.target;e&&(t.stopPropagation(),i=i.parentNode),n.selectedLayer&&n.selectedLayer.classList.remove("active"),n.selectedLayer=i,i.classList.add("active"),n.selectEventEmitter.changed()}),t},iS3.layertree.Layertree.prototype.getLayerById=function(t){for(var e=this.map.getLayers().getArray(),n=0;n<e.length;n+=1)if(e[n].get("id")===t)return e[n];return null},iS3.layertree.Layertree.prototype.getLayerDefById=function(t){return this.parentObj.getLayerDefs()[t]},iS3.layertree.Layertree.prototype.getDrawingLayer=function(){return this.getLayerById("Local:Local:Drawing Layer")},iS3.layertree.BaseButton=function(t){var e=document.createElement("button");e.className="ui button",e.setAttribute("data-tooltip",t.elemTitle||"Custom interaction"),e.setAttribute("data-position","bottom left"),e.setAttribute("data-variation","mini");var n=document.createElement("i"),i=null;"addwms"==t.elemName&&(i="th icon"),"addwfs"==t.elemName&&(i="clone icon"),"newlayer"==t.elemName&&(i="plus icon"),"addinput"==t.elemName&&(i="upload icon"),"outputlayer"==t.elemName&&(i="download icon"),"deletelayer"==t.elemName&&(i="trash icon"),n.className=i,e.appendChild(n),this.button=e},iS3.layertree.InputButton=function(t){iS3.layertree.BaseButton.call(this,t),this.parentObj=t.parentObj;var e,n=this,i=this.button;return i.addEventListener("click",function(){e||(e=n.createUI(),document.body.appendChild(e),document.getElementById("addInput_form").addEventListener("submit",function(t){t.preventDefault(),n.addInputLayer(this),this.parentNode.style.display="none"})),"none"===e.style.display?e.style.display="block":e.style.display="none"}),i},iS3.inherits(iS3.layertree.InputButton,iS3.layertree.BaseButton),iS3.layertree.InputButton.prototype.createUI=function(){var t=iS3Project.getConfig().lang,e=document.createElement("div");e.id="addInput",e.className="toggleable",e.style.display="none";var n=document.createElement("form");n.id="addInput_form",n.className="addlayer",e.appendChild(n);var i=document.createElement("p");i.textContent=this.button.title,n.appendChild(i);var o=document.createElement("table"),r=document.createElement("tr");r.innerHTML="<td>"+t.inputFile+':</td><td><input name="file" type="file" required="required"></td>',o.appendChild(r);var s=document.createElement("tr");s.innerHTML="<td>"+t.type+':</td><td><select name="format" required="required"><option value="panotimeb">PanotimeB</option><option value="shapefile">Shapefile</option><option value="geojson">GeoJSON</option></select></td>',o.appendChild(s);var a=document.createElement("tr");return a.innerHTML='<td><input type="submit" value="'+t.addLayer+'"></td><td><input type="button" value="'+t.cancel+'" onclick="this.form.parentNode.style.display = \'none\'"></td>',o.appendChild(a),n.appendChild(o),e},iS3.layertree.InputButton.prototype.addInputLayer=function(t){var e,n=this.parentObj,i=t.file.files[0],o="Local:Local:"+i.name.substr(0,i.name.lastIndexOf(".")),r=n.map.getView().getProjection();try{var s,a=new FileReader,l=new ol.source.Vector({wrapX:!1}),d=new ol.layer.Vector({source:l,style:iS3.style.getDefault()});d.set("id",o),n.addBufferIcon(d),n.map.addLayer(d),n.message.textContent="Vector layer added successfully.","shapefile"===t.format.value?(s=new iS3.format.Shapefile,s.readFeatures(i,{targetSrs:r},function(t){l.addFeatures(t)})):(a.readAsText(i),a.onload=function(n){var o=n.target.result;switch(t.format.value){case"panotimeb":s=new iS3.format.PanotimeB({name:i.name});break;case"geojson":s=new ol.format.GeoJSON;break;default:return!1}e=s.readProjection(o)||r;var a=s.readFeatures(o,{dataProjection:e,featureProjection:r});l.addFeatures(a)})}catch(t){n.message.textContent="Some unexpected error occurred: ("+t.message+")."}},iS3.layertree.NewButton=function(t){iS3.layertree.BaseButton.call(this,t),this.parentObj=t.parentObj;var e,n=this,i=this.button;return i.addEventListener("click",function(){e||(e=n.createUI(),document.body.appendChild(e),document.getElementById("newlayer_form").addEventListener("submit",function(t){t.preventDefault(),n.newVectorLayer(this),this.parentNode.style.display="none"})),"none"===e.style.display?e.style.display="block":e.style.display="none"}),i},iS3.inherits(iS3.layertree.NewButton,iS3.layertree.BaseButton),
iS3.layertree.NewButton.prototype.createUI=function(){var t=iS3Project.getConfig().lang,e=document.createElement("div");e.id="newLayer",e.className="toggleable",e.style.display="none";var n=document.createElement("form");n.id="newlayer_form",n.className="addlayer",e.appendChild(n);var i=document.createElement("p");i.textContent=this.button.title,n.appendChild(i);var o=document.createElement("table"),r=document.createElement("tr");r.innerHTML="<td>"+t.displayName+':</td><td><input name="displayname" type="text" value="unnamed"></td>',o.appendChild(r);var s=document.createElement("tr");s.innerHTML="<td>"+t.type+':</td><td><select name="type" required="required"><option value="point">Point</option><option value="line">Line</option><option value="polygon">Polygon</option><option value="geomcollection">Geometry Collection</option></select></td>',o.appendChild(s);var a=document.createElement("tr");return a.innerHTML='<td><input type="submit" value="'+t.addLayer+'"></td><td><input type="button" value="'+t.cancel+'" onclick="this.form.parentNode.style.display = \'none\'"></td>',o.appendChild(a),n.appendChild(o),e},iS3.layertree.NewButton.prototype.newVectorLayer=function(t){var e=this.parentObj,n=t.type.value;if("point"!==n&&"line"!==n&&"polygon"!==n&&"geomcollection"!==n)return e.message.textContent="Unrecognized layer type.",null;var i=new ol.layer.Vector({source:new ol.source.Vector({wrapX:!1}),style:iS3.style.getDefault(),name:t.displayname.value||"Unnamed Layer",type:n}),o="Local:"+t.displayname.value;return i.set("id",o),iS3Project.getLayerDefs()["Local:"+t.displayname.value]=new iS3.LayerDef({id:o,name:o}),e.addBufferIcon(i),e.map.addLayer(i),i.getSource().changed(),e.message.textContent="New vector layer created successfully.",this},iS3.layertree.OutputButton=function(t){iS3.layertree.BaseButton.call(this,t),this.parentObj=t.parentObj;var e,n=this,i=this.button;return i.addEventListener("click",function(){if(e||(e=n.createUI(),document.body.appendChild(e),document.getElementById("addOutput_form").addEventListener("submit",function(t){t.preventDefault(),n.outputLayer(this),this.parentNode.style.display="none"})),"none"===e.style.display){var t=document.getElementById("outputlayeropt");iS3.domTool.removeContent(t);var i=n.parentObj.layerContainer.childNodes;for(var o in i)1===i[o].nodeType&&t.appendChild(iS3.domTool.createOption(i[o].title,i[o].id));e.style.display="block"}else e.style.display="none"}),i},iS3.inherits(iS3.layertree.OutputButton,iS3.layertree.BaseButton),iS3.layertree.OutputButton.prototype.createUI=function(){var t=iS3Project.getConfig().lang,e=document.createElement("div");e.id="addOutput",e.className="toggleable",e.style.display="none";var n=document.createElement("form");n.id="addOutput_form",n.className="addlayer",e.appendChild(n);var i=document.createElement("p");i.textContent=this.button.title,n.appendChild(i);var o=document.createElement("table"),r=document.createElement("tr");r.innerHTML="<td>"+t.outputFile+':</td><td><select id="outputlayeropt" name="layer" required="required"></td>',o.appendChild(r);var s=document.createElement("tr");s.innerHTML="<td>"+t.type+':</td><td><select name="format" required="required"><option value="panotimeb">PanotimeB</option><option value="shapefile">Shapefile</option><option value="geojson">GeoJSON</option></select></td>',o.appendChild(s);var a=document.createElement("tr");return a.innerHTML='<td><input type="submit" value="'+t.export+'"></td><td><input type="button" value="'+t.cancel+'" onclick="this.form.parentNode.style.display = \'none\'"></td>',o.appendChild(a),n.appendChild(o),e},iS3.layertree.OutputButton.prototype.outputLayer=function(t){var e=this.parentObj;e.getLayerDefById(t.layer.value);try{var n=e.getLayerById(t.layer.value),i=e.map.getView().getProjection();if(n instanceof ol.layer.Vector){var o;switch(t.format.value){case"panotimeb":o=new iS3.format.PanotimeB;break;case"shapefile":o=new iS3.format.Shapefile;break;case"geojson":o=new ol.format.GeoJSON;break;default:return!1}var r=o.writeFeatures(n.getSource().getFeatures(),{dataProjection:ol.proj.get("EPSG:4326"),featureProjection:i}),s=t.layer.options[t.layer.selectedIndex].text;if(r){var a=new File([r],s+".txt",{encoding:"utf-8",type:"text/plain;charset=utf-8"});iS3.saveAs(a,s+".txt",!0)}}}catch(t){e.message.textContent="Some unexpected error occurred: ("+t.message+")."}},iS3.layertree.RemoveButton=function(t){iS3.layertree.BaseButton.call(this,t);var e=t.parentObj,n=this.button;return n.addEventListener("click",function(){if(e.selectedLayer){var t=e.getLayerById(e.selectedLayer.id);e.map.removeLayer(t),e.message.textContent="Layer removed successfully."}else e.message.textContent="No selected layer to remove."}),n},iS3.inherits(iS3.layertree.RemoveButton,iS3.layertree.BaseButton),iS3.layertree.WfsButton=function(t){iS3.layertree.BaseButton.call(this,t),this.parentObj=t.parentObj;var e,n=this,i=this.button;return i.addEventListener("click",function(){e||(e=n.createUI(),document.body.appendChild(e),document.getElementById("wfsurl").value=n.parentObj.parentObj.getConfig().server,document.getElementById("addwfs_form").addEventListener("submit",function(t){t.preventDefault(),n.addWfsLayer(this),this.parentNode.style.display="none"})),"none"===e.style.display?e.style.display="block":e.style.display="none"}),i},iS3.inherits(iS3.layertree.WfsButton,iS3.layertree.BaseButton),iS3.layertree.WfsButton.prototype.createUI=function(){var t=document.createElement("div");t.id="addwfs",t.className="toggleable",t.style.display="none";var e=document.createElement("form");e.id="addwfs_form",e.className="addlayer",t.appendChild(e);var n=document.createElement("p");n.textContent=this.button.title,e.appendChild(n);var i=document.createElement("table"),o=document.createElement("tr");o.innerHTML='<td>Server URL:</td><td><input id="wfsurl" name="server" type="text" required="required" value="http://localhost:8080/geoserver/wfs"></td>',i.appendChild(o);var r=document.createElement("tr");r.innerHTML='<td>Layer name:</td><td><input name="layer" type="text" required="required" value="demo:countries"></td>',i.appendChild(r);var s=document.createElement("tr");s.innerHTML='<td>Display name:</td><td><input name="displayname" type="text" value="countries"></td>',i.appendChild(s);var a=document.createElement("tr");a.innerHTML='<td>Projection:</td><td><input name="projection" type="text" value="EPSG:4326"></td>',i.appendChild(a);var l=document.createElement("tr");return l.innerHTML='<td><input type="submit" value="Add layer"></td><td><input type="button" value="Cancel" onclick="this.form.parentNode.style.display = \'none\'"></td>',i.appendChild(l),e.appendChild(i),t},iS3.layertree.WfsButton.prototype.addWfsLayer=function(t){var e=this.parentObj,n=t.server.value+"/wfs";n=/^((http)|(https))(:\/\/)/.test(n)?n:"http://"+n,n=/\?/.test(n)?n+"&":n+"?";var i=t.layer.value,o=e.map.getView().getProjection().getCode(),r=t.projection.value||o,s=new ol.format.GeoJSON,a=new ol.source.Vector({wrapX:!1,strategy:ol.loadingstrategy.bbox}),l=new XMLHttpRequest;l.onreadystatechange=function(){4===l.readyState&&200===l.status&&a.addFeatures(s.readFeatures(l.responseText,{dataProjection:r,featureProjection:o}))},n=n+"SERVICE=WFS&REQUEST=GetFeature&TYPENAME="+i+"&VERSION=1.1.0&outputFormat=application%2Fjson&SRSNAME="+r,l.open("GET",n),l.send();var d=new ol.layer.Vector({source:a});return d.set("id",t.server.value+":"+t.layer.value),e.addBufferIcon(d),e.map.addLayer(d),e.message.textContent="WFS layer added successfully.",this},iS3.layertree.WmsButton=function(t){iS3.layertree.BaseButton.call(this,t),this.parentObj=t.parentObj;var e,n=this,i=this.button;return i.addEventListener("click",function(){e||(e=n.createUI(),document.body.appendChild(e),document.getElementById("wmsurl").value=n.parentObj.parentObj.getConfig().server,document.getElementById("checkwmslayer").addEventListener("click",function(){n.checkWmsLayer(this.form)}),document.getElementById("addwms_form").addEventListener("submit",function(t){t.preventDefault(),n.addWmsLayer(this),this.parentNode.style.display="none"}),document.getElementById("wmsurl").addEventListener("change",function(){iS3.domTool.removeContent(this.form.layer),iS3.domTool.removeContent(this.form.format)})),"none"===e.style.display?e.style.display="block":e.style.display="none"}),i},iS3.inherits(iS3.layertree.WmsButton,iS3.layertree.BaseButton),iS3.layertree.WmsButton.prototype.createUI=function(){var t=iS3Project.getConfig().lang,e=document.createElement("div");e.id="addwms",e.className="toggleable",e.style.display="none";var n=document.createElement("form");n.id="addwms_form",n.className="addlayer",e.appendChild(n);var i=document.createElement("p");i.textContent=this.button.title,n.appendChild(i);var o=document.createElement("table"),r=document.createElement("tr");r.innerHTML="<td>"+t.serverURL+':</td><td><input id="wmsurl" name="server" type="text" required="required" value="http://localhost:8080/geoserver"></td><td><input id="checkwmslayer" name="check" type="button" value="'+t.checkForLayers+'"></td>',o.appendChild(r);var s=document.createElement("tr");s.innerHTML="<td>"+t.layerName+':</td><td><select name="layer" required="required"></select></td>',o.appendChild(s);var a=document.createElement("tr");a.innerHTML="<td>"+t.format+':</td><td><select name="format" required="required"></select></td>',o.appendChild(a);var l=document.createElement("tr");return l.innerHTML='<td><input type="submit" value="'+t.addLayer+'"></td><td><input type="button" value="'+t.cancel+'" onclick="this.form.parentNode.style.display = \'none\'"></td>',o.appendChild(l),n.appendChild(o),e},iS3.layertree.WmsButton.prototype.checkWmsLayer=function(t){t.check.disabled=!0;var e=this.parentObj;iS3.domTool.removeContent(t.layer),iS3.domTool.removeContent(t.format);var n=t.server.value+"/wms";n=/^((http)|(https))(:\/\/)/.test(n)?n:"http://"+n;var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var n=new ol.format.WMSCapabilities;try{var o,r=n.read(i.responseText),s=e.map.getView().getProjection().getCode(),a="Layers read successfully.";"1.3.0"===r.version?o=r.Capability.Layer.CRS:(o=[s],a+=" Warning! Projection compatibility could not be checked due to version mismatch ("+r.version+").");var l=r.Capability.Layer.Layer;if(l.length>0&&o.indexOf(s)>-1){for(var d=0;d<l.length;d+=1)t.layer.appendChild(iS3.domTool.createOption(l[d].Name));var c=r.Capability.Request.GetMap.Format;for(d=0;d<c.length;d+=1)t.format.appendChild(iS3.domTool.createOption(c[d]));e.message.textContent=a}}catch(t){e.message.textContent="Some unexpected error occurred: ("+t.message+")."}finally{t.check.disabled=!1}}else i.status>200&&(t.check.disabled=!1)},n=/\?/.test(n)?n+"&":n+"?",n+="REQUEST=GetCapabilities&SERVICE=WMS",i.open("GET",n,!0),i.send()},iS3.layertree.WmsButton.prototype.addWmsLayer=function(t){var e=this.parentObj,n={url:t.server.value+"/wms",params:{LAYERS:t.layer.value,FORMAT:t.format.value,VERSION:"1.1.0"},wrapX:!1},i=new ol.layer.Tile({source:new ol.source.TileWMS(n)});return i.set("id",t.server.value+":"+t.layer.value),e.map.addLayer(i),e.message.textContent="WMS layer added successfully.",this},iS3.layertree.BasicContainer=function(t){var e=document.createElement("div");e.className="ui segment",e.id=t.id,this.title=t.title,this.container=e,this.layertree=t.parentObj,this.layer=t.layer},iS3.layertree.BasicContainer.prototype.init=function(){return this.enableDraggable().addCheckbox(),this.layer instanceof ol.layer.Tile&&this.addFilter(),this.container},iS3.layertree.BasicContainer.prototype.enableDraggable=function(){var t=this.container,e=this.layertree;return t.draggable=!0,t.addEventListener("dragstart",function(t){t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",this.id)}),t.addEventListener("dragenter",function(t){this.classList.add("over")}),t.addEventListener("dragleave",function(t){this.classList.remove("over")}),t.addEventListener("dragover",function(t){t.preventDefault(),t.dataTransfer.dropEffect="move"}),t.addEventListener("drop",function(t){t.preventDefault(),this.classList.remove("over");var n=document.getElementById(t.dataTransfer.getData("Text"));if(n!==this){e.layerContainer.removeChild(n),e.layerContainer.insertBefore(n,this);var i=[].slice.call(e.layerContainer.children),o=i.length-i.indexOf(n)-1,r=e.getLayerById(n.id),s=e.map.getLayers().getArray();s.splice(s.indexOf(r),1),s.splice(o,0,r),e.map.render()}}),this},iS3.layertree.BasicContainer.prototype.addLayerTitle=function(){var t=this.layertree,e=this.container,n=document.createElement("span");return n.textContent=e.title,e.appendChild(t.addSelectEvent(n,!0)),n.addEventListener("dblclick",function(){this.contentEditable=!0,e.draggable=!1,e.classList.remove("ol-unselectable"),this.focus()}),n.addEventListener("blur",function(){this.contentEditable&&(this.contentEditable=!1,e.draggable=!0,e.classList.add("ol-unselectable"),e.title=this.textContent)}),this},iS3.layertree.BasicContainer.prototype.addVisibleCheckbox=function(){var t=this.layer,e=this.container,n=document.createElement("input");return n.type="checkbox",n.className="visible",n.checked=t.getVisible(),n.addEventListener("change",function(){this.checked?t.setVisible(!0):t.setVisible(!1)}),e.appendChild(iS3.domTool.stopPropagationOnEvent(n,"click")),this},iS3.layertree.BasicContainer.prototype.addOpacityBar=function(){var t=this.layertree,e=this.layer,n=this.container,i=document.createElement("div");t.addSelectEvent(i,!0);var o=document.createElement("input");return o.type="range",o.min=0,o.max=1,o.step=.1,o.value=e.getOpacity(),o.addEventListener("input",function(){e.setOpacity(this.value)}),o.addEventListener("change",function(){e.setOpacity(this.value)}),o.addEventListener("mousedown",function(){n.draggable=!1}),o.addEventListener("mouseup",function(){n.draggable=!0}),i.appendChild(iS3.domTool.stopPropagationOnEvent(o,"click")),n.appendChild(i),this},iS3.layertree.BasicContainer.prototype.addFilter=function(){var t=this.layertree,e=this.layer,n=this.container,i=document.createElement("div");i.className="filterdiv",t.addSelectEvent(i,!0);var o=document.createElement("form");o.className="filterform",i.appendChild(o);var r=document.createElement("table");r.className="filtertable",o.appendChild(r);var s=document.createElement("tr"),a=document.createElement("td");a.style.width="70%",a.innerHTML=iS3Project.getConfig().lang.filter,s.appendChild(a);var l=document.createElement("td");l.style.width="30%";var d=document.createElement("input");d.type="button",d.value=iS3Project.getConfig().lang.reset,l.appendChild(d),s.appendChild(l),r.appendChild(iS3.domTool.stopPropagationOnEvent(s,"click"));var c=document.createElement("tr"),h=document.createElement("td"),u=document.createElement("select");u.name="header",u.required="required",h.appendChild(u),c.appendChild(h);var p=document.createElement("td"),g=document.createElement("select");g.name="condition",g.required="required",p.appendChild(g),c.appendChild(p),r.appendChild(iS3.domTool.stopPropagationOnEvent(c,"click"));var m=document.createElement("tr"),f=document.createElement("td"),y=document.createElement("input");y.type="text",y.name="cql",y.required="required",f.appendChild(y),m.appendChild(f);var v=document.createElement("td"),j=document.createElement("input");j.type="submit",j.value=iS3Project.getConfig().lang.apply,v.appendChild(j),m.appendChild(v),r.appendChild(iS3.domTool.stopPropagationOnEvent(m,"click")),n.appendChild(i);var x=t.getLayerDefById(e.get("id"));return x?(iS3.geoRequest.getLayerHeader(x,function(t){for(var e=1;e<t.length;e++)u.appendChild(iS3.domTool.createOption(t[e].name))}),g.appendChild(iS3.domTool.createOption("=","=")),g.appendChild(iS3.domTool.createOption("<>","<>")),g.appendChild(iS3.domTool.createOption("<","<")),g.appendChild(iS3.domTool.createOption("<=","<=")),g.appendChild(iS3.domTool.createOption(">",">")),g.appendChild(iS3.domTool.createOption(">=",">=")),g.appendChild(iS3.domTool.createOption("LIKE"," LIKE ")),g.appendChild(iS3.domTool.createOption("BETWEEN"," BETWEEN ")),o.addEventListener("submit",function(t){if(t.preventDefault(),e instanceof ol.layer.Tile){var n=e.getSource(),i=this.header.value+this.condition.value+this.cql.value,o=n.getParams();o.t=(new Date).getMilliseconds(),o.CQLFILTER=i,n.updateParams(o)}}),d.onclick=function(t){if(e instanceof ol.layer.Tile){var n=e.getSource(),i=n.getParams();i.t=(new Date).getMilliseconds(),i.CQLFILTER=null,n.updateParams(i)}},this):this},iS3.layertree.BasicContainer.prototype.addCheckbox=function(){var t=this.layer,e=this.container,n=document.createElement("div");n.className="ui checkbox",e.appendChild(n);var i=document.createElement("input");i.type="checkbox",i.checked=t.getVisible(),i.addEventListener("change",function(){this.checked?t.setVisible(!0):t.setVisible(!1)}),n.appendChild(iS3.domTool.stopPropagationOnEvent(i,"click"));var o=document.createElement("label");return o.addEventListener("click",function(t){t.stopPropagation(),e.click()}),o.textContent=this.title,n.appendChild(o),this},iS3.layertree.BaseMapContainer=function(t){iS3.layertree.BasicContainer.call(this,t)},iS3.inherits(iS3.layertree.BaseMapContainer,iS3.layertree.BasicContainer),iS3.layertree.BaseMapContainer.prototype.init=function(){return this.enableDraggable().addCheckbox(),this.container},iS3.layertree.PanopointContainer=function(t){iS3.layertree.BasicContainer.call(this,t)},iS3.inherits(iS3.layertree.PanopointContainer,iS3.layertree.BasicContainer),iS3.layertree.PanopointContainer.prototype.addFilter=function(){var t=iS3Project.getConfig().lang,e=this.layertree,n=this.layer,i=this.container,o=document.createElement("div");o.className="filterdiv",e.addSelectEvent(o,!0);var r=document.createElement("form");r.className="filterform",o.appendChild(r);var s=document.createElement("table");s.className="filtertable",r.appendChild(s);var a=document.createElement("tr"),l=document.createElement("td");l.style.width="70%",l.innerHTML=iS3Project.getConfig().lang.filter,a.appendChild(l);var d=document.createElement("td");d.style.width="30%";var c=document.createElement("input");c.type="button",c.value=iS3Project.getConfig().lang.reset,d.appendChild(c),a.appendChild(d),s.appendChild(iS3.domTool.stopPropagationOnEvent(a,"click"));var h=document.createElement("tr"),u=document.createElement("td"),p=document.createElement("select");p.name="point",p.required="required",u.appendChild(p),h.appendChild(u);var g=document.createElement("td"),m=document.createElement("input");m.type="submit",m.value=iS3Project.getConfig().lang.apply,g.appendChild(m),h.appendChild(g),s.appendChild(iS3.domTool.stopPropagationOnEvent(h,"click"));var f=document.createElement("tr"),y=document.createElement("td");y.innerHTML=iS3Project.getConfig().lang.carDay,f.appendChild(y),s.appendChild(iS3.domTool.stopPropagationOnEvent(f,"click"));var v=document.createElement("tr"),j=document.createElement("td"),x=document.createElement("input");x.type="text",x.name="day",j.appendChild(x),v.appendChild(j);var _=document.createElement("td"),S=document.createElement("input");return S.type="button",S.value=iS3Project.getConfig().lang.apply,S.onclick=function(){if(!x.value)return!1;var t="kydateid like '%"+x.value+"%'",e=n.getSource(),i=e.getParams();i.t=(new Date).getMilliseconds(),i.CQLFILTER=t,e.updateParams(i)},_.appendChild(S),v.appendChild(_),s.appendChild(iS3.domTool.stopPropagationOnEvent(v,"click")),i.appendChild(o),p.appendChild(iS3.domTool.createOption(t.qualifiedPoints,"status=0")),p.appendChild(iS3.domTool.createOption(t.pictureDeletedPoints,"status=1")),p.appendChild(iS3.domTool.createOption(t.isolatedDeletedPoints,"status=2")),p.appendChild(iS3.domTool.createOption(t.repeatedDeletedPoints,"status=3")),p.appendChild(iS3.domTool.createOption(t.linkDeletedPoints,"status=4")),p.appendChild(iS3.domTool.createOption(t.allPanopoints,"status<>-1")),r.addEventListener("submit",function(t){if(t.preventDefault(),n instanceof ol.layer.Tile){var e=n.getSource(),i=p.value,o=e.getParams();o.t=(new Date).getMilliseconds(),o.CQL_FILTER=i,e.updateParams(o)}}),c.onclick=function(t){if(n instanceof ol.layer.Tile){var e=n.getSource(),i=e.getParams();i.t=(new Date).getMilliseconds(),i.CQL_FILTER=null,e.updateParams(i)}},m.click(),this},iS3.toolbar=function(t){},iS3.toolbar.Toolbar=function(t){"use strict";if(!(this instanceof iS3.toolbar.Toolbar))throw new Error("toolBar must be constructed with the new keyword.");if("object"!=typeof t||!t.parentObj||!t.target)throw new Error("Invalid parameter(s) provided.");if(!(t.parentObj.getMap()instanceof ol.Map))throw new Error("Please provide a valid OpenLayers 3 map object.");var e=document.getElementById(t.target);if(null===e||1!==e.nodeType)throw new Error("Please provide a valid element id.");this.map=t.parentObj.getMap(),this.buttons=t.buttons,this.containerDiv=document.getElementById(t.target),this.layertree=t.parentObj.getLayertree(),this.message=t.parentObj.getMessage(),this.groups=new iS3.ToolGroupCollection({}),this.init()},iS3.toolbar.Toolbar.prototype.init=function(){var t=this;this.buttons.forEach(function(e){t.addGroup(e)})},iS3.toolbar.Toolbar.prototype.addGroup=function(t){var e=iS3Project.getConfig().lang;switch(t){case"zoomGroup":this.addToolGroup(new iS3.toolbar.ZoomGroup({parentObj:this,id:"zoomGroup",name:e.zoomGroupName}));break;case"selectGroup":this.addToolGroup(new iS3.toolbar.SelectGroup({parentObj:this,id:"selectGroup",name:e.selectGroupName}));break;case"drawGroup":this.addToolGroup(new iS3.toolbar.DrawGroup({parentObj:this,id:"drawGroup",name:e.drawGroupName}));break;case"measureGroup":this.addToolGroup(new iS3.toolbar.MeasureGroup({parentObj:this,id:"measureGroup",name:e.measureGroupName}));break;case"queryGroup":this.addToolGroup(new iS3.toolbar.QueryGroup({parentObj:this,id:"queryGroup",name:e.queryGroupName}));break;case"customGroup":this.addToolGroup(new iS3.toolbar.CustomGroup({parentObj:this,id:"customGroup",name:e.customGroupName}));break;case"testGroup":this.addToolGroup(new iS3.toolbar.TestGroup({parentObj:this,id:"testGroup",name:"Test"}));break;default:return!1}},iS3.toolbar.Toolbar.prototype.addControl=function(t,e){if(!(e instanceof ol.control.Control))throw new Error("Only controls can be added to the toolbar.");return"toggle"===e.get("type")&&e.on("change:active",function(){e.get("active")&&this.groups.getAllTools().forEach(function(t){"toggle"===t.get("type")&&t!==e&&t.get("toggleGroup")===e.get("toggleGroup")&&t.set("active",!1)})},this),e.setTarget(t),this.map.addControl(e),this},iS3.toolbar.Toolbar.prototype.removeControl=function(t){return this.controls.remove(t),this.map.removeControl(t),this},iS3.toolbar.Toolbar.prototype.addToolGroup=function(t){if(!t||0===t.getTools().length)return this;this.groups.add(t);var e=document.createElement("span");e.className="group-name",e.textContent=t.name+"  ";var n=document.createElement("div");n.className="groupHolder";var i=document.createElement("div");i.className="ui large basic icon buttons",n.appendChild(i),this.containerDiv.appendChild(n);for(var o=0;o<t.getTools().length;o++)this.addControl(i,t.getTools()[o]);return this},iS3.toolbar.BasicControl=function(t){var e=document.createElement("button");e.setAttribute("data-tooltip",t.tipLabel||"Custom interaction"),e.setAttribute("data-position","bottom left"),e.className="ui button";var n=document.createElement("i"),i=iS3.toolbar.BasicControl.getIcon(t.className);n.className=i,e.appendChild(n),ol.control.Control.call(this,{element:e,target:t.target}),this.setDisabled=function(t){if("boolean"==typeof t)return e.disabled=t,this};var o=this;t.type&&"toggle"===t.type?(o.setProperties({active:!1,type:"toggle",toggleGroup:t.toggleGroup||"Global"}),o.on("change:active",function(){this.get("active")?(e.classList.add("active"),t.trigger()):(e.classList.remove("active"),t.destroy())},this),e.addEventListener("click",function(){o.get("active")?o.set("active",!1):o.set("active",!0)})):e.addEventListener("click",t.trigger)},ol.inherits(iS3.toolbar.BasicControl,ol.control.Control),iS3.toolbar.BasicControl.getIcon=function(t){return"ol-zoom-layer"===t?"expand icon":"ol-zoom-selected"===t?"map marker alternate icon":"ol-deselect"===t?"circle notch icon":"iS3-clickquery"===t?"info icon":"question icon"},iS3.toolbar.CustomGroup=function(t){iS3.ToolGroup.call(this,t),this.parentObj=t.parentObj,this.layertree=t.parentObj.layertree,this.init()},iS3.inherits(iS3.toolbar.CustomGroup,iS3.ToolGroup),iS3.toolbar.CustomGroup.prototype.init=function(){var t=this,e=new iS3.toolbar.GisQualityControl(t.parentObj);e.id="gisQuality",this.add(e)},iS3.toolbar.DrawGroup=function(t){iS3.ToolGroup.call(this,t),this.layertree=t.parentObj.layertree,this.init()},iS3.inherits(iS3.toolbar.DrawGroup,iS3.ToolGroup),iS3.toolbar.DrawGroup.prototype.init=function(){var t=this,e=this.layertree;this.activeFeatures=new ol.Collection,e.selectEventEmitter.on("change",function(){var n=e.getLayerById(e.selectedLayer.id);if(n instanceof ol.layer.Vector){this.getTools().forEach(function(t){t.setDisabled(!1)});var i=n.get("type");i||(t.getTools()[3].setDisabled(!0).set("active",!1),t.getTools()[4].setDisabled(!0).set("active",!1)),"point"!==i&&"geomcollection"!==i&&t.getTools()[0].setDisabled(!0).set("active",!1),"line"!==i&&"geomcollection"!==i&&t.getTools()[1].setDisabled(!0).set("active",!1),"polygon"!==i&&"geomcollection"!==i&&t.getTools()[2].setDisabled(!0).set("active",!1),setTimeout(function(){t.activeFeatures.clear(),t.activeFeatures.extend(n.getSource().getFeatures())},0)}else this.getTools().forEach(function(t){t.set("active",!1),t.setDisabled(!0)})},this),this.loadDrawPoint().loadDrawLine().loadDrawPolygon().loadRemoveFeature().loadDragFeature()},iS3.toolbar.DrawGroup.prototype.loadDrawPoint=function(){var t=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.addPointsTip,className:"ol-addpoint",interaction:ol.control.Interaction.handleEvents(this,new ol.interaction.Draw({type:"Point",snapTolerance:1}),"point")}).setDisabled(!0);return t.id="drawPoint",this.add(t),this},iS3.toolbar.DrawGroup.prototype.loadDrawLine=function(){var t=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.addLinesTip,className:"ol-addline",interaction:ol.control.Interaction.handleEvents(this,new ol.interaction.Draw({type:"LineString",snapTolerance:1}),"line")}).setDisabled(!0);return t.id="drawLine",this.add(t),this},iS3.toolbar.DrawGroup.prototype.loadDrawPolygon=function(){var t=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.addPolygonsTip,className:"ol-addpolygon",interaction:ol.control.Interaction.handleEvents(this,new ol.interaction.Draw({type:"Polygon",snapTolerance:1}),"polygon")}).setDisabled(!0);return t.id="drawPolygon",this.add(t),this},iS3.toolbar.DrawGroup.prototype.loadRemoveFeature=function(){var t=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.removeFeaturesTip,className:"ol-removefeat",interaction:new ol.interaction.RemoveFeature({features:this.activeFeatures})}).setDisabled(!0);return t.id="removeFeature",this.add(t),this},iS3.toolbar.DrawGroup.prototype.loadDragFeature=function(){var t=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.dragFeaturesTip,className:"ol-dragfeat",interaction:new ol.interaction.DragFeature({features:this.activeFeatures})}).setDisabled(!0);t.id="dragFeature",this.add(t)},ol.interaction.RemoveFeature=function(t){ol.interaction.Pointer.call(this,{handleDownEvent:function(t){return this.set("deleteCandidate",t.map.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.get("features").getArray().indexOf(t)!==-1)return t},this)),!!this.get("deleteCandidate")},handleUpEvent:function(t){t.map.forEachFeatureAtPixel(t.pixel,function(t,e){t===this.get("deleteCandidate")&&(e.getSource().removeFeature(t),this.get("features").remove(t))},this),this.set("deleteCandidate",null)}}),this.setProperties({features:t.features,deleteCandidate:null})},ol.inherits(ol.interaction.RemoveFeature,ol.interaction.Pointer),ol.interaction.DragFeature=function(t){ol.interaction.Pointer.call(this,{handleDownEvent:function(t){return this.set("draggedFeature",t.map.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.get("features").getArray().indexOf(t)!==-1)return t},this)),this.get("draggedFeature")&&this.set("coords",t.coordinate),!!this.get("draggedFeature")},handleDragEvent:function(t){var e=t.coordinate[0]-this.get("coords")[0],n=t.coordinate[1]-this.get("coords")[1];this.get("draggedFeature").getGeometry().translate(e,n),this.set("coords",t.coordinate)},handleUpEvent:function(t){this.setProperties({coords:null,draggedFeature:null})}}),this.setProperties({features:t.features,coords:null,draggedFeature:null})},ol.inherits(ol.interaction.DragFeature,ol.interaction.Pointer),iS3.toolbar.GisQualityControl=function(t){this.NOMARK=-1,this.QUALIFIED=0,this.PICTURE=1,this.ISOLATED=2,this.REPEATED=3,this.LINK=4,this.WORKTMPFIELD="worktmp",this.TIPREPEATED="tip_repeated";var e,n=this;iS3.toolbar.BasicControl.call(this,{label:" ",tipLabel:iS3Project.getConfig().lang.gisQualifiedTip,className:"iS3-gisquality ol-unselectable ol-control",trigger:function(){if(e||(e=n.getGISQualityDiv(t)),e.isVisible())e.close();else{e.show();var i=document.getElementById("gisQualityForm"),o=i.getElementsByTagName("table")[0],r=o.getElementsByTagName("tr")[0],s=r.getElementsByTagName("td")[0];s.textContent=s.textContent.replace(/\*/g,"");var a=t.layertree.layerContainer.childNodes,l=document.getElementById("gis-qualified-target");iS3.domTool.removeContent(l);for(var d in a)if(1===a[d].nodeType&&t.layertree.getLayerDefById(a[d].id).layertype===iS3.LayerDef.layerType.PANOPOINT){var c=document.createElement("option");c.value=a[d].id,c.textContent=a[d].title,l.appendChild(c)}}}})},ol.inherits(iS3.toolbar.GisQualityControl,iS3.toolbar.BasicControl),iS3.toolbar.GisQualityControl.prototype.getGISQualityDiv=function(t){var e=iS3Project.getConfig().lang,n="#66CD00",i="#FF69B4",o=this,r=t.layertree,s=new iS3.DraggableDiv({id:"gisquality",title:iS3Project.getConfig().lang.gisQualifiedTip}),a=document.createElement("form");a.id="gisQualityForm",a.className="draggable-form",a.addEventListener("submit",function(t){t.preventDefault();var e=r.getLayerById(r.selectedLayer.id),n=r.getLayerDefById(this.target.value);iS3.toolbar.GisQualityControl.mergePoints(e,n),s.close()});var l=document.createElement("table"),d=document.createElement("tr"),c=document.createElement("td");c.textContent=e.pictureDeletedPoints,d.appendChild(c);var h=document.createElement("td"),u=document.createElement("input");u.id="gischeck-checkbox-picture",u.type="checkbox",u.checked=!0,u.onchange=function(){var t=document.getElementById("gischeck-checkbox-picture").checked;iS3.toolbar.GisQualityContprol.switchFeatureStyle(o.PICTURE,n,t)},h.appendChild(u);var p=document.createElement("input");p.type="button",p.value=e.auto,p.onclick=function(){iS3.toolbar.GisQualityControl.autoMarkPicturedPoints(o.PICTURE,n).done(function(t){c.textContent=e.pictureDeletedPoints+"*("+t+")"})},h.appendChild(p);var g=document.createElement("input");g.name="file",g.type="file",g.onchange=function(){iS3.toolbar.GisQualityControl.markPicturedPoints(g.files[0],o.PICTURE,n)},h.appendChild(g),d.appendChild(h);var m=document.createElement("tr"),f=document.createElement("td");f.textContent=e.isolatedDeletedPoints,m.appendChild(f);var y=document.createElement("td"),v=document.createElement("input");v.id="gischeck-checkbox-isolated",v.type="checkbox",v.checked=!0,v.onchange=function(){var t=document.getElementById("gischeck-checkbox-isolated").checked;iS3.toolbar.GisQualityControl.switchFeatureStyle(o.ISOLATED,n,t)},y.appendChild(v);var j=document.createElement("input");j.type="button",j.value=e.auto,j.onclick=function(){this.disabled=!0;var t=this;setTimeout(function(){iS3.toolbar.GisQualityControl.autoMarkIsolatedPoints(o.ISOLATED,n),t.disabled=!1},100)},y.appendChild(j);var x=document.createElement("input");
x.id="gischeck-mark-isolated",x.type="button",x.value=e.markSelected,x.onclick=function(){iS3.toolbar.GisQualityControl.markFeatures(t.selectInteraction.getFeatures(),o.ISOLATED,n)},y.appendChild(x),y.appendChild($("<span>1</span>").get(0)),m.appendChild(y);var _=document.createElement("tr"),S=document.createElement("td");S.textContent=e.repeatedDeletedPoints,_.appendChild(S);var b=document.createElement("td"),E=document.createElement("input");E.id="gischeck-checkbox-repeated",E.type="checkbox",E.checked=!0,E.onchange=function(){var t=document.getElementById("gischeck-checkbox-repeated").checked;iS3.toolbar.GisQualityControl.switchFeatureStyle(o.REPEATED,n,t)},b.appendChild(E);var C=document.createElement("input");C.id="auto-repeated-mark",C.type="button",C.value=e.auto,C.onclick=function(){C.disabled=!0,setTimeout(function(){var t=r.getLayerDefById(document.getElementById("gisQualityForm").target.value);iS3.toolbar.GisQualityControl.autoMarkRepeatedPoints(t,o.REPEATED,i)},100)},b.appendChild(C);var I=document.createElement("input");I.id="gischeck-mark-repeated",I.type="button",I.value=e.markSelected,I.onclick=function(){iS3.toolbar.GisQualityControl.markFeatures(t.selectInteraction.getFeatures(),o.REPEATED,n)},b.appendChild(I),b.appendChild($("<span>2</span>").get(0)),_.appendChild(b);var w=document.createElement("tr"),L=document.createElement("td");L.textContent=e.linkDeletedPoints,w.appendChild(L);var P=document.createElement("td"),T=document.createElement("input");T.id="gischeck-checkbox-link",T.type="checkbox",T.checked=!0,T.onchange=function(){var t=document.getElementById("gischeck-checkbox-link").checked;iS3.toolbar.GisQualityControl.switchFeatureStyle(o.LINK,n,t)},P.appendChild(T);var N=document.createElement("input");N.id="gischeck-mark-link",N.type="button",N.value=e.markSelected,N.onclick=function(){iS3.toolbar.GisQualityControl.markFeatures(t.selectInteraction.getFeatures(),o.LINK,n)},P.appendChild(N),P.appendChild($("<span>3</span>").get(0)),w.appendChild(P);var D=document.createElement("tr"),O=document.createElement("td");O.textContent=e.reset,D.appendChild(O);var A=document.createElement("td"),R=document.createElement("input");R.id="gischeck-checkbox-tip",R.type="checkbox",R.checked=!0,R.onchange=function(){var t=document.getElementById("gischeck-checkbox-tip").checked;iS3.toolbar.GisQualityControl.switchFeatureStyle(o.NOMARK,i,t,"tip_repeated")},A.appendChild(R);var M=document.createElement("input");M.id="gischeck-mark-reset",M.type="button",M.value=e.markSelected,M.onclick=function(){iS3.toolbar.GisQualityControl.resetFeatures(t.selectInteraction.getFeatures())},A.appendChild(M),A.appendChild($("<span>4</span>").get(0)),D.appendChild(A);var F=document.createElement("tr"),k=document.createElement("td");k.textContent=e.targetLayer,F.appendChild(k);var G=document.createElement("select");G.id="gis-qualified-target",G.name="target",G.required="required",F.appendChild(G);var B=document.createElement("tr"),q=document.createElement("td"),V=document.createElement("input");V.type="submit",V.value=e.submit,q.appendChild(V),B.appendChild(q);var H=document.createElement("td"),U=document.createElement("input");return U.type="button",U.value=e.cancel,U.onclick=function(){s.close()},q.appendChild(U),B.appendChild(H),l.appendChild(d),l.appendChild(m),l.appendChild(_),l.appendChild(w),l.appendChild(D),l.appendChild(F),l.appendChild(B),a.appendChild(l),s.getContent().appendChild(a),s},iS3.toolbar.GisQualityControl.resetFeatures=function(t){function e(){return function(){return n.selectInteraction.getFeatures().getArray().indexOf(this)===-1?iS3.style.getDefault():iS3.style.getDefaultSelected()}}var n=iS3Project.getToolbar();t.forEach(function(t){t.set("status",0),t.unset("worktmp"),t.setStyle(e())}),n.selectInteraction.getFeatures().clear()},iS3.toolbar.GisQualityControl.markFeatures=function(t,e,n,i){function o(){return function(){return r.selectInteraction.getFeatures().getArray().indexOf(this)===-1?d:iS3.style.getDefaultSelected()}}var r=iS3Project.getToolbar(),s=iS3.style.getFill(n),a=iS3.style.getStroke(iS3.style.setTransparent(n,.4),8),l=null;switch(e){case 1:l=iS3.style.getTriangle(s,a,8);break;case 2:l=iS3.style.getSquare(s,a,5);break;case 3:l=iS3.style.getStar(s,a,5);break;case 4:l=iS3.style.getHexagon(s,a,5);break;default:return!1}i&&(l=iS3.style.getCircle(s,a,5));var d=new ol.style.Style({image:l});t.forEach(function(t){i||(t.set("status",e),t.unset("worktmp")),t.setStyle(o())}),r.selectInteraction.getFeatures().clear()},iS3.toolbar.GisQualityControl.switchFeatureStyle=function(t,e,n,i){function o(){return function(){return l.selectInteraction.getFeatures().getArray().indexOf(this)===-1?u:iS3.style.getDefaultSelected()}}function r(){return function(){return this.get("worktmp")&&this.get("worktmp")===i?iS3.style.getDefault():iS3.style.getTransparent()}}function s(t,e,n){return t.get("worktmp")?t.get("worktmp")===n:t.get("status")===e}var a=iS3Project.getLayertree();if(a.getLayerDefById(a.selectedLayer.id).layertype!==iS3.LayerDef.layerType.PANOTIMEB)return document.getElementById("auto-repeated-mark").disabled=!1,!1;if("undefined"===n)return!1;var l=iS3Project.getToolbar(),d=iS3.style.getFill(e),c=iS3.style.getStroke(iS3.style.setTransparent(e,.4),8),h=null;switch(t){case-1:break;case 1:h=iS3.style.getTriangle(d,c,8);break;case 2:h=iS3.style.getSquare(d,c,5);break;case 3:h=iS3.style.getStar(d,c,5);break;case 4:h=iS3.style.getHexagon(d,c,5);break;default:return!1}"tip_repeated"===i&&(h=iS3.style.getCircle(d,c,5));for(var u=new ol.style.Style({image:h}),p=a.getLayerById(a.selectedLayer.id),g=p.getSource().getFeatures(),m=[],f=0;f<g.length;f++)s(g[f],t,i)&&m.push(g[f]);l.selectInteraction.getFeatures().clear(),m.forEach(function(t){n?(t.setStyle(o()),t.set("selectable",!0)):(t.setStyle(r()),t.set("selectable",!1))}),a.message.textContent=m.length+" switched"},iS3.toolbar.GisQualityControl.mergePoints=function(t,e){var n=t.getSource().getFeatures(),i=new iS3.format.PanotimeB,o=i.toJson(n),r=iS3Project.getLayertree().getLayerDefById(t.get("id")),s=iS3Project.getConfig().proxy;$.post(s+"/gischeck/task/submit",{cardayID:r.name.split(":")[1],json:o}).done(function(t){alert(t);var n=iS3Project.getLayertree().getLayerById(e.id);if(n instanceof ol.layer.Tile){var i=n.getSource(),o=i.getParams();o.t=(new Date).getMilliseconds(),i.updateParams(o)}})},iS3.toolbar.GisQualityControl.autoMarkPicturedPoints=function(t,e){var n=$.Deferred,i=n(),o=iS3Project.getLayertree(),r=o.getLayerDefById(o.selectedLayer.id),s=iS3Project.getConfig().proxy;return $.post(s+"/gischeck/upload/exp",{cardayID:r.name.split(":")[1]}).done(function(n){for(var r,s=/'(.*?)'/g,a=[];r=s.exec(n);)a.push(r[1]);for(var l=[],d=o.getLayerById(o.selectedLayer.id).getSource().getFeatures(),c=0;c<d.length;c++)for(var h=0;h<a.length;h++)if(d[c].get("kydate_id")===a[h]){l.push(d[c]);break}iS3.toolbar.GisQualityControl.markFeatures(l,t,e),i.resolve(l.length)}),i.promise()},iS3.toolbar.GisQualityControl.markPicturedPoints=function(t,e,n){var i=new FileReader,o=iS3Project.getLayertree().getLayerById(iS3Project.getLayertree().selectedLayer.id).getSource().getFeatures();i.readAsText(t),i.onload=function(t){for(var i,r=/'(.*?)'/g,s=[];i=r.exec(t.target.result);)s.push(i[1]);for(var a=[],l=0;l<o.length;l++)for(var d=0;d<s.length;d++)if(o[l].get("kydate_id")===s[d]){a.push(o[l]);break}iS3.toolbar.GisQualityControl.markFeatures(a,e,n)}},iS3.toolbar.GisQualityControl.autoMarkIsolatedPoints=function(t,e){var n=iS3.topology.trueDist2MapDist(200),i=iS3Project.getLayertree();if(i.getLayerDefById(i.selectedLayer.id).layertype===iS3.LayerDef.layerType.PANOTIMEB){for(var o=3.14*n*n*2,r=i.getLayerById(i.selectedLayer.id).getSource().getFeatures(),s=[],a=[],l=0;l<r.length;l++)s.push(iS3.topology.parser.read(r[l].getGeometry()).buffer(n));var d=jsts.operation.union.CascadedPolygonUnion.union(s);if(d instanceof jsts.geom.MultiPolygon){for(l=0;l<d.geometries.length;l++)d.geometries[l].getArea()<o&&a.push(d.geometries[l]);var c=[];for(l=0;l<a.length;l++){for(var h=[],u=0;u<r.length;u++)a[l].intersects(s[u])===!0&&h.push(r[u]);console.log(h.length),h.length<4&&h.forEach(function(t){c.push(t)})}iS3.toolbar.GisQualityControl.markFeatures(c,t,e)}}},iS3.toolbar.GisQualityControl.autoMarkRepeatedPoints=function(t,e,n){var i=iS3.topology.trueDist2MapDist(5),o=iS3Project.getLayertree();if(o.getLayerDefById(o.selectedLayer.id).layertype!==iS3.LayerDef.layerType.PANOTIMEB)return void(document.getElementById("auto-repeated-mark").disabled=!1);for(var r=o.getLayerById(o.selectedLayer.id),s=r.getSource().getFeatures(),a={},l=0;l<s.length;l++){var d=iS3.geohash.encode(s[l].get("xxx"),s[l].get("yyy"),7);a[d]||(a[d]=[]),a[d].push(s[l])}$.each(a,function(o,r){var s=[];for(l=0;l<r.length;l++)0===r[l].get("status")&&s.push(r[l].getGeometry().getCoordinates());var a=hull(s,10),d=new ol.geom.Polygon([a],"XY");d=iS3.topology.parser.write(iS3.topology.parser.read(d).buffer(10)),iS3.geoRequest.polygonFeaturesFromTile(t,d).done(function(t){if(t.length<1)return void(document.getElementById("auto-repeated-mark").disabled=!1);for(var o={},s=0;s<t.length;s++)if(0===t[s].get("status")){var a=iS3.geohash.encode(t[s].get("xxx"),t[s].get("yyy"),9);o[a]||(o[a]=[]),o[a].push(t[s])}var l=[];for(s=0;s<r.length;s++){r[s].unset("worktmp");var d=iS3.geohash.encode(r[s].get("xxx"),r[s].get("yyy"),9),c=iS3.geohash.neighbors(d);c.unshift(d);for(var h=iS3.topology.parser.read(r[s].getGeometry()).buffer(i),u=!1,p=0;p<c.length;p++){if(o[c[p]])for(var g=0;g<o[c[p]].length;g++)if(h.intersects(iS3.topology.parser.read(o[c[p]][g].getGeometry()))){u=!0;break}if(u)break}u&&(r[s].set("worktmp","tip_repeated"),l.push(r[s]))}iS3.toolbar.GisQualityControl.markFeatures(l,e,n,!0),document.getElementById("auto-repeated-mark").disabled=!1})})},ol.control.Interaction=function(t){var e=document.createElement("button");e.setAttribute("data-tooltip",t.tipLabel||"Custom interaction"),e.setAttribute("data-position","bottom left"),e.className="ui button";var n=document.createElement("i"),i=ol.control.Interaction.getIcon(t.className);n.className=i,e.appendChild(n),this.setDisabled=function(t){if("boolean"==typeof t)return e.disabled=t,this};var o=this;e.addEventListener("click",function(){o.get("interaction").getActive()?o.set("active",!1):o.set("active",!0)});var r=t.interaction;ol.control.Control.call(this,{element:e,target:t.target}),this.setProperties({interaction:r,active:!1,type:"toggle",toggleGroup:t.toggleGroup||"Global",destroyFunction:function(t){t.element===o&&this.removeInteraction(o.get("interaction"))}}),this.on("change:active",function(){this.get("interaction").setActive(this.get("active")),this.get("active")?e.classList.add("active"):e.classList.remove("active")},this)},ol.inherits(ol.control.Interaction,ol.control.Control),ol.control.Interaction.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t);var e=this.get("interaction");null===t?ol.Observable.unByKey(this.get("eventId")):t.getInteractions().getArray().indexOf(e)===-1&&(t.addInteraction(e),e.setActive(!1),this.set("eventId",t.getControls().on("remove",this.get("destroyFunction"),t)))},ol.control.Interaction.handleEvents=function(t,e,n){var i=iS3Project.getLayertree();return"point"!==n&&e.on("drawstart",function(t){var o=!1;if(i.selectedLayer){var r=i.getLayerById(i.selectedLayer.id),s=r.get("type");o=s!==n&&"geomcollection"!==s}else o=!0;o&&e.finishDrawing()},this),e.on("drawend",function(e){var o,r="";t:if(i.selectedLayer){if(o=i.getLayerById(i.selectedLayer.id),r=o instanceof ol.layer.Vector?"":"Please select a valid vector layer.")break t;var s=o.get("type");r=s===n||"geomcollection"===s?"":"Selected layer has a different vector type."}else r="Please select a layer first.";r?i.message.textContent=r:(o.getSource().addFeature(e.feature),t.activeFeatures.push(e.feature))},this),e},ol.control.Interaction.getIcon=function(t){return"ol-dragpan"===t?"hand paper icon":"ol-singleselect"===t?"genderless icon":"ol-singleselect"===t?"genderless icon":"ol-multiselect"===t?"cube icon":"ol-polygonselect"===t?"connectdevelop icon":"ol-addpoint"===t?"pencil alternate icon":"ol-addline"===t?"minus icon":"ol-addpolygon"===t?"square icon":"ol-removefeat"===t?"eraser icon":"ol-dragfeat"===t?"hand rock icon":"ol-lineString-measure"===t?"road icon":"ol-polygon-measure"===t?"map icon":"question icon"},iS3.toolbar.MeasureGroup=function(t){iS3.ToolGroup.call(this,t),this.parentObj=t.parentObj,this.layertree=t.parentObj.layertree,this.init()},iS3.inherits(iS3.toolbar.MeasureGroup,iS3.ToolGroup),iS3.toolbar.MeasureGroup.prototype.init=function(){this.loadLineStringMeasure().loadPolygonMeasure()},iS3.toolbar.MeasureGroup.formatLength=function(t){for(var e=new ol.Sphere(6378137),n=0,i=t.getCoordinates(),o=iS3Project.getMap().getView().getProjection(),r=0,s=i.length-1;r<s;++r){var a=ol.proj.transform(i[r],o,"EPSG:4326"),l=ol.proj.transform(i[r+1],o,"EPSG:4326");n+=e.haversineDistance(a,l)}var d;return d=n>100?Math.round(n/1e3*100)/100+" km":Math.round(100*n)/100+" m"},iS3.toolbar.MeasureGroup.formatArea=function(t){var e,n=new ol.Sphere(6378137),i=iS3Project.getMap().getView().getProjection(),o=t.clone().transform(i,"EPSG:4326"),r=o.getLinearRing(0).getCoordinates(),s=Math.abs(n.geodesicArea(r));return e=s>1e4?Math.round(s/1e6*100)/100+" km<sup>2</sup>":Math.round(100*s)/100+" m<sup>2</sup>"},iS3.toolbar.MeasureGroup.createMeasureTooltipElement=function(){var t=document.createElement("div");return t.className="ol-measure-tip",t},iS3.toolbar.MeasureGroup.createMeasureTooltip=function(t){var e=new ol.Overlay({element:t,offset:[0,-15],positioning:"bottom-center"});return iS3Project.getMap().addOverlay(e),e},iS3.toolbar.MeasureGroup.prototype.loadLineStringMeasure=function(){var t=this.layertree,e=new ol.interaction.Draw({type:"LineString",source:t.getDrawingLayer().getSource()}),n=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.measureLinestringTip,className:"ol-lineString-measure",interaction:e});n.id="lineStringMeasure";var i,o,r;return e.on("drawstart",function(t){o=iS3.toolbar.MeasureGroup.createMeasureTooltipElement(),r=iS3.toolbar.MeasureGroup.createMeasureTooltip(o);var e=t.coordinate;i=t.feature.getGeometry().on("change",function(t){var n,i=t.target;i instanceof ol.geom.LineString&&(n=iS3.toolbar.MeasureGroup.formatLength(i),e=i.getLastCoordinate()),o.innerHTML=n,r.setPosition(e)})},this),e.on("drawend",function(){r.setOffset([0,-7]),o=null,o=iS3.toolbar.MeasureGroup.createMeasureTooltipElement(),r=iS3.toolbar.MeasureGroup.createMeasureTooltip(o),ol.Observable.unByKey(i)},this),n.on("change:active",function(){this.get("active")||(t.map.getOverlays().clear(),t.getDrawingLayer().getSource().clear())}),this.add(n),this},iS3.toolbar.MeasureGroup.prototype.loadPolygonMeasure=function(){var t=this.layertree,e=new ol.interaction.Draw({type:"Polygon",source:t.getDrawingLayer().getSource()}),n=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.measurePolygonTip,className:"ol-polygon-measure",interaction:e});n.id="polygonMeasure";var i,o,r;return e.on("drawstart",function(t){o=iS3.toolbar.MeasureGroup.createMeasureTooltipElement(),r=iS3.toolbar.MeasureGroup.createMeasureTooltip(o);var e=t.coordinate;i=t.feature.getGeometry().on("change",function(t){var n,i=t.target;i instanceof ol.geom.Polygon&&(n=iS3.toolbar.MeasureGroup.formatArea(i),e=i.getInteriorPoint().getCoordinates()),o.innerHTML=n,r.setPosition(e)})},this),e.on("drawend",function(){r.setOffset([0,-7]),o=null,o=iS3.toolbar.MeasureGroup.createMeasureTooltipElement(),r=iS3.toolbar.MeasureGroup.createMeasureTooltip(o),ol.Observable.unByKey(i)},this),n.on("change:active",function(){this.get("active")||(t.map.getOverlays().clear(),t.getDrawingLayer().getSource().clear())}),this.add(n),this},iS3.toolbar.Projection=function(t){var e=this,n=document.createElement("select"),i=document.createElement("option");i.value="EPSG:4326",i.textContent="EPSG:4326",n.appendChild(i);var o=document.createElement("option");o.value="EPSG:3857",o.textContent="EPSG:3857",n.appendChild(o),n.addEventListener("change",function(t){var n=e.getMap().getView(),i=n.getProjection(),o=ol.proj.get(this.value),r=new ol.View({center:ol.proj.transform(n.getCenter(),i,o),zoom:n.getZoom(),projection:o,extent:o.getExtent()});e.getMap().setView(r),e.getMap().getLayers().forEach(function(t){e.changeLayerProjection(t,i,o)})}),ol.control.Control.call(this,{element:n,target:t.target}),this.set("element",n)},ol.inherits(iS3.toolbar.Projection,ol.control.Control),iS3.toolbar.Projection.prototype.setMap=function(t){ol.control.Control.prototype.setMap.call(this,t),null!==t&&(this.get("element").value=t.getView().getProjection().getCode())},iS3.toolbar.Projection.prototype.changeLayerProjection=function(t,e,n){if(t instanceof ol.layer.Group)t.getLayers().forEach(function(t){this.changeLayerProjection(t,e,n)});else if(t instanceof ol.layer.Tile){var i=t.getSource().getTileLoadFunction();t.getSource().setTileLoadFunction(i)}else if(t instanceof ol.layer.Vector)for(var o=t.getSource().getFeatures(),r=0;r<o.length;r+=1)o[r].getGeometry().transform(e,n)},iS3.toolbar.QueryGroup=function(t){iS3.ToolGroup.call(this,t),this.parentObj=t.parentObj,this.layertree=t.parentObj.layertree,this.init()},iS3.inherits(iS3.toolbar.QueryGroup,iS3.ToolGroup),iS3.toolbar.QueryGroup.prototype.init=function(){var t=this.layertree;t.selectEventEmitter.on("change",function(){},this),this.loadClickQuery()},iS3.toolbar.QueryGroup.prototype.loadClickQuery=function(){var t=this,e=new iS3.toolbar.BasicControl({label:" ",tipLabel:iS3Project.getConfig().lang.queryAttributeTip,className:"iS3-clickquery",type:"toggle",trigger:function(){t.clickEvent=iS3.toolbar.QueryGroup.clickQueryFunction(t.parentObj)},destroy:function(){t.parentObj.map.unByKey(t.clickEvent)}});return e.id="clickQuery",this.add(e),this},iS3.toolbar.QueryGroup.clickQueryFunction=function(t){var e=t.map,n=t.layertree;return e.on("click",function(i){e.getOverlays().clear(),t.selectInteraction.getFeatures().clear();var o=e.getView().getResolution(),r=n.getLayerById(n.selectedLayer.id),s=e.getView().getProjection(),a=r.getSource().getGetFeatureInfoUrl(i.coordinate,o,s.getCode(),{INFO_FORMAT:"application/json"}),l=new ol.format.GeoJSON,d=new XMLHttpRequest;d.open("GET",a),d.send(),d.onreadystatechange=function(){if(4===d.readyState&&200===d.status){var n=l.readFeatures(d.responseText,{featureProjection:s});if(n.length>0){var o=iS3.toolbar.QueryGroup.createFeatureDiv(t,n[0],"read");e.addOverlay(new ol.Overlay({element:o,position:i.coordinate})),t.selectInteraction.getFeatures().push(n[0])}}}})},iS3.toolbar.QueryGroup.createFeatureDiv=function(t,e,n){function i(){var e=document.createElement("input");return e.type="button",e.className="cancel",e.value=iS3Project.getConfig().lang.cancel,e.addEventListener("click",function(e){e.preventDefault(),a.getOverlays().clear(),t.selectInteraction.getFeatures().clear()}),e}function o(){var n=document.createElement("input");return n.type="button",n.className="edit",n.value=iS3Project.getConfig().lang.edit,n.addEventListener("click",function(n){n.preventDefault();var i=a.getOverlays().getArray()[0].getPosition();a.getOverlays().clear(),a.addOverlay(new ol.Overlay({element:iS3.toolbar.QueryGroup.createFeatureDiv(t,e,"edit"),position:i}))}),n}function r(){var n=document.createElement("input");return n.type="button",n.className="save",n.value=iS3Project.getConfig().lang.save,n.addEventListener("click",function(n){n.preventDefault();var i=a.getOverlays().getArray()[0].getPosition();a.getOverlays().clear(),a.addOverlay(new ol.Overlay({element:iS3.toolbar.QueryGroup.createFeatureDiv(t,e,"read"),position:i}))}),n}function s(){var n=document.createElement("input");return n.type="button",n.className="delete",n.value=iS3Project.getConfig().lang.delete,n.addEventListener("click",function(n){n.preventDefault(),a.getOverlays().clear(),t.selectInteraction.getFeatures().clear(),iS3.geoRequest.transactWFS(l,[e],"delete")}),n}var a=t.map,l=(t.layertree.getLayerById(t.layertree.selectedLayer.id),t.layertree.getLayerDefById(t.layertree.selectedLayer.id)),d=document.createElement("div");return d.className="iS3-feature-popup",d.appendChild(iS3.toolbar.QueryGroup.featureToForm(e,n)),"read"===n&&(d.appendChild(o()),d.appendChild(i())),"edit"===n&&(d.appendChild(r()),d.appendChild(s())),d},iS3.toolbar.QueryGroup.featureToForm=function(t,e){function n(t,e,n){var i=document.createElement("div"),o=document.createElement("span");o.textContent=t+": ",i.appendChild(o);var r=document.createElement("input");return r.name=t,r.type="text",r.value=e,i.appendChild(r),n||(r.readOnly="readonly"),i}var i=document.createElement("form");i.className="iS3-feature-form";var o=t.getProperties();for(var r in o)"read"===e?i.appendChild(n(r,o[r],!1)):"edit"===e&&i.appendChild(n(r,o[r],!0));return i},iS3.toolbar.SelectGroup=function(t){iS3.ToolGroup.call(this,t),this.parentObj=t.parentObj,this.layertree=t.parentObj.layertree,this.init()},iS3.inherits(iS3.toolbar.SelectGroup,iS3.ToolGroup),iS3.toolbar.SelectGroup.prototype.init=function(){var t=this.layertree;this.selectInteraction=new ol.interaction.Select({style:iS3.style.getDefaultSelected(),layers:function(e){return!(!t.selectedLayer||e!==t.getLayerById(t.selectedLayer.id))},wrapX:!1}),this.parentObj.map.addInteraction(this.selectInteraction),this.selectInteraction.setActive(!1),this.parentObj.selectInteraction=this.selectInteraction,t.selectEventEmitter.on("change",function(){var e=t.getLayerById(t.selectedLayer.id);e instanceof ol.layer.Vector?this.getTools()[0].setDisabled(!1):(this.getTools()[0].set("active",!1),this.getTools()[0].setDisabled(!0))},this),this.loadSingleSelect().loadBoxSelect().loadPolygonSelect().loadDeselect()},iS3.toolbar.SelectGroup.prototype.loadSingleSelect=function(){var t=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.clickSelectTip,className:"ol-singleselect",interaction:this.selectInteraction}).setDisabled(!0);return t.id="singleSelect",this.add(t),this},iS3.toolbar.SelectGroup.prototype.loadBoxSelect=function(){var t=this.layertree,e=this,n=new ol.interaction.DragBox,i=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.boxSelectTip,className:"ol-multiselect",interaction:n});return i.id="boxSelect",n.on("boxend",function(i){e.selectInteraction.getFeatures().clear();var o=n.getGeometry().getExtent();if(this.layertree.selectedLayer){var r=t.getLayerById(t.selectedLayer.id).getSource();if(r instanceof ol.source.Vector)r.forEachFeatureIntersectingExtent(o,function(t){(void 0===t.get("selectable")||t.get("selectable"))&&e.selectInteraction.getFeatures().push(t)}),t.getLayerById(t.selectedLayer.id).changed(),t.message.textContent=e.selectInteraction.getFeatures().getLength()+" selected";else if(r instanceof ol.source.Tile){var s=t.getLayerDefById(t.selectedLayer.id);iS3.geoRequest.bboxFeaturesFromTile(s,o,function(i){for(var o=0;o<i.length;o++){var r=n.getGeometry();iS3.topology.polyIntersectsPoly(r,i[o].getGeometry())===!0&&e.selectInteraction.getFeatures().push(i[o])}t.message.textContent=i.length+" selected"})}}},this),this.add(i),this},iS3.toolbar.SelectGroup.prototype.loadPolygonSelect=function(){var t=this.layertree,e=this,n=new ol.interaction.Draw({type:"Polygon",snapTolerance:1}),i=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.polygonSelectTip,className:"ol-polygonselect",interaction:n});return i.id="polygonSelect",n.on("drawend",function(n){if(e.selectInteraction.getFeatures().clear(),t.selectedLayer){var i=n.feature.getGeometry().getExtent(),o=n.feature.getGeometry(),r=t.getLayerById(t.selectedLayer.id).getSource();if(r instanceof ol.source.Vector)r.forEachFeatureInExtent(i,function(t){iS3.topology.polyIntersectsPoly(o,t.getGeometry())===!0&&(void 0===t.get("selectable")||t.get("selectable"))&&e.selectInteraction.getFeatures().push(t)}),t.getLayerById(t.selectedLayer.id).changed(),t.message.textContent=e.selectInteraction.getFeatures().getLength()+" selected";else if(r instanceof ol.source.Tile){var s=t.getLayerDefById(t.selectedLayer.id);iS3.geoRequest.polygonFeaturesFromTile(s,o).done(function(n){for(var i=0;i<n.length;i++)e.selectInteraction.getFeatures().push(n[i]);t.message.textContent=n.length+" selected"})}}},this),this.add(i),this},iS3.toolbar.SelectGroup.prototype.loadDeselect=function(){var t=this,e=new iS3.toolbar.BasicControl({label:" ",tipLabel:iS3Project.getConfig().lang.removeSelectionTip,className:"ol-deselect",trigger:function(){t.selectInteraction.getFeatures().clear()}});return e.id="deselect",this.add(e),this},iS3.toolbar.TestGroup=function(t){iS3.ToolGroup.call(this,t),this.parentObj=t.parentObj,this.layertree=t.parentObj.layertree,this.init()},iS3.inherits(iS3.toolbar.TestGroup,iS3.ToolGroup),iS3.toolbar.TestGroup.prototype.init=function(){this.layertree;this.loadTest()},iS3.toolbar.TestGroup.prototype.loadTest=function(){var t=this,e=new iS3.toolbar.BasicControl({label:"T",tipLabel:"Test",className:"iS3-test ol-unselectable ol-control",trigger:function(){t.test(t.layertree)}});return e.id="test",this.add(e),this},iS3.toolbar.TestGroup.prototype.test=function(t){var e=t.getLayerById(t.selectedLayer.id),n=e.getSource().getFeatures(),i=new iS3.format.PanotimeB,o=(i.toJson(n),iS3Project.getToolbar());console.log(o.selectInteraction.getFeatures().getArray()["PANOTIME201507216I_Btest.1"])},iS3.toolbar.ZoomGroup=function(t){iS3.ToolGroup.call(this,t),this.parentObj=t.parentObj,this.layertree=t.parentObj.layertree,this.init()},iS3.inherits(iS3.toolbar.ZoomGroup,iS3.ToolGroup),iS3.toolbar.ZoomGroup.prototype.init=function(){this.layertree;this.loadDragPan().loadZoomToLayer().loadZoomToSelected()},iS3.toolbar.ZoomGroup.prototype.loadDragPan=function(){var t=new ol.control.Interaction({label:" ",tipLabel:iS3Project.getConfig().lang.pan,toggleGroup:"Pan",className:"ol-dragpan",interaction:new ol.interaction.DragPan});return t.id="dragPan",this.add(t),this},iS3.toolbar.ZoomGroup.prototype.loadZoomFull=function(){var t=new ol.control.ZoomToExtent({label:" ",tipLabel:iS3Project.getConfig().lang.zoomToFullTip});return t.id="zoomFull",this.add(t),this},iS3.toolbar.ZoomGroup.prototype.loadZoomToLayer=function(){var t=this.layertree,e=this,n=null,i=new iS3.toolbar.BasicControl({label:" ",tipLabel:iS3Project.getConfig().lang.zoomToLayerTip,className:"ol-zoom-layer",trigger:function(){if(!t.selectedLayer)return e.parentObj.message.textContent="Please select a layer",null;var i=t.getLayerById(t.selectedLayer.id);if(i instanceof ol.layer.Tile){var o=t.getLayerDefById(t.selectedLayer.id);$.get(iS3Project.getConfig().proxy+"/index.php/v1/extents?layername="+o.featureType).done(function(e){var i=[],o=JSON.parse(e);i.push(o.data.minx),i.push(o.data.miny),i.push(o.data.maxx),i.push(o.data.maxy),n=ol.proj.transformExtent(i,ol.proj.get("EPSG:4326"),t.map.getView().getProjection()),(n instanceof ol.geom.SimpleGeometry||"[object Array]"===Object.prototype.toString.call(n)&&4===n.length)&&t.map.getView().fit(n,t.map.getSize())})}else if(i instanceof ol.layer.Vector){var r=i.getSource();r.getExtent()&&(n=r.getExtent())}(n instanceof ol.geom.SimpleGeometry||"[object Array]"===Object.prototype.toString.call(n)&&4===n.length)&&t.map.getView().fit(n,t.map.getSize())}});return i.id="zoomToLayer",this.add(i),this},iS3.toolbar.ZoomGroup.prototype.loadZoomToSelected=function(){var t=this,e=this.layertree,n=ol.extent.createEmpty(),i=new iS3.toolbar.BasicControl({label:" ",tipLabel:iS3Project.getConfig().lang.zoomToSelectedTip,className:"ol-zoom-selected",trigger:function(){if(0===t.parentObj.selectInteraction.getFeatures().getArray().length)return t.parentObj.message.textContent="Please select a layer",null;for(var i=t.parentObj.selectInteraction.getFeatures(),o=0;o<i.getLength();o++){var r=i.item(o).getGeometry();r instanceof ol.geom.SimpleGeometry&&(n=ol.extent.extend(n,r.getExtent()))}(n instanceof ol.geom.SimpleGeometry||"[object Array]"===Object.prototype.toString.call(n)&&4===n.length)&&e.map.getView().fit(n,e.map.getSize())}});return i.id="zoomToSelected",this.add(i),this},iS3.format=function(t){},iS3.format.PanotimeB=function(t){this.name=t?t.name:null,this.headers=[{name:"captureid",type:"string"},{name:"date",type:"string"},{name:"time",type:"string"},{name:"flag",type:"string"},{name:"xxx",type:"number",fixed:9},{name:"yyy",type:"number",fixed:9},{name:"nexxx",type:"number",fixed:9},{name:"northdeg",type:"number",fixed:9},{name:"speed",type:"number",fixed:2},{name:"kydate_id",type:"string"},{name:"x",type:"number",fixed:0},{name:"y",type:"number",fixed:0},{name:"z",type:"number",fixed:3},{name:"h_ell",type:"number",fixed:3},{name:"vnorth",type:"number",fixed:3},{name:"veast",type:"number",fixed:3},{name:"vup",type:"number",fixed:3},{name:"pitch",type:"number",fixed:3},{name:"roll",type:"number",fixed:3},{name:"q",type:"number",fixed:0},{name:"gpstime",type:"string"},{name:"scale",type:"number",fixed:3},{name:"s_f",type:"number",fixed:3},{name:"viewtype",type:"number",fixed:0},{name:"dis",type:"string"},{name:"dis_time",type:"string"},{name:"av",type:"string"},{name:"tv",type:"string"},{name:"iso",type:"string"},{name:"wb",type:"string"}]},iS3.format.PanotimeB.prototype.readFeatures=function(t,e){for(var n=this.headers,i=t.split(/[\r\n]+/g),o=[],r=this.name.substr(0,this.name.lastIndexOf(".")),s=1;s<i.length;s++)if(""!==i[s]&&"#"!==i[s].substring(0,1)&&" "!==i[s].substring(0,1)){var a=i[s].replace("//","").replace(/]\//g,"] ").replace(/,/g," ").split(" "),l=r+"."+s,d=new ol.geom.Point([parseFloat(a[4]),parseFloat(a[5])]),c=new ol.Feature;c.setId(l),c.setGeometryName("wkb_geometry"),c.setGeometry(d),c.getGeometry().transform(e.dataProjection,e.featureProjection);for(var h=0;h<a.length;h++)"string"===n[h].type?c.set(n[h].name,a[h]):c.set(n[h].name,parseFloat(a[h]));c.set("status",0),o.push(c)}return o},iS3.format.PanotimeB.prototype.writeFeatures=function(t,e){function n(t,e){return parseInt(t.get("captureid"),10)-parseInt(e.get("captureid"),10)}t.sort(n);var i=this.headers,o=[];o.push("#captureID,date,time,flag,xxx,yyy,NExxx,northDeg,Speed,kydate_id,x,y,z,H-Ell,VNorth,VEast,VUp,Pitch,Roll,Q,gpstime,scale,s-f,viewtype//dis,time,Av,Tv,ISO,WB");for(var r=0;r<t.length;r++)if(0===t[r].get("status")){for(var s=[],a=0;a<4;a++)"string"===i[a].type?s.push(t[r].get(i[a].name)):s.push(t[r].get(i[a].name).toFixed(i[a].fixed));for(s.push(t[r].get(i[4].name)),s.push(t[r].get(i[5].name)),a=6;a<8;a++)"string"===i[a].type?s.push(t[r].get(i[a].name)):s.push(t[r].get(i[a].name).toFixed(i[a].fixed));var l=t[r].get(i[8].name).toFixed(2).toString();for(s.push(("00000"+l).substr(-5)),a=9;a<24;a++)"string"===i[a].type?s.push(t[r].get(i[a].name)):s.push(t[r].get(i[a].name).toFixed(i[a].fixed));var d=["//",t[r].get(i[24].name),"/",t[r].get(i[25].name),"/",t[r].get(i[26].name),",",t[r].get(i[27].name),",",t[r].get(i[28].name),",",t[r].get(i[29].name)];s.push(d.join("")),o.push(s.join(" "))}return o.join("\r\n")},iS3.format.PanotimeB.prototype.toJson=function(t,e){for(var n=[],i=this.headers,o="status",r="carday_series",s="keydate",a=0;a<t.length;a++){for(var l={},d=0;d<i.length;d++)l[i[d].name]=t[a].get(i[d].name);t[a].get(r)?l[r]=t[a].get(r):l[r]=0,t[a].get(o)?l[o]=t[a].get(o):l[o]=0,t[a].get(s)?l[s]=t[a].get(s):l[s]=t[a].get("kydate_id").split("_")[0].toLowerCase(),n.push(l)}return JSON.stringify(n)},iS3.format.PanotimeB.prototype.readProjection=function(t){return ol.proj.get("EPSG:4326")},iS3.format.Shapefile=function(t){},iS3.format.Shapefile.prototype.readFeatures=function(t,e,n){iS3.geoRequest.shapeToGeojson(t,e,function(t){var i=new ol.format.GeoJSON,o=i.readFeatures(t,{dataProjection:e.targetSrs,featureProjection:e.targetSrs});n(o)})},iS3.format.Shapefile.prototype.writeFeatures=function(t,e){var n=new ol.format.GeoJSON;iS3.geoRequest.geojsonToShp(n.writeFeatures(t),"output",e)},iS3.LangCN=function(){this.cancel="",this.save="",this.delete="",
this.edit="",this.close="",this.add="",this.type="",this.apply="",this.submit="",this.reset="",this.filter="",this.carDay="",this.auto="",this.markSelected="",this.targetLayer="",this.inputFile="",this.outputFile="",this.export="",this.addwmsTitle="",this.addwfsTitle="",this.newlayerTitle="",this.addInputTitle="",this.outputLayerTitle="",this.removeLayerTitle="",this.serverURL="URL",this.checkForLayers="",this.layerName="",this.addLayer="",this.format="",this.displayName="",this.qualifiedPoints="",this.pictureDeletedPoints="",this.isolatedDeletedPoints="",this.repeatedDeletedPoints="",this.linkDeletedPoints="Link",this.allPanopoints="",this.zoomGroupName="",this.selectGroupName="",this.drawGroupName="",this.measureGroupName="",this.queryGroupName="",this.customGroupName="",this.pan="",this.zoomToFullTip="",this.zoomToLayerTip="",this.zoomToSelectedTip="",this.clickSelectTip="",this.boxSelectTip="",this.polygonSelectTip="",this.removeSelectionTip="",this.addPointsTip="",this.addLinesTip="",this.addPolygonsTip="",this.removeFeaturesTip="",this.dragFeaturesTip="",this.measureLinestringTip="",this.measurePolygonTip="",this.queryAttributeTip="",this.gisQualifiedTip="GIS ctrl+q "},iS3.LangEN=function(){this.cancel="Cancel",this.save="Save",this.delete="Delete",this.edit="Edit",this.close="Close",this.add="Add",this.type="Type",this.apply="Appply",this.submit="Submit",this.reset="Reset",this.filter="Filter",this.carDay="Car day",this.auto="Auto",this.markSelected="Mark selected",this.targetLayer="Target layer",this.inputFile="Input file",this.outputFile="Output file",this.export="Export",this.addwmsTitle="Add WMS Layer",this.addwfsTitle="Add WFS Layer",this.newlayerTitle="Add Empty Layer",this.addInputTitle="Input Layer",this.outputLayerTitle="Export Layer",this.removeLayerTitle="Remove Layer",this.serverURL="Server URL",this.checkForLayers="Check for layers",this.layerName="Layer name",this.addLayer="Add layer",this.format="Format",this.displayName="Display name",this.qualifiedPoints="Qualified points",this.pictureDeletedPoints="Picture deleted points",this.isolatedDeletedPoints="Isolated deleted points",this.repeatedDeletedPoints="Repeated deleted points",this.linkDeletedPoints="Link deleted points",this.allPanopoints="All the panopoints",this.zoomGroupName="Zoom",this.selectGroupName="Select",this.drawGroupName="Draw",this.measureGroupName="Measure",this.queryGroupName="Query",this.customGroupName="Custom",this.pan="Pan",this.zoomToFullTip="Zoom to full extent",this.zoomToLayerTip="Zoom to layer extent",this.zoomToSelectedTip="Zoom to selected feature",this.clickSelectTip="Select feature",this.boxSelectTip="Select features with a box",this.polygonSelectTip="Select features with a polygon",this.removeSelectionTip="Remove selection(s)",this.addPointsTip="Add points",this.addLinesTip="Add lines",this.addPolygonsTip="Add polygons",this.removeFeaturesTip="Remove features",this.dragFeaturesTip="Drag features",this.measureLinestringTip="Measure with a line string",this.measurePolygonTip="Measure with a polygon",this.queryAttributeTip="Query attribute",this.gisQualifiedTip="GIS quality testing"},iS3.data=function(t){},iS3.data.Data=function(t){"use strict";if(!(this instanceof iS3.data.Data))throw new Error("data must be constructed with the new keyword.");if("object"!=typeof t||!t.parentObj||!t.target)throw new Error("Invalid parameter(s) provided.");if(!(t.parentObj.getMap()instanceof ol.Map))throw new Error("Please provide a valid OpenLayers 3 map object.");var e=document.getElementById(t.target);if(null===e||1!==e.nodeType)throw new Error("Please provide a valid element id.");this.map=t.parentObj.getMap(),this.containerDiv=document.getElementById(t.target),this.layertree=t.parentObj.getLayertree(),this.message=t.parentObj.getMessage(),this.init()},iS3.data.Data.prototype.init=function(){this.containerDiv.innerHTML="<table id='datapanel' class='ui celled table' style='width:100%'><thead> <tr> <th>Name</th> <th>Position</th> <th>Office</th> <th>Age</th> <th>Start date</th> <th>Salary</th> </tr> </thead><tbody> <tr> <td>Tiger Nixon</td> <td>System Architect</td> <td>Edinburgh</td> <td>61</td> <td>2011/04/25</td> <td>$320,800</td> </tr><tr> <td>Garrett Winters</td> <td>Accountant</td> <td>Tokyo</td> <td>63</td> <td>2011/07/25</td> <td>$170,750</td> </tr><tr> <td>Ashton Cox</td> <td>Junior Technical Author</td> <td>San Francisco</td> <td>66</td> <td>2009/01/12</td> <td>$86,000</td> </tr><tr> <td>Cedric Kelly</td> <td>Senior Javascript Developer</td> <td>Edinburgh</td> <td>22</td> <td>2012/03/29</td> <td>$433,060</td> </tr><tr> <td>Airi Satou</td> <td>Accountant</td> <td>Tokyo</td> <td>33</td> <td>2008/11/28</td> <td>$162,700</td> </tr><tr> <td>Brielle Williamson</td> <td>Integration Specialist</td> <td>New York</td> <td>61</td> <td>2012/12/02</td> <td>$372,000</td> </tr>";var t=$("#datapanel").DataTable({dom:"t",scrollY:300,scrollCollapse:!0,scrollX:!0,paging:!1});$("#datapanel tbody").on("click","tr",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):(t.$("tr.selected").removeClass("selected"),$(this).addClass("selected"))})},iS3.data.Data.prototype.updateSize=function(){var t=$("#datapanel").DataTable();$(".dataTables_scrollBody").css("max-height",this.containerDiv.clientHeight-25+"px"),t.draw()},iS3.datatree=function(t){},iS3.datatree.Datatree=function(t){"use strict";if(!(this instanceof iS3.datatree.Datatree))throw new Error("datatree must be constructed with the new keyword.");if("object"!=typeof t||!t.parentObj||!t.target)throw new Error("Invalid parameter(s) provided.");if(!(t.parentObj.getMap()instanceof ol.Map))throw new Error("Please provide a valid OpenLayers 3 map object.");var e=document.getElementById(t.target);if(null===e||1!==e.nodeType)throw new Error("Please provide a valid element id.");this.map=t.parentObj.getMap(),this.containerDiv=document.getElementById(t.target),this.layertree=t.parentObj.getLayertree(),this.message=t.parentObj.getMessage(),this.init()},iS3.datatree.Datatree.prototype.init=function(){if(null!=iS3Project.domains){var t=this,e=document.createElement("div");e.setAttribute("class","semantic-full ui mini top attached tab segment active"),e.setAttribute("data-tab","first"),e.setAttribute("id","dt-geo"),t.containerDiv.appendChild(e);var n=document.createElement("div");n.setAttribute("class","ui mini bottom attached tabular menu"),t.containerDiv.appendChild(n);var i=document.createElement("div");i.setAttribute("class","semantic-menu item active"),i.setAttribute("data-tab","first"),i.textContent="Geology",n.appendChild(i),$(".menu .item").tab(),$(function(){$("#dt-geo").jstree({core:{animation:200,data:[{text:"Root node",icon:"sitemap icon",state:{opened:!0},children:[{text:"Child node 1",icon:"anchor icon"},{text:"Child node 2",icon:"anchor icon"}]}]},plugins:["wholerow"]})})}},iS3.DraggableDiv=function(t){function e(){window.removeEventListener("mousemove",i,!0)}function n(t){d.x=t.clientX-o.offsetLeft,d.y=t.clientY-o.offsetTop,window.addEventListener("mousemove",i,!0)}function i(t){o.style.position="absolute";var e=t.clientY-d.y,n=t.clientX-d.x;o.style.top=e+"px",o.style.left=n+"px"}this.id=t.id,this.title=t.title,this.width=t.width?t.width:.3*document.body.clientWidth,this.height=t.height?t.height:.3*document.body.clientHeight,this.left=document.body.clientWidth?(document.body.clientWidth-this.width)/2:0,this.top=document.body.clientHeight?(document.body.clientHeight-this.height)/2:0;var o=document.createElement("div");o.setAttribute("id",this.id),o.setAttribute("class","draggable-div");var r=document.createElement("div");r.setAttribute("class","draggable-bar"),r.appendChild(document.createTextNode(this.title));var s=document.createElement("span");s.setAttribute("class","draggable-close"),s.appendChild(document.createTextNode("[X]")),r.appendChild(s),o.appendChild(r);var a=document.createElement("div");a.setAttribute("class","draggable-content"),o.appendChild(a);var l=this;s.onclick=function(t){l.close()};var d={x:0,y:0};r.addEventListener("mousedown",n,!1),window.addEventListener("mouseup",e,!1),o.style.width="auto",o.style.height="auto",o.style.left=this.left+"px",o.style.top=this.top+"px",o.style.display="none",document.body.appendChild(o),this._container=o,this.content=a},iS3.DraggableDiv.prototype.getContent=function(){return this.content},iS3.DraggableDiv.prototype.isVisible=function(){return"block"===this._container.style.display},iS3.DraggableDiv.prototype.show=function(){this._container.style.display="block"},iS3.DraggableDiv.prototype.close=function(){this._container.style.display="none"};